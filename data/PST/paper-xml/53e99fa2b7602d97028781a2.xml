<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Numerical representation of geostrophic modes on arbitrarily structured C-grids</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2009-08-18">18 August 2009</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">J</forename><surname>Thuburn</surname></persName>
							<email>j.thuburn@ex.ac.uk</email>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Mathematics Research Institute</orgName>
								<orgName type="department" key="dep2">School of Engineering, Mathematics and Physical Sciences</orgName>
								<orgName type="institution">University of Exeter</orgName>
								<address>
									<addrLine>North Park Road</addrLine>
									<postCode>EX4 4QF</postCode>
									<settlement>Exeter</settlement>
									<country key="GB">UK</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">T</forename><forename type="middle">D</forename><surname>Ringler</surname></persName>
							<email>ringler@lanl.gov</email>
							<affiliation key="aff1">
								<orgName type="department">Theoretical Division</orgName>
								<orgName type="institution">Los Alamos National Laboratory</orgName>
								<address>
									<postCode>87545</postCode>
									<settlement>Los Alamos</settlement>
									<region>NM</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">W</forename><forename type="middle">C</forename><surname>Skamarock</surname></persName>
							<email>skamaroc@ucar.edu</email>
							<affiliation key="aff2">
								<orgName type="institution">National Center for Atmospheric Research</orgName>
								<address>
									<postCode>80307</postCode>
									<settlement>Boulder</settlement>
									<region>CO</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">J</forename><forename type="middle">B</forename><surname>Klemp</surname></persName>
							<email>klemp@ucar.edu</email>
							<affiliation key="aff2">
								<orgName type="institution">National Center for Atmospheric Research</orgName>
								<address>
									<postCode>80307</postCode>
									<settlement>Boulder</settlement>
									<region>CO</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Numerical representation of geostrophic modes on arbitrarily structured C-grids</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2009-08-18">18 August 2009</date>
						</imprint>
					</monogr>
					<idno type="MD5">36C0A47ADB67B0FC2ABA04AD25168C29</idno>
					<idno type="DOI">10.1016/j.jcp.2009.08.006</idno>
					<note type="submission">Received 29 May 2009 Received in revised form 7 August 2009 Accepted 10 August 2009</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.3" ident="GROBID" when="2023-07-28T04:24+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>A C-grid staggering, in which the mass variable is stored at cell centers and the normal velocity component is stored at cell faces (or edges in two dimensions) is attractive for atmospheric modeling since it enables a relatively accurate representation of fast wave modes. However, the discretization of the Coriolis terms is non-trivial. For constant Coriolis parameter, the linearized shallow water equations support geostrophic modes: stationary solutions in geostrophic balance. A naive discretization of the Coriolis terms can cause geostrophic modes to become non-stationary, causing unphysical behaviour of numerical solutions. Recent work has shown how to discretize the Coriolis terms on a planar regular hexagonal grid to ensure that geostrophic modes are stationary while the Coriolis terms remain energy conserving. In this paper this result is extended to arbitrarily structured C-grids. An explicit formula is given for constructing an appropriate discretization of the Coriolis terms. The general formula is illustrated by showing that it recovers previously known results for the planar regular hexagonal C-grid and the spherical longitude-latitude C-grid. Numerical calculation confirms that the scheme does indeed give stationary geostrophic modes for the hexagonal-pentagonal and triangular geodesic C-grids on the sphere.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Atmospheric and oceanic flows are balance-dominated on large scales. Accurate representation of balance in numerical models requires an accurate representation of the fast acoustic and inertio-gravity waves that are the mechanism for adjustment towards balance. A C-grid, in which the mass and pressure variables are stored at cell centers and normal velocity components are stored at cell faces (or cell edges in two dimensions), allows a relatively accurate representation of the fast waves provided the Rossby radius is well resolved <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b17">18,</ref><ref type="bibr" target="#b8">9]</ref> and so is often favored by atmospheric modelers.</p><p>The drawback of the C-grid is its handling of the Coriolis terms: the Coriolis term at any face requires a value of the tangential velocity at that face, which must therefore be approximated using a suitable weighted average of normal velocity components from nearby faces. The ability of the resulting scheme to capture wave propagation accurately can be sensitive to the details of the stencil and weights used for this averaging <ref type="bibr" target="#b26">[27,</ref><ref type="bibr" target="#b7">8,</ref><ref type="bibr" target="#b24">25,</ref><ref type="bibr" target="#b25">26]</ref>.</p><p>The present work is motivated by the possibility of using a hexagonal-pentagonal geodesic grid with a C-grid staggering for global atmospheric modeling. Geodesic grids (both hexagonal and triangular versions, though not necessarily with C-grid staggering) were proposed in the late 1960s <ref type="bibr" target="#b27">[28,</ref><ref type="bibr" target="#b20">21,</ref><ref type="bibr" target="#b6">7,</ref><ref type="bibr" target="#b13">14]</ref>, and there is now renewed interest because the nearly homogeneous and isotropic grid avoids pole problems and is expected to permit good performance on massively parallel computer architectures <ref type="bibr" target="#b10">[11,</ref><ref type="bibr" target="#b23">24,</ref><ref type="bibr" target="#b22">23,</ref><ref type="bibr" target="#b9">10,</ref><ref type="bibr" target="#b18">19,</ref><ref type="bibr" target="#b12">13,</ref><ref type="bibr" target="#b19">20,</ref><ref type="bibr" target="#b3">4,</ref><ref type="bibr" target="#b14">15,</ref><ref type="bibr" target="#b21">22]</ref>. However, despite the promise of such grids, initial studies of wave propagation for the linearized f-plane shallow water equations using a perfectly regular hexagonal C-grid revealed a potential problem: with the most obvious discretization of the Coriolis terms, geostrophic modes, which should have zero frequency, in fact have non-zero frequencies, with the largest being of the same order as the Coriolis parameter f <ref type="bibr" target="#b15">[16]</ref>. Thuburn <ref type="bibr" target="#b25">[26]</ref> and, independently, Klemp and Skamarock (unpublished report) showed how to modify the discretization of the Coriolis terms on the regular hexagonal f-plane C-grid to ensure stationary geostrophic modes. However, they left open the question of how to extend this construction to the distorted hexagons and the pentagons of the spherical geodesic grid. This extension is the topic of the present paper.</p><p>Although motivated by one particular grid, our procedure for constructing a discretization of the Coriolis terms is, in fact, applicable to a wide variety of grid structures. To define the class of permitted grids consider the dual grid. The vertices of the dual grid coincide with the cell centers of the original or primal grid, the dual grid cell centers correspond to primal grid vertices, and each dual edge crosses exactly one primal edge. Our procedure is applicable to grids having the property that dual edges are orthogonal to primal edges. The allowed grids include arbitrary Delaunay triangulations and Voronoi diagrams (e.g. <ref type="bibr" target="#b2">[3]</ref>), as well as quadrilateral grids based on orthogonal coordinate systems such as longitude-latitude and conformal cubed sphere (e.g. <ref type="bibr" target="#b16">[17]</ref>). Unstructured versions of such grids, called unstructured orthogonal grids, have been applied, for example, to coastal and shelf modelling <ref type="bibr" target="#b4">[5,</ref><ref type="bibr" target="#b5">6]</ref>, though without explicitly addressing the issue of stationarity of geostrophic modes.</p><p>To keep clear the wide applicability of our construction of the Coriolis terms, we present it in Section 2 below for the linearized constant f shallow water equations in a general framework. In Section 3 we show that the proposed scheme maintains energy conservation. In Section 4 we illustrate how our procedure works for several example grid structures. The derivation gives insight into previous results showing sensitivity of Rossby wave propagation to the handling of the Coriolis terms on a longitude-latitude spherical C-grid <ref type="bibr" target="#b26">[27]</ref>. The construction presented here will also be applicable to a wide variety of other grids, including conformal cubed sphere and arbitrarily structured and adaptively refined grids.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Derivation of coriolis term weighting factors</head><p>The rotating shallow water equations, linearized about a state of rest with constant mean geopotential U 0 , may be written</p><formula xml:id="formula_0">@U @t þ U 0 d ¼ 0;<label>ð1Þ</label></formula><formula xml:id="formula_1">@u @t þ f k Â u þ rU ¼ 0:<label>ð2Þ</label></formula><p>Here u is the horizontal velocity vector, k is the unit vertical vector, f is the Coriolis parameter, r is the horizontal gradient operator, and d ¼ r Á u is the velocity divergence. The geometry is two-dimensional, but may be planar or some curved surface such as the surface of a sphere.</p><p>In this paper we will restrict attention to the case of constant Coriolis parameter f, allowing us to focus on the requirement that geostrophic modes should be stationary. Although, for a spherical planet, variations in f are inherently associated with the spherical geometry, in fact there is no mathematical inconsistency in taking f to be constant in a curved geometry. We will exploit this fact in order to test our approach in Section 4.</p><p>The key insight needed to motivate the derivation below comes from the linearized vorticity equation (obtained by taking</p><formula xml:id="formula_2">k Á rÂ (2)) @n @t þ f d ¼ 0;<label>ð3Þ</label></formula><formula xml:id="formula_3">where n ¼ k Á r Â u<label>ð4Þ</label></formula><p>is the relative vorticity. For geostrophic modes the divergence vanishes, implying that the vorticity tendency must vanish; thus, geostrophic modes must be stationary. We wish to develop numerical schemes that have an analogue of this property that vanishing divergence implies steady vorticity. This will be achieved by ensuring that the divergence that appears in the discrete vorticity equation is consistent with the divergence that appears in the discrete mass equation. Now consider a C-grid discretization of (1) and (2). Fig. <ref type="figure">1</ref> shows part of a polygonal grid. The cells, vertices and edges are numbered arbitrarily; this numbering will be used to give concrete examples illustrating the general formulas derived below. The geometrical quantities needed to define a C-grid scheme and for the derivation below are shown in Fig. <ref type="figure" target="#fig_9">2</ref>. These are l e the length of primal edge e; d e the length of dual edge e; A i the area of primal cell i, and A ðvÞ v the area of dual cell v. (For this last quantity, the superscript label (v) indicates that the area is associated with a vertex of the primal grid, while the subscript index v indicates which vertex.) The prognostic variables are the geopotential stored at cell centers (or, better, regarded as cell averages) U i , and the normal component of velocity stored at cell edges u e (Fig. <ref type="figure">3</ref>). In order to remove the ambiguity in the sign of u e we define a unit normal vector n e at each edge that points in the direction of positive u e (Fig. <ref type="figure" target="#fig_9">2</ref>). We also define an indicator function n e i : when edge e is an edge of cell i n e i ¼ 1 if n e is an outward normal of cell i and n e i ¼ À1 if n e is an inward normal of cell i. In the derivation that follows we will need some notation to describe the connectivity of the grid. The notation used is summarized in Table <ref type="table" target="#tab_0">1</ref>.</p><p>The discrete form of the mass equation is</p><formula xml:id="formula_4">@U i @t þ U 0 d i ¼ 0;<label>ð5Þ</label></formula><p>where d i , the discrete divergence in cell i, is defined in a natural way via the divergence theorem:</p><formula xml:id="formula_5">A i d i ¼ X e2ECðiÞ n e i l e u e :<label>ð6Þ</label></formula><p>The discrete momentum equation is</p><formula xml:id="formula_6">@u e @t þ fu ? e À 1 d e X i2CEðeÞ n e i U i ¼ 0;<label>ð7Þ</label></formula><p>where the discrete gradient is given by a natural centered difference approximation. As usual on a C-grid, the awkward part of the discretization is how to approximate the Coriolis terms, since we require the velocity component u ? e in the direction Àk Â n e orthogonal to the normal component that naturally resides at edge e.</p><p>We assume that u ? e is given by some weighted combination of the normal velocities at the edges surrounding the two cells either side of edge e:</p><formula xml:id="formula_7">d e u ? e ¼ X e 0 2ECPðeÞ</formula><p>w e e 0 l e 0 u e0 : ð8Þ</p><p>Inspired by Arakawa and Lamb's scheme <ref type="bibr" target="#b1">[2]</ref> for a longitude-latitude grid, we include the length factors l e and d e in this formula in the expectation that this will lead to simplifications later. (We also anticipate that the extension to the full nonlinear case will work in terms of mass fluxes -Ringler et al., manuscript submitted to Journal of Computational Physics.) Our task now is to find suitable weights w e e 0 such that the Coriolis terms give no net source or sink of energy and geostrophic modes are stationary. It is physically reasonable to set w e e ¼ 0 for all e, so that u e does not contribute to u ? e . The requirement that the Coriolis terms be energy conserving also implies w e e ¼ 0 (see (39) below). We therefore build in this assumption from the start. For the grid shown in Figs. <ref type="figure">1</ref><ref type="figure" target="#fig_9">2</ref><ref type="figure">3</ref>, for example, u ?</p><p>1 is given by a weighted combination of u 2 ; u 3 ; u 9 ; u 8 ; u 10 ; u 11 , and u 12 . Now seek a discrete analogue of the vorticity equation. On a C-grid the relative vorticity n v is naturally defined at vertices via Stokes' theorem applied to a dual cell:</p><formula xml:id="formula_8">A ðvÞ v n v ¼ X e2EVðvÞ d e u e t e v :<label>ð9Þ</label></formula><p>Here we have introduced another indicator function t e v , which is equal to 1 when vertex v is at the left end of edge e (i.e. in the direction k Â n e ) and equal to À1 if vertex v is at the right end of edge e. This indicator function ensures that counterclockwise circulation about vertex v contributes positively to the vorticity at vertex v. For the grid shown in Figs. <ref type="figure">1</ref><ref type="figure" target="#fig_9">2</ref><ref type="figure">3</ref>, for example, t 1 1 ; t 9 1 and t 8 1 would all equal 1 because u 1 ; u 9 and u 8 all contribute positively to the circulation about vertex 1. This definition of n v depends on the orthogonality of primal and dual edges, since it requires the normal velocity at a primal edge to equal the tangential velocity at the corresponding dual edge.</p><p>Using the definitions ( <ref type="formula" target="#formula_8">9</ref>) and ( <ref type="formula">8</ref>) and the discrete momentum equation ( <ref type="formula" target="#formula_6">7</ref>), the vorticity tendency is given by</p><formula xml:id="formula_9">A ðvÞ v @n v @t ¼ X e2EVðvÞ d e @u e @t t e v ¼ À X e2EVðvÞ fd e u ? e t e v þ X e2EVðvÞ t e v X i2CEðeÞ n e i U i ¼ Àf X e2EVðvÞ X e 0 2ECPðeÞ</formula><p>w e e 0 l e 0 u e 0 t e v : ð10Þ</p><p>(It may be verified that each U i that appears does so twice, once with a plus sign and once with a minus sign. Thus all contributions involving U cancel, giving a discrete analog of the identity r Â rU 0.) If we demand that a discrete analogue of (3) should hold then the right hand side of (10) should equal </p><p>for some discrete analogue of the divergence d ðvÞ v at vertex v.</p><p>In order for geostrophic modes to be stationary the vertex divergence d ðvÞ v must vanish whenever the cell divergence d i vanishes for all cells i. A natural way to impose this requirement is to demand that d ðvÞ v be given by a remapping of d i :</p><formula xml:id="formula_11">A ðvÞ v d ðvÞ v ¼ X i2CVðvÞ R i v A i d i<label>ð12Þ</label></formula><p>for some weights R i v . These weights may be thought of as residing at cell corners (Fig. <ref type="figure" target="#fig_1">4</ref>). We have some freedom in the choice of weights, but they must satisfy</p><formula xml:id="formula_12">X v2VCðiÞ R i v ¼ 1<label>ð13Þ</label></formula><p>in order to preserve the global integral of divergence: <ref type="formula" target="#formula_5">6</ref>) in ( <ref type="formula" target="#formula_11">12</ref>) and combining with <ref type="bibr" target="#b9">(10)</ref> and <ref type="bibr" target="#b10">(11)</ref> gives</p><formula xml:id="formula_13">P v A ðvÞ v d ðvÞ v ¼ P i A i d i . Substituting (</formula><formula xml:id="formula_14">X i2CVðvÞ R i v X e2ECðiÞ n e i l e u e ¼ X e2EVðvÞ X e 0 2ECPðeÞ</formula><p>w e e0 l e 0 u e 0 t e v : ð14Þ</p><p>We require this to hold for arbitrary values of the cell edge normal velocities. First consider an edge e 0 and a vertex v of cell i such that vertex v is not at one end of edge e 0 (for example, edge e 0 ¼ 1 and vertex v ¼ 8 of cell i ¼ 3 in Figs. <ref type="figure">1</ref><ref type="figure" target="#fig_9">2</ref><ref type="figure">3</ref><ref type="figure" target="#fig_1">4</ref>). The contribution to the left hand side of ( <ref type="formula">14</ref>) involving velocity u e 0 is R iv n e 0 i l e 0 u e 0 ; ð15Þ while the contribution to the right hand side is X e2EVCðv;iÞ w e e 0 l e 0 u e 0 t e v : ð16Þ (In our example EVCð8; 3Þ is the edge pair {8, 10}. Edge 1 contributes to the vorticity tendency at vertex 8 through its contribution to u ? 8 and u ? 10 , while it contributes to the divergence at vertex 8 through R 3 8 times its contribution to the divergence in cell 3.) Equating the contributions ( <ref type="formula">15</ref>) and ( <ref type="formula">16</ref>) gives</p><formula xml:id="formula_15">X e2EVCðv;iÞ w e e 0 t e v ¼ R i v n e 0 i :<label>ð17Þ</label></formula><p>Now consider an edge e 0 and a vertex v that is at one end of edge e 0 (for example, edge e 0 ¼ 1 and vertex v ¼ 1 in Figs. <ref type="figure">1</ref><ref type="figure" target="#fig_9">2</ref><ref type="figure">3</ref><ref type="figure" target="#fig_1">4</ref>).</p><p>The contribution to the left hand side of ( <ref type="formula">14</ref>) involving velocity u e 0 is</p><formula xml:id="formula_16">X i2CEðe 0 Þ R i v n e 0 i l e 0 u e 0 ;<label>ð18Þ</label></formula><p>while the contribution to the right hand side is  w e e 0 l e 0 u e 0 t e v : ð19Þ (In our example EVEð1; 1Þ is the edge pair {8, 9}. Edge 1 contributes to the vorticity tendency at vertex 1 through its contribution to u ? 8 and u ? 9 while it contributes to the divergence at vertex 1 through R 3 1 times its contribution to the divergence in cell 3 and R 1 1 times its contribution to the divergence in cell 1.) Equating the contributions ( <ref type="formula" target="#formula_16">18</ref>) and <ref type="bibr" target="#b18">(19)</ref> gives</p><formula xml:id="formula_17">R 31 R 21 R 11 R 28 R 27 R 25 R 24 R 38 R 39 R 32 R 3 10 R 14 R 13 R 12</formula><formula xml:id="formula_18">X e2EVEðv;e 0 Þ w e e 0 t e v ¼ X i2CEðe 0 Þ R i v n e 0 i :<label>ð20Þ</label></formula><p>For any given e 0 , the Eqs. ( <ref type="formula" target="#formula_15">17</ref>) and (20) constitute a system of linear simultaneous equations for the weights w e e 0 given the R i v .</p><p>The linear system contains a single equation for each vertex v associated with the cells on either side of edge e 0 . In our example, the edge e 0 ¼ 1 gives rise to 7 equations for 7 unknowns:</p><formula xml:id="formula_19">w 8 1 þ w 9 1 ¼ ÀR 1 1 þ R 3 1 ; Àw 10 1 À w 8 1 ¼ R 3 8 ; w 11 1 þ w 10 1 ¼ R 3 9 ; Àw 12 1 À w 11 1 ¼ R 3 10 ; Àw 2 1 þ w 12 1 ¼ R 3 2 À R 1 2 ; w 3 1 þ w 2 1 ¼ ÀR 1 3 ; Àw 9 1 À w 3 1 ¼ ÀR 1 4 :<label>ð21Þ</label></formula><p>For the general case, let us write the linear system compactly as</p><formula xml:id="formula_20">Aw ¼ R;<label>ð22Þ</label></formula><p>where w is the vector of unknown weights, R is the vector of right hand sides, and A is the coefficient matrix. In fact this system of equations is singular. If we add together all the equations in the system for a given e 0 we find that each w e e 0 appears exactly twice, once with t e v ¼ 1 and once with t e v ¼ À1 so that the total left hand side vanishes, i.e.</p><formula xml:id="formula_21">c T A ¼ 0;<label>ð23Þ</label></formula><p>where c is a column vector whose elements are all equal to 1. Therefore, the system can have a solution only if a certain solvability condition is satisfied. The solvability condition is obtained by taking c T times <ref type="bibr" target="#b21">(22)</ref>, implying c T R ¼ 0, in other words the sum of all the right hand sides should also equal zero:</p><formula xml:id="formula_22">X i2CEðe 0 Þ X v2VCðiÞ R i v n e 0 i ¼ 0:<label>ð24Þ</label></formula><p>Using <ref type="bibr" target="#b12">(13)</ref>, this reduces to</p><formula xml:id="formula_23">X i2CEðe 0 Þ n e 0 i ¼ 0;<label>ð25Þ</label></formula><p>which is indeed satisfied. The singular nature of the linear system, and the fact that the solvability condition is satisfied, are easily verified for the example (21) by adding the component equations.</p><p>Because the solvability condition is satisfied, the linear system not only has a solution, but has a non-unique solution; because A is singular there exists a w satisfying A w ¼ 0, and we may add any multiple of w to a solution w of ( <ref type="formula" target="#formula_20">22</ref>) to obtain another solution.</p><p>This non-uniqueness means we have the freedom to introduce one further constraint into each system of linear equations. We will choose a constraint that causes the system of linear equations for a given e 0 to split into two independent subsystems, with the property that each subsystem involves w's and R's from only one of the cells either side of edge e 0 . This splitting is essential to allow an energy conserving scheme to be found. To split the system, replace <ref type="bibr" target="#b19">(20)</ref> by two equations of the form w e e 0 t e v ¼ ðR i v À a e 0 i v Þn e 0 i ; ð26Þ one equation for each cell i either side of edge e 0 . In each case the relevant e is defined by the fact that e 0 and e are edges of cell i that meet at vertex v. The a e 0 i v are some constants that are to be determined, subject to some constraints discussed below; for each linear system four a's appear, two in each subsystem. For example, the system (21) splits into the two subsystems</p><formula xml:id="formula_24">w 8 1 ¼ R 3 1 þ a 1 1 3 ; Àw 10 1 À w 8 1 ¼ R 3 8 ; w 11 1 þ w 10 1 ¼ R 3 9 ; Àw 12 1 À w 11 1 ¼ R 3 10 ; w 12 1 ¼ R 3 2 À a 1 2 3 ;<label>ð27Þ</label></formula><p>involving edges and R's only from cell 3, and</p><formula xml:id="formula_25">Àw 2 1 ¼ ÀR 1 2 þ a 1 2 1 ; w 3 1 þ w 2 1 ¼ ÀR 1 3 ; Àw 9 1 À w 3 1 ¼ ÀR 1 4 ; w 9 1 ¼ ÀR 1 1 À a 1 1 1 ;<label>ð28Þ</label></formula><p>involving edges and R's only from cell 1.</p><p>In order to recover <ref type="bibr" target="#b19">(20)</ref> from the components into which it has been split, we require</p><formula xml:id="formula_26">X i2CEðe 0 Þ a e 0 i v n e 0 i ¼ 0<label>ð29Þ</label></formula><p>for each e 0 and v 2 VEðe 0 Þ. Now we have one more equation than unknown in each subsystem: one equation for each vertex v of cell i, and one unknown w e e 0 for each edge e of cell i except for e ¼ e 0 . Thus each subsystem will have a solution only if it satisfies its own solvability condition. Again, the solvability condition is obtained by summing the individual equations in the subsystem to obtain</p><formula xml:id="formula_27">X v2VCðiÞ R i v À X v2VEðe 0 Þ a e 0 i v ¼ 0:<label>ð30Þ</label></formula><p>Using <ref type="bibr" target="#b12">(13)</ref>, this reduces to</p><formula xml:id="formula_28">X v2VEðe 0 Þ a e 0 i v ¼ 1:<label>ð31Þ</label></formula><p>Thus, the four a values associated with edge e 0 must be related to each other by ( <ref type="formula" target="#formula_26">29</ref>) and (31). The simplest choice that satisfies these constraints is to set</p><formula xml:id="formula_29">a e 0 i v ¼ 1=2<label>ð32Þ</label></formula><p>for all e 0 ; i 2 CEðe 0 Þ and v 2 VEðe 0 Þ. We will show in Section 3 that this choice also makes the scheme energy conserving, and, moreover, is the only such choice. This choice will be used in the examples discussed in Section 4.</p><p>For each edge e 0 , Eqs. ( <ref type="formula" target="#formula_15">17</ref>) and ( <ref type="formula">26</ref>) now form a closed linear subsystem for the w e e 0 with e 2 ECðiÞ that has a unique solution. In fact the solution for w e e 0 may be found explicitly by summing <ref type="bibr" target="#b16">(17)</ref> and <ref type="bibr" target="#b25">(26)</ref> over the vertices between edge e 0 and edge e:</p><p>w e e 0 t e v 2 ¼ X</p><formula xml:id="formula_30">v R i v À a e 0 i v 1 ! n e 0 i ¼ X v R i v À 1=2 ! n e 0 i ;<label>ð33Þ</label></formula><p>where the vertex v 1 is the first vertex encountered in traversing from edge e 0 to edge e, v 2 is the last vertex encountered, and, in the final expression, the a's have been set to 1/2. The sum may be taken either clockwise or counterclockwise around cell i;</p><p>the solvability condition (30) ensures that the same answer is obtained either way. For example, for the grid shown in Figs.</p><p>1-4, if we evaluate w 7 4 by summing counterclockwise around cell 2 we would take v 1 ¼ 5 and v 2 ¼ 7 to obtain</p><formula xml:id="formula_31">w 7 4 ¼ R 2 5 þ R 2 6 þ R 2 7 À 1=2:<label>ð34Þ</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Energy conservation</head><p>For the continuous equations (2) the Coriolis force does no work and therefore makes no net contribution to the energy budget. It is highly desirable that a numerical scheme should have an analogous property.</p><p>We may form a discrete kinetic energy equation for the linearized system by taking A ðeÞ e u e times <ref type="bibr" target="#b6">(7)</ref> and summing over edges. Here, the superscript ðeÞ indicates that the area A ðeÞ e is associated with an edge, while the subscript index e identifies which edge (Fig. <ref type="figure">5</ref>). The contribution from the Coriolis terms will vanish provided w e e 0 l e 0 u e 0 ¼ 0; ð36Þ</p><p>where the sums over e are over all edges on the grid.</p><p>The contribution involving u e u e 0 will vanish provided </p><p>In planar geometry the orthogonality of primal and dual edges implies A ðeÞ e ¼ l e d e =2. In curved geometry we can used this relation to define A ðeÞ e , making a very good approximation to the actual kite-shaped area associated with edge e. 1 Assuming this choice, energy conservation by the Coriolis terms then requires w e e 0 þ w e 0 e ¼ 0: ð39Þ</p><p>Using the explicit expression (33) for the weights derived in Section 2, we find</p><formula xml:id="formula_33">w e e 0 þ w e 0 e ¼ X v R i v À a e 0 i v 1 ! n e 0 i t e v 2 þ X v R i v À a e i v 2</formula><p>! n e i t e 0 v 1 : ð40Þ</p><p>It may easily be verified that n e 0 i t e v 2 þ n e i t e 0 v 1 must always vanish. Therefore the Coriolis terms will be energy conserving provided</p><formula xml:id="formula_34">a e 0 i v 1 ¼ a e i v 2 :<label>ð41Þ</label></formula><p>The choice a e i v ¼ 1=2 for all e, i and v, certainly satisfies this constraint as well as the constraints (29) and (31) of Section 2.</p><p>In fact it can be shown that for any grid a e i v ¼ 1=2 for all e, i and v is the only such choice. Application of the constraint (41) for different edges and vertices of any cell i leads to the conclusion that all a's associated with cell i must take the same value. The constraint (31) then implies that that value must equal 1/2.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Examples</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.">Planar square grid</head><p>The simplest possible C-grid comprises a grid of square cells on a plane. Let the cell width be d, so that l e ¼ d and d e ¼ d for all edges e. The simplest and most symmetrical choice is to set R i v ¼ 1=4 for the four vertices v of each cell i, so that each cell contributes one quarter of its divergence to each of its four vertices. To be concrete, consider the cell, edge and vertex numbering shown in Fig. <ref type="figure" target="#fig_7">6</ref>. Taking e 0 ¼ 1, formula (33) gives for the contributions of u 1 to u ? 2 , u ? 3 , and u ? 4 , with similar expressions for the other weights relating the edges of cell 1. In terms of the more familiar notation where u signifies the eastward velocity component and v the northward component, we obtain the most obvious discretization, in which v at a u point is given by the average (with weights 1/4) of the nearest four v values and u at a v point is given by the average of the nearest four u values. It is well known that the f-plane dispersion relation for this discretization does have x ¼ 0 as a root, confirming that its geostrophic modes are indeed stationary.</p><formula xml:id="formula_35">Àw 2 1 ¼ R 1 1 À 1=2 ¼ À1=4; w 3 1 ¼ R 1 1 þ R 1 2 À 1=2 ¼ 0; w 4 1 ¼ R 1 1 þ R 1 2 þ R 1 4 À 1=2 ¼ 1=4;<label>ð42Þ</label></formula><p>As an aside, we note that a higher order discretization of the Coriolis terms has been proposed by Dobricic <ref type="bibr" target="#b7">[8]</ref>. Although the Dobricic scheme does not fit within the framework permitted by our analysis, because it uses a larger stencil, it does give stationary geostrophic modes on a square planar grid. However, as is evident from <ref type="bibr" target="#b26">[27]</ref> and Example 4.3 below, care will be needed when extending that scheme to a longitude-latitude grid in spherical geometry.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2.">Planar regular hexagonal grid</head><p>Now consider a perfectly regular hexagonal C-grid in planar geometry, with numbering as in Fig. <ref type="figure" target="#fig_6">7</ref>. Let the distance between neighboring cell centers be d, so that l e ¼ d= ffiffiffi 3 p and d e ¼ d for every edge e. The simplest and most symmetrical choice is to set R i v ¼ 1=6 for the six vertices v of every cell i, so that each cell shares its divergence equally among its six vertices.</p><p>Using the numbering in Fig. <ref type="figure" target="#fig_6">7</ref>, Eq. (33) then gives</p><formula xml:id="formula_36">w 2 1 ¼ R 1 1 À 1=2 ¼ À1=3; Àw 3 1 ¼ R 1 1 þ R 1 2 À 1=2 ¼ À1=6; w 4 1 ¼ R 1 1 þ R 1 2 þ R 1 4 À 1=2 ¼ 0; À w 5 1 ¼ R 1 1 þ R 1 2 þ R 1 4 þ R 1 5 À 1=2 ¼ 1=6; w 6 1 ¼ R 1 1 þ R 1 2 þ R 1 4 þ R 1 5 þ R 1 6 À 1=2 ¼ 1=3;<label>ð43Þ</label></formula><p>for the contributions of u 1 to u ? 2 ; u ? 3 ; u ? 4 ; u ? 5 , and u ? 6 , with similar expressions for the other weights relating the edges of cell 1. Taking into account the weighting by d e and l e 0 in (8), it may be verified that these weights agree with those given by <ref type="bibr" target="#b25">[26]</ref> and by Klemp and Skamarock (unpublished report). Those authors confirmed that these weights do indeed give stationary geostrophic modes on the f-plane.  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3.">Longitude-latitude grid on the f-sphere</head><p>The derivation presented here is motivated by the need for discretizations in spherical geometry. However, allowing f to vary with latitude would provide a propagation mechanism for Rossby waves, obscuring the issue of whether the slow modes are accurately represented. We therefore introduce the idea of the ''f-sphere": the geometry is spherical, but the Coriolis parameter is set to a constant. This allows us to capture the effects of the spherical geometry on the grid structure, but within a system that still supports stationary geostrophic modes, as we show next.</p><p>To find the dispersion relation for the continuous linearized shallow water equations on the f-sphere, first form the vorticity and divergence equations by taking k Á rÂ(2) and rÁ (2):</p><formula xml:id="formula_37">@n @t þ f d ¼ 0;<label>ð44Þ</label></formula><formula xml:id="formula_38">@d @t À f n þ r 2 U ¼ 0:<label>ð45Þ</label></formula><p>Now eliminate n and d using the mass continuity equation ( <ref type="formula" target="#formula_0">1</ref>) to obtain</p><formula xml:id="formula_39">@ 3 U @t 3 þ f 2 @U @t À U 0 r 2 @U @t ¼ 0:<label>ð46Þ</label></formula><p>This equation supports normal mode solutions with U proportional to the spherical harmonic Y n m ðk; sin /Þ, where k is longitude and / is latitude, with frequency x satisfying the dispersion relation</p><formula xml:id="formula_40">x x 2 À f 2 À nðn þ 1ÞU 0 =a 2 È É ¼ 0;<label>ð47Þ</label></formula><p>where a is the Earth's radius. Here n must be a natural number. For n ¼ 0 only the x ¼ 0 root is physically realizable, corresponding to the trivial geostrophic mode U ¼ const, n ¼ d ¼ 0. For n &gt; 0 there are linearly independent spherical harmonics for integer m 2 fÀn; . . . ; 0; . . . ; ng, and for each such m all three roots of (47) are realizable; the x ¼ 0 root corresponds to a geostrophic mode and the non-zero roots to inertio-gravity modes. Now consider a C-grid discretization on a longitude-latitude grid with uniform longitude spacing Dk and uniform latitude spacing D/. The lengths of the eastern and western cell edges and the distances between centers of neighboring cells at the same longitude are all equal to aD/. The lengths of the northern and southern cell edges and the distances between centres of neighboring cells at the same latitude are proportional to the cosine of the relevant latitude. If we assume that the nonzero R i v are all equal to 1/4, as on the planar square grid, then (33) leads to the following discretization of the component momentum equations:</p><formula xml:id="formula_41">@u @t À f 1 cos / v cos / / k þ 1 a cos / d k U ¼ 0;<label>ð48Þ</label></formula><formula xml:id="formula_42">@v @t þ f u k / þ 1 a d / U ¼ 0:<label>ð49Þ</label></formula><p>Here, u and v are the usual eastward and northward velocity components, d k and d / are the C-grid centered difference approximations to @=@k and @=@/, and an overline indicates an equally-weighted two-point average, with the superscript indicating the spatial direction of the average. Note how the cos / terms appear within the averages involved in the fv term. Direct numerical calculation of the normal modes for this scheme, following the method of <ref type="bibr" target="#b26">[27]</ref> but with f constant, confirms that the geostrophic modes are stationary. Interestingly, the more naive discretization that omits the cos / factors from the average of v is also found to support stationary geostrophic modes. However, as <ref type="bibr" target="#b26">[27]</ref> showed, when f takes its usual north-south variation proportional to sin /, inclusion of the cos / factors leads to good behavior of the entire Rossby mode spectrum, whereas omission of the cos / factors causes many Rossby modes to be badly misrepresented in terms of frequency and structure.</p><p>This result shows the importance of consistency of the mass and vorticity budgets, and hence the relevance of our derivation, even for non-constant f. It also shows that accurate representation of the Coriolis terms is non-trivial, and can have major consequences, even for what would appear to be the most straightforward case of a quadrilateral grid based on an orthogonal coordinate system. Thus, our derivation is also relevant to the Yin-Yang grid (e.g. <ref type="bibr" target="#b11">[12]</ref>) and the conformal cubed sphere grid (e.g. <ref type="bibr" target="#b16">[17]</ref>), among others.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.4.">Hexagonal-pentagonal geodesic grid on the f-sphere</head><p>On the hexagonal-pentagonal geodesic grid, the primal and dual edge lengths vary from edge to edge and so (33) does not reduce to any simpler formula. The weights w e e 0 must be calculated for each edge pair; they may either be tabulated or recalculated when needed.</p><p>To confirm the behaviour of the proposed scheme, we directly calculated the normal modes of the discretized shallow water equations on a hexagonal-pentagonal geodesic grid on the f-sphere. The grid comprised 642 cells and 1920 edges, giving 2562 degrees of freedom in total, with an average distance between cell centers of about 9:6 Â 10 5 m. The Coriolis terms were evaluated using ( <ref type="formula">8</ref>) and (33). Earth's radius was taken to be a = 6371220 m, the Coriolis parameter was set to f ¼ 1:4584 Â 10 À4 s À1 , and the mean geopotential was taken to be 10 5 m 2 s À2 , giving a Rossby radius of 2:1683 Â 10 6 m.</p><p>Of the 2562 normal modes found, 1280 are geostrophic modes and 1282 are inertio-gravity modes. These numbers are consistent with a slightly modified version of the argument given by <ref type="bibr" target="#b25">[26]</ref>, who claimed that the number of geostrophic modes should equal the number of vorticity degrees of freedom while the number of inertio-gravity modes should equal the number of mass plus divergence degrees of freedom. Vorticity is naturally evaluated at vertices, and the grid used has 1280 vertices. However, the global integral of vorticity is constrained to vanish, so in fact there are only 1279 vorticity degrees of freedom. Mass and divergence naturally reside in cells, but the global integral of divergence is constrained to vanish, so there are in fact 1283 mass plus divergence degrees of freedom. However, one of the mass degrees of freedom, U ¼ const, corresponds to the n ¼ 0 mode, which has x ¼ 0 and so is classed as a geostrophic mode rather than an inertio-gravity mode.</p><p>Hence there should be 1280 geostrophic modes and 1282 inertio-gravity modes, as found.</p><p>Fig. <ref type="figure" target="#fig_8">8</ref> shows the normal mode frequencies, sorted into geostrophic and inertio-gravity modes, and into ascending order within each of these categories. A similar number of frequencies given by (47) are also shown. Two points are noteworthy. First, all of the frequencies are real, implying that the scheme is stable; this is a consequence of energy conservation. Second, the geostrophic mode branch has frequencies exactly zero, as intended. The numerical inertio-gravity mode frequencies somewhat underestimate the exact frequencies for the fastest, smallest-scale modes, for which the finite-difference approximations to the gradient and divergence become less accurate. This is consistent with the results of <ref type="bibr" target="#b25">[26]</ref>; although not perfect, the inertio-gravity wave dispersion is far superior to that on an unstaggered grid.</p><p>For comparison, Fig. <ref type="figure">9</ref> shows the normal mode frequencies for an alternative scheme: only the four edges that meet edge e are used to approximate u ? e ; this scheme reduces to the scheme analysed by <ref type="bibr" target="#b15">[16]</ref> on a plane regular hexagonal grid. Again, all the frequencies are real. However, the geostrophic modes have non-zero frequencies, with the largest being of a size comparable to f.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.5.">Triangular geodesic grid on the f-sphere</head><p>There is current research interest in the possible use of the version of the geodesic C-grid that uses triangular primal cells; it is therefore worth confirming the behavior of the proposed scheme for this grid too. The calculation of Section 4.4 was repeated for the triangular version of the grid. The grid now comprised 1280 triangular cells and 1920 edges, giving 3200 degrees of freedom in total, with an average distance between cell centers of about 5:6 Â 10 5 m. Again, the Coriolis terms were evaluated using ( <ref type="formula">8</ref>) and (33). The other problem parameters were the same as in Section 4.4.</p><p>Of the 3200 normal modes found, 642 are geostrophic modes and 2558 are inertio-gravity modes, consistent with the numbers of vorticity, mass and divergence degrees of freedom on this grid. Fig. <ref type="figure" target="#fig_11">10</ref> shows the normal mode frequencies, and confirms that the geostrophic mode frequencies are exactly zero, as intended. For comparison, Fig. <ref type="figure">11</ref> shows the results of a similar calculation using a different but plausible method of constructing the tangential velocity components based on computing the angles between adjacent edges and projecting the normal velocity component at a given edge onto the tangential direction of each neighboring edge. The accuracy of the inertio-gravity wave frequencies is comparable to that seen in Fig. <ref type="figure" target="#fig_11">10</ref>, but the geostrophic mode frequencies are not exactly zero.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.6.">Computational modes</head><p>An important issue for atmosphere and ocean models, particularly in the balance-dominated flow regime, is whether the numerical solution method supports computational modes that fail to propagate or that propagate in an unphysical way. An advantage of the C-grid is that it does not support wave modes that spuriously fail to propagate; this result is well known for grids of orthogonal quadrilaterals (e.g. <ref type="bibr" target="#b1">[2,</ref><ref type="bibr" target="#b17">18]</ref>), has been shown theoretically for regular hexagons on the plane <ref type="bibr" target="#b25">[26]</ref>, and is confirmed numerically for hexagonal and triangular geodesic grids by experiments like those described above but where f is allowed to vary with latitude.</p><p>Nevertheless, the C-grid may support wave modes that propagate in an unphysical way. The numbers and types of such modes depend on the grid structure, and are related to the numbers of vorticity, mass, and divergence degrees of freedom on the grid, as discussed above.  Mode index Frequency Fig. <ref type="figure">9</ref>. Normal mode frequencies on the f-sphere. The upper panel is like the upper panel in Fig. <ref type="figure" target="#fig_8">8</ref> but for a scheme that reduces to the scheme used by <ref type="bibr" target="#b15">[16]</ref> on a plane regular hexagonal grid. The lower panel shows the same data but with a much expanded frequency scale to make clear the non-zero frequencies of the geostrophic modes.</p><p>A hexagonal C-grid, for example, has roughly twice as many Rossby modes as might be expected for a given resolution. For the case of regular hexagons on a plane, which can be analysed theoretically <ref type="bibr" target="#b25">[26]</ref>, the shallow water dispersion relation is found to be a quartic expression in frequency, with two branches corresponding to Rossby modes (rather than one branch of a cubic dispersion relation, as in the continuous case). For constant f, provided the tangential velocity appearing in the Coriolis terms is correctly constructed, the Rossby modes in the extra branch are stationary, as they should be. However, when f varies with latitude the extra Rossby modes propagate unphysically: their frequency is extremely small and of the wrong sign, and is strongly sensitive to the details of the discretization <ref type="bibr" target="#b25">[26]</ref>. The extra Rossby modes are visible in Figs. <ref type="figure" target="#fig_8">8</ref> and<ref type="figure">9</ref>, though in these numerical calculations there is no simple way to distinguish which of the two branches a given mode belongs to.</p><p>A triangular C-grid, on the other hand, has roughly twice as many inertio-gravity modes as might be expected for a given resolution. For equilateral triangles on a plane the dispersion relation is a quintic in frequency, with four branches corresponding to inertio-gravity modes (rather than two branches of a cubic in the continuous case). These extra inertio-gravity modes are visible in Figs. <ref type="figure" target="#fig_11">10</ref> and<ref type="figure">11</ref>. There is a distinct change in slope of the numerical dispersion relation around mode index ±640 at the transition between the inertio-gravity mode branches.</p><p>The question here, then, is what effect, if any, does the construction ( <ref type="formula">8</ref>) and (33) have on the presence of computational modes. The construction does not change the numbers of modes of different types; in particular, it does not introduce any new computational modes or affect the presence or otherwise of extra branches to the dispersion relation. The construction is also found to have negligible effect on inertio-gravity mode frequencies (see Figs. 8-11 and also <ref type="bibr" target="#b25">[26]</ref>). In the constant f case the construction has a clear benefit of eliminating spuriously fast propagation of Rossby modes (and this applies to both branches on the hexagonal and hexagonal-geodesic grids). However, in the variable f case, it does not eliminate the unphysical slow, backward propagation of the extra Rossby mode branch on the hexagonal and hexagonalgeodesic grids.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Discussion and conclusions</head><p>We have shown how to construct a discretization of the Coriolis terms for the linearized shallow water equations on C-grids with a wide variety of possible grid structures so as to ensure that geostrophic modes are stationary in the case of constant Coriolis parameter f. Stationarity of geostrophic modes for constant f is a pre-requisite for good Rossby mode behaviour when f varies. The proposed scheme also ensures that the Coriolis terms introduce no spurious source or sink of energy.</p><p>The tangential velocity at a cell edge is expressed as a weighted sum of the known normal velocities at a set of nearby edges, with the required weights given explicitly by (33). Assuming that the grid geometry is completely given in terms of the lengths l e and d e and areas A i , A ðvÞ v , the scheme still allows some freedom in the choice of the weights R i v relating the cell divergence to the vertex divergence. This freedom may be used to optimize the overall accuracy of the scheme, for example.</p><p>When the scheme is extended to the case of variable f, some new freedom arises in exactly how the factors of f are handled: for example, velocity components may be multiplied by f before taking the weighted sum <ref type="bibr" target="#b7">(8)</ref>, after taking the weighted sum, or as some linear combination of these alternatives. The requirement for energy conservation, however, does constrain the options (Ringler et al., manuscript submitted to Journal of Computational Physics). The accuracy with which Rossby mode propagation is captured is sensitive to these details: the case of the longitude-latitude grid on the sphere is discussed by <ref type="bibr" target="#b24">[25]</ref> and the case of a perfectly regular hexagonal grid on a b-plane is discussed by <ref type="bibr" target="#b25">[26]</ref>.</p><p>In a companion paper (Ringler et al., manuscript submitted to Journal of Computational Physics) we discuss the extension of this scheme to the nonlinear case with variable f. We obtain a scheme that is energy conserving in the fully nonlinear case, and retains stationary geostrophic modes in the linear constant f limit. Mode index Frequency Fig. <ref type="figure">11</ref>. Normal mode frequencies on the f-sphere. The upper panel is like the upper panel in Fig. <ref type="figure" target="#fig_11">10</ref> but for a scheme that constructs edge tangential velocities by projection of nearby normal velocities. The lower panel shows the same data but with a much expanded frequency scale to make clear the nonzero frequencies of the geostrophic modes.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 . 1 Fig. 2 . 1 Fig. 3 .</head><label>11213</label><figDesc>Fig. 1. Schematic showing part of an arbitrary polygonal grid. Cells, edges and vertices are each numbered with unique but otherwise arbitrary indices; this numbering will be used to give concrete examples illustrating more general formulas.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 4 .</head><label>4</label><figDesc>Fig.<ref type="bibr" target="#b3">4</ref>. Schematic showing the locations of the weights R i v that define the vertex divergence in terms of the cell divergence.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>X</head><label></label><figDesc>e2EVEðv;e 0 Þ</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 5 . 2 e 2 e</head><label>522</label><figDesc>Fig. 5. Schematic showing the areas A ðeÞ 1 ; A ðeÞ 9 , and A ðeÞ 8 associated with edges 1, 9, and 8. The area associated with edge 1 comprises the two triangles either side of edge 1.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig. 7 .</head><label>7</label><figDesc>Fig.7. Schematic showing the cell, edge and vertex numbering, and unit normal vectors at cell edges, for part of a regular hexagonal grid.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig. 6 .</head><label>6</label><figDesc>Fig.6. Schematic showing the cell, edge and vertex numbering, and unit normal vectors at cell edges, for part of a square grid.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig. 8 .</head><label>8</label><figDesc>Fig.8. Normal mode frequencies on the f-sphere. The upper panel shows the full spectrum of frequencies resolved on a hexagonal geodesic grid with 2562 degrees of freedom using the proposed scheme to compute the Coriolis terms (continuous curves) along with the exact normal mode frequencies given by (47) for n 6 25 (dashed curves). The lower panel shows a subset of frequencies with smallest indices: circles and diamonds indicate exact normal mode frequencies; plus and cross symbols indicate numerical normal mode frequencies.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>2</head><label>2</label><figDesc></figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Fig. 10 .</head><label>10</label><figDesc>Fig.10. Normal mode frequencies on the f-sphere. The upper panel shows the full spectrum of frequencies resolved on a triangular geodesic grid with 3200 degrees of freedom using the proposed scheme to compute the Coriolis terms (continuous curves) along with the exact normal mode frequencies given by (47) for n 6 25 (dashed curves). The lower panel shows a subset of frequencies with smallest indices: circles and diamonds indicate exact normal mode frequencies; plus and cross symbols indicate numerical normal mode frequencies.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1</head><label>1</label><figDesc>Summary of notation used to describe the grid connectivity.</figDesc><table><row><cell>Edges of cell i</cell></row></table><note><p>CVðvÞ Vertices of cell i VCðiÞ Vertices at the ends of edge e VEðeÞ Edges of a cell pair meeting at edge e ECPðeÞ ¼ [ i2CEðeÞ ECðiÞ Edge pair meeting at a vertex v of cell i EVCðv; iÞ Edges meeting at vertex v that each share a cell with edge e EVEðv; eÞ ÀfA ðvÞ v d ðvÞ v</p></note></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_0"><p>J. Thuburn et al. / Journal of Computational Physics 228 (2009) 8321-8335</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_1"><p>J. Thuburn et al. / Journal of Computational Physics 228 (2009) 8321-8335</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2" xml:id="foot_2"><p>Incidentally, exactly the same discussion would apply to a ''C-grid" vorticity-divergence formulation, in which the prognostic variables are mass and divergence in primal cells and vorticity in dual cells. This formulation would be equivalent, through<ref type="bibr" target="#b5">(6)</ref> and (9), to the standard velocity C-grid formulation discussed in this paper.</p></note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgment</head><p>This paper is Los Alamos report number LA-UR 09-03238.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Computational design of the basic dynamical processes of the UCLA general circulation model</title>
		<author>
			<persName><forename type="first">A</forename><surname>Arakawa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">R</forename><surname>Lamb</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Methods in Computational Physics</title>
		<editor>
			<persName><forename type="first">J</forename><surname>Chang</surname></persName>
		</editor>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="173" to="265" />
			<date type="published" when="1977">1977</date>
			<publisher>Academic Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">A potential enstrophy and energy conserving scheme for the shallow-water equations</title>
		<author>
			<persName><forename type="first">A</forename><surname>Arakawa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">R</forename><surname>Lamb</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mon. Weather Rev</title>
		<imprint>
			<biblScope unit="volume">109</biblScope>
			<biblScope unit="page" from="18" to="36" />
			<date type="published" when="1981">1981</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">On the construction of the Voronoi mesh on a sphere</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Augenbaum</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">S</forename><surname>Peskin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Phys</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page" from="177" to="192" />
			<date type="published" when="1985">1985</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Analysis of discrete shallow water models on geodesic delaunay grids with C-type staggering</title>
		<author>
			<persName><forename type="first">L</forename><surname>Bonaventura</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Ringler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mon. Weather Rev</title>
		<imprint>
			<biblScope unit="volume">133</biblScope>
			<biblScope unit="page" from="2351" to="2373" />
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">An unstructured grid, three-dimensional model based on the shallow water equations</title>
		<author>
			<persName><forename type="first">V</forename><surname>Casulli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">A</forename><surname>Walters</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Int. J. Numer. Methods Fluids</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="331" to="348" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Semi-implicit numerical modeling of nonhydrostatic free-surface flows for environmental problems</title>
		<author>
			<persName><forename type="first">V</forename><surname>Casulli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Zanolli</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Math. Comput. Modell</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page" from="1131" to="1149" />
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Integration of the primitive equations on a sphere using the finite element method</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">J P</forename><surname>Cullen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Quart. J. Roy. Meteorol. Soc</title>
		<imprint>
			<biblScope unit="volume">100</biblScope>
			<biblScope unit="page" from="555" to="562" />
			<date type="published" when="1974">1974</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">An improved calculation of Coriolis terms on the C grid</title>
		<author>
			<persName><forename type="first">S</forename><surname>Dobricic</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mon. Weather Rev</title>
		<imprint>
			<biblScope unit="volume">134</biblScope>
			<biblScope unit="page" from="3764" to="3773" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Computational dispersion properties of 3D staggered grids for a nonhydrostatic anelastic system</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">S</forename><surname>Fox-Rabinovitz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mon. Weather Rev</title>
		<imprint>
			<biblScope unit="volume">124</biblScope>
			<biblScope unit="page" from="498" to="510" />
			<date type="published" when="1996">1996</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Lagrange-Galerkin methods on spherical geodesic grids: the shallow-water equations</title>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">X</forename><surname>Giraldo</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Phys</title>
		<imprint>
			<biblScope unit="volume">160</biblScope>
			<biblScope unit="page" from="336" to="368" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Numerical integration of the shallow-water equations on a twisted icosahedral grid. Part I: basic design and results of tests</title>
		<author>
			<persName><forename type="first">R</forename><surname>Heikes</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Randall</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mon. Weather Rev</title>
		<imprint>
			<biblScope unit="volume">123</biblScope>
			<biblScope unit="page" from="1862" to="1887" />
			<date type="published" when="1995">1995</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Yin-Yang grid: an overset grid in spherical geometry</title>
		<author>
			<persName><forename type="first">A</forename><surname>Kageyama</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Sato</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Geochem. Geophys. Geosyst</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
	<note>Art. No. Q09005</note>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<title level="m" type="main">The operational global icosahedral-hexagonal grid-point model GME: description and high-resolution tests</title>
		<author>
			<persName><forename type="first">D</forename><surname>Majewski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Liermann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Prohl</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Ritter</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Buchhold</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Hanisch</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Paul</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Wergen</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002">2002</date>
			<biblScope unit="volume">130</biblScope>
			<biblScope unit="page" from="319" to="338" />
			<pubPlace>Mon</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<monogr>
		<title level="m" type="main">An integration scheme of the primitive equation model with an icosahedral-hexagonal grid system and its application to the shallow-water equations, in: Short-and Medium-Range Numerical Weather Prediction. Collection of Papers Presented at the WMO/IUGG NWP Symposium</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Masuda</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Ohnishi</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1986">August 4-8, 1986</date>
			<publisher>Japan Meteorological Society</publisher>
			<biblScope unit="page" from="317" to="326" />
			<pubPlace>Tokyo</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">A comparison of grid quality of optimized spherical hexagonal-pentagonal geodesic grids</title>
		<author>
			<persName><forename type="first">H</forename><surname>Miura</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Kimoto</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mon. Weather Rev</title>
		<imprint>
			<biblScope unit="volume">133</biblScope>
			<biblScope unit="page" from="2817" to="2833" />
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<monogr>
		<title level="m" type="main">Tosic ´, Geostrophic adjustment on hexagonal grids, Mon</title>
		<author>
			<persName><forename type="first">S</forename><surname>Nic ˇkovic</surname></persName>
		</author>
		<author>
			<persName><forename type="first">´</forename></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">B</forename><surname>Gavrilov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><forename type="middle">A</forename></persName>
		</author>
		<imprint>
			<date type="published" when="2002">2002</date>
			<biblScope unit="volume">130</biblScope>
			<biblScope unit="page" from="668" to="683" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">A global shallow-water model using an expanded spherical cube: gnomonic versus conformal coordinates</title>
		<author>
			<persName><forename type="first">M</forename><surname>Ranc ˇic ´</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">J</forename><surname>Purser</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Mesinger</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Quart. J. Roy. Meteorol. Soc</title>
		<imprint>
			<biblScope unit="volume">122</biblScope>
			<biblScope unit="page" from="959" to="982" />
			<date type="published" when="1996">1996</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<monogr>
		<title level="m" type="main">Geostrophic adjustment and the finite-difference shallow-water equations, Mon. Weather Rev</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Randall</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1994">1994</date>
			<biblScope unit="volume">122</biblScope>
			<biblScope unit="page" from="1371" to="1377" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Modeling the atmospheric general circulation using a spherical geodesic grid</title>
		<author>
			<persName><forename type="first">T</forename><surname>Ringler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Heikes</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Randall</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mon. Weather Rev</title>
		<imprint>
			<biblScope unit="volume">128</biblScope>
			<biblScope unit="page" from="2471" to="2490" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
		<title level="m" type="main">A potential enstrophy and energy conserving numerical scheme for solution of the shallow-water equations on a spherical geodesic grid</title>
		<author>
			<persName><forename type="first">T</forename><surname>Ringler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Randall</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002">2002</date>
			<biblScope unit="volume">130</biblScope>
			<biblScope unit="page" from="1397" to="1410" />
			<pubPlace>Mon</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Numerical integration of the primitive equations on a spherical grid with hexagonal cells</title>
		<author>
			<persName><forename type="first">R</forename><surname>Sadourny</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of WMO/IUGG NWP Symp., Japan Meteorological Agency</title>
		<meeting>WMO/IUGG NWP Symp., Japan Meteorological Agency<address><addrLine>Tokyo, Japan</addrLine></address></meeting>
		<imprint>
			<date type="published" when="1969">1969</date>
			<biblScope unit="page" from="45" to="52" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Nonhydrostatic Icosahedral Atmospheric Model (NICAM) for global cloud resolving simulations</title>
		<author>
			<persName><forename type="first">M</forename><surname>Satoh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Matsuno</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Tomita</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Nasuno</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Iga</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Miura</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Phys</title>
		<imprint>
			<biblScope unit="volume">227</biblScope>
			<biblScope unit="page" from="3486" to="3514" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">New icosahedral grid-point discretizations of the shallow water equations on the sphere</title>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">R</forename><surname>Stuhne</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">R</forename><surname>Peltier</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Phys</title>
		<imprint>
			<biblScope unit="volume">148</biblScope>
			<biblScope unit="page" from="23" to="58" />
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">A PV-based shallow water model on a hexagonal-icosahedral grid</title>
		<author>
			<persName><forename type="first">J</forename><surname>Thuburn</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mon. Weather Rev</title>
		<imprint>
			<biblScope unit="volume">125</biblScope>
			<biblScope unit="page" from="2328" to="2347" />
			<date type="published" when="1997">1997</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Rossby wave propagation on the C-grid</title>
		<author>
			<persName><forename type="first">J</forename><surname>Thuburn</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Atmos. Sci. Lett</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="page" from="37" to="42" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Numerical wave propagation on the hexagonal C-grid</title>
		<author>
			<persName><forename type="first">J</forename><surname>Thuburn</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Comput. Phys</title>
		<imprint>
			<biblScope unit="volume">227</biblScope>
			<biblScope unit="page" from="5836" to="5858" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Conservation and linear Rossby-mode dispersion on the spherical C-grid</title>
		<author>
			<persName><forename type="first">J</forename><surname>Thuburn</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Staniforth</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mon. Weather Rev</title>
		<imprint>
			<biblScope unit="volume">132</biblScope>
			<biblScope unit="page" from="641" to="653" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">Integration of the barotropic vorticity equation on a spherical geodesic grid</title>
		<author>
			<persName><forename type="first">D</forename><surname>Williamson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Tellus</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="624" to="653" />
			<date type="published" when="1968">1968</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
