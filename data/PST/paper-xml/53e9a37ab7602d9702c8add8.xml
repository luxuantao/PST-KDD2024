<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Measuring Round Trip Times to Determine the Distance between WLAN Nodes</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author role="corresp">
							<persName><forename type="first">André</forename><surname>Günther</surname></persName>
							<email>anguenther@gmx.de|hoene@ieee.org</email>
							<affiliation key="aff0">
								<orgName type="laboratory">Telecommunication Networks Group (TKN)</orgName>
								<orgName type="institution">TU-Berlin</orgName>
								<address>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Christian</forename><surname>Hoene</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Telecommunication Networks Group (TKN)</orgName>
								<orgName type="institution">TU-Berlin</orgName>
								<address>
									<country key="DE">Germany</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Measuring Round Trip Times to Determine the Distance between WLAN Nodes</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">6121BE7FD6879B8ED69FD2E980B344E6</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.3" ident="GROBID" when="2023-07-28T17:03+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>This publication explores the degree of accuracy to which the propagation delay of WLAN packets can be measured using today's commercial, inexpensive equipment. The aim is to determine the distance between two wireless nodes for location sensing applications. We conducted experiments in which we measured the time difference between sending a data packet and receiving the corresponding immediate acknowledgement. We found the propagation delays correlate closely with distance, having only a measurement error of a few meters. Furthermore, they are more precise than received signal strength indications. To overcome the low time resolution of the given hardware timers, various statistical methods are applied, developed and analyzed. For example, we take advantage of drifting clocks to determine propagation delays that are forty times smaller than the clocks' quantization resolution. Our approach also determines the frequency offset between remote and local crystal clocks. This work has been supported by the Deutsche Forschungsgemeinschaft (DFG). This publication is a condensed and enhanced version of <ref type="bibr" target="#b0">[1]</ref> </p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Introduction</head><p>Knowing the position of wireless nodes is required for location-aware services and applications. The position can be calculated using the distance between wireless nodes. Furthermore distance helps when deciding the time of handovers or finding the optimal routing path throughout an ad-hoc network.</p><p>In this paper we focus on locating techniques which use the intrinsic features of WIFI based wireless access. Usually, received signal strength indications are applied to identify the location of wireless nodes. We show that precise distance measurement based on round trip time measurements of WLAN packets is possible even with low-cost, commercial WLAN hardware. We developed the algorithms to determine the air propagation time indirectly and to improve the accuracy and resolution of the time measurements. We validated our approach with two independent experimental measurement campaigns and with an analytical explanation.</p><p>We utilize the following intrinsic feature of IEEE 802.11: Each unicast data packet is immediately acknowledged by its receiver (Fig. <ref type="figure">1</ref>). We took the time between starting the transmission of a data packet and receiving the corresponding immediate acknowledgement. We will refer to this as remote delay (d remote ). We also measured the duration of receiving one data packet and sending out the immediate acknowledgement. We will call this duration local delay (d local ). The overall propagation time is then estimated by subtracting the local from the remote delay. In order to overcome the problem of interrupt latencies and hence inaccuracies when measuring the duration of packet transmission in the operating system, we measured the time on the hardware layer -the WLAN card. Most WLAN solutions allow to record time stamps at a resolution of 1 µs. However, a packet travels a distance of 300 m in 1 µs, which usually exceeds the range of WLAN transmission. We increase the resolution by using multiple delay observations and applying statistical methods to enhance the accuracy. This paper is structured as follows: In Sect. 2 we refer to the state of the art. Then we explain our approaches to enhance the measurement resolution. In Sect. 4 we describe our experimental measurement campaigns. Finally, we briefly summarize the results and contributions of this paper.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Related Work</head><p>A couple of approaches to in-and outdoor location sensing techniques have been presented in <ref type="bibr" target="#b1">[2]</ref>. An essential part of location sensing algorithms is a method to determine the distance between two wireless nodes. In general, three methods have been considered. Firstly, in case of densely populated networks such as sensor networks <ref type="bibr" target="#b2">[3]</ref> the information about which nodes are within transmission range is used. Secondly, the received signal strength indication (RSSI) of data packets transmitted is considered. It decreases sharply in a non-linear fashion with distance, so that environment specific signal strength maps relating RSSI values to positions have to be created first. An example for RSSI application is the RADAR system <ref type="bibr" target="#b3">[4]</ref>, which has been one of the first approaches presenting an indoor positioning system based on WLAN components (overview in <ref type="bibr" target="#b0">[1]</ref>). Thirdly, the propagation time of radio signals can be used because in free air it linearly increases with distance. Such an approach is usually considered to be impossible without the help of special signal processing hardware <ref type="bibr" target="#b4">[5]</ref>.</p><p>The classic approach to the latter method of position location estimates the time of arrival (TOA) of pure radio signals (instead of WLAN packets). This is conducted by applying signal processing algorithms based on cross-correlation techniques <ref type="bibr" target="#b5">[6]</ref>. The TOA method suffers from multi-path conditions. This problem can be encountered with a wider frequency band, e.g. ultra-wide band.</p><p>TOA measurement is being employed both outdoors for GPS-positioning <ref type="bibr" target="#b6">[7]</ref> and indoors to find things and people marked by a tag <ref type="bibr" target="#b7">[8]</ref>. In the latter paper, the author gives an appraisal of the achievable accuracy when measuring the round trip TOA within the 2.44 GHz and 5.78 GHz bands. For a signal bandwidth of 40 MHz, the accuracy of 3.8 m can be an achievable resolution limit unless further signal processing techniques are applied. Those might enhance the resolution up to 1 m.</p><p>The only paper focussing on measuring pure packet propagation delays is <ref type="bibr" target="#b8">[9]</ref>. The objective is to determine the speed of light using the averaged measured round trip propagation delay of ping packets. The measurements were conducted in a wired Ethernet infrastructure. Estimating the propagation delay which ranges below the clock resolution was facilitated by employing the concept of noise-assisted sub-threshold signal detection. For measurements in an IEEE 802.11b wireless environment the round trip times were too variable and noisy to be used.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Approach</head><p>Inspired by the approach presented in <ref type="bibr" target="#b8">[9]</ref> we also use the mean round trip time delay of packets to determine the distance as given in <ref type="bibr" target="#b0">(1)</ref>. In order to keep the time measurements as unbiased as possible resulting in a high resolution, we try to preclude any disruption caused by operating system activities. To do so, we took the following action:</p><p>Firstly, we utilized the IEEE 802.11 data/acknowledgement sequence instead of the ICMP-Ping request/response packet sequence. As the ping response is generated by the operation system the time it takes is subject to a highly variable delay. In contrast, the immediate acknowledgements are handled by the hardware of the WLAN radio and hence highly predictable. As for our measurements we assumed the MAC processing time to be equal on both wireless nodes. Although the MAC processing time is standardized according to IEEE 802.11 we will prove that not all WLAN cards operate in compliance with the standard. In practice, the MAC processing time also depends on the chip set hardware and firmware of the actual WLAN cards in use. To account for this a model-specific absolute delay offset needs to be considered. Secondly, we do not measure the time stamps for packet arrival and transmission on the operating system layer, but on the WLAN card hardware layer. This features measuring conditions that are independent of variable interrupt latencies. In <ref type="bibr" target="#b9">[10]</ref> we showed that measuring the time of a packet's arrival in the operating system's kernel (e.g. during an interrupt) entails quite imprecise results due to falsification by the variable interrupt latency.</p><p>The resolution of these hardware time stamps, which are implemented in most current WLAN products, is 1 µs corresponding to 300 m. In terms of the achievable accuracy this discrete time resolution is not precise enough yet. The resolution increases when averaging numerous observations. In the following we consider three phenomena that help to achieve a higher resolution.</p><p>Gaussian noise: The presence of measurement noise is assumed. Noise can be caused by thermal noise in the received radio signal or by the presence of multipath environment. Also, the crystal clocks of the WLAN equipment are subject to a constant clock drift and variable clock noise. Thus, the delay values are not limited to only one value. (In Fig. <ref type="figure">2</ref> not only 323 µs can be observed but also other values). If one assumes a Gaussian noise distribution with a suitable strength, we can simply take the sample mean to enhance the resolution.</p><p>Stochastic Resonance: Instead of the explanation above the authors of <ref type="bibr" target="#b8">[9]</ref> suggested another statistic effect called stochastic resonance. The concept of stochastic resonance was originally introduced as an explanation for the periodically recurrent ice ages. In the last two decades, it has been applied to explain many physical phenomena <ref type="bibr" target="#b10">[11]</ref>. In the realm of signal detecting stochastic resonance allows for detecting signals below the resolution of the measuring units because the signal becomes detectable with the help of noise. Noise adds to the signal so that it eventually exceeds the threshold given by the resolution of the detecting device. Thus, the system is able to change its states. The state durations have random lengths, but the probability is high that one state remains the same in the next observation.</p><p>Beat Frequencies: In our experiments (Fig. <ref type="figure" target="#fig_2">4</ref>.3 in <ref type="bibr" target="#b0">[1]</ref>) it can be observed that the 323 and 324 values occur in blocks of regular patterns. But this effect cannot be explained with the effect of stochastic resonance. Another effect can also entail resolution enhancement even if measurement noise is missing: 'Relative clock drift' -both WLAN cards are driven by built-in crystal oscillators that have nearly the same frequency. Due to tolerances, there is a slight drift between both clocks which causes varying rounding errors.</p><p>Let us consider the impact of a discrete time resolution on the measurement error. Firstly, we construct a model of the experiment setups. Instead of using packets, we assume that a delta pulse is sent off from the local to the remote node. After the delta pulse's arrival another delta pulse is sent back to the local node representing an acknowledgement. The local node can only process the impulses only in discrete time steps t local ∈ N described with natural numbers. The same is also valid for the remote node. It only reacts in discrete time steps, which are t remote = δ + n where n ∈ N and phase offset of δ ∈ [0; 1[. We assume that the clocks work at the same speed but with a phase offset. Moreover, another assumption is that phase offset changes over time but not for the duration of a round trip. The transmission of a delta impulse from one node to the other takes the delay of d prop ∈ R + , which is equal to the propagation time.</p><p>Let us assume that a delta impulse is sent off from the local node at the time t out local . It arrives the remote node after a period of d prop . Due to the discrete MAC processing, the delta impulse is only identified at the next remote clock impulse, which is:</p><formula xml:id="formula_0">t in remote = t out local + d prop -δ + δ (2)</formula><p>Assuming a MAC processing duration equal to zero and t out remote = t in remote , the remote node immediately sends back a delta impulse representing the acknowledgement. It arrives at the local node after a period of d prop , but is again only recognized at the next local clock, which is</p><formula xml:id="formula_1">t in local = t out remote + d prop (3)</formula><p>Then, the observed round trip time rtt is (4).</p><formula xml:id="formula_2">rtt = t in local -t out local = t out local + d prop -δ + δ + d prop -t out local = d prop + δ + d prop -δ (4)</formula><p>Next, we assume that the phase changes from one to the next measurement. The change is constant and is repeated after each phase period starting at zero again.</p><p>In the following, we only consider one phase period and assume that round trip times are measured at all times. Thus, the number of observations is infinite. The mean rtt over all phase offsets is calculated as follows.</p><formula xml:id="formula_3">rtt = 1 0 rtt dδ = 1 0 d prop + δ + d prop -δ dδ = 2 • d prop + 1 (5)</formula><p>The variance of the quantization error is calculated as followed and is simplified to a cubic function of the fractional part of the round trip distance. Both the mean and variance are displayed in Fig. <ref type="figure">3</ref>.</p><formula xml:id="formula_4">σ 2 = 1 0 rtt -rtt 2 dδ = {2d prop } -{2d prop } 2 = 1 4 -{2d prop } -1 2 2<label>(6)</label></formula><p>The rtt function produces a pattern which is repeated every phase period. This reoccurrence introduces a frequency component to be present in the observations. If two clocks interfere, their phases are equal every beat period, which is the reciprocal of the beat frequency. The beat frequency is the difference of both frequencies of both interfering waves <ref type="bibr" target="#b6">( 7)</ref>.Thus, the impact of quantization errors causes a similar effect as the two interfering waves -namely a beat frequency. Limits and Verification: The accuracy of location and distance sensing algorithms have fundamental limits (refer to the citation in <ref type="bibr" target="#b0">[1]</ref>). For example, the analytic calculations above do not take into account the clock drift during one RTT observation. Assuming a frequency stability of ±25 ppm and a length of a transmission sequence of 60 µs and 320 µs, the maximal error could be up to 0.9 m and 4.8 m respectively. Furthermore, one should note that only in vacuum light travels at the speed of light c. In materials the propagation speed depends on the square root of the dielectric constant ε. For example, dry ferroconcrete has an ε of about 9 and electromagnetic waves traverse through ferroconcrete 3 times slower than in vacuum. Most other materials used in buildings have lower dielectric constants.</p><formula xml:id="formula_5">f beat = |f 1 -f 2 | (7)</formula><p>Another source of possible errors is due to non-line-of-sight conditions. This results in an overestimation of the distance between the two nodes <ref type="bibr" target="#b11">[12]</ref>. Multipath propagation might introduce measurement errors because the dominant path can vary depending on the current transmission conditions. Multi-path propagation is only present if reflections are given. Reflections can have large impact on signal strength but only a low one on propagation delay. Thus, in the presence of multi-path propagation or reflections, we assume time delay measurement as being more precise than those based on the RSSI.</p><p>In order to check these hypotheses and identify the real measurement resolution, we conducted experiments. The first measurement campaign was conducted to study the impact of slow-user motion on packet loss and delay as described in <ref type="bibr" target="#b9">[10]</ref>. At the same time, we also measured the impact of distance on the round trip times. One year later, we embarked on a second measurement campaign. We altered the radio modem technology, the location, the analysis software, and the staff. The consistence of both results proves the reliability and correctness of our approach.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Measurements: First and second campaign</head><p>Experimental setup: The measurement was conducted twice: First in a gymnasium <ref type="bibr" target="#b9">[10]</ref> and later in the in the countryside where one could expect the channel to be free of disturbing noise coming from other radiating devices. The data communication took place between the local and the remote node. ICMP ping packets were transmitted each 20 ms (A) respective 10 ms. The measurements of RTT were conducted for several distances: First covering the range from 5 to 40 m, later extend to the maximal transmission range of 100 m.</p><p>At each distance, we measured for about 15 minutes respective 4 minutes. One should note, that in this first campaign, the wireless LAN cards were situated close to the ground. Also, the directions of the antennas were selected at random and were not recorded. This is important to know as it explains some of the results presented later. In the second session the sender was placed on a plastic table, whereas the receiver was installed on top of a 1.5 m wood-metal ladder. This was to guarantee that a large percentage of the Fresnel-zone, an elliptic space around the direct line-of-sight between both nodes is free of any obstacles harming the transmission. This time, the antennas were directed toward each other.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Equipment:</head><p>The PCs were running a Suse 6.4 Linux system with a 2.4.17 kernel (A). D-Link cards featuring an Intersil's (now Conexant) Prism2 chipset were employed as a wireless interface. Packets were directly sniffed on the MAC layer by the measurement tool 'Snuffle'.</p><p>The second time, we used an access point (Netgear FWAG114) supporting 802.11b/g as remote node. The PCs were running under Linux, Suse 9.1, with a special 2.6 kernel. We used two different WLAN cards containing chip sets from Atheros and Conexant implementing IEEE 802.11 a,b and g. The Atheros cards (brand Netgear WAG-511, contained an AR5212 chip) are supported by the Madwifi device driver. We used the software version downloaded from the CVS server on the August 30 th , 2004. The Conexant cards (brand: Longshine LCS-8531G containing Prism-GT chipset with an ISL3890 as MAC-Controller) are controlled by the prism54.org device driver (date 28-06-2004, firmware 1.0.4.3.arm). During each measurement both the sender and monitor were equipped with cards of the same brand. To gather the packet traces, we used tcpdump and libpcap.</p><p>Configuration: WLAN networking technologies based on the IEEE 802.11 standards transmit data packets via air. To avoid potential packet delay effects, in the first experiments the maximal number of retransmissions (transmission type) was set to zero. The second measurements were conducted in seven different configurations to study the impact of the WLAN card, CPU clock and modulation type. We used the default configuration of WLAN cards and access point but changed the supported standard to 802.11g and set the modulation type to either 36 or 54 Mbit/s. The frame length of the data packets are 65 bytes and of the acknowledgements 14 bytes. Time measurements: All three different WLAN cards recorded the arrival time of packets at a resolution of 1 µs without any variable latency. The precise point of time, at which the time stamp is recorded, is not documented. Also, the WLAN chip sets feature only the recording of time stamps of incoming packets. But we needed both sending and receiving time stamps. Therefore, we decided to use a third PC to monitor the packets which the local node sends and receives. The monitor PC was placed close-by the sender to avoid any additional propagation delays that could falsify the measurements.</p><p>It will be straight forward to alter software and firmware of WLAN cards to record transmission time stamps, too. Due to legal constraints, we were not able to implement these changes by ourselves. We expect that WLAN chipset manufactures will provide firmware updates to support precise time stamps because they will benefit from customers using WLAN for location-aware services. Until then, we are required to use the third monitoring node.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Data collection &amp; processing:</head><p>Snuffle provides the packet traces of all 802.11b packets received at the monitoring node. We filtered-out only the successful ping sequences which consist of an ICMP request, an acknowledgement, an ICMP response and again an acknowledgement. Other packets like erroneous transmissions, beacons, ARQ messages etc. were dropped. Due to hardware limitations of the WLAN card only a fraction of observations were recorded.</p><p>Only the delays fitting in the interval [323 µs, 324 µs] are considered in further calculations (Fig. <ref type="figure">2</ref>). A few delay measurements were observed with the value of 322 and 325 µs. These and all other delays were considered as measurement errors. Taken the valid packet sequences, the mean and variance of the remote delay and local delay were calculated. To check for stationary process properties, the autocorrelation function was calculated.</p><p>In the second round, Tcpdump recorded the packet traces and wrote them to files. After the measurements we used tcpdump to convert these files to plain text files. Tcpdump had to be modified in order to print out the prism link-layer headers. For statistical analysis the R project software turned out to be quite efficient. Thus, this time we applied R programs to calculate the data's analyzed mean, variance and autocorrelation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Results:</head><p>The distance was directly derived from the measured propagation delay using equation <ref type="bibr" target="#b0">(1)</ref>. Assuming a Gaussian error distribution, we also plotted the confidence intervals in Fig. <ref type="figure" target="#fig_2">4</ref>. In the first campaign the calculated distances were always higher than the real distances. Also, in some measurements (e.g. 35 m) the air propagation time was significantly higher. Due to the experimental setup, we could not ensure that the direct line-of-sight path was taken. The remote node was placed directly on the ground. Thus, the Fresnel zone was violated and the direct transmission path was hampered.</p><p>In Fig. <ref type="figure" target="#fig_3">5</ref> the signal strength is displayed as a function of the distance. Theoretically, the signal strength should decrease with distance. In this measurement campaign other factors, such as reflection, seem to be dominant. If one compares Fig. <ref type="figure" target="#fig_2">4</ref> and Fig. <ref type="figure" target="#fig_3">5</ref>, it seems time measurements reflect the distance more precisely  than RSSI but they have a higher variance and a larger confidence interval. The results of the second round are illustrated in Fig. <ref type="figure" target="#fig_4">6</ref>, which shows the remote (blue) and local delay (red) measurements, the number of overall observations (#) and the correlation coefficient (R) for the given configuration. A clear correlation between actual distance and calculated distance can be identified. In the right graph, one can see that the larger the distance (and the worse the link quality), the larger the confidence interval becomes. In Fig. <ref type="figure" target="#fig_7">9</ref> we display the variance of rtt observations over the distance. The curve is highly similar to the curve described with <ref type="bibr" target="#b5">(6)</ref>. Thus, our beat-frequency explanation seems to be valid. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Analysis:</head><p>In <ref type="bibr" target="#b0">[1]</ref> we show that the first measurements follow a weak stationary process, with a constant mean, variance and covariance (for a constant lag). Thus, further statistical methods are applicable: Confidence intervals are only meaningful if the observations are independent. This assumption can be verified by the autocorrelation function. The time-lag dependent autocorrelation coefficients are presented as a graph  in Fig. <ref type="figure" target="#fig_5">7</ref>. The 40 m results are shown as an example. The autocorrelation for the local delay is low. It is smaller than ρ=0.05. Thus, the local delay measurements can be seen as independent. The autocorrelation of remote delay values has the shape of a decaying cosines wave. This kind of autocorrelation curve is found if the observations feature a constant frequency component. Indeed, this pattern arises in the delay traces. The values of 323 and 324 occur block-wise in bursts. We also calculated an FFT over the packet delays. Assuming that each observation follows the previous after 20 ms, we identified a dominant frequency of about 3.5 Hz independent of the distance (Fig. <ref type="figure" target="#fig_6">8</ref>). However, the lower the packet error rate, the stronger this effect is. We also calculated the autocorrelation of the second measurement's second results, high and alternating correlation coefficients were only present, if we used the Prism GT chip sets. We assume that this observation is due to the clocking of the MAC protocol and due to the frequency stability and accuracy of the WLAN quartz crystals. Further studies are required to understand this effect in-depth. We explain the effect displayed in Fig. <ref type="figure" target="#fig_5">7</ref> with interference of both remote and local crystal clocks. Taken this explanation of quantization errors we can calculate the clock drift between both signals. Assuming a clocking of the MAC protocol at 1 MHz, the drift between both clocks is approximately drif t = f beat f1 = 3.5Hz 1MHz = 3.5ppm. Usually, the tolerance of consumer grade quartz clocks is up to 25 ppm. Thus, we consider this explanation to be plausible.</p><p>Interestingly, the MAC processing is conducted in steps of 1 µs. Thus, the MAC processing time is not precisely the SIFS interval but is rounded up to the next 1 µs. However, the error is small so that receivers tolerate it.</p><p>In our quantization error analysis we calculated the variance which is up to 1 / 4 . A distance of one and a time unit of one in the analysis refer to 300 m or 1 µs in the experiments. Then, the standard deviation would be 18.75 m or 62.5 ns at most. The measured standard deviation ranges between 3.3 and 25 m. Thus, the  quantization error is not the only dominant effect and others such as thermal noise are important too.</p><p>We measured at each distance for 4 to 15 minutes. Is it really required to measure that long? In Fig. <ref type="figure" target="#fig_8">10</ref> we consider only a subset of all rtt observations taken during the second campaign. We display the correlation coefficient R and the standard error over the number of observations per distance. With 500 to 1000 observations per position nearly the optimal accuracy is achieved. If one assumes that a packet is sent off every mircosecond, the distance can be estimated after 1 s of continues transmission.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">Conclusion</head><p>We have presented an algorithm to measure the air propagation time of IEEE 802.11 packets with a higher accuracy. Using two different experimental setups, we determined the precision of round trip time measurements. We used commercial WLAN cards, supporting IEEE 802.11b and 802.11g, implemented with three different WIFI chip sets. We have shown that such time measurements are possible even with off-the-shelf, commercial WLAN equipment and without additional signal processing hardware.</p><p>To overcome the low resolution of the clocks, numerous observations have to be combined and smoothened. This can be carried out best during an ongoing data transmission at no additional cost. We explained why smoothing indeed helps to enhance the resolution of the time difference measurement so that distance measurements become possible. This effect can be due to the presence of measurement noise and to the beat frequency resulting from drifting clocks. To the best of our knowledge, especially the latter explanation is novel.</p><p>Our finding suggests that instead of RSSI the round trip time should be measured because it is correlated with the distance more strongly. In our gymnasium measurement the RSSI has not been useful to identify the distance becausedue to reflections -the attenuation varied largely.</p><p>The contribution of this work is to show that neither synchronized, precise clocks nor special hardware is required if the propagation delay between two WLAN nodes is to be measured. This allows the implementation of easy-touse, cheap and precise indoor positioning systems, which do not require maps containing signal strength distributions. However, WLAN chipset manufacturers should update their firmware so that it reports the round trip time of packets with an accuracy of at least 1 µs. Then, a 1000 packets transmission -achievable in less than one second -can measure the distance with an error deviation of less than 8 m.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>c = 2 1 )Fig. 1 .</head><label>211</label><figDesc>Fig. 1. Distance measurement: Transmission of an ICMP ping sequence.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 .Fig. 3 .</head><label>23</label><figDesc>Fig. 2. Discrete distribution of noisy delay measurements.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Distance as calculated from RTT versus actual distance between both nodes. 95% confidence levels are given.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 5 .</head><label>5</label><figDesc>Fig. 5. Received signal strength indication versus distance. Confidence intervals are too small to be shown.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 6 .</head><label>6</label><figDesc>Fig. 6. Propagation delay (=calculated distance) vs. actual distance (plus 95% conf. intervals). (blue/upper lines=biased remote delay, red/lower lines=biased local delays). Each value is based on at least 1000 observations.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 7 .</head><label>7</label><figDesc>Fig. 7. Autocorrelation (=cross correlation of itself) is oscillating for remote delays -indicating a fundamental frequency component in observations (at 40 m).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig. 8 .</head><label>8</label><figDesc>Fig. 8. The Fourier transformation of the observations shows a dominant frequency at 3.5 Hz, which is only present in the remote delays. (at 40 m).</figDesc><graphic coords="10,311.19,124.53,169.57,113.93" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig. 9 .</head><label>9</label><figDesc>Fig. 9. The variance of rtt observations over time.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig. 10 .</head><label>10</label><figDesc>Fig. 10. The accuracy (cross correlation and standard error) over the number of observations per position.</figDesc></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>We like to thank Prof. Wolisz for his ongoing support, E.-L. Hoene for the revision, and Sven Lamprecht and David Hundenborn for conducting the second measurements.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">Measuring round trip times to determine the distance between WLAN nodes</title>
		<author>
			<persName><forename type="first">A</forename><surname>Günther</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Hoene</surname></persName>
		</author>
		<idno>TKN-04-016</idno>
		<imprint>
			<date type="published" when="2004">2004</date>
		</imprint>
		<respStmt>
			<orgName>Telecommunication Networks Group, Technische Universität Berlin</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">Technical Report</note>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Location systems for ubiquitous computing</title>
		<author>
			<persName><forename type="first">J</forename><surname>Hightower</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Borriello</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Computer</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="page" from="57" to="66" />
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Range-free localization schemes for large scale sensor networks</title>
		<author>
			<persName><forename type="first">T</forename><surname>He</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Huang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">M</forename><surname>Blum</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">A</forename><surname>Stankovic</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Abdelzaher</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of MOBICOM</title>
		<meeting>MOBICOM<address><addrLine>San Diego, CA</addrLine></address></meeting>
		<imprint>
			<publisher>ACM Press</publisher>
			<date type="published" when="2003">2003</date>
			<biblScope unit="page" from="81" to="95" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">RADAR: An In-Building RF-Based User Location and Tracking System</title>
		<author>
			<persName><forename type="first">P</forename><surname>Bahl</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">N</forename><surname>Padmanabhan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Infocom 2000</title>
		<meeting><address><addrLine>Tel-Aviv, Israel</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2000">2000</date>
			<biblScope unit="page" from="775" to="784" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Limitations in range estimation for wireless LAN</title>
		<author>
			<persName><forename type="first">H</forename><surname>Velayos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Karlsson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. 1st Workshop on Positioning, Navigation and Communication (WPNC&apos;04)</title>
		<meeting>1st Workshop on Positioning, Navigation and Communication (WPNC&apos;04)<address><addrLine>Hannover, Germany</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Performance of TOA estimation algorithms in different indoor multipath conditions</title>
		<author>
			<persName><forename type="first">N</forename><surname>Alsindi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Pahlavan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">IEEE Wireless Communications and Networking Conference (WCNC)</title>
		<imprint>
			<date type="published" when="2004">2004</date>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="495" to="500" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title level="m" type="main">Special issue on GPS: The Global Positioning System</title>
		<author>
			<persName><forename type="first">P</forename><surname>Enge</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Misra</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1999">1999</date>
			<publisher>IEEE</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Designing a positioning system for finding things and people indoors</title>
		<author>
			<persName><forename type="first">J</forename><surname>Werb</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Lanzl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Spectrum</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="page" from="71" to="78" />
			<date type="published" when="1998">1998</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<title level="m" type="main">Speed of light measurement using ping</title>
		<author>
			<persName><forename type="first">J</forename><surname>Lepak</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Crescimanno</surname></persName>
		</author>
		<idno>B2.009</idno>
		<imprint>
			<date type="published" when="2002">2002</date>
			<publisher>American Physical Society -Meeting Abstracts</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Measuring the impact of slow user motion on packet loss and delay over IEEE 802.11b wireless links</title>
		<author>
			<persName><forename type="first">C</forename><surname>Hoene</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Günther</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Wolisz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. of Workshop on Wireless Local Networks (WLN)</title>
		<meeting>of Workshop on Wireless Local Networks (WLN)<address><addrLine>Bonn; Germany</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2003">2003. 2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<author>
			<persName><forename type="first">L</forename><surname>Gammaitoni</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Hanggi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Jung</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Marchesoni</surname></persName>
		</author>
		<title level="m">Stochastic resonance. Reviews of Modern Physics</title>
		<imprint>
			<date type="published" when="1998">1998</date>
			<biblScope unit="volume">70</biblScope>
			<biblScope unit="page" from="223" to="287" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<monogr>
		<title level="m" type="main">Non-line-of-sight error mitigation in mobile location</title>
		<author>
			<persName><forename type="first">L</forename><surname>Cong</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Zhuang</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2004">2004. 2004</date>
			<biblScope unit="page" from="650" to="659" />
			<pubPlace>Hong Kong</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
