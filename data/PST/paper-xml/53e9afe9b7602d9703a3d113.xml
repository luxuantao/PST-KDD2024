<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">NONLINEARITY CRITERIA FOR CRYPTOGRAPHIC FUNCTIONS</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Willi</forename><surname>Meier</surname></persName>
							<affiliation key="aff0">
								<address>
									<addrLine>Othmar Staffelbach 2, l) HTL Brugg-Windisch</addrLine>
									<postCode>CH-5200</postCode>
									<settlement>Windisch</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<address>
									<addrLine>GRETAG Aktiengesellschaft Althardstr. 70</addrLine>
									<postCode>CH-8105</postCode>
									<settlement>Regensdorf</settlement>
									<country key="CH">Switzerland</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">NONLINEARITY CRITERIA FOR CRYPTOGRAPHIC FUNCTIONS</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">5331ECEEF52AF469352D089929B1212B</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.3" ident="GROBID" when="2023-07-28T04:53+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Nonlinearity criteria for Boolean functions are classified in view of their suitability for cryptographic design. The classification is set up in terms of the laraest transformation arouo leavina a criterion invariant. In this resoect two criteria turn out to be-of special interest, the distance to linear structures and the distance to affine functions, which are shown to be invariant under all affine transformations. With regard to these criteria an optimum class of functions is considered. These functions simultaneously have maximum distance to affine functions and maximum distance to linear structures, as well as minimum correlation to affine functions. The functions with these properties are proved to coincide with certain functions known in combinatorial theory, where they are called bent functions. They are shown to have</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>xl,x2, ... ,Xn. At the first glance this seems to be a good nonlinear function, since it contains all nonlinear terms. However f can be written as the product f(x1, ,..., X , ) = (l+xl)(l+x2) * * -(l+xn) which transforms into the monomial function g(xl,xz,. .. ,Xn)</p><p>= x1x2 . * * Xn by simply complementing all arguments. This turns f into a poor function with respect to the number of nonlinear terms. Thus, from the present point of view, a large number of nonlinear terms taken as a criterion is not suitable since it is not invariant under simple transformations.</p><p>larger group of transformations. For many applications this symmetry group should contain the group of all affine transformations. I n Section 2 we develop a general method It is desirable therefore that a nonlinearity criterion remains invariant under a -.</p><p>(Theorem 2.1) in requirement. Some propriate sets of f to any subset S tances of f to a1 is defined as S(f p. 122). We show remains invariant rder to show that several well known criteria satisfy this stronger of these criteria can be expressed in terms of a distance to ap-(cryptologically weak) functions. (The distance d(f ,S) of a function of Boolean functions is defined as the minimum of the Hamming dismembers of S.) I n particular the distance 6(f) to affine functions = d(f,S), where S is the set of all affine functions (cf. also <ref type="bibr">[ 7 ]</ref> , hat S is a nonlinearity criterion with the desired property since it under the operation of the full affine group (Corollary 2.2).</p><p>Depending on the application different sets S of functions have to be considered as cryptographically weak. The set of affine functions may be replaced e.g. by functions of low nonlinear order, like quadratic functions. Therefore, as a design criterion for a Boolean function f, we may introduce its distance 6k(f) to all functions with nOnlinear order bounded by k. (Note that S1 = 6.) We show that the design criterion Sk also remains invariant under affine transformations. This is proved as a consequence Of the fact that similar invariance properties hold for the nonlinear order of Boolean functions (Theorem 2 . 4 ) .</p><p>class of cryptographically weak functions. The definition of these functions is motivated by the fact that for a linear ( o r affine) Boolean function f the values f(x+a) and f(x), for every fixed i, are either always equal or always different. Note however that many functions have this property without being linear or affine. The functions characterized by this condition appear to be important in the analysis and design of block ciphers, as has been pointed out by Chaum and Evertse i n [ I ] and <ref type="bibr">[3]</ref>, where this property is termed a linear structure. We denote by a ( f ) the distance d(f,S), where S is the set of all Boolean functions with linear structures. Then as for 6, the distance u is invariant under the operation of the full affine group (Corollary 2.3). every nonzero vector E G F ( 2 ) " the values f(x+a) and f(5) are equal for exactly half of the arguments perfect nonlinear with respect to linear structures, or briefly perfect nonlinear. In [3] Evertse has introduced a corresponding notion for LIES-like S-boxes where he named it a 50%-linear structure. Furthermore he questioned whether S-boxes with this restrictive property do exist, a question which is settled i n this paper.</p><p>I n a different direction, this notion of perfect nonlinearity is closely related to another design criterion for S-boxes, namely the strict avalanche criterion ( S A C ) . Basicly this is a diffusion criterion and has been investigated in <ref type="bibr">[ll]</ref> and <ref type="bibr">[ 4 ]</ref> . Recall that a Boolean function satisfies SAC if the output changes with probability one half whenever a single input bit is complemented. This means that a function satisfies SAC if the condition stated in the definition of perfect nonlinearity merely holds for vec-In certain applications the class of affine functions has to be extended to another With respect to linear structures, a function f has optimum nonlinearity if for E GF(Z)n. If a function f Tatisfies this property we will call it tors 5 of weight 1. Therefore perfect nonlinearity effects diffusion, and it is in fact a much stronger requirement than SAC. It is remarkable that in this context diffusion can be linked with nonlinearity.</p><p>i n combinatorial theoryin combinatorial theory Rothaus <ref type="bibr">( [ 6 ]</ref> ) has investigated a Class of functions, which he called 'bent functions'. The coincidence of bent functions with perfect nonlinear functions is derived by using properties of the Walsh transform. The existence of these functions i s established in <ref type="bibr">[6]</ref> by giving explicit constructions. I n particular, for n = E m , the functions of the form f(xl,x2 ,..., xn) = g(x1, ... , Xm) + XlXm+l + XZXm+z + ... + xmxn are known to be perfect nonlinear, where g(x1, ... txm) i s a completely arbitrary function. Moreover a systematic method allows to generate a large class of perfect nonlinear functions out of any existing one. However these constructions apply to even dimensions n only, whereas no perfect nonlinear functions exist in odd dimensions. It is furthermore known that the nonlinear order of bent functions i s tightly bounded by n/2.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>It turns out that perfect nonlinear functions correspond to certain functions known</head><p>We show that perfect nonlinear functions are optimum Nith regard to the distances 6 and u. More precisely for an even number n of arguments the class z(n) of perfect non-1 inear functions simultaneously has maximum distance to all affine functions (Theorem 3.4) as well as maximum distance to linear structures (Theorem 3.2). These maximum values are shown to be 2n-1-2(n//2)-1 for 6, and 2n-2 for U. Furthermore, perfect nonlinear functions have equal, and in fact minimum correlation to all affine functions (Theorem 3.5). The maximum distance 6 to affine functions i s of independent interest in coding theory, where it appears to be the covering radius of the Reed-Muller code of order 1 (cf. [Z]). In the same context the maximum value o f 8k coincides with the covering radius of the k-th order Reed-Muller code.</p><p>These results allow for applications in several directions. I n odd dimensions functions can be generated with properties close to those of perfect nonlinear functions (Section 3 . 3 ) . Thub in every dimension we arrive at constructing Boolean functions with large distances 6 and u, i.e. functions with guaranteed lower bounds on S and u. For large n (e.g. n = 64) an a priori verification of this property may be impossible since even the computation of Hamming distances between functjons becomes infeasible.</p><p>Notably, our considerations have consequences for the design of block ciphers. Since perfect nonlinear functions are not exactly balanced the question as raised by Evertse can be answered: There are no DES-like S-boxes with maximum distance to linear structures (Corollary 3.6). A search for such S-boxes was motivated by the analysis of DES in <ref type="bibr">[ l ]</ref> where linear structures of the S-boxes are considered.</p><p>The above example shows that in general perfect nonlinearity may not be compatible with other cryptographic design criteria, e.g. balance or highest nonlinear order. We indicate a method of finding functions which at the same time are nearly perfect non- linear (i.e. with large 6 and u) and satisfy other criteria of cryptographic interest.</p><p>stream cipher design where one or more linear feedback shift registers are combined to produce the key stream. In this design there arise correlation problems, since any Boolean function f has correlation to some linear functions L. Such correlations are shown to lead to correlations to certain LFSR-sequences. For an individual L this correlation i s reflected in a nonvanishing cross correlation coefficient c(f,L). The (normalized) correlations to ail linear functions L are shown to satisfy</p><p>In particular tnis procedure is applied to propose functions which are useful in c C(f,L)Z = 1, which implies that correlations to linear functions do always exist whatever function f is used. However for perfect nonlinear functions the. absolute values Ic(f , L ) I turn out to be uniformly small. This motivates a general method to face the correlation problems in stream cipher design by choosing the combining functions to be (close to) a perfect nonlinear function (which in fact can be done in conjunction with other design criteria). By suitable design the remaining correlations may become as small as to defeat any kind of correlation attack. This contrasts to the method of facing correlation by choosing correlation immune functions. A correlation immune function (of some order) has zero correlation to certain linear functions. However, as the above formula shows, the strongest correlations (to some other linear functions) are necessarily larger than for per nearly perfect) nonlinear functions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">NONLINEARITY CRITERIA FOR BOOLEAN FUNCTIONS</head><p>Cryptographic transformations are often described in terms of functions GF GF(2)m. For small values of n and m these functions are usually given in f ect (or 2)n --&gt; rm o f tables. These tables can then be used as building blocks for generating functions in higher dimensions. A s examples we mention the 5-boxes S: GF(2)6 -&gt; GF(Z)4 of DES, or the combining functions used i n certain types of stream ciphers. The strength of the resulting algorithms heavily relies on the nonlinearity o f these functions.</p><p>Most of the known nonlinearity criteria can be reduced to conditions imposed on Boolean functions f: GF(2)n --&gt; GF(2). This is illustrated by the notion of linear structures of S-boxes as introduced by Chaum and Evertse A function f is nonlinear (or non-affine) if i t s algebraic normal form contains terms of degree higher than one.</p><p>In this section we compare different criteria in view of their ability to measure nonlinearity of Boolean functions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1.">Distance to affine functions</head><p>The distance to the nearest affine function is defined as</p><formula xml:id="formula_0">6(f) = min d(f,L) L E A(n)</formula><p>where d(f,L) is the Hamming distance between f and L , and where the minimum is taken over the set A(n) of all affine functions L(x1, ... ,xn) = a0 t alxl t ... + anxn. Thus 6(f) is the distance of f to the set A(n). In order to investigate the properties of 6</p><p>we introduce some additional notations.</p><p>Let Q(n) denote the group of all invertible transformations of GF( <ref type="formula">2</ref>)", and let AGL(n) denote the subgroup of all aff ine transformations. Recall that the elements of AGL(n) can be described as functions a(5) = AX + 5 where A is a regular n x nmatrix and f: GF(2)n --&gt; GF(2) of n arguments. patible with group multiplication (cf. [5], Ch.1). For the image of a pair (g,s) (9 E G and s E S ) the notation 9.5 is commonly used. In these terms an operation of the group Q(n) on the set @(n) is defined by E GF(2)n is a vector. Moreover denote by @(n) the set of all Boolean functions An operation of a group G on a set S means a mapping G x S -&gt; S which i s com-</p><formula xml:id="formula_1">a-f(x) = f(a(x)), where f E @(n) and a E Q ( n ) (2.3)</formula><p>With this notion, we can now make some of our considerations in more general and more precise terms. Any design criterion is connected with a function D (valuation)</p><formula xml:id="formula_2">0: @(n) --&gt; W (2.4)</formula><p>with values in a suitable set W, and a function f is considered to be "good" if the value O(f) belongs to some well defined subset W1 of W. It may be essential for a design criterion that the valuation D remains invariant under those transformations of Q(n) which are considered "cryptographically weak". This guarantees that a good function cannot be made "worse" by means of weak transformations. For nonlinearity, weak transformations usually include affine transformations. To illustrate our terminology, the number of terms in the algebraic normal form (as exemplified in the introduction) is not invariant even under simple transformations like complementations of variables.</p><p>For any design criterion it is therefore of interest to introduce the largest subgroup I ( 0 ) of f l ( n ) which leaves D invariant, i.e.</p><formula xml:id="formula_3">I(D) = { a E n(n) I D(a-f) = D(f) for all f E @ ( n ) } (2.5)</formula><p>Hereafter I ( 0 ) will be called the symmetry qroup of 0. In cryptography i t may be essential that I(D) is large. We therefore investigate various design criteria in view of their symmetry groups.</p><p>First we show that the distance 6 to the nearest affine function remains in fact invariant under the operation of the whole affine group AGL(n) (cf. Corollary 2.2 below.) It appears worthwhile to prove this result in a more general context, which allows to analyze other design criteria with regard to their symmetry group.</p><p>Let H be a subset of @(n), and for f E @ ( n ) let dH(f) = d(f,H) be the distance of f to the set H. (In applications, t h i s subset will be the class of cryptographically weak functions, and for 6 it will be the set A(n) of all affine functions.) Moreover let</p><formula xml:id="formula_4">( 2 . 6 ) O(n)fi = { a E O(n) 1 a-h E H for all h E H}</formula><p>which will be called the s;lmmetry qroup o f the set H. This terminology is justified by the following result.</p><p>Theorem 2.1. For any subset H of @(n) the symmetry group of dH coincides with the symmetry group of H I(dH) = a(n)H.</p><p>(2.7)</p><formula xml:id="formula_5">Proof. (a) fl(n)H is contained in I(dH): Suppose a E n(n)H and f E @(n). Let h E H such dH(f) = d(f,h). Then dH(f) = d(f,h) = d(a.f,a.h) 2 dH(a-f).</formula><p>Observe that the second equality is a consequence of the fact that the operation of Q(n) on @(n) leaves the Hamming distance invariant. Moreover the last inequality holds as a*h E H by definition (2.6). Therefore dH(f) 2 dH(a*f) (2.8)</p><p>Since n(nlH is a subgroup (2.8) may be applied with respect to the operation of a-l. This yields dH(a*f) 2 dH(a-'.(a.f))</p><p>= dH(f), and consequently dH(a*f) = dH(f).</p><p>a-h i s not in H. Hence dH(h) = 0 but (b) I(dH) is contained in n(n)H: For any a f i2(n)H there exists h E H such that dH(a*h) # 0. Therefore a is not i n I(dH).</p><p>Corollary 2.2. The symmetry group I ( 6 ) of 6 is the affine group AGL(n).</p><p>Proof. With regard to Theorem 2.1. it remains to show tnat n(n)A(n</p><formula xml:id="formula_6">) = AGL(n). Obviously AGL(n1 is contained i n o(n)A(n).</formula><p>In the other direction for any a E Q(n) -AGL(n) there exists an index i such that the i-th component ai(x1, ..., x,) of a is not affine. Then for g(x1 ,..., xn) = xi, the function a* (XI ,..., xn</p><formula xml:id="formula_7">) = ai(x1, ..., xn) is not in A(n),</formula><p>which implies that a is not in n(n)A(nY.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2.">Distance to linear structures</head><p>According to the preliminary remarks to this section a general linear structure can be formulated i n terms o f linear structures o f appropriate Boolean functions. Recall that a linear structure of a Boolean function f: GF(2)n --&gt; GF(2) can be identified with a vector E GF(2)n such that the expression takes the same value (0 or 1) for all x E GF(2)n ([1],[3]). Let LS(n) denote the subset of Boolean functions having linear structures. Observe that LS(n) properly contains the set A(n) of all affine functions. tance of f to the s e t LS(n):</p><p>For a Boolean function f the distance to linear structures is defined as the dis-</p><formula xml:id="formula_8">u(f) = d(f,LS(n)) = min d(f,S) s E LS(Il)</formula><p>(2.10)</p><p>The distance to linear structures serves as a useful nonlinearity criterion as follows as a corollary to Theorem 2.1.</p><p>Corollary 2 . 3 . The symmetry group I(o) of u contains the affine group AGL(n).</p><p>Proof. In order to apply Theorem 2.1 we show that Hence a E Q(n)LS(n).</p><formula xml:id="formula_9">Q ( n ) L s ( n ) contains AGL(n). Let f E LS(n) and</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>--</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3.">The nonlinear order</head><p>For a Boolean function f E @(n) let O(f) be the degree of the highest order terms in the algebraic normal form, which is called the nonlinear order of f. This defines another useful nonlinearity criterion 0: Q(n) -&gt; { O , ..., n} as is demonstrated by the followiflg Theorem 2.4. The symmetry group I ( 0 ) of 0 is the affine group AGL(n).</p><p>Proof. (a) AGL(n) i s contained in I ( 0 ) : Let a E AGL(n) and f E @(n) arbitrary. Compute the algebraic normal form of a * f by formal reduction of f(a(5)). In this procedure existing nonlinear terms of f(5) may disappear and new terms may be generated in f(a(5)). However terms of some degree k in f(2) cannot create terms of degree higher than k in f(u( <ref type="formula">5</ref>)). This shows O(a-f) L O(f) (2.12) Formula (2.12) may be applied also with respect to the operation of a-l. Hence</p><formula xml:id="formula_10">O(f) = o(a-l.(a-f)) 5 O(a.f)</formula><p>and O(a-f) = O(f). Therefore a E I ( <ref type="formula">0</ref>) .</p><p>(b) I ( <ref type="formula">0</ref>) is contained in AGL(n): Suppose that a is not contained i n AGL(n). Then a has a nonlinear component ai(x1, ..., xn).</p><formula xml:id="formula_11">With f ( x 1 , ..., xn) = xi we have a -f = ai. Thus O(a-f) &gt; 1 whereas O(f) = 1. Therefore a is not contained in I(0).</formula><p>functions with nonlinear order bounded by k , also remain invariant under the operation of AGL( n) .</p><p>Theorem 2.4 implies that other nonlinearity criteria, namely the distances 6k to</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4.">Correlation immunity</head><p>Refer to the notion of correlation immunity as introduced by Siegenthaler ([g]).</p><p>It is known that correlation immunity i s not a genuine nonlinearity criterion. Indeed the consideration of its symmetry group further illuminates this fact. In view of a later comparison to other design criteria, the study of correlation immunity i n the context of symmetry groups is of independent interest. We start by defining a valuation C: @(n) -&gt; {O,l, ... ,n-1} by assigning to every function f E $(n) its order c(f) of correlation immunity.</p><p>Theorem 2.5. The symmetry group I(c) is the group of permutations and complementations of variables, i.e. the group P(n) = {a=(A,d] E AGL(n) where A i s a permutation matrix}.</p><p>Proof. First we show that I ( c ) is contained in AGL(n). Suppose that a is not contained i n AGL(n), and let a(5) = (cq(x), ..., ~~( 5 ) ) .</p><p>For this we claim that there exists a sum of at least n-1 ai's which is not linear. Suppose to the contrary that all the sums po = a1 f a2 + .... an and P i = j$i "j are linear. Then ai = Po t P;. is linear for all i , in contradiction to the nonlinearity of a.</p><p>In case PO is nonlinear take f(5) = x1 + x 2 + ... + xn, and in case Pi is nonlinear for some i &gt; 0 take f(2) = Z x j . Then a.f = p i has nonlinear order at least 2.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Pi</head><p>Moreover a -f is balanced as (z is a permutation o f GF(2)". Therefore by a result Of Siegenthaler <ref type="bibr">( [ 9 ]</ref> ) , c(a*f) &lt; n-2 whereas c(f) t n-2. Hence a is not contained in I(c).</p><p>In a second step we show that I(c) is contained in P(n). Suppose a E AGL(n) is not contained in P(n). Then there exists a component a i ( 5 ) = bo t blxl t ... t bnxn with weight(b1, ..., b,) = t &gt; 1. Take f(5) = xi. Then c(a*f) = t-I &gt; 0 and c(f) = 0. Therefore a is not contained in I(c). Alltogether this shows that I(c) is contained i n P(n).</p><p>Since obviously P(n) is contained in I(c), this completes the proof of the theorem.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">PERFECT NONLINEAR FUNCTIONS</head><p>I n this section we investigate a class of functions whose definition is motivated by considering linear structures. With respect to linear structures (cf. (2.9)) a Boolean function f has optimum nonlinearity if f(xt2) coincides with f(5) for exactly half of the arguments 5: <ref type="formula">2</ref>) is called perfect nonlinear with respect to linear structures (or briefly perfect nonlinear) if f o r every nonzero vector ; E GF( <ref type="formula">2</ref>)n the values f(x+a) and f(2) are equal for exactly half o f the arguments &amp; E GF(2)n. n ( n ) . We first show that these functions are optimum with respect to the distance u to linear structures.</p><formula xml:id="formula_12">Definition 3.1. A Boolean function f: GF(2)n -&gt; GF(</formula><p>The subset o f @ ( n ) consisting of the perfect nonlinear functions will be denoted by For an arbitrary function f: GF(2)n -&gt; GF(2) the distance to linear structures can be computed as follows. Let can be exhausted by Zn-I pairs (x,x+a). Denote by no the number of elements in the set Wg of pairs (5,s':) for which f(2) coincides with f(x+a). Similarly let n1 be the number of elements in the set W1 of pairs (&amp;,&amp;ti) for w6ich f(5) differs from f(x+a).</p><p>Furthermore any Boolean function can be derived from f by modifying an appropriate set of f-values. I n this way f can be turned into a function with the linear structure a by changing the f-values of either 5 or x+c for pairs in WO, or by changing the fvalues of either 5 o r x+for the pairs in W1. Thus no values are to be changed to get a function g with the linear structure (g(5) # g(xt5) for all z), and n1 values are to be changed to get a function g with the linear structure (g(2) = g(5.2) for all x).</p><p>In order to generate any other function with these linear structures at least min(n0,nl) modifications are necessary. Therefore n = min(n0,nl) is the distance of f t o the nearest functions with the linear structure d. Observe that this n depends on the vector d , i.e. n = nf(2) = min(no($),nl(a)).</p><p>Hence the distance of f to linear structures is given by E GF(2)n be a nonzero vector. Then the space GF(2)n u(f) = rnin nf(a)</p><formula xml:id="formula_13">-a P O</formula><p>Since no(?) + nl(5) = 2 " ' the derivation of formula (3.1) also proves that nf(5) 5 2n-2 for all a f 0. This maximum distance is achieved by perfect nonlinear functions, as these functions are characterized by no(a) = n l ( a ) = 2n--2 for a f 0, or equivalently by the property u ( f ) = 2n--2. This proves ---Theorem 3 . 2 . The class a ( n ) of perfect nonlinear functions is the class of functions with maximum distance 2n-2 to linear structures.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1.">Bent functions</head><p>We now establish a relationship between perfect nonlinear functions and the 'bent' functions which were introduced by Rothaus <ref type="bibr">( [ 6 ]</ref> ) . The relation is expressed in terms of the Walsh transform.</p><p>Hereafter, in connection with Walsh transforms, al'l Boolean functions are considered with values +1 and -1 (i.e. f(p) is replaced by (-l)f(')</p><p>) . Recall the definition of the Walsh transform</p><formula xml:id="formula_14">F(?) = Z f(z)(-l)z'x x E GF(2)"</formula><p>where w E GF(2)n and 5.w is the dot-product over GF(2), and where the sum is evaluated over the reals.</p><p>For a Boolean function f: GF(2)n -&gt; {+l,-1} the condition of Definition 3.1. for given 5 reads as</p><formula xml:id="formula_15">z f(x)f(p+:) = 0 ( 3 . 3 ) x E G F ( Z ) "</formula><p>The sum (3.3) equals f*f(a) where f*f denotes the convolution of f with itself. Thus a il-valued function f is perfect nonlinear if and only if f*f(a) = 0 for every nonzero vector d E GF(2)n, i.e. if and only if f*f is a &amp;function. By the convolution theorem the function f*f transforms into F2, and a &amp;function transforms into a constant. Therefore a tl-valued Boolean function f is perfect nonlinear if and only if IF(w_)l i s constant for all w. Since f*f(g) = Zn, this constant is IF(?)\ = 2"12 <ref type="bibr">( 3 . 4 )</ref> This property has been used by Rothaus to define the bent functions, which implies Theorem 3 . 3 . The class of perfect nonlinear functions coincides with the class of bent functions.</p><p>The following theorems A and B are the main results proved in <ref type="bibr">[6]</ref> about bent functions.</p><p>Theorem A . Bent functions only exist f o r even numbers n o f arguments, and their nonlinear order is always bounded by n/2. Theorem 8 . For an even number n of arguments bent functions are constructed as follows.  </p><formula xml:id="formula_16">+ C(X) is a l s o bent. Then the function f(p,x,,l,x,,p) = a(x)b(x) + b(x)c(x) + c(x)a(x) + [a(x)+b(x)]~,,~ requirement that a(x)+b(x)+c(x)</formula><p>is bent is readily met by taking a ( : ) , b(x) and c(x) from class 61, or by putting a(?) = b(5) or b(5) = ~(5).</p><p>+ [a(r)+c(x)]xn+2 + xn+lxn+2 is a bent function. The (81) leads to an explicit construction of bent functions, whereas (82) allows to generate new perfect nonlinear or bent functions o u t of any existing ones. This procedure can be combined with linear operations on given perfect nonlinear functions. In fact formula (2.11) implies that the class n(n) o f perfect nonlinear functions is in-variant under the operation of the affine group AGL bitrary affine function does not affect perfect non f E @(n) the function 5 --&gt; f(a(x)) t L(x) defines 4 ( n ) which leaves x(n) invariant.-This leads to the perfect nonlinear functions. n). Moreover addition of an arinearity. Therefore assigning t o an operation o f AGL(n) x A(n) on following recursive construction of I . For n = 2 take the class C(2) consisting of all functions of nonlinear order 2.</p><p>11. For n &gt; 2 take any functions a,b,c in C(n-2) such that their sum is also in C(n-21, and apply construction ( 8 2 ) . This defines a class C ' ( n ) of perfect nonlinear functions. This class C ' ( n ) is enlarged to a class C(n) by letting operate the whole group</p><formula xml:id="formula_17">G = AGL(n) x A(n) on C'(n).</formula><p>It can be shown that C(n) includes the functions obtained in ( B l ) . It is not clear whether the at least Z2 very small fraction of all Boolean functions are perfect nonlinear. Already for n = 6 (i.e. in the input dimension of the DES S-boxes) it is virtaally impossible to find perfect nonlinear functions by a pure random search.</p><p>lass C(n) exhausts all functions in n(n)."But (61) implies that there are Boolean functions. Thus only a n/F perfect nonlinear functions among all 2* Let Lw(x) = !*? denote an arbitrary linear function. Thus (-1)Y.z is the corresponding *l-valued function which is also denoted by Lw(x). Then the definition (3.2) of the Walsh transform implies where d denotes the Hamming distance. Therefore Formula (3.5) can be used to f i n d the best affine approximation to a given function by finding w such that I F ( w ) j i s maximum (cf. also Rueppel there exists a w with jF(w)l &gt; Z n I Z . This implies 6(f) &lt; 2"; -2n/2-i and therefore f is closer to the s e t of all affine functions than are perfect nonlinear functions.</p><p>This shows that the perfect nonlinear functions are not only optimum with respect to the distance to linear structures but also with respect to the distance to all affine functions.</p><p>Theorem 3.4. The class n(n) of perfect nonlinear functions is the class of functions with maximum distance 2n-l -2("2)-1 to affine functions.</p><p>As formula (3.5) shows this result can be refined to the statement that the distance Of a perfect nonlinear function f to any affine function is ejther Znml f 2n/2-1 or 2"l -2'I2-l. This fact can be expressed in terms of correlations of f to affine functions. In general the Hamming distance between two Boolean functions f,g: GF(2)n --&gt; {+l,-1) is tied u p with the cross correlation between f and g which is defined as For g = Lw we have by definition o f the Walsh transform ( s e e also (3.5))</p><formula xml:id="formula_18">(3.9)</formula><p>Therefore the absolute value of the cross correlation between a perfect nonlinear function and any affine function is a constant equal to 2-"2. Moreover for a function g which is not perfect nonlinear there is always an affine function L with cross correlation c(g,L) larger than 2-n//2 in absolute value. This is summarized in the followi ng Theorem 3.5. The perfect nonlinear functions are the class of functions with minimum correlation to all affine functions. This property contrasts to correlation immunity. Recall that a m-th order correlation immune function f satisfies F(w) = 0 for all (cf. [12]). Hence for these vectors y the cross correlation c(f,Lw) vanishes. *I-balance of a Boolean function f. Therefore a perfect nonlinear function is never balanced. However its deviation from balance is given by 2-"2 which rapidly tends to 0 as n grows larger. The same holds for the correlation to any other affine function. The fact that there exist no balanced perfect nonlinear functions answers a question raised by <ref type="bibr">Evertse (cf. [ 3 ]</ref> ) .</p><p>The cross correlation c ( f , O ) to the all zero function measures the deviation from Corollary 3.6. There are no DES-like S-boxes which are perfect nonlinear, or equivalently, S-boxes with maximum distance to 1 inear structures. Recall that there are no perfect nonlinear functions with an odd number of arguments. This relies on the fact that the absolute value of the Walsh transform of a perfect nonlinear function has to be constant (cf. formula (3.4)). However for odd dimensions we can construct functions with the property that the absolute value of their Walsh transform i s two-valued. Such functions may be obtained by the following construction.</p><p>fo E @(n-1) defined by fO(x1, ... Suppose now that fo and fl are perfect nonlinear. Then the values of For and F1 are *2(n-1)/2, which implies that the values of FO and F1 are either 0 or *2(n+1)/2. Thus for any pair of perfect nonlinear functions f0,fl E a(n-1) we can construct a function f E @(n) such that the function IF/ takes two values (0 or 2(n+1)/2). More precisely, by Parseval's theorem (cf. ( 3 . 8 ) ) , half of the values of IF1 are 0 and the other half 2(nt1)/2.</p><p>F o r n odd denote by a'(n) the class of all functions f such that IF1 takes the 2 values 0 and 2(nt1)/2. These classes 71' of functions in odd dimensions are related to the classes T in even dimensions. This is reflected by similar properties of the two classes with regard to nonlinear order and distance to affine functions. I n analogy to Theorem A it can be shown that the nonlinear order of a function f E n'(n) is always bounded by (n+1)/2. Moreover the distance of a function f E n ' ( n ) to affine functions is obtained as</p><formula xml:id="formula_19">6 ( f ) = p -1 -Z ( n + l ) / Z ' -l .</formula><p>(3.12) This shows that in odd dimensions the elements of ~' ( n ) are nearly as far from affine functions as are the perfect nonlinear functions in even dimensions. Note however that it is possible to generate functions f in odd dimensions with larger distance S(f) In general the maximum value of 6 coincides with the covering radius o f the Reed-Muller code R(1,n). This covering radius is unknown if n is an arbitrary odd number (cf. [2]).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">CONCLUSIONS AND APPLICATIONS</head><p>The theory of perfect nonlinear (or bent) functions has interesting implications to the design of block ciphers as well as stream ciphers. We have already observed (cf. Corollary 3.6) that perfect nonlinearity may not be compatible with other cryptographic design criteria. For example perfect nonlinearity cannot be achieved in conjunction with balance or highest nonlinear order. However a reasonable strategy will be to find nearly perfect nonlinear functions which satisfy additional design criteria. This is i l - lustrated by the following example of finding nearly perfect nonlinear functions which are balanced. Suppose e.g. that f has distance Zn-I + 2n/2-1 to the ail zero function. Then com-Recall that a function f E v(n) has distance Zn-l i 2n//2-1 to each affine function.</p><p>plementing an arbitrary set of 2n12-1 f-values 1 yields a balanced function f'. With regard to distance to affine functions this modified function f' still has desirable properties, since the triangle inequality implies To illustrate this procedure take n = 8. I n this case it is easy to generate balanced functions with distance 6 at least 112 (compared to 120 for perfect nonlinear fUnCtions). Instead one could randomly try balanced functions until a function with 6 = 112 has been found. However it has appeared (cf. Section 3 ) that perfect (or nearly perfect) nonlinear functions are very rare in the set of all Boolean functions. Therefore an exhaustive search in the set of balanced functions has virtually zero probability to succeed in reasonable time.</p><p>A similar method can be applied to other design criteria, e.g. nonlinear order or correlation immunity. This leads to the following general procedure, where we use a systematic approach to satisfy first those properties which cannot be achieved by a pure random search.</p><p>1. Generate a random perfect noniinear function f using the recursive algorithm as described in Section 3.</p><p>2. Find a random function f' as close as possible to f which satisfies all the other desired criteria.</p><p>In this way we can construct functions which are useful in stream cipher design where one or more linear feedback shift registers (LFSRs) are combined to produce the key stream.</p><p>We start by considering the case where n different taps of one LFSR are nonlinearly combined by some Boolean function f E @ ( n ) (a situation which was originally treated in which is a sequence (another phase) produced by the same LFSR. The corresponding cross correlation is obtained by (3.9)</p><p>In this situation the use of correlation immune functions (of any order) is not adequate. To the contrary, correlation immunity of functions is equivalent to the vanishing of certain Walsh coefficients (or cross correlations to certain phases). But in this case Parseval's equality (cf. also (3.10))</p><formula xml:id="formula_20">z Cf(VJ2 = 1 w E G F ( Z ) "</formula><p>implies that cross correlations to other phases are necessarily larger. In this context it is best to face the correlation problem by choosing f as close as possible to a perfect nonlinear function (where all cross correlations are minimum). This treatment also applies to the situation where taps of different LFSR's are combined.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head></head><label></label><figDesc>of confusion and diffusion we mention DES. Likewise, this concept applies to other cryptosystems, block ciphers as well as stream ciphers. In this context it is important to have criteria which are measures for nonlinearity. A variety of such criteria are known in cryptographic design. Our aim is to contribute to a general theory which classifies these criteria in view of their our concept we consider the Boolean function f(XI,xz,**.lxn) whose algebraic normal form is obtained by summing up all possible product terms in J.J. Quisquater and J. Vandewalle (Eds.): Advances in Cryptology -EUROCRYPT '89, LNCS 434, pp. 549-562, 1990. 0 Springer-Verlag Berlin Heidelberg 1990</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc>m i s said to have a linear structure if there is a nonzero vector 9 E GF(2)n together with a nontrivial linear mapping L: GF(2)m --&gt; GF(2) such that LS(x+a) + LS(5) takes the same value (0 or 1) for all x E GF(2)n. Thus linear structures of S can be expressed in terms of linear structures '07 the Boolean function LS. F o r this reason we concentrate hereafter on Boolean functions f: GF(2)n -&gt; GF(2). It is common to describe these functions in terms of their algebraic normal form</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><label></label><figDesc>let d E GF(2)n be a linear structure o f f , i . e . for all 5 E GF(2)n the equation f(x+a) + f(5) = c holds, where c E G F ( 2 ) is a constant. Then for a E AGL(n) f(a(5 + a-l(?))) + f(a(5)) = c (2.11) i s satisfied for all x E GF(2)n. This means that .-'(a) i s a linear structure of asf.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>(</head><label></label><figDesc>Bl) Let n = 2m. Then the functions of the form f(x1, ..., xn) = g(x1, ... ,xm) + xlxm+l + xzxrn+2 + ... + xmxn are bent, where g(x1, ..., x , ) is a completely arbitrary function of m variables.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>( 82 )</head><label>82</label><figDesc>Let p = (XI ,..., xn) and let a(?), b(p) and c(5) be befit functions such a(x) + b(5)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head></head><label></label><figDesc>L,) = 2'l-I -For the corresponding affine function L,' = 1 t L, the distance d is computed as d(f,L,') = 2"* + (1/2)F(!).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head></head><label></label><figDesc>affine functions. Suppose now that f i s not perfect nonlinear. Then by Parseval's theorem z F(W)* = 2n 1 f(x)2 = 22n</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><label></label><figDesc>On the other hand Parseval's theorem implies with Hamming weight less or equal m z c(f,Lw)2 = 1 Boolean function f, which means that the "global correlation" to all linear (or affine) functions does not depend on the function f. Thus for correlation immune functions the vanishing of certain cross correlations necessarily leads to larger correlations to other aff ine functions.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>3. 3 .</head><label>3</label><figDesc>Boolean functions with a n odd number of arguments</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head></head><label></label><figDesc>,xn-l) = f(O,xl, ..., xn-l), and by fl E @(n-1) the upper half, fl(x1, ... ,xn-1) = f(l,xl, ..., x,,-~). Similarly denote by FO and F1 the lower and upper half of the Walsh transform F. Moreover let Fo' and F1' be the Walsh transforms of fo and fl, respectively. Then definition (3.2) impliesFor f E @(n), n odd, denote by fo the lower half of f , i.e. the function(3.11    </figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>[</head><label></label><figDesc>l o ] ) . Denote by ill 22, ... , -n the output sequences of these taps. Now suppose that f is correlated to the linear function Lw, w E GF(2)n. Then the generator output sequence is correlated to the sum x = w p 1 + W 2 9 + ... + wna, (4.2)</figDesc></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_0"><p>3.2. Distance to affine functions and correlation</p></note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgement.</head><p>We wish to thank Bert den Boer for helpful discussions</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Suppose that a Boolean function f E @(n) combines a total number of n taps from k different LFSRs. Again, correlation will occur to sequences of the form (4.2) which is caused by correlation of f to the corresponding linear functions Lw. In this more general setting the sequence (4.2) can be expressed as by collecting terms coming from the same LFSR (i.e. bi = 2 djij, summed over the set Si of all indices j corresponding to tap positions belonging to LFSR i). It may happen that some o f the b i t s in (4.3) are zero, in which case the generator is vulnerable to a divide and conquer attack by exploiting the correlation. Otherwise stated, if all summands bi are nonzero, a divide and conquer correlation attack is not possible. TO this aim maximum order correlation immunity has been postulated in [7]. In our terminology the generator is maximum order correlation immune if the combining function f satisfies the following condition MCI (expressed in terms of the iv'alsh transform):</p><p>In fact MCI is equivalent to the condition that all b i ' s in (4.3) are nonzero. correlations are uniformly small. This can be achieved e.g. by choosing f close to a perfect nonlinear function. By appropriate design these correlations may become as small as to defeat any kind o f correlation attack.</p><p>In addition to MCI the combining function f may be designed such that the remaining</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Cryptanalysis of GES with a reduced n u d e r o f rounds</title>
		<author>
			<persName><forename type="first">D</forename><surname>Chaum</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J.-H</forename><surname>Evertse</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of irypto&apos;85</title>
		<meeting>irypto&apos;85</meeting>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Covering radius -Survey and recent results</title>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">D</forename><surname>Cohen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">G H F</forename><surname>Karpovsky</surname></persName>
		</author>
		<author>
			<persName><forename type="middle">J R</forename><surname>Mattson</surname></persName>
		</author>
		<author>
			<persName><surname>Schatz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Inform. Theory, Val. IT</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="page" from="328" to="343" />
			<date type="published" when="1985">1985</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Linear structures in block ciphers</title>
		<author>
			<persName><forename type="first">J.-H</forename><surname>Evertse</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of Eurocrypt&apos;87</title>
		<meeting>Eurocrypt&apos;87</meeting>
		<imprint>
			<biblScope unit="page" from="249" to="266" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">The strict avalanche criterion: Spectral properties of Boolean functions and an extended definition</title>
		<author>
			<persName><forename type="first">R</forename><surname>Farrb</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of Crypto&apos;88</title>
		<meeting>Crypto&apos;88</meeting>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<monogr>
		<title level="m" type="main">Algebra</title>
		<author>
			<persName><forename type="first">S</forename><surname>Lang</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1971">1971</date>
			<publisher>Addison-iiesley Publishing Company</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">On bent filncxions</title>
		<author>
			<persName><surname>Rothaus</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal o f Canbinatorla1 Theory ( A )</title>
		<imprint>
			<biblScope unit="page" from="300" to="305" />
			<date type="published" when="1975">Val. 20. 1975</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<monogr>
		<title level="m" type="main">Analysis a m design of stream ciphers</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">A</forename><surname>Rueppel</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1986">1986</date>
			<publisher>Springer-Verlag</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Comnications theory of secrecy systems</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">E</forename><surname>Shannon</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bell Sys. Tech. Journal</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="656" to="715" />
			<date type="published" when="1949">1949</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Correlatlon-innunity of nonlinear coirblning functions for cryptographlc applications</title>
		<author>
			<persName><surname>Slegenthaler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Inform. Theory. Val</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="issue">30</biblScope>
			<biblScope unit="page" from="776" to="780" />
			<date type="published" when="1984">1984</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Cryptanalysts representation of nonl inearly fi 1 w e d Mi-sequences</title>
		<author>
			<persName><forename type="first">T</forename><surname>Siegenthaler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings o f Eurocrypt&apos;85</title>
		<meeting>o f Eurocrypt&apos;85</meeting>
		<imprint>
			<biblScope unit="page" from="103" to="110" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<monogr>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">F S E</forename><surname>Hebster</surname></persName>
		</author>
		<author>
			<persName><surname>Tavares</surname></persName>
		</author>
		<title level="m">On the design o f 5-boxes</title>
		<imprint>
			<biblScope unit="page" from="523" to="534" />
		</imprint>
	</monogr>
	<note>Proceedin98 o f Crypto&apos;85</note>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">A spectral characterization of correlatisn-imne corbining functlons</title>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">L J L</forename><surname>Xiao</surname></persName>
		</author>
		<author>
			<persName><surname>Hassey</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Inform. Theory</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="page" from="192" to="211" />
			<date type="published" when="1988">1988</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
