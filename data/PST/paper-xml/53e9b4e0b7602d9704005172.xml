<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Joint Scheduling and Resource Allocation for Device-to-Device Underlay Communication</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Feiran</forename><surname>Wang</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Electronics Engineering and Computer Science</orgName>
								<orgName type="laboratory">State Key Laboratory of Advanced Optical Communication Systems and Networks</orgName>
								<orgName type="institution">Peking University</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Lingyang</forename><surname>Song</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Electronics Engineering and Computer Science</orgName>
								<orgName type="laboratory">State Key Laboratory of Advanced Optical Communication Systems and Networks</orgName>
								<orgName type="institution">Peking University</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Zhu</forename><surname>Han</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">Electrical and Computer Engineering Department</orgName>
								<orgName type="institution">University of Houston</orgName>
								<address>
									<settlement>Houston</settlement>
									<region>TX</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Qun</forename><surname>Zhao</surname></persName>
							<affiliation key="aff2">
								<orgName type="institution">DOCOMO Beijing Communications Laboratories</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Xiaoli</forename><surname>Wang</surname></persName>
							<affiliation key="aff2">
								<orgName type="institution">DOCOMO Beijing Communications Laboratories</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Joint Scheduling and Resource Allocation for Device-to-Device Underlay Communication</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">82AB4DB803D72C64D29645C6C0026749</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.3" ident="GROBID" when="2023-07-28T10:52+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Device-to-device (D2D) communication as an underlay to cellular networks can bring significant benefits to users' throughput. However, as D2D user equipments (UEs) can cause interference to cellular UEs, the scheduling and allocation of channel resources and power to D2D communication need elaborate coordination. In this paper, we propose a joint scheduling and resource allocation scheme to improve the performance of D2D communication. We take network throughput and UEs' fairness into account by performing interference management. Specifically, we develop a Stackelberg game framework in which we group a cellular UE and a D2D UE to form a leader-follower pair. The cellular user is the leader, and the D2D UE is the follower who buys channel resources from the leader. We analyze the equilibrium of the game, and propose an algorithm for joint scheduling and resource allocation. Finally, we perform computer simulations to study the performance of the proposed algorithm.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>I. INTRODUCTION</head><p>Device-to-device (D2D) communication as an underlay to cellular networks is considered as a key feature to be integrated into the Third Generation Partnership Project (3GPP) Long Term Evolution-Advanced (LTE-A) system, which is motivated by the increasing demand for higher data rates. It allows user equipments (UEs) in close proximity to communicate directly without through the evolved NodeB (eNB) <ref type="bibr" target="#b0">[1]</ref>. These UEs can share the same resources with cellular users under the control of the cellular network. D2D communication is promising for improving resource utilization, enlarging users' throughput and extending battery lifetime. Therefore, D2D communication has recently received extensive attention.</p><p>However, D2D communication can cause serious interference problems due to sharing cellular resources. Cellular and D2D communication needs careful coordination. Major research aspects include power control, resource allocation, and mode selection. Various researches have been conducted to study these problems <ref type="bibr" target="#b1">[2]</ref>- <ref type="bibr" target="#b5">[6]</ref>. The goal is to reduce the interference from D2D communication to the cellular networks and to guarantee the performance of D2D communication at the same time. In <ref type="bibr" target="#b1">[2]</ref>, the authors studied a power control scheme that constrains the signal to interference plus noise ratio (SINR) degradation of the cellular link. In <ref type="bibr" target="#b2">[3]</ref>, the authors derived the optimal power allocation in a single cellular UE and D2D pair scenario. A heuristic greedy algorithm for resource allocation was developed in <ref type="bibr" target="#b3">[4]</ref>. In <ref type="bibr" target="#b4">[5]</ref>, a sequential second price auction scheme was proposed for allocating the spectrum resources to D2D communications with multiple user pairs. In <ref type="bibr" target="#b5">[6]</ref>, a reverse combinatorial auction based resource allocation scheme was proposed.</p><p>Prior works have considered little about time-domain scheduling of D2D communication. In this paper, we study joint scheduling, power control and channel allocation for D2D communication using a game theoretic approach. Note that if cellular and D2D UEs are simply modeled as selfish players, the outcome is usually inefficient, since cellular UEs do not want to share the channels with D2D UEs. As D2D communication is an underlay to the primary cellular networks, the concept of the Stackelberg game is well suited for the system. The Stackelberg game is hierarchical, and has a leader and a follower. The leader acts first, and then the follower observes the leader's behavior and decides his strategy. The Stackelberg game has been employed in cooperative networks <ref type="bibr" target="#b6">[7]</ref> and cognitive radio networks <ref type="bibr" target="#b7">[8]</ref>, <ref type="bibr" target="#b8">[9]</ref>. In our proposed Stackelberg game, the cellular UEs are viewed as leaders and the D2D UEs are followers. We group cellular and D2D UEs into leaderfollower pairs. The leader charges some fees for the follower using the channel. We analyze the optimal price for the leader and the optimal power for the follower. The strategies lead to a Stackelberg equilibrium. Then, we propose a joint scheduling and resource allocation algorithm. The leader-follower pairs form a priority queue based on their utilities, and the system schedules the D2D UEs according to their orders in the queue.</p><p>The rest of the paper is organized as follows. In Section II, we illustrate the system model of D2D communication as an underlay to cellular networks. In Section III, we construct the Stackelberg game and analyze the equilibrium. In Section IV, we develop the joint scheduling and resource allocation scheme. In Section V, we present several simulation results. Finally, we conclude in Section VI.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>II. SYSTEM MODEL</head><p>We consider a single cell scenario with multiple UEs and one eNB located at the center of the cell. Both the UEs and the eNB are equipped with a single omni-directional antenna. The system includes two types of UEs, D2D UEs and cellular UEs. The D2D UEs are in pairs, each consisting of one transmitter and one receiver. We consider a dense D2D environment, where the number of cellular UEs and D2D UEs is K and D (D &gt; K), respectively. The set of cellular UEs and D2D pairs is K and D, respectively. There are K orthogonal channels, which is occupied by the corresponding cellular UEs. The channels allocated to the cellular UEs are fixed, and D2D communications share the channels with cellular UEs. One channel is only allowed to be used by one cellular UE and one D2D UE. In LTE, scheduling takes place every transmission time interval (TTI) <ref type="bibr" target="#b9">[10]</ref>, which consists of two time slots. Channels are allocated among D2D UEs according to their priority. During each TTI, K D2D pairs are selected to share the K channels with the cellular UEs while other D2D UEs wait for transmission.</p><p>A scenario of uplink resource sharing is illustrated in Fig. <ref type="figure" target="#fig_0">1</ref>, which includes one cellular UE (UE 1 ) and two D2D pairs (UE 2 and UE 3 , UE 4 and UE 5 ). UE 2 and UE 4 are transmitters while UE 3 and UE 5 are receivers. The two D2D UEs in a pair are close enough to satisfy the maximum distance constraint of D2D communication, in order to guarantee the quality of D2D services. D2D pair 1 is selected to share the channel resource with UE 1 whereas D2D pair 2 cannot transmit. During the uplink period of the cellular network, UE 1 transmits data to the eNB, while the eNB suffers interference from UE 2 . Also, the D2D pair 1 is in communication while UE 3 are exposed to interference from UE 1 .</p><p>During the downlink period, the cellular UE receives data from the eNB and interference from D2D transmitter sharing the same channel. The D2D receivers suffer interference from the eNB. The transmit power of eNB is too large, causing serious interference to the D2D UEs, so it is hard to guarantee the quality of D2D services. Therefore, we focus on the uplink frame of the network.</p><p>We define a set of binary variables {x ik }(i ∈ D, k ∈ K) to denote the current D2D pair in communication. x ik = 1 if the i-th D2D pair is selected to use channel k; and x ik = 0 otherwise. Based on the analysis above, during the uplink period, the k-th cellular UE transmits s k to the eNB, and the i-th D2D transmitter transmits s i . The received signals at the eNB and D2D receiver i are written as</p><formula xml:id="formula_0">y c k = √ p k g ke s k + D i=1 x ik √ p i g ie s i + n k , (<label>1</label></formula><formula xml:id="formula_1">)</formula><formula xml:id="formula_2">y d i = √ p i g ii s i + K k=1 x ik √ p k g ki s k + n i ,<label>(2)</label></formula><p>where p k and p i is the transmit power of the k-th cellular UE and the i-th D2D transmitter, respectively. g ki denotes the channel gain between the k-th cellular UE and the i-th D2D receiver. g ii denotes the channel gain between the i-th D2D transmitter and the i-th D2D receiver, which are in a pair. g ke is the channel gain between cellular UE k and the eNB, and g ie is the channel gain between D2D transmitter i and the eNB. n k and n i is the additive white Gaussian noise (AWGN). Without loss of generality, we assume all UEs observe the same noise power N 0 . The received SINR at the i-th D2D receiver can be expressed as</p><formula xml:id="formula_3">γ d i = p i g ii k x ik p k g ki + N 0 , (<label>3</label></formula><formula xml:id="formula_4">)</formula><p>The SINR at the eNB corresponding to cellular UE k is</p><formula xml:id="formula_5">γ c k = p k g ke i x ik p i g ie + N 0 . (<label>4</label></formula><formula xml:id="formula_6">)</formula><p>The channel rate of UEs is obtained by</p><formula xml:id="formula_7">r = log 2 (1 + γ).<label>(5)</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>III. STACKELBERG GAME</head><p>As D2D communication takes place underlaying the primary cellular network, we focus on the power control and scheduling of the D2D UEs, while the transmit power and channel of the cellular UE are assumed to be fixed. D2D communication can utilize the proximity between UEs to improve the throughput performance of the system. In the meanwhile, the interference from D2D network to the cellular network should be limited. Thus, the transmit power of the D2D UEs should be properly controlled. Another goal is to guarantee the fairness among D2D UEs when scheduling.</p><p>Interactions among the selfish cellular and D2D UEs sharing a channel can be modeled as a non-cooperative game using the game theory framework. When the players choose their strategies independently without any coordination, it usually leads to an inefficient outcome. If we simply model the D2D scenario as a noncooperative game, D2D UEs will choose to use the maximum transmit power to maximize their own payoffs regardless of other players, whereas cellular UEs will choose not to share the channel resources with D2D UEs. This is an inefficient outcome, as the interference is too serious or D2D cannot get access into the network.</p><p>Therefore, we employ the Stackelberg game to coordinate the scheduling, in which the cellular UEs are the leaders and the D2D UEs are the followers. We focus on the behavior of a one-leader one-follower pair. The leader owns the channel resource and it can charge the D2D UE some fees for using the channels. The fees are fictitious money to coordinate the system. Thus, the cellular UE has an incentive to share the channel with the D2D UE if it is profitable, and the leader has the right to decide the price. For the D2D UE, under the charging price, it can choose the optimal power to maximize its payoff. In this way, an equilibrium can be reached.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Utility Functions</head><p>We analyze the behavior of a one-leader one-follower pair, which includes cellular UE k as the leader, and D2D pair i as the follower. The utility of the leader can be defined as its own throughput performance plus the gain it earns from the follower. The fee should be decided according to the leader's own consideration. Thus, we set the fee proportional to the interference the leader observe. The utility function of the leader can be expressed as</p><formula xml:id="formula_8">u k (α k , p i ) = log 2 1 + p k g ke p i g ie + N 0 + α k βp i g ie , (<label>6</label></formula><formula xml:id="formula_9">)</formula><p>where α k is the charging price (α k &gt; 0). β is a scale factor to denote the ratio of the leader's gain and the follower's payment (β &gt; 0). β is a key parameter to influence the outcome of the game, which we will discuss later. The optimization problem for the leader is to set a charging price that maximizes its utility, i.e.,</p><formula xml:id="formula_10">max u k (α k , p i ), s.t. α k &gt; 0.<label>(7)</label></formula><p>For the follower, the utility is its throughput performance minus the cost it pays for using the channel, which can be expressed as</p><formula xml:id="formula_11">u i (α k , p i ) = log 2 1 + p i g ii p k g ki + N 0 -α k p i g ie . (<label>8</label></formula><formula xml:id="formula_12">)</formula><p>The optimization problem for the follower is to set proper transmit power to maximize its utility, i.e.,</p><formula xml:id="formula_13">max u i (α k , p i ), s.t. p min ≤ p i ≤ p max . (<label>9</label></formula><formula xml:id="formula_14">)</formula><p>In the Stackelberg game, the leader moves first and the follower moves sequentially, i.e., the leader sets the price first, and the follower selects its best transmit power based on the price. The leader knows ex ante that the follower observes its action. The game can be solved by backward induction.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Follower Analysis</head><p>Given α k decided by the leader, when p i approaches 0, the utility approaches 0 as well. As p i increases, u i also increases. If p i grows too large, u i will begin to decrease since the logarithmic function grows slower than the cost. The follower wants to maximize its utility by choosing proper transmit power. The best response is derived by solving</p><formula xml:id="formula_15">∂u i ∂p i = 1 ln 2 g ii p i g ii + p k g ki + N 0 -α k g ie = 0. (<label>10</label></formula><formula xml:id="formula_16">)</formula><p>The solution is</p><formula xml:id="formula_17">pi = 1 α k g ie ln 2 - p k g ki + N 0 g ii . (<label>11</label></formula><formula xml:id="formula_18">)</formula><p>The second order derivative is</p><formula xml:id="formula_19">∂ 2 u i ∂p 2 i = - 1 ln 2 g ii p i g ii + p k g ki + N 0 2 &lt; 0.<label>(12)</label></formula><p>Thus, the solution in (11) is a maximum point. From (11), we know the power is monotonically decreasing with α k , which means when the price is higher, the amount of power bought is smaller. Note that p min ≤ p i ≤ p max , thus, the best response is searched in {p min , p max , pi }.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C. Leader Analysis</head><p>The leader knows ex ante that the follower will react to his price by searching in {p min , p max , pi }. If the leader sets the price too low, the follower will only buy p max , and the leader will earn more if it raises the price. Besides, the price is restricted to be set too high, to prevent inefficient outcome. Thus, the leader will set a price such that p min ≤ pi ≤ p max . Solving the inequations, we have</p><formula xml:id="formula_20">α kmin = g ii (g ii p max + p k g ki + N 0 )g ie ln 2 , (<label>13</label></formula><formula xml:id="formula_21">)</formula><formula xml:id="formula_22">α kmax = g ii (g ii p min + p k g ki + N 0 )g ie ln 2 , (<label>14</label></formula><formula xml:id="formula_23">)</formula><p>and</p><formula xml:id="formula_24">α kmin ≤ α ≤ α kmax .</formula><p>Substituting the follower's strategy (11) into the leader's utility function, we get</p><formula xml:id="formula_25">u k (α k ) = β ln 2 -α k βg ie p k g ki + N 0 g ii + log 2 1 + p k g ke 1 α k ln 2 -g ie p k g ki + N 0 g ii + N 0 -1 . (<label>15</label></formula><formula xml:id="formula_26">)</formula><p>There is a tradeoff between the gain from the leader itself and the gain from the follower. When the leader raises the price, it will gain less from the follower according to (15), but the follower will buy less power, which will lead to an increase in the leader's rate. Therefore, there is an optimal price for the leader to ask for.</p><formula xml:id="formula_27">Let A = p k g ke , B = 1/ln 2, C = -g ie (p k g ki + N 0 )/g ii + N 0 , we have u k (α k ) = log 2 1 + Aα k Cα k + B +(C -N 0 )βα k +Bβ. (<label>16</label></formula><formula xml:id="formula_28">)</formula><p>To get the optimal price, by taking the first order derivative, we obtain</p><formula xml:id="formula_29">du k dα k = AB 2 (Cα k + B)[(A + C)α k + B] + (C -N 0 )β. (<label>17</label></formula><formula xml:id="formula_30">)</formula><p>We consider the following cases: 1) C = 0. The first order condition is</p><formula xml:id="formula_31">du k dα k = AB Aα k + B -N 0 β = 0. (<label>18</label></formula><formula xml:id="formula_32">)</formula><p>The solution is</p><formula xml:id="formula_33">αk = B N 0 β - B A . (<label>19</label></formula><formula xml:id="formula_34">)</formula><p>The second order derivative is</p><formula xml:id="formula_35">d 2 u k dα 2 k = -B A Aα k + B 2 &lt; 0.<label>(20)</label></formula><p>Note that α kmin = B/(p max g ie + N 0 -C) and α kmax = B/(p min g ie + N 0 -C). Thus, the optimal α k is searched in {α k , α kmin , α kmax }.</p><p>2) A+C = 0. The optimal price α k can be solved similarly. The solution is searched in</p><formula xml:id="formula_36">{ B A - B (A+N0)β , α kmin , α kmax }. If C = 0 and A + C = 0, we denote f (α k ) = (Cα k + B)[(A + C)α k + B],</formula><p>which is a quadratic function of α k . We notice that roots for the f (α k ) are α k1 = -B C and α k2 = -B A+C . From α k ≤ α kmax , we get (C -N 0 )α k + B ≥ 0. Thus, Cα k + B &gt; 0 and (A + C)α k + B &gt; 0. We discuss the following three cases based on the sign of C and A + C.</p><p>3) C &gt; 0. We have α k ≥ α kmin &gt; 0 &gt; α k2 &gt; α k1 . f (α k ) is monotonically increasing with α k and f (α k ) &gt; 0 for α k &gt; α kmin . Thus, the first order derivative of the utility u k (α k ) is monotonically decreasing with α k and it follows lim</p><formula xml:id="formula_37">α k →∞ u k (α k ) = (C-N 0 )β &lt; 0. If u k (α kmin ) ≤ 0, it satisfies that u k (α k ) ≤ 0, α k ∈ [α kmin , α kmax ].</formula><p>Thus, the optimal price is α kmin . Otherwise, if u k (α kmin ) &gt; 0, there exists a unique point such that</p><formula xml:id="formula_38">u k (α k ) = 0. Solving u k (α k ) = 0 gives α k = -B(A + 2C) ± √ Δ 2C(A + C) , (<label>21</label></formula><formula xml:id="formula_39">)</formula><p>where</p><formula xml:id="formula_40">Δ = AB 2 A + 4C(A + C) 1 (N 0 -C)β .</formula><p>The maximum point must be the larger root or on the boundary of the feasible region of α.</p><p>4) C &lt; 0 and A + C &gt; 0. We have</p><formula xml:id="formula_41">α k2 &lt; 0 &lt; α kmin ≤ α k &lt; α k1 , and f (α k ) &gt; 0. If min u k (α k ) ≤ 0, α k ∈ [α kmin , α kmax ],</formula><p>with α k increasing, u 0 (α k ) is increasing, decreasing, and increasing sequentially. Thus, the maximum point is either on the maximum boundary of the feasible region, or is the smaller root of u k (α k ) = 0, i.e.,</p><formula xml:id="formula_42">α k = -B(A + 2C) + √ Δ 2C(A + C) . (<label>22</label></formula><formula xml:id="formula_43">) Otherwise, u k (α k ) is increasing with α k , the maximum point is α kmax . 5) A + C &lt; 0. We have 0 &lt; α k &lt; α k1 &lt; α k2 , f (α k ) &gt; 0 and u k (α k</formula><p>) is monotonically increasing with α k . Thus, there does not exist an maximum point within the feasible region. By similar analysis, we derive the optimal price α k is on the boundary of the feasible region.</p><p>Based on the discussion above, the optimal α k can be uniquely decided. The strategies of the leader and the follower construct a Stackelberg equilibrium defined below.</p><p>Definition 1: A pair of strategies (α k , p i ) is a Stackelberg equilibrium if no unilateral deviation in strategy by the leader or the follower is profitable, i.e.,</p><formula xml:id="formula_44">u i (α k , p i ) ≥ u i (α k , p i ), (<label>23</label></formula><formula xml:id="formula_45">)</formula><formula xml:id="formula_46">u k (α k , p i (α k )) ≥ u k (α k , p i (α k )). (<label>24</label></formula><formula xml:id="formula_47">)</formula><p>Joint D2D Scheduling and Resource Allocation Algorithm 1: Given CSI, TTI t, the scale factor β, the fairness coefficient δ, and the additional cost ci(t), ∀i.</p><formula xml:id="formula_48">2: Initialize x ik = 0, ∀i, k. 3: Search the optimal α * ik , ∀i, k in B pmaxgie + N0 -C , B pmingie + N0 -C , and B N0β - B A , B A - B (A + N0)β , -B(A + 2C) + √ Δ 2C(A + C) .</formula><p>4: Calculate the optimal power</p><formula xml:id="formula_49">p * ik = 1 α * ik gie ln 2 - p k g ki + N0 gii , ∀i, k.</formula><p>5: Calculate priorities</p><formula xml:id="formula_50">P ik = log 2 1 + p * ik gii p k g ki + N0 -α * ik giep * ik -ci(t), ∀i, k.</formula><p>6: Sort P ik in descending order to form a priority queue. 7: while i x ik = 0, ∃k do 8:</p><p>Select the head of the queue. The pair is(i * , k * ).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>9:</head><p>if i x ik * = 0 and k x i * k = 0 then 10:</p><p>Schedule the pair (i * , k * ).</p><p>11:</p><formula xml:id="formula_51">Set x i * k * = 1 and ci * (t + 1) = ci * (t) + δu i * k * .</formula><p>12:</p><formula xml:id="formula_52">end if 13:</formula><p>Delete the head of the queue. 14: end while Algorthm 1. Joint scheduling and resource allocation algorithm.</p><p>The equilibrium is a stable outcome of the Stackelberg game where the leader and the follower compete through selfoptimization and reach a point where no player wishes to deviate. The analysis of the leader and the follower above shows the existence and uniqueness of the Stackelberg equilibrium.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>IV. JOINT SCHEDULING AND RESOURCE ALLOCATION</head><p>The scheduling process is conducted at each TTI. The D2D UEs form a priority queue for each channel. During each TTI, the eNB selects K D2D UEs with the highest priority for each channel sequentially and other D2D UEs have to wait.</p><p>In our Stackelberg game framework, the priority is based on the utilities of the followers, which express the satisfaction of the followers. In the design of scheduling scheme, fairness is considered as an important goal. The scheme should take the outcome in the previous TTIs into account. This can be achieved by adjusting prices for using the channel. The follower has to pay an additional fee for using the channel at TTI t if it has been selected in previous TTIs, which will lead to a decrease in the priority. The additional fee is decided by the cumulative utility of follower. The priority for follower i at TTI t can be defined as</p><formula xml:id="formula_53">P ik (t) = u i (α * k (t), p * i (t)) -c i (t),<label>(25)</label></formula><p>where α * k (t) and p * i (t) are the optimal strategy pair under the Stackelberg equilibrium at TTI t. c i (t) is the additional cost, and can be defined as</p><formula xml:id="formula_54">c i (t) = t-1 τ =0 K k=1 δx ik (τ )u i (α * k (τ ), p * i (τ )),<label>(26)</label></formula><p>where δ &gt; 0 is the fairness coefficient. For a larger δ, the cumulative utility has a larger influence on the priority. If δ = 0, the scheduling scheme does not take fairness into account. Based on the above discussion, during each TTI, every cellular UE and D2D UE form a leader-follower pair and play the Stackelberg game. The optimal price and power can be decided for each pair. The priority for each pair can be calculated and they form a priority queue. Then, the eNB schedules the D2D pairs sequentially according to their order in the queue. If there is a tie, that one channel has been allocated to another D2D pair, or the D2D pair has been scheduled to another channel, the pair is skipped. When each channel is allocated to one D2D pair, the eNB record the outcome and the scheduling is over. The algorithm is summarized in Algorithm 1.</p><p>The algorithm has a low complexity, as the optimal strategy for each leader-follower pair is searched in a set with a constant number of elements. To form the priority queue with length K × D, the complexity is O(KD).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>V. SIMULATION RESULTS</head><p>To evaluate the performance of the proposed algorithm, we perform several simulations. We consider a single circular cell environment. The cellular UEs and D2D pairs are uniformly distributed in the cell. The two D2D UEs in a D2D pair are close enough to satisfy the maximum distance constraint of D2D communication. The received signal power is</p><formula xml:id="formula_55">P i = P j d -2 ij |h ij | 2</formula><p>, where P i and P j are received power and transmit power, respectively. d ij is the distance between the transmitter and the receiver. h ij represents the complex Gaussian channel coefficient that satisfies h ij ∼ CN (0, 1). The scheduling takes place every TTI. Simulation parameters are summarized in TABLE <ref type="table">I</ref>.</p><p>In Fig. <ref type="figure" target="#fig_1">2</ref>, we study the effect of the fairness coefficient δ. We plot cumulative distribution function (CDF) of UE rate. δ has little effect on the performance of the cellular UEs. For a small δ, D2D UE rate is distributed in a large  range, and has a tendency to converge with a larger δ. Thus, scheduling with a larger δ achieves better fairness. If we set δ too large, the scheduling algorithm behaves like the Round Robin scheduling, in which the previous utility is the deciding factor and the utility of the current TTI has little influence. If D2D scheduling is not considered, there will be only C D2D pairs that can get access to the network, resulting in 1 -C/D proportion of D2D UEs cannot achieve any data transmission. In Fig. <ref type="figure">3</ref> and Fig. <ref type="figure">4</ref>, we plot CDF of UE transmit power and UE rate under different scale factor β, respectively. β is the ratio of the leader's gain and the follower's payment. For a larger β, the payment for the follower is relatively lower, and thus, the follower will choose larger transmit power. This is illustrated in Fig. <ref type="figure">3</ref>. With larger transmit power of D2D UEs, the rate of D2D UEs is larger. In the meanwhile, D2D UEs cause more interference to cellular UEs, causing a decrease in the rate of cellular UEs. This effect is illustrated in Fig. <ref type="figure">4</ref>. We can also observe that D2D UEs use a much smaller transmit power than the cellular UEs.</p><p>In Fig. <ref type="figure" target="#fig_3">5</ref> and Fig. <ref type="figure" target="#fig_4">6</ref>, we plot average rate of UEs and system sum rate with different numbers of cellular UEs, respectively. Fig. <ref type="figure" target="#fig_3">5</ref> shows that when the number of cellular UEs increases, the rate performance of D2D UEs is improved. This is due to the fact that D2D UEs has more resources to use. We observe that when C = 10, the rate performance of D2D UEs is much better than that of cellular UEs. The effect of scale factor β and fairness coefficient δ is shown clearly in the two figures. It can be seen that the interference is properly managed and the cellular UEs achieve a reasonable rate performance. Besides, as there are C resources and D D2D UEs, the average transmission time of D2D UEs is D/C of that of cellular UEs. In Fig. <ref type="figure" target="#fig_3">5</ref>, we observe that D2D UEs achieve a similar or higher rate with cellular UEs. The D2D communication obviously has higher efficiency.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>VI. CONCLUSION</head><p>In this paper, we developed a Stackelberg game framework for joint power control, channel allocation and scheduling of D2D communication. We analyzed the optimal strategy for the constructed game, and proposed an algorithm to allocate resources and schedule D2D UEs. Throughput, interference management and fairness of the system were considered. Simulation results show that the proposed algorithm can achieve a good throughput performance for both the cellular and the D2D UEs. The D2D UEs can be fairly served. The scale factor β and fairness coefficient δ have an important effect on the performance of the algorithm. It is also shown that D2D communication can improve the throughput of the system. </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. System model of D2D underlay communication with uplink resource sharing. UE 1 is a cellular user whereas UE 2 and UE 3 , UE 4 and UE 5 are D2D UEs.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>CellularFig. 2 .</head><label>2</label><figDesc>Fig. 2. UE rate distribution under different δ.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 3 .Fig. 4 .</head><label>34</label><figDesc>Fig. 3. UE power distribution under different β.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 5 .</head><label>5</label><figDesc>Fig. 5. Cellular and D2D average UE rate with different number of cellular UEs.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 6 .</head><label>6</label><figDesc>Fig.6. System sum rate with different numbers of cellular UEs.</figDesc></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>ACKNOWLEDGMENT This work was partially supported by National Nature Science Foundation of China under grant number 61061130561 and 61222104, the Ph.D. Programs Foundation of Ministry of Education of China under grant number 20110001120129, DOCOMO Beijing Communications Labs research fund, US National Science Foundation funding CNS-1265268, CNS-1117560, ECCS-1028782, CNS-0953377, and Qatar National Research Fund.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Deviceto-device communication as an underlay to LTE-advanced networks</title>
		<author>
			<persName><forename type="first">K</forename><surname>Doppler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Rinne</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Wijting</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Ribeiro</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Hugl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Commun. Mag</title>
		<imprint>
			<biblScope unit="volume">47</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="42" to="49" />
			<date type="published" when="2009-12">Dec. 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">On the performance of device-to-device underlay communication with simple power control</title>
		<author>
			<persName><forename type="first">C.-H</forename><surname>Yu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Tirkkonen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Doppler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Ribeiro</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE 69th Vehicular Technology Conference Spring</title>
		<meeting>IEEE 69th Vehicular Technology Conference Spring<address><addrLine>Barcelona</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2009-04">Apr. 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Power optimization of device-to-device communication underlaying cellular communication</title>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE International Conference on Communications</title>
		<meeting>IEEE International Conference on Communications<address><addrLine>Dresden</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2009-06">Jun. 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Efficient resource allocation for device-to-device communication underlaying LTE network</title>
		<author>
			<persName><forename type="first">M</forename><surname>Zulhasnine</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Huang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Srinivasan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE 6th International Wireless and Mobile Computing, Networking and Communications Conference</title>
		<meeting>IEEE 6th International Wireless and Mobile Computing, Networking and Communications Conference<address><addrLine>Niagara Falls</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2010-10">Oct. 2010</date>
			<biblScope unit="page" from="368" to="375" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Interferenceaware resource allocation for device-to-device communications as an underlay using sequential second price auction</title>
		<author>
			<persName><forename type="first">C</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Han</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Q</forename><surname>Zhao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Jiao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE International Conference on Communications</title>
		<meeting>IEEE International Conference on Communications<address><addrLine>Ottawa</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2012-06">Jun. 2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Resource allocation using a reverse iterative combinatorial auction for device-to-device underlay cellular networks</title>
		<author>
			<persName><forename type="first">C</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Han</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Jiao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE Global Communications Conference</title>
		<meeting>IEEE Global Communications Conference<address><addrLine>Anaheim</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2012-12">Dec. 2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Distributed relay selection and power control for multiuser cooperative communication networks using buyer/seller game</title>
		<author>
			<persName><forename type="first">B</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Han</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">J R</forename><surname>Liu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. 26th IEEE International Conference on Computer Communications</title>
		<meeting>26th IEEE International Conference on Computer Communications<address><addrLine>Barcelona</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2007-05">May 2007</date>
			<biblScope unit="page" from="544" to="552" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Stackelberg game for utility-based cooperative cognitiveradio networks</title>
		<author>
			<persName><forename type="first">J</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Q</forename><surname>Zhang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. ACM International Symposium on Mobile ad hoc Networking and Computing</title>
		<meeting>ACM International Symposium on Mobile ad hoc Networking and Computing<address><addrLine>New Orleans</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2009-05">May 2009</date>
			<biblScope unit="page" from="23" to="32" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">A Stackelberg game for power control and channel allocation in cognitive radio networks</title>
		<author>
			<persName><forename type="first">M</forename><surname>Bloem</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Alpcan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Bas ¸ar</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. International Conference on Performance Evaluation Methodologies and Tools</title>
		<meeting>International Conference on Performance Evaluation Methodologies and Tools<address><addrLine>Dresden</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2007-10">Oct. 2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title level="m" type="main">Evolved cellular network planning and optimization for UMTS and LTE</title>
		<author>
			<persName><forename type="first">L</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Shen</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2010">2010</date>
			<publisher>CRC Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
