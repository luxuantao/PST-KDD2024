<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">LightNet: A Dual Spatiotemporal Encoder Network Model for Lightning Prediction</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Yangli-Ao</forename><surname>Geng</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Qingyong</forename><surname>Li</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Tianyang</forename><surname>Lin</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Lei</forename><surname>Jiang</surname></persName>
							<email>leijiang@bjtu.edu.cn</email>
						</author>
						<author>
							<persName><forename type="first">Liangtao</forename><surname>Xu</surname></persName>
						</author>
						<author>
							<persName><forename type="first">Dong</forename><surname>Zheng</surname></persName>
							<email>zhengdong@cma.gov.cn</email>
						</author>
						<author>
							<persName><forename type="first">Wen</forename><surname>Yao</surname></persName>
							<email>yaowen@cma.gov.cn</email>
						</author>
						<author>
							<persName><forename type="first">Weitao</forename><surname>Lyu</surname></persName>
							<email>wtlyu@cma.gov.cn</email>
						</author>
						<author>
							<persName><forename type="first">Yijun</forename><surname>Zhang</surname></persName>
							<email>zhangyijun@fudan.edu.cn</email>
						</author>
						<author>
							<persName><surname>Lightnet</surname></persName>
						</author>
						<author>
							<affiliation key="aff0">
								<orgName type="laboratory">Beijing Key Lab of Traffic Data Analysis and Mining</orgName>
								<orgName type="institution">Beijing Jiaotong University</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff1">
								<orgName type="laboratory">State Key Laboratory of Severe Weather</orgName>
								<orgName type="institution">Chinese Academy of Meteorological Sciences</orgName>
								<address>
									<settlement>Beijing</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<affiliation key="aff2">
								<orgName type="department">Department of Atmospheric and Oceanic Sciences</orgName>
								<orgName type="institution">Fudan University Shanghai</orgName>
								<address>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">LightNet: A Dual Spatiotemporal Encoder Network Model for Lightning Prediction</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1145/3292500.3330717</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.2" ident="GROBID" when="2022-12-25T13:41+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Spatiotemporal data mining</term>
					<term>Lightning Prediction</term>
					<term>Deep learning</term>
					<term>Time series prediction</term>
					<term>Convolutional Neural Network</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Lightning as a natural phenomenon poses serious threats to human life, aviation and electrical infrastructures. Lightning prediction plays a vital role in lightning disaster reduction. Existing prediction methods, usually based on numerical weather models, rely on lightning parameterization schemes for forecasting. These methods, however, have two drawbacks. Firstly, simulations of the numerical weather models usually have deviations in space and time domains, which introduces irreparable biases to subsequent parameterization processes. Secondly, the lightning parameterization schemes are designed manually by experts in meteorology, which means these schemes can hardly benefit from abundant historical data. In this work, we propose a data-driven model based on neural networks, referred to as LightNet, for lightning prediction. Unlike the conventional prediction methods which are fully based on numerical weather models, LightNet introduces recent lightning observations in an attempt to calibrate the simulations and assist the prediction. LightNet first extracts spatiotemporal features of the simulations and observations via dual encoders. These features are then combined by a fusion module. Finally, the fused features are fed into a spatiotemporal decoder to make forecasts. We conduct experimental evaluations on a real-world North China lightning dataset, which shows that LightNet achieves a threefold improvement in equitable threat score for six-hour prediction compared with three established forecast methods.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">INTRODUCTION</head><p>Lightning is a typical feature of severe weather that is a significant source of concern for public safety and a wide range of weather sensitive operations <ref type="bibr" target="#b23">[24]</ref>. According to an investigation conducted by Curran et al. <ref type="bibr" target="#b4">[5]</ref>, lightning is near the top of the list of all types of weather-related deaths. On the other hand, lightning also poses a serious threat to the physical environment, such as wildfires, power failures, air traffic disruption, and damage to telecommunication infrastructure <ref type="bibr" target="#b16">[17]</ref>.</p><p>The undoubted importance of lightning has driven significant interest in the prediction of this natural hazard <ref type="bibr" target="#b6">[7]</ref>. Preliminary studies focus on understanding the electrification mechanism of lightning <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b11">12,</ref><ref type="bibr" target="#b17">18]</ref>. These researches provide basic theory and routes for the prediction of lightning. On the other hand, the development of computing technology gave rise to a modern prediction tool, numerical weather prediction (NWP) system. Given initial conditions, an NWP system can simulate atmospheric evolution for the future. Though this tool can provide simulated atmospheric parameters such as ice mixing ratio and snow mixing ratio <ref type="bibr" target="#b7">[8]</ref>, it does not directly support lightning prediction. Therefore, researchers proposed lightning parameterization schemes to convert the simulated parameters into the probability of lightning occurrence <ref type="bibr" target="#b13">[14,</ref><ref type="bibr" target="#b15">16,</ref><ref type="bibr" target="#b23">24]</ref>. In recent years, with the success of deep neural networks (DNNs), some researches have applied DNNs to precipitation <ref type="bibr" target="#b20">[21]</ref> and radar echo <ref type="bibr" target="#b31">[32]</ref> nowcast. These methods can nowcast weather distribution for a short period (e.g. three hours) based on recent weather observations, but their performance may drop for longer prediction.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Time Now Prediction</head><p>Figure <ref type="figure" target="#fig_0">1</ref>: A sketch map of the spatiotemporal prediction for lightning.</p><p>Despite the extensive research into lightning, the spatiotemporal prediction for it (see Figure <ref type="figure" target="#fig_0">1</ref>) still poses a challenge. The difficulties come from three aspects. Firstly, given the inconstancy of thunderstorms, the performance of nowcasting methods based on recent weather observations degenerate for long-period prediction. Secondly, the simulation of the NWP systems often shows deviations in the time and space domain, which introduce irreparable biases to prediction methods based on the simulation. For example, the simulated parameters of the southeast for 7:00 may be the real situation of the south for 8:00. Thirdly, the errors in the simulation demonstrate different patterns in different spatiotemporal locations, which make it hard to calibrate the simulation. For instance, the simulated weather parameters in high latitude area may have a positive bias, but the bias may be negative in low latitude area. Furthermore, the sign of bias may change with time. Though recent lightning observation data is capable of calibrating the simulation, it is hard to bridge their relation due to complex spatiotemporal correspondences between them.</p><p>To meet the above-mentioned challenges, we propose LightNet, a data-driven lightning prediction model based on deep neural networks. Unlike the existing methods, which exploit either simulation data (commonly used in conventional prediction methods) or recent weather observation data (often used in extrapolation methods), LightNet makes predictions based on both of them. LightNet extracts spatiotemporal features of the simulation and the observation via dual encoders. Then, these features are combined by a fusion module. Finally, the fused features are fed into a spatiotemporal decoder to make forecasts. LightNet has demonstrated superior performance for lightning prediction without complex feature selection process and tuning trick. To summarize, our contributions include four aspects: (4) In our experiment, we used a real-world lightning of North China dataset to evaluate LightNet, which achieved threefold improvements in equitable threat score compared with three established prediction methods.</p><p>The rest of this paper is organized as follows. In Section 2, we discuss the related works. Section 3 introduces the preparatory work. Section 4 details the proposed LightNet framework. Experimental results are demonstrated in Section 5. Finally, we conclude this paper and suggest future work in Section 6.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">RELATED WORKS</head><p>Lightning Prediction. Generally speaking, modern lightning prediction methods fall into three categories <ref type="bibr" target="#b30">[31]</ref>: numerical diagnosis prediction based on synoptic background filed statistical relations; the numerical weather model coupled with the explicit electrification and lightning parameterization schemes; and flash rate parameterization. Here, we focus on prediction methods based on the flash rate parameterization, which are widely used in the real world and served as our baseline. As a pioneering work, Price et al. <ref type="bibr" target="#b15">[16]</ref> bridged the relation between lightning frequency and maximum vertical velocity (or convective cloud top height), and propose the well-known PR92 lightning parameterization scheme. Michalon et al. <ref type="bibr" target="#b13">[14]</ref> proposed a new parameterization by combining PR92 and cloud droplet concentration. Deierling et al. <ref type="bibr" target="#b5">[6]</ref> used groundbased dual-polarimetric radar and total lightning data to investigate the relationship between total lightning activity and precipitation ice mass on a storm scale. Jr et al. <ref type="bibr" target="#b23">[24]</ref> proposed two approaches based on the upward fluxes of precipitating ice hydrometeors in the mixed-phase region and the vertically integrated amounts of ice hydrometeors, respectively. They found that the first method is more capable of capturing time-dependent features of lightning while the second one owns superiority in forecasting lighting areas. Though lightning prediction has been researched extensively, its accuracy leaves much to be desired.</p><p>Weather Pattern Mining Based on Deep Learning. With its recent success in many walks of life, deep learning has boosted great interest in weather pattern mining. Some works focusing on weather pattern mining are relevant to our model. As pioneers in this field, Klein et al. <ref type="bibr" target="#b10">[11]</ref> proposed a new neural network layer called "dynamic convolutional layer" and applied it to short-term forecasting of location and intensity of rain and snow. To solve the problem of spatiotemporal dependency, Shi et al. <ref type="bibr" target="#b20">[21]</ref> developed the conventional LSTM and propose convolutional LSTM (ConvLSTM). Their experiments demonstrate that ConvLSTM outperforms the previous works on the grid-wise precipitation nowcasting task. Furthermore, they also proposed the trajectory GRU model <ref type="bibr" target="#b21">[22]</ref> that improves ConvLSTM by actively learning the recurrent connection structure. Liu et al. <ref type="bibr" target="#b12">[13]</ref> applied deep convolutional neural networks to detect extreme weather in large historical climate datasets. Wang et al. <ref type="bibr" target="#b31">[32]</ref> presented a predictive recurrent neural network (PredRNN) in the light of the idea that spatiotemporal predictive learning should memorize both spatial appearances and temporal variations in a unified memory pool. Their model has achieved state-of-the-art performance on a radar echo forecasting task. Our work focuses on lightning prediction, which is more challenging given the unstable development trend of thunderstorms. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Spatiotemporal Prediction Model in Deep</head><p>Learning. There are also some deep learning models focusing on spatiotemporal prediction tasks such as 3D ConvNets <ref type="bibr" target="#b28">[29]</ref>, PredCNN <ref type="bibr" target="#b26">[27]</ref>, DCRNN <ref type="bibr" target="#b25">[26]</ref> and StepDeep <ref type="bibr" target="#b19">[20]</ref>. To better model spatiotemporal information, 3D ConvNets <ref type="bibr" target="#b28">[29]</ref> extend conventional 2-dimensional convolution, which slides only in the spatial dimension, to 3-dimensional convolution, which moves in both spatial and temporal dimensions. PredCNN <ref type="bibr" target="#b26">[27]</ref> designs a cascade multiplicative unit and models the dependencies between the next frame and the spatiotemporal inputs by an entirely CNN based architecture. Traffic forecasting is one canonical example of spatiotemporal tasks. DCRNN <ref type="bibr" target="#b25">[26]</ref> models traffic flow as a diffusion process on a directed graph and introduces diffusion convolutional recurrent neural network for traffic forecasting. StepDeep <ref type="bibr" target="#b19">[20]</ref> formulates the problem of mobility event prediction as a spatiotemporal task and then designs a spatial-temporal progress cell to handle it. In summary, these approaches make predictions based on recent weather observations. By contrast, our model introduces simulation data besides the observation data, in a bid to enhance the prediction for a longer period.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">PRELIMINARY</head><p>We first review the framework of conventional prediction methods and contrast it with the proposed LightNet. Secondly, we introduce the Weather Research and Forecasting (WRF) model, which serves as our numerical weather prediction system. Thirdly, we detail the input data of LightNet. Finally, we define the problem to be solved.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Framework of Conventional Prediction</head><p>The framework of conventional lightning prediction methods is shown in the dotted box of Figure <ref type="figure" target="#fig_1">2</ref>. The historical weather collection includes daily-updated meteorological data measured by weather detection equipment such as satellites, radars and sounding aircraft. At first, the numerical weather prediction system is initialized by the data from the historical weather collection. After initialization, this system will compute and simulate the weather condition for the future. The simulation has a structure of grids, where each grid represents a spatial local area. Lastly, a lightning parameterization scheme is exploited to grid-wise convert the simulation to lightning forecasts.</p><p>As shown in Figure <ref type="figure" target="#fig_1">2</ref>, unlike conventional prediction methods, our LightNet model additionally introduces recent lightning observation data besides simulation data, with the goal of calibrating the simulation data and assisting the prediction. Notice that, due to the complex computation rules, the numerical weather prediction system cannot directly assimilate the observation data and calibrate itself.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Weather Research and Forecasting</head><p>The Weather Research and Forecasting (WRF<ref type="foot" target="#foot_0">1</ref> ) Model <ref type="bibr" target="#b22">[23]</ref> is a nextgeneration numerical weather prediction system designed for both atmospheric research and operational forecasting applications. The WRF model serves as a numerical weather prediction system to supply us the simulation data. In the present study, the WRF model, with a version 3.4.1, is initialized using data from the National Centers for Environmental Prediction (NCEP) global final (FNL) analysis data at a resolution of 1 • and six-hour intervals.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Data Description</head><p>Once the WRF model is initialized, it can run and simulate the weather condition for the future, where the weather condition is described by numerous meteorological parameters with a structure of grids. Here, we introduce the simulated parameters used in this work.</p><p>Simulated Micro-Physical Parameters. According to the recommendation in <ref type="bibr" target="#b23">[24]</ref>, three types of microphysical parameters, ice mixing ratio (QICE), snow mixing ratio (QSNOW) and graupel mixing ratio (QGRAUP), are selected in our study. QICE, QSNOW and QGRAUP present the ratio of the mass of ice, snow and graupel, respectively, per unit mass of dry air. Since all three parameters share THE same data structure, we only use QICE to illustrate. The simulated data of QICE can be described as a fourth-order tensor I , with three spatial indexes x, y, z (corresponding to longitude, latitude and altitude, respectively) and a temporal index t. Specifically, I</p><p>x,y,z t stores the simulated value of QICE in a grid with a spatial coordinate (x, y, z) and at a time scale t. For convenience, we use I t (a third-order tensor) to denote the slice at time t. Similarly, the simulated tensor of QSNOW and QGRAUP are denoted as S and G, respectively.</p><p>Simulated Radar Reflectivity. Radar reflectivity is a measure of the efficiency of a meteorological target (e.g. cloud, precipitation particles) in intercepting and returning radio energy. It is proportional to the number of drops per unit volume and the sixth power of drops' diameter and is thus used to estimate the rain or snow intensity <ref type="bibr" target="#b18">[19]</ref>. We introduce the radar reflectivity simulated by the WRF model to improve the lightning prediction. We denote this data by R, which shares the same structure with the microphysical parameters.</p><p>Simulated Maximum Vertical Velocity. Maximum vertical velocity is the maximum wind velocity in a vertical direction. Price and Rind <ref type="bibr" target="#b15">[16]</ref> found a strong relationship between the maximum vertical velocity and lightning activities. The simulated maximum vertical velocity is described by a third-order tensor V , with two spatial indexes x, y (the dimension z vanished due to the maximum operation) and a time index t.</p><p>Real-World Lightning Observations. In addition to the WRF simulated data, we also access real-world lightning observations, provided by China National Lightning Detection Networks <ref type="bibr" target="#b24">[25]</ref>. We denote this data by L, which is structured in the same way as the simulated maximum vertical velocity V . Specifically, L</p><p>x,y t is a binary value indicating whether lightning happened during the period of [t, t + 1).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Problem Definition</head><p>Given the WRF simulation data for next time slots and the lightning observation data for recent time slots, our goal is to predict the lightning activities for next time slots. We formally define the problem as below. Suppose the current moment is t = 0. We have access to the WRF simulation</p><formula xml:id="formula_0">[P t ] h t =0 (P t = [I t , S t , G t , R t , V t ]</formula><p>) and the recent lightning observations [L t ] −1 t =−s . Our task is to predict Lt h t =0 and make them as close as possible to [L t ] h t =0 , which is the real lightning observations for next time slots (i.e. [0, 1), [1, 2), . . . , [h, h + 1)). Specifically, our goal is to find a mapping f such that</p><formula xml:id="formula_1">min f loss [ Lt ] h t =0 , [L t ] h t =0 s. t. [ Lt ] h t =0 = f [P t ] h t =0 , [L t ] −1 t =−s<label>(1)</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">METHOD</head><p>In this section, we first introduce the convolutional long short-term memory (ConvLSTM) networks, which serve as a backbone of our model. Then we detail the proposed LightNet for spatiotemporal lightning prediction.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1">Convolutional Long Short Term Memory Networks</head><p>Convolutional long short-term memory (ConvLSTM) network is an extension of the popular fully connected long short-term memory (FC-LSTM) network, with a goal to overcome the drawbacks of FC-LSTM in handling spatial-temporal data such as videos <ref type="bibr" target="#b20">[21]</ref>. Specifically, in the ConvLSTM network, the fully-connected gates of the FC-LSTM module are replaced by convolutional gates thereby making it capable of encoding spatial-temporal features. Following the conventional notations, we let X t , H t , C t and Y t denote the input, hidden state, cell state, and output of the ConvLSTM network at the t-th moment, respectively. The equations characterizing the Conv-LSTM are shown as follows:</p><formula xml:id="formula_2">Z i t = σ (W xi * X t + W hi * H t −1 + W ci • C t −1 + B i ), Z f t = σ (W x f * X t + W hf * H t −1 + W c f • C t −1 + B f ), C t = Z f t • C t −1 + Z i t • tanh(W xc * X t + W hc * H t −1 + B c ), Y t = σ (W xy * X t + W hy * H t −1 + W cy • C t + B y ), H t = Y t • tanh(C t ) (2)</formula><p>where * , • and σ (•) denote the convolution operator, the Hadamard product and the logistic sigmoid function, respectively. W and B are trainable parameters whose sizes match the corresponding tensors.</p><p>Note that all the gate activation and the hidden states in ConvLSTM are three-dimensional tensors in contrast to vectors in FC-LSTM, which lose the natural spatial information.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.2">Model Architecture</head><p>Figure <ref type="figure" target="#fig_2">3</ref> illustrates the overall architecture of LightNet, comprising a WRF encoder, an observation encoder, a fusion module and a prediction decoder. Since the WRF simulation (for next six hours) and the lightning observations (for recent three hours) come from different time domains, LightNet introduces the WRF encoder and the observation encoder to convert the raw data into feature codes in a unified space for further combination. Then in this space, the WRF feature code and the observation feature code are fused via the fusion module. Finally, the prediction decoder is utilized to recursively decode the lightning predictions from the fused feature. We detail each component as follows.</p><p>WRF Encoder. The WRF encoder is responsible for encoding the WRF simulation data. We stack the microphysical parameters (S, I , G), the radar reflectivity (R) and the maximum vertical velocity (V ) along the z direction for each time slot. These parameters constitute the input of the WRF encoder. Specifically, we denote the input P = [P t ] h t =0 , where P t is defined as</p><formula xml:id="formula_3">P t = stack z ↑ (S t , I t , G t , R t , V t ).<label>(3)</label></formula><p>P has a large size due to the high resolution in x-y-z space. However, adjacent grids in this space usually share very similar value, which makes P somewhat redundant and increases the burden on model training. Therefore, we reduce the spatial resolution of P t through a convolution layer with a ReLU activation:</p><formula xml:id="formula_4">Pt = ReLU (W * P t + B) = Conv 1 (P t ).<label>(4)</label></formula><p>Then, the compact input P = Pt h t =0 is sent into a convLSTM network to obtain two WRF feature tensors:</p><formula xml:id="formula_5">C wr f , H wr f = convLSTM wr f ( P),<label>(5)</label></formula><p>where C wr f and H wr f denote the cell state and the hidden state of the last moment, respectively. The detailed calculation steps of (5) were presented in <ref type="bibr" target="#b1">(2)</ref>. Observation Encoder. The observation encoder is in charge of extracting the information within lightning observations for recent s periods (L = [L t ] −1 t =−s ). To be consistent with the WRF encoder, we also use a convolution layer to reduce the horizontal resolution of L:</p><formula xml:id="formula_6">Lt = Conv 2 (L t ).<label>(6)</label></formula><p>Then the compact representation L = Lt −1 t =−s is fed to a convL-STM network and it returns two observation feature tensors:</p><formula xml:id="formula_7">C obs , H obs = convLSTM obs ( L). (<label>7</label></formula><formula xml:id="formula_8">)</formula><p>Fusion Module. The WRF simulation data can provide longterm weather information for the future, but it usually shows deviation in space and time domains. On the other hand, the observation data can offer the lightning distribution estimation for short-term prediction (e.g. less than three hours), whereas its effect degenerates for long-term prediction. Therefore, we introduce the fusion module in order to improve the short-term prediction and calibrate long-term simulation. Especially, the WRF features ({C wr f , H wr f }) and observation features ({C obs , H obs }) are fused as</p><formula xml:id="formula_9">C f use = Conv 3 stack z ↑ (C wr f , C obs ) , H f use = Conv 4 stack z ↑ (H wr f , H obs ) . (<label>8</label></formula><formula xml:id="formula_10">)</formula><p>Prediction Decoder. The prediction decoder receives the fused features and makes predictions for the future. Considering chronological relation among these predictions, we employ a convLSTM network as the configuration of the prediction decoder. In addition, inspired by the method from machine translation <ref type="bibr" target="#b1">[2]</ref>, the prediction for the moment t will be sent as the input of forecasting for the moment t + 1. Specifically, at the moment t = 0, all variables are initialized as follows:</p><formula xml:id="formula_11">C −1 = C f use , H −1 = H f use , X 0 = Conv 5 (L −1 ).<label>(9)</label></formula><p>Notice that we introduce the last lightning observation L −1 as the initial input to provide a good "starting point" for the subsequent predictions. After loading the initial values, the prediction decoder will run following the calculation as shown in <ref type="bibr" target="#b1">(2)</ref>. In particular, the input and the prediction at a moment t &gt; 0 are specified as follows:</p><formula xml:id="formula_12">X t = Conv 5 ( Lt−1 ), Lt = softmax((Conv 6 (DeConv(Y t ))),<label>(10)</label></formula><p>where a deconvolution (DeConv) layer <ref type="bibr" target="#b14">[15]</ref> is used to recover the horizontal resolution of the prediction. The prediction decoder will recursively run h times and give predictions L = Lt h t =0 . The settings (the kernel size and stride) of each component of LightNet are detailed in Table <ref type="table" target="#tab_0">1</ref>. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.3">Implementation Details</head><p>The proposed neural networks are implemented with Keras<ref type="foot" target="#foot_1">2</ref> . All network parameters are initialized with a normal distribution. Weighted Loss Function. In our dataset, the number of positive samples (grids with lightning) is much smaller than the number of negative samples. To meet the challenge of sample imbalance, we select the weighted cross entropy as the loss function. Formally, given the ground truth L = [L t ] h t =0 and the predictions L = Lt h t =0 , the weighted cross entropy between them is computed as</p><formula xml:id="formula_13">loss(L, L) = − h t =0 x,y wL xy t log( Lxy t ) + (1 − L xy t ) log(1 − Lxy t ), (<label>11</label></formula><formula xml:id="formula_14">)</formula><p>where w is the weight of positive loss. We tune this hyper-parameter in {4, 8, 16, 32, 64} and find setting w = 16 achieves the best performance.</p><p>Training Details. We use Adaptive Moment Estimation (Adam) <ref type="bibr" target="#b9">[10]</ref> method to adapt learning rates. Adam essentially combines RMSProp <ref type="bibr" target="#b27">[28]</ref> with momentum. The initial learning rate is set to 0.0001 without dropout. We train our model for 50 epochs and select the model with the lowest validation loss.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5">EXPERIMENTS</head><p>In this section, we evaluate the proposed model on a real lightning dataset of North China. In Section 5.1, we introduce the details of the dataset. Section 5.2 introduces several baseline methods coming from meteorology and machine learning. Performance metrics are described in Section 5.3. Section 5.4 compares LightNet with baseline approaches. In Section 5.5, we visualize six representative examples for further analysis. Finally, we analyze the effect of different configuration on our model in Section 5.6. We conduct experiments on a 64-bit Ubuntu 16.04 computer with 18 Intel 2.68GHz CPUs, 256 GB memory, and 8 NVIDIA TITAN X GPUs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Dataset</head><p>Prediction Region. We access the data of a sub-region of North China from Chinese Academy of Meteorological Sciences 3 . Specifically, this region is a square with a center at 40°N and 116.2°E, which is divided into 159 × 159 grids and each grid has a resolution of 4km × 4km.</p><p>WRF Simulation Data. Due to the limitation of computing power, the WRF system can only provide four simulations in a day, at 0:00, 6:00, 12:00 and 18:00. Each simulation contains the weather parameter grids for the next 18 hours, with a time span of one hour. Each grid has nine vertical levels. We use the simulations for the first six hours since they have higher quality. The data covers June to September 2015 time period, and May to September in both 2016 and 2017.</p><p>Observation Data. The observation data shares the same spatiotemporal resolution and time period with the WRF simulation data.</p><p>Our task is to make lightning forecasts for future six hours (i.e., output Lt 5 t =0 ) based on six-hour WRF data ({P t } 5 t =0 ) and threehour observation data ({L t } −1 t =−3 ). We divide the total dataset by a ratio of 11:1:2 for training, validation and testing.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Baselines</head><p>To evaluate the effectiveness of our framework, we compare Light-Net with seven baselines. Among them, PR92, LF1 and LF2 are conventional prediction methods in meteorology, and others are data-driven models.</p><p>PR92. The PR92 method <ref type="bibr" target="#b29">[30]</ref> is the most well documented commonly used lightning parameterization scheme in meteorology. It relates lightning flash rates to the fifth-power of vertical updraft velocities as follows:</p><formula xml:id="formula_15">F = 5.7 × 10 −6 v 4.5 max .<label>(12)</label></formula><p>Here, v max is the maximum vertical velocity and F is lightning frequency (unit: min −1 ). LF1. The LF1 method developed by McCaul et al. <ref type="bibr" target="#b3">[4]</ref> forecasts flash rate as a linear function of graupel flux at −15 • C. The graupel 3 http://www.camscma.cn/.</p><p>Table <ref type="table">2</ref>: The detailed information for three performance metrics.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Name Equation Range Explanation POD</head><formula xml:id="formula_16">N 1 N 1 +N 3 [0,1]</formula><p>The ratio of the number of hit lightnings to the number of observed lightnings. FAR</p><formula xml:id="formula_17">N 2 N 1 +N 2 [0,1]</formula><p>The ratio of the number of false alarm lightnings to the number of foretasted lightnings. ETS</p><formula xml:id="formula_18">N 1 −R N −N 4 −R [− 1 3 , 1]</formula><p>The ratio of the number of hit lightnings to the number of events except for the correct rejections, and removed the contribution from hits by chance in random forecasts.</p><p>flux is the product of the upward vertical velocity and graupel mixing ratio. Specifically, the flash rate in LF1 is calculated as</p><formula xml:id="formula_19">F = 0.042(v −15 д −15 ),<label>(13)</label></formula><p>where v −15 and д −15 respectively denote the upward vertical velocity and graupel mixing ratio at −15 • C. LF2. The LF2 method <ref type="bibr" target="#b3">[4]</ref> builds the relation of flash rate to graupel, snow, and cloud ice mixing ratios (kg kg −1 ) within a grid column. Its expression is</p><formula xml:id="formula_20">F = 0.02 ∫ ρ(д z + s z + i z )dz,<label>(14)</label></formula><p>where д z , s z and i z respectively denote the graupel, snow, and cloud ice mixing ratios at height z.</p><p>GBDT. Gradient Boost Decision Tree (GBDT) is widely used in data mining applications these years. LightGBM <ref type="bibr" target="#b8">[9]</ref> is a state-of-art GBDT implementation used for supervised learning problems and has a good performance in many areas. We select LightGBM 2.0.4 as a baseline to predict the lightning.</p><p>StepDeep.</p><p>StepDeep <ref type="bibr" target="#b19">[20]</ref> is a prediction framework based on 3D ConvNets (3-dimensional convolutional networks), which are proposed for spatiotemporal feature learning using 3-dimensional (introducing time dimension) convolutional kernels. It demonstrated superiority for spatiotemporal mobility event prediction. We first extract the features of the WRF simulation data utilizing StepDeep, and then send the WRF features and the recent lightning observations into an additional CNN module to make the predictions.</p><p>LightNet-W. An incomplete LightNet in which observation encoder is removed.</p><p>LightNet-O. An incomplete LightNet in which WRF encoder is removed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Performance Metric</head><p>We evaluate the prediction results by three metrics: probability of detection (POD), false alarm ratio (FAR) and equitable threat score (ETS), which have been widely applied in meteorology <ref type="bibr" target="#b2">[3]</ref>. Let N denote the total number of grids. Let N 1 , N 2 , N 3 and N 4 denote the number of true-positive, false-positive, false-negative and truenegative grids, respectively. Define the expectation of the number Table <ref type="table">3</ref>: Illustration for quantitative results (POD(%), FAR(%), ETS). The best performance is reported using bold red, and the second best is reported using bold blue. The term "Neighb." is the abbreviations of "Neighborhood". </p><formula xml:id="formula_21">= (N 1 + N 2 )(N 1 + N 3 )/N .</formula><p>The equations for the three metrics are detailed in Table <ref type="table">2</ref>.</p><p>The above described three measures are called strict metrics since they consider that a lightning is hit (i.e. predicted correctly) only if the lightning strictly falls in the predicted grid. By contrast, neighborhood-based metrics relax the criteria for "hits" by considering grid points within a specified radius r . Specifically, a prediction is called an r -neighborhood-based hit if a lightning falls in the area within the radius r centered at the predicted grid. Accordingly, denote Ñ1 , Ñ2 , Ñ3 and Ñ4 as the number of r -neighborhood-based true-positive, false-positives, false-negative and true-negative grids, respectively. The r -neighborhood-based POD, FAR and ETS are computed by the equations as shown in Table <ref type="table">2</ref>, where {N i } 4 i=1 is replaced by { Ñi } 4 i=1 . In our experiments, we set the radius r = 1 (i.e. the eight neighborhoods). Notice that the strict metrics can be seen as a special case of the neighborhood-based metrics with r = 0. Clark et al. <ref type="bibr" target="#b2">[3]</ref> have shown that the neighborhood-based metrics demonstrate better properties than the strict metrics in assessing the prediction for high-resolution grids.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.4">Comparison with Baselines</head><p>Table <ref type="table">3</ref> presents the performance of LightNet compared with the three meteorologic methods and four data-driven baselines. We evaluate their prediction results for three periods, i.e. the first hour, first three hours and all six hours. For each period, we demonstrate their scores of both strict metrics and neighborhood-based metrics (with radius r = 1). The upper part shows the results of the three meteorologic baselines. The lower part reports the performance of all data-driven models including LightNet.</p><p>From Table <ref type="table">3</ref>, we observe that the three methods from meteorology show poor performance compared with data-driven methods. This result is caused by two factors. Firstly, they do not exploit the recent observation data and are completely based on the simulation of WRF, which usually have deviations in the space and time domain. Secondly, these methods are designed manually by meteorological experts, which hardly benefits from massive historical data. In contrast, data-driven methods achieve improvements thanks to the experience mined from training data.</p><p>For data-driven models, we observe that LightNet and LightNet-O achieve comparable performance on the first hour and first three hours, which will be explained in Subsection 5.6. StepDeep obtains lower scores but is still competitive. In contrast, GBDT and LightNet-W show similar poor performance among data-driven methods, since they are entirely based on the WRF simulation data, which usually shows deviations in space and time domain. Next, we focus on the three competitive methods (StepDeep, LightNet-O and LightNet) and compare their performance for different time periods as follows:</p><p>(1) First-hour prediction. LightNet-O achieves the highest POD values for both strict and neighborhood-based metrics, which are slightly higher than the second place, LightNet. Though StepDeep is not very competitive in the POD measure, it records the highest ETS due to its lower FAR. For neighborhoodbased metrics, we find that their performance gaps are small (below 0.01), since all their predictions are mainly based on the same information provided by L −1 . (2) First-three-hour prediction. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.5">Visualization Results</head><p>Figure <ref type="figure" target="#fig_3">4</ref> visualizes six representative cases for StepDeep, LihgtNet-O and LightNet. From this figure, we observe that all methods make a good prediction for the first hour, which benefits from the information provided by the last-hour observation. On the other hand, StepDeep tends to predict no lightnings for the last three hours of the forecast period, which is consistent with its performance on quantitative metrics shown in Table <ref type="table">3</ref>. Next, we focus on comparing the results of LightNet-O and LightNet.</p><p>For the case shown in Figure <ref type="figure" target="#fig_3">4a</ref>, both LightNet-O and Light-Net correctly predict the main area of lightning for six hours, and the difference between their predictions is small. However, for the cases shown in Figures <ref type="figure" target="#fig_3">4b, 4c and 4d</ref>, LightNet-O tends to predict no lightnings for the last several hours. This is because the observations for recent hours provide insufficient information about the development trend of thunderstorms. In contrast, LightNet captures the approximate area of thunderstorms thanks to the knowledge extracted from the WRF data. For the case shown in Figure <ref type="figure" target="#fig_3">4e</ref>, LightNet captures the core thunder zone for the first three hours, but the prediction gradually deviates from the right track for the last three hours. Figure <ref type="figure" target="#fig_3">4f</ref> shows a case where thunderstorms gradually disappear. It seems that this trend is predicted in all methods.</p><p>However, from the above cases, we speculate that the trend predicted by StepDeep and LightNet-O is more likely to be an inertial behavior. By comparison, LightNet is more possible to anticipate the disappearing trend in light of the WRF simulation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.6">Model Analysis</head><p>To demonstrate the effect of different configuration on our model, we also evaluate the prediction performance of LightNet-W, LightNet-O and LightNet for the last three hours and show their scores in Table <ref type="table" target="#tab_3">4</ref>. The prediction scores for the first three hours have been shown in Table <ref type="table">3</ref>. For LightNet-W, we observe that neither the first-three-hour prediction nor the last-three-hour prediction is acceptable, which illustrates that only exploiting WRF data is insufficient to make a good prediction. On the other hand, for LightNet-O, the first-threehour prediction is very competitive, but its performance rapidly degenerates for the last three hours. This is because the recent observations can hardly provide the development trend of thunderstorms for such long hours. In contrast, LightNet not only achieves comparable performance on the first-three-hour prediction, but also has an obvious advantage for the last three hours. This demonstrates the necessity of combining WRF simulation data and the recent observation data to make a good prediction.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6">CONCLUSIONS</head><p>In this paper, we presented a model (named LightNet) for lightning prediction. LightNet is an end-to-end deep neural network, which overcomes the drawback of conventional prediction methods which fail to mine knowledge from historical data. LightNet exploits dual encoders to extract spatiotemporal features of WRF simulation data and recent lightning observation data. Furthermore, these features are combined by a fusion module, which proves effective in withstanding the deviations in the simulation and enhancing the prediction. We conducted the experiments on a real-world lightning dataset of North China. The results show that LightNet achieves a threefold improvement in equitable threat score for the six-hour prediction compared with three established forecast methods.</p><p>In future research, we will extend the current work in three aspects. Firstly, we will continue to improve the forecast quality and further predict the intensity of lightning. Secondly, we will expand the forecast duration from six hours to over twelve hours. Thirdly, we will generalize our framework and employ it to predict other meteorological disasters such as windstorm and hailstone.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>( 1 )</head><label>1</label><figDesc>We propose a data-driven LightNet model for lightning prediction, which outperforms the established prediction methods that fail to mine knowledge from historical data.(2) We introduce dual spatiotemporal encoders to extract simulation based and observation based features, which offers new insights into the general problem of weather forecast. (3) We combine simulation based and observation based features by a fusion module, which proves effective in withstanding deviations in the simulation.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :</head><label>2</label><figDesc>Figure 2: Framework of conventional lightning prediction methods (inside the dotted box). Unlike conventional prediction, our LightNet model introduces recent lightning observation data to assist prediction besides simulation data.</figDesc><graphic url="image-9.png" coords="3,54.58,83.37,238.84,76.84" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 3 :</head><label>3</label><figDesc>Figure 3: The diagram of LightNet. LightNet consists of four parts: WRF encoder, observation (Obs.) encoder, fusion module and prediction (Pred.) decoder. The WRF encoder and the observation encoder are responsible for encoding the spatiotemporal features of WRF simulation (P = [P t ] h t =0 ) and recent lightning observations (L = [L t ] −1 t =−s ), respectively. Then the fusion module combines the WRF feature ({C wr f , H wr f }) and observation feature ({C obs , H obs }) so as to improve short-term prediction and calibrate long-term simulation. Finally, the prediction decoder receives the fused feature prediction and recursively makes forecasts ( L = Lt h t =0 ).</figDesc><graphic url="image-53.png" coords="5,98.25,177.06,166.28,81.49" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: Visualization of six representative cases for six-hour prediction. In each example, the left part is observations for recent three hours, and the right part is predictions for future six hours, where the predictions from top to bottom are made by StepDeep, LightNet-O and LightNet. The observation, prediction and hit are marked by blue (•), dark green (•) and red (•), respectively. Best viewed on a color screen.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1 :</head><label>1</label><figDesc>The detailed settings of LightNet.</figDesc><table><row><cell>Module</cell><cell>Notation</cell><cell>Size</cell><cell>stride</cell></row><row><cell>WRF Encoder</cell><cell>Conv 1 ConvLSTM</cell><cell cols="2">[7 × 7, 64] [5 × 5, 128] 1 2</cell></row><row><cell>Obs. Encoder</cell><cell>Conv 2 ConvLSTM</cell><cell>[7 × 7, 4] [5 × 5, 8]</cell><cell>2 1</cell></row><row><cell>Fusion Module</cell><cell>Conv 3 Conv 4</cell><cell>[1 × 1, 64] [1 × 1, 64]</cell><cell>1 1</cell></row><row><cell></cell><cell>Conv 5</cell><cell>[7 × 7, 4]</cell><cell>2</cell></row><row><cell></cell><cell>ConvLSTM</cell><cell>[5 × 5, 64]</cell><cell>1</cell></row><row><cell>Pred. Decoder</cell><cell>DeConv</cell><cell>[7 × 7, 64]</cell><cell>2</cell></row><row><cell></cell><cell>Conv 6</cell><cell>[1 × 1, 1]</cell><cell>1</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>Table 4 :</head><label>4</label><figDesc>Quantitative results (POD(%), FAR(%), ETS) for lastthree-hour prediction. The best performance is reported using bold dark. The term "Neighb." is the abbreviations of "Neighborhood".</figDesc><table><row><cell></cell><cell></cell><cell cols="4">Last-Three-Hour Cumulative Score</cell></row><row><cell>Method</cell><cell></cell><cell>Strict Metric</cell><cell cols="3">Neighb.-Based Metric</cell></row><row><cell></cell><cell cols="4">POD FAR ETS POD FAR</cell><cell>ETS</cell></row><row><cell>LightNet-W</cell><cell>1.8</cell><cell>87.0 0.015</cell><cell>5.9</cell><cell>59.3</cell><cell>0.053</cell></row><row><cell cols="5">LightNet-O 12.3 83.8 0.071 26.9 60.0</cell><cell>0.187</cell></row><row><cell>LightNet</cell><cell cols="5">22.3 82.8 0.102 42.3 59.1 0.257</cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="1" xml:id="foot_0">Full formulation and documentation can be accessed through UCAR at: https://www.mmm.ucar.edu/weather-research-and-forecasting-model.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="2" xml:id="foot_1">https://keras.io/</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGMENTS</head><p>This work is partly supported by the National Key Research and Development Program of China (No. 2017YFC1501503), Beijing Municipal Education Commission Research Program (No. SM20191001107, PXM2019_014213_000007) and National Social Science Foundation of China (No. 18CSH019).</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Some Observations of Vertical Velocities and Precipitation Sizes in a Thunderstorm</title>
		<author>
			<persName><forename type="first">Louis</forename><forename type="middle">J</forename><surname>Battan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Applied Meteorology</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="415" to="420" />
			<date type="published" when="1964">1964. 1964</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Learning Phrase Representations using RNN Encoder-Decoder for Statistical Machine Translation</title>
		<author>
			<persName><forename type="first">Kyunghyun</forename><surname>Cho</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. EMNLP</title>
				<meeting>EMNLP<address><addrLine>Doha, Qatar</addrLine></address></meeting>
		<imprint>
			<publisher>Association for Computational Linguistics</publisher>
			<date type="published" when="2014">2014</date>
			<biblScope unit="page" from="1724" to="1734" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Neighborhoodbased verification of precipitation forecasts from convection-allowing NCAR WRF model simulations and the operational NAM</title>
		<author>
			<persName><forename type="first">Adam J</forename><surname>Clark</surname></persName>
		</author>
		<author>
			<persName><forename type="first">William</forename><forename type="middle">A</forename><surname>Gallus</surname><genName>Jr</genName></persName>
		</author>
		<author>
			<persName><forename type="first">Morris</forename><forename type="middle">L</forename><surname>Weisman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Weather and Forecasting</title>
		<imprint>
			<biblScope unit="volume">25</biblScope>
			<biblScope unit="page" from="1495" to="1509" />
			<date type="published" when="2010">2010. 2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<title level="m" type="main">An Investigation of the Parameterized Prediction of Lightning in Cloud-Resolved Convection and the Resulting Chemistry</title>
		<author>
			<persName><forename type="first">Kristin</forename><surname>Ashley</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Cummings</forename></persName>
		</author>
		<imprint>
			<date type="published" when="2017">2017</date>
			<pubPlace>College Park</pubPlace>
		</imprint>
		<respStmt>
			<orgName>University of Maryland</orgName>
		</respStmt>
	</monogr>
	<note>Ph.D. Dissertation</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Lightning casualties and damages in the United States from 1959 to 1994</title>
		<author>
			<persName><forename type="first">Ronald</forename><forename type="middle">L</forename><surname>E Brian Curran</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Raúl</forename><forename type="middle">E</forename><surname>Holle</surname></persName>
		</author>
		<author>
			<persName><surname>López</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Climate</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="3448" to="3464" />
			<date type="published" when="2000">2000. 2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">The relationship between lightning activity and ice fluxes in thunderstorms</title>
		<author>
			<persName><forename type="first">Wiebke</forename><surname>Deierling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Geophysical Research: Atmospheres</title>
		<imprint>
			<biblScope unit="volume">113</biblScope>
			<biblScope unit="page">D15</biblScope>
			<date type="published" when="2008">2008. 2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Predicting lightning activity in Greece with the Weather Research and Forecasting (WRF) model</title>
		<author>
			<persName><forename type="first">Vassiliki</forename><surname>Theodore M Giannaros</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Konstantinos</forename><surname>Kotroni</surname></persName>
		</author>
		<author>
			<persName><surname>Lagouvardos</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Atmospheric Research</title>
		<imprint>
			<biblScope unit="volume">156</biblScope>
			<biblScope unit="page" from="1" to="13" />
			<date type="published" when="2015">2015. 2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title level="m" type="main">Glossary of meteorology</title>
		<author>
			<persName><forename type="first">Walter</forename><surname>Todd S Glickman</surname></persName>
		</author>
		<author>
			<persName><surname>Zenk</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2000">2000</date>
			<publisher>American Meteorological Society</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Lightgbm: A highly efficient gradient boosting decision tree</title>
		<author>
			<persName><forename type="first">Guolin</forename><surname>Ke</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. NIPS</title>
				<meeting>NIPS</meeting>
		<imprint>
			<date type="published" when="2017">2017</date>
			<biblScope unit="page" from="3146" to="3154" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title level="m" type="main">Adam: A Method for Stochastic Optimization</title>
		<author>
			<persName><forename type="first">P</forename><surname>Diederik</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jimmy</forename><surname>Kingma</surname></persName>
		</author>
		<author>
			<persName><surname>Ba</surname></persName>
		</author>
		<idno>CoRR abs/1412.6980</idno>
		<imprint>
			<date type="published" when="2014">2014. 2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">A dynamic convolutional layer for short range weather prediction</title>
		<author>
			<persName><forename type="first">Benjamin</forename><surname>Klein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Lior</forename><surname>Wolf</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Yehuda</forename><surname>Afek</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE CVPR</title>
				<meeting>IEEE CVPR</meeting>
		<imprint>
			<date type="published" when="2015">2015</date>
			<biblScope unit="page" from="4840" to="4848" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Generation of electric charge associated with the formation of soft hail in thunderclouds</title>
		<author>
			<persName><forename type="first">J</forename><surname>Latham</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Basil</forename><surname>John Mason</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Royal Society London Series A. Mathematical and Physical Sciences</title>
		<imprint>
			<biblScope unit="volume">260</biblScope>
			<biblScope unit="page" from="537" to="549" />
			<date type="published" when="1961">1961. 1961</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<monogr>
		<title level="m" type="main">Application of deep convolutional neural networks for detecting extreme weather in climate datasets</title>
		<author>
			<persName><forename type="first">Yunjie</forename><surname>Liu</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1605.01156</idno>
		<imprint>
			<date type="published" when="2016">2016. 2016</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Contribution to the climatological study of lightning</title>
		<author>
			<persName><forename type="first">N</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Geophysical research letters</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="3097" to="3100" />
			<date type="published" when="1999">1999. 1999</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Learning Deconvolution Network for Semantic Segmentation</title>
		<author>
			<persName><forename type="first">Hyeonwoo</forename><surname>Noh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Seunghoon</forename><surname>Hong</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Bohyung</forename><surname>Han</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE ICCV</title>
				<meeting>IEEE ICCV<address><addrLine>Washington, DC, USA</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2015">2015</date>
			<biblScope unit="page" from="1520" to="1528" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">A simple lightning parameterization for calculating global lightning distributions</title>
		<author>
			<persName><forename type="first">Colin</forename><surname>Price</surname></persName>
		</author>
		<author>
			<persName><forename type="first">David</forename><surname>Rind</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Geophysical Research: Atmospheres</title>
		<imprint>
			<biblScope unit="volume">97</biblScope>
			<biblScope unit="page" from="9919" to="9933" />
			<date type="published" when="1992">1992. 1992</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Industrial accidents triggered by lightning</title>
		<author>
			<persName><forename type="first">Elisabetta</forename><surname>Renni</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Elisabeth</forename><surname>Krausmann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Valerio</forename><surname>Cozzani</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of hazardous materials</title>
		<imprint>
			<biblScope unit="volume">184</biblScope>
			<biblScope unit="page" from="42" to="48" />
			<date type="published" when="2010">2010. 2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Thunderstorm charge separation</title>
		<author>
			<persName><surname>Se Reynolds</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Mary</forename><forename type="middle">Foulks</forename><surname>Brook</surname></persName>
		</author>
		<author>
			<persName><surname>Gourley</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Meteorology</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page" from="426" to="436" />
			<date type="published" when="1957">1957. 1957</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">R</forename><surname>Rogers</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Man</forename><surname>Kong</surname></persName>
		</author>
		<author>
			<persName><surname>Yau</surname></persName>
		</author>
		<title level="m">A short course in cloud physics</title>
				<meeting><address><addrLine>New York</addrLine></address></meeting>
		<imprint>
			<publisher>Pergamon Press Oxford</publisher>
			<date type="published" when="1989">1989</date>
		</imprint>
	</monogr>
	<note>3rd ed. ed.</note>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">StepDeep: A Novel Spatial-temporal Mobility Event Prediction Framework based on Deep Neural Network</title>
		<author>
			<persName><forename type="first">Bilong</forename><surname>Shen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. KDD. ACM</title>
				<meeting>KDD. ACM</meeting>
		<imprint>
			<date type="published" when="2018">2018</date>
			<biblScope unit="page" from="724" to="733" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Convolutional LSTM network: A machine learning approach for precipitation nowcasting</title>
		<author>
			<persName><forename type="first">Shi</forename><surname>Xingjian</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. NIPS</title>
				<meeting>NIPS</meeting>
		<imprint>
			<date type="published" when="2015">2015</date>
			<biblScope unit="page" from="802" to="810" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Deep learning for precipitation nowcasting: A benchmark and a new model</title>
		<author>
			<persName><forename type="first">Xingjian</forename><surname>Shi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. NIPS</title>
				<meeting>NIPS</meeting>
		<imprint>
			<date type="published" when="2017">2017</date>
			<biblScope unit="page" from="5617" to="5627" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<title level="m" type="main">A description of the Advanced Research WRF Version 3</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">C</forename><surname>Skamarock</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2008">2008</date>
			<publisher>National Center for Atmospheric Research</publisher>
			<biblScope unit="page" from="1" to="113" />
		</imprint>
	</monogr>
	<note type="report_type">Technical Report</note>
</biblStruct>

<biblStruct xml:id="b23">
	<monogr>
		<title level="m" type="main">Forecasting lightning threat using cloud-resolving model simulations</title>
		<author>
			<persName><surname>Mccaul</surname><genName>Jr</genName></persName>
		</author>
		<imprint>
			<date type="published" when="2009">2009. 2009</date>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="709" to="729" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<monogr>
		<title level="m" type="main">Development of national lightning detection network and its application in China</title>
		<author>
			<persName><forename type="first">Meng</forename><surname>Qing</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Diffusion Convolutional Recurrent Neural Network: Data-Driven Traffic Forecasting</title>
		<author>
			<persName><forename type="first">Yaguang</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. ICLR</title>
				<meeting>ICLR</meeting>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">PredCNN: Predictive learning with cascade convolutions</title>
		<author>
			<persName><forename type="first">Ziru</forename><surname>Xu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IJCAI</title>
				<meeting>IJCAI</meeting>
		<imprint>
			<date type="published" when="2018">2018</date>
			<biblScope unit="page" from="2940" to="2947" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">Lecture 6.5-rmsprop: Divide the gradient by a running average of its recent magnitude</title>
		<author>
			<persName><forename type="first">Tijmen</forename><surname>Tieleman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Geoffrey</forename><surname>Hinton</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">COURSERA: Neural networks for machine learning</title>
				<imprint>
			<date type="published" when="2012">2012. 2012</date>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page" from="26" to="31" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Learning spatiotemporal features with 3d convolutional networks</title>
		<author>
			<persName><forename type="first">Du</forename><surname>Tran</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE ICCV</title>
				<meeting>IEEE ICCV</meeting>
		<imprint>
			<date type="published" when="2015">2015</date>
			<biblScope unit="page" from="4489" to="4497" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Evaluation of lightning forecasting based on one lightning parameterization scheme and two diagnostic methods</title>
		<author>
			<persName><forename type="first">Ying</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Yi</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Shuanglong</forename><surname>Jin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Atmosphere</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page">99</biblScope>
			<date type="published" when="2018">2018. 2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Progress in lightning forecast by using numerical weather models and model outputs</title>
		<author>
			<persName><forename type="first">Haoliang</forename><surname>Wang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Advances in Earth Science</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="44" to="55" />
			<date type="published" when="2017">2017. 2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Predrnn: Recurrent neural networks for predictive learning using spatiotemporal lstms</title>
		<author>
			<persName><forename type="first">Yunbo</forename><surname>Wang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. NIPS</title>
				<meeting>NIPS</meeting>
		<imprint>
			<date type="published" when="2017">2017</date>
			<biblScope unit="page" from="879" to="888" />
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
