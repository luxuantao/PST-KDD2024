<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Diagnosis of heart disease using artificial immune recognition system and fuzzy weighted pre-processing</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Kemal</forename><surname>Polat</surname></persName>
							<email>kpolat@selcuk.edu.tr</email>
							<affiliation key="aff0">
								<orgName type="department">Electrical and Electronics Engineering Department</orgName>
								<orgName type="institution">Selcuk University</orgName>
								<address>
									<postCode>42035</postCode>
									<settlement>Konya</settlement>
									<country key="TR">Turkey</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Salih</forename><surname>Güneş</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Electrical and Electronics Engineering Department</orgName>
								<orgName type="institution">Selcuk University</orgName>
								<address>
									<postCode>42035</postCode>
									<settlement>Konya</settlement>
									<country key="TR">Turkey</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Sülayman</forename><surname>Tosun</surname></persName>
							<email>stosun@selcuk.edu.tr</email>
							<affiliation key="aff1">
								<orgName type="department">Computer Engineering Department</orgName>
								<orgName type="institution">Selcuk University</orgName>
								<address>
									<postCode>42035</postCode>
									<settlement>Konya</settlement>
									<country key="TR">Turkey</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Diagnosis of heart disease using artificial immune recognition system and fuzzy weighted pre-processing</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">F7A7A72D0D9AF707C82538110CA2313A</idno>
					<idno type="DOI">10.1016/j.patcog.2006.05.028</idno>
					<note type="submission">Received 23 October 2005; received in revised form 18 April 2006; accepted 25 May 2006</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.3" ident="GROBID" when="2023-07-28T13:39+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Heart disease</term>
					<term>Artificial immune system</term>
					<term>AIRS</term>
					<term>Fuzzy weighted pre-processing</term>
					<term>k-fold cross validation</term>
					<term>Medical diagnosis</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>This paper presents a novel method for diagnosis of heart disease. The proposed method is based on a hybrid method that uses fuzzy weighted pre-processing and artificial immune recognition system (AIRS). Artificial immune recognition system has showed an effective performance on several problems such as machine learning benchmark problems and medical classification problems like breast cancer, diabetes, liver disorders classification. The robustness of the proposed method is examined using classification accuracy, k-fold cross-validation method and confusion matrix. The obtained classification accuracy is 96.30% and it is very promising compared to the previously reported classification techniques.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">Introduction</head><p>Heart disease is any disorder that influences the heart's ability to function normally. The most common cause of heart disease is narrowing or blockage of the coronary arteries, which supply blood to the heart itself. This happens slowly over time <ref type="bibr">[1]</ref>.</p><p>Extensive clinical and statistical studies have identified several factors that increase the risk of coronary heart disease and heart attack. Major risk factors (e.g., tobacco smoke, high blood cholesterol, high blood pressure, physical inactivity, obesity and overweight and diabetes mellitus) can significantly increase the risk of heart and blood vessel (cardiovascular) disease as the previous research have shown <ref type="bibr">[2]</ref>. Other factors, called contributing risk factors, (e.g., stress and alcohol) may increase the risk of cardiovascular disease, however, their significance and prevalence have not yet been precisely determined. While some of the risk factors can be modified, treated or controlled, some cannot. The more risk factors you have, the greater the chance of developing a coronary heart disease. The level of each risk factor may also increase the chance of having coronary heart disease <ref type="bibr">[2]</ref>.</p><p>Having so many factors to analyze to diagnose the heart disease of a patient makes the physician's job difficult. A physician usually makes decisions by evaluating the current test results of a patient and by referring to the previous decisions she made on other patients with the same condition. The former method depends strongly on the physician's knowledge. On the other hand, the latter depends on the physician's experience to compare her patient with her earlier patients. This job is not easy considering the number of factors she has to evaluate. In this crucial step, she may need an accurate tool that lists her previous decisions on the patient having same (or close to same) factors.</p><p>Motivated by the need of such an important classification method, in this study, we propose a method to diagnose the heart disease. The proposed method uses AIRS classification system and a weighting process, which is based on fuzzy weighted pre-processing method. In our method, we first apply the fuzzy weighted pre-processing step to the heart disease dataset and we weight the dataset in the interval [0, 1]. After the pre-processing step, we run the main AIRS classifier algorithm using the weighted heart disease dataset. We obtained 96.30% classification accuracy from the experiments made on the data taken from machine learning database. To the best of our knowledge, this classification accuracy is the highest so far. We also obtained 92.30% and 100% sensitivity and specificity values, respectively, in heart disease diagnosis. Note here that this study is an improvement of our earlier work <ref type="bibr">[3]</ref>.</p><p>The remaining of the paper is organized as follows. We present the related work in the next section. In Section 3, we give a brief background on natural and artificial immune systems. We present the proposed method in Section 4. In Section 5, we give the experimental data to show the effectiveness of our method. Finally, we conclude this paper in Section 6 with future directions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Related work</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Classification systems have been used for heart disease diagnosis problem as for other clinical diagnosis problems (refer this work). There have been several studies reported focusing on heart disease diagnosis [3]</head><p>. These studies applied different methods to the given problem and achieved high classification accuracies using the dataset taken from UCI machine learning repository. Among these studies, we see a competition between ToolDiag and RA and WEKA and RA. ToolDiag and RA [3] obtained 50.00% classification accuracy by using IB1-4 algorithm while WEKA and RA [3] obtained a classification accuracy of 58.50% using InductH algorithm. Then, ToolDiag and RA reached to 60.00% accuracy with RBF algorithm and WEKA and RA applied FOIL algorithm to the problem and obtained a classification accuracy of 64.00%. MLP+BP algorithm that was used by ToolDiag and RA reached to the 65.60% accuracy. The classification accuracies obtained by WEKA and RA using T2, 1R, IB1c and K * algorithms are 68.10%, 71.40%, 74.00% and 76.70%, respectively. In addition, Robert Detrano used Logistic regression algorithm and obtained 77.0% classification accuracy [3]. Newton Cheung utilized C4.5, Naive Bayes, BNND and BNNF algorithms and reached the classification accuracies of 81.11%, 81.48%, 81.11% and 80.96%, respectively, for these algorithms <ref type="bibr" target="#b0">[4]</ref>. A higher classification accuracy, 83.60%, was obtained by WEKA and RA using Naive-Bayes algorithm [3]. In our earlier work, we applied AIRS to the problem and reached a classification accuracy of 84.50% <ref type="bibr" target="#b1">[5]</ref>. In this work, we added a pre-processing step to our earlier work and improved the classification accuracy to 96.30%.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Natural and artificial immune systems</head><p>The natural immune system is a distributed novelpattern detection system with several functional components positioned in strategic locations throughout the body. Immune system regulates defense mechanism of the body by means of innate and adaptive immune responses. Between these, adaptive immune response is much more important for us because it contains metaphors like recognition, memory acquisition, diversity, self-regulation, etc. The main architects of adaptive immune response are lymphocytes, which can be divided into two classes as T-and B-Lymphocytes (cells), each having its own function. Especially B cells have a great importance because of their secreted antibodies (Abs) that take very critical roles in adaptive immune response.</p><p>The simplified working procedure of the human immune system is illustrated in Fig. <ref type="figure" target="#fig_0">1</ref>. Specialized antigen presenting cells (APCs) called macrophages circulates through the body and if they encounter an antigen, they ingest and fragment them into antigenic peptides (I). The pieces of these peptides are displayed on the cell surface by major histocompatibility complex (MHC) molecules existing in the digesting APC. The presented MHC-peptide combination on the cell surface is recognized by the T-cells causing them to be activated (II). Activated T cells secrete some chemicals as alert signals to other units in response to this recognition (III). B cells, one of the units that take these signals from the T cells, become activated with the recognition of antigen by their antibodies occurred in the same time (IV). When activated, B cells turn into plasma cells that secrete bound antibodies on their surfaces (V). Secreted antibodies bind the existing antigens and neutralize them signaling other components of immune system to destruct the antigen-antibody complex (VI) <ref type="bibr" target="#b2">[6]</ref>. For more detailed information about immune system refer to Refs. <ref type="bibr" target="#b3">[7]</ref><ref type="bibr" target="#b4">[8]</ref><ref type="bibr" target="#b5">[9]</ref>.</p><p>Artificial immune systems emerged in the 1990s as a new computational research area. Artificial immune systems link several emerging computational fields inspired by biological behavior such as artificial neural networks and artificial life <ref type="bibr" target="#b5">[9]</ref>.</p><p>In the studies conducted in the field of AIS, B cell modeling is the most encountered representation type. Different representation methods have been proposed in that modeling. Among these, shape-space representation is the most commonly used one <ref type="bibr" target="#b2">[6]</ref>.</p><p>The shape-space model (S) aims at quantitatively describing the interactions among antigens (Ags), the foreign elements that enter the body like microbe, etc., and antibodies (Ag-Ab). The set of features that characterize a molecule is called its generalized shape. The Ag-Ab representation (binary or real-valued) determines a distance measure to be used to calculate the degree of interaction between these molecules. Mathematically, the generalized shape of a molecule (m), either an antibody or an antigen, can be represented by a set of coordinates m = m 1 , m 2 , . . . , m L , which can be regarded as a point in an L-dimensional realvalued shape-space (m ∈ S L ). In this work, we used real strings to represent the molecules. Antigens and antibodies are considered to be the same length L. The length and cell representation depend upon the given problem <ref type="bibr" target="#b5">[9]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">The proposed system</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.">Overview</head><p>The proposed medical decision making method consists of two main parts: fuzzy weighted pre-processing and AIRS classifier. We apply the former to the given heart disease dataset to weight the input data. We use the latter part to classify the weighted input. The block diagram of the proposed method is given in Fig. <ref type="figure">2</ref>. We explain the details of the pre-processing and classification steps in the following subsections.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.1.">Fuzzy weighted pre-processing</head><p>In the fuzzy weighted pre-processing, we extract new feature values for each feature. To do this, we first apply two membership functions, known as the input and output membership functions, and we then use weighting procedure to the given data. The membership functions are selected as triangular membership functions as shown in Figs. <ref type="figure">3</ref> and<ref type="figure" target="#fig_2">4</ref>, respectively.</p><p>The formation of these membership functions is realized as follows: first, the arithmetic mean values of each feature for corresponding samples are calculated using Eq. (1):</p><formula xml:id="formula_0">m i = 1 N N k=1</formula><p>x k,i .</p><p>(1)  In this expression, x k,i represents the ith feature value of sample x k , k = 1, 2, . . . , N.</p><p>After the calculation of the sample means for each feature, the input membership function is formed by triangles as shown in Fig. <ref type="figure">3</ref>. The supports of these triangles are determined by m i /8, m i /4, m i /2, m i , 2m i , 4m i , 8m i . The lines of the input membership functions are named as mf 1, mf 2, . . . , mf 8. To form the output membership function, the interval [0, 1] is divided into eight equal parts and the corresponding lines are named as mf 1 , mf 2 , . . . , mf 8 as shown in Fig. <ref type="figure" target="#fig_2">4</ref>. Note here that these input and output membership functions are formed for each feature so that there will exist different input-output membership function configurations for each feature since the sample means of each feature differs.</p><p>After determining the input and output membership functions for each feature, the weighted procedure can start. In this procedure, a feature value x k,i is assumed to be in the x-axis of input membership function and y-axis values for the points at which this value cuts the input membership functions are determined. For example, if a feature value is between 0 and m i /8, then this point will cut both lines mf 1 and mf 2. The y-values at these intersection points, say y 1  </p><formula xml:id="formula_1">+ mf (k + 1) (y))/2 7 if Input_value cuts mf (k) and mf (k + 1) then Output_value = (mf (k) (y) + mf (k + 1) (y))/2</formula><p>and y 2 , are known as membership values ( ) and they will then be used in a fuzzy rule base in the following manner: first, the input membership value, (i), is determined by using the above mentioned intersection points as follows:</p><formula xml:id="formula_2">(i) = A∩B (x k,i ) = MIN( A (x k,i ), B (x k,i )), x ∈ X. (<label>2</label></formula><formula xml:id="formula_3">)</formula><p>In this expression, A (x k,i ) and B (x k,i ) membership values correspond to the intersection points. The rule base for our system is used as presented in Table <ref type="table" target="#tab_1">1</ref>. After (i) value is determined using Eq. (2) for the x k,i feature value, the output weight value is determined by using output membership functions and the rules in Table <ref type="table" target="#tab_1">1</ref>. To do this, first, the input membership value, (i), is presented to the output membership function to determine the corresponding weighted value of the original feature value. This membership value is then taken as a point in y-axis of the output membership functions and, the intersection points, which are cut by this membership value, are determined. As the output membership functions show, there will be more than one intersection point. Which of them will be used is decided by the rules given in Table <ref type="table" target="#tab_1">1</ref>. For example, if the input feature value cuts mf 1 and mf 2 lines in input membership functions then the output value for this feature will be the arithmetic mean of two points that (i) cuts mf 1 and mf 2 at the output membership functions <ref type="bibr" target="#b6">[10]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.2.">The parameters in AIRS classifier</head><p>One of the important advantages of AIRS is that it is not necessary to know the appropriate settings for the classifier in advance. The most important feature of the classifier is its self-determination ability <ref type="bibr" target="#b7">[11]</ref>. The explanations of each parameter used in AIRS are given below. Table <ref type="table" target="#tab_2">2</ref> summarizes these parameters.</p><p>• Mutation rate: A parameter between 0 and 1 that indicates the probability that any given feature (or the output) of an ARB will be mutated. • Affinity threshold scalar (ATS): A value between 0 and 1 that provides a cut-off value for memory cell (mc) replacement in the AIRS training routine when multiplied by the affinity threshold. • Stimulation threshold: A parameter between 0 and 1 used as a stopping criterion for the training on a specific antigen. • Clonal rate: An integer value used to determine the number of mutated clones that a given ARB is allowed to attempt to produce. should be used to determine the classification of a given test item.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.1.3.">AIRS classification algorithm</head><p>AIRS is a resource limited supervised learning algorithm inspired from immune metaphors. In this algorithm, the used immune mechanisms are resource competition, clonal selection, affinity maturation and mc formation. The feature vectors presented for training and test are named as antigens while the system units are called as B cells. Similar B cells are represented with artificial recognition balls (ARBs) and these ARBs compete with each other for a fixed resource number. This provides ARBs, which have higher affinities to the training antigen to improve. The mc s formed after the whole training antigens were presented are used to classify test antigens. The algorithm is composed of four main stages, which are initialization, mc identification and ARB generation, competition for resources and development of a candidate mc, and mc introduction. Table <ref type="table" target="#tab_3">3</ref> summarizes the mapping between the immune system and AIRS.</p><p>We give the details of our algorithm below.</p><p>1. Initialization: Create a set of cells called the memory pool (M) and the ARB pool (P) from randomly selected training data. 2. Antigenic presentation: For each antigenic pattern do:</p><p>(a) Clonal expansion: For each element of M, determine its affinity to the antigenic pattern, which resides in the same class. Select the highest affinity mc and clone mc in proportion to its antigenic affinity to add to the set of ARBs (P).</p><p>( Classification is performed in a k-nearest neighbor fashion with a vote being made among the k closest mc s to the given data item being classified.</p><p>We can characterize AIRS as follows:</p><p>• Memory: The memory of the AIRS algorithm is in the pool of mc s developed through exposure to the training data (experiences). • Adaptation: The adaptation occurs primarily in the ARB pool. With each new experience, AIRS evolves a candidate mc in reaction to this experience. If this mc is of sufficient quality, then the memory structure is adapted to include in it. • Decision-making: The initial decision is which mc is the most similar to the incoming training antigen. This cell is used as a progenitor for a pool of evolving cells. During classification, the primary classification decision is made based on the k most similar mc s to the data item being classified.</p><p>We explain each step of our algorithm in detail in the following paragraphs.</p><p>a. Initialization: The first step of the algorithm is the data pre-processing stage. In this step, the given data is normalized to ensure that the Euclidean distance between two data is in the interval of [0-1].</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>b. Mc identification and ARB generation:</head><p>In this step, the algorithm iterates for each training antigen. Training antigen is presented to mc s and the most stimulated mc by that antigen is cloned. The stimulation levels are calculated by Eq. (3). All of the clones with mc are added to ARB pool. The number of clones is determined based on the affinity between the mc and the antigen. Calculation of the affinity values is done by using Eq. ( <ref type="formula" target="#formula_5">4</ref>), which results in higher affinities for lower Euclidean distances.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Stimulation(x, y)</head><formula xml:id="formula_4">= affinity(x, y) if class of x = class of y, 1 -affinity(x, y) otherwise,<label>(3)</label></formula><formula xml:id="formula_5">affinity(x, y) = 1 -Euclidean distance(x, y) = 1 - n i=1 (x i -y i ) 2 . (<label>4</label></formula><formula xml:id="formula_6">)</formula><p>c. Competition for resources and development of a candidate mc: In this step, the training antigen is presented to all ARBs in ARB pool. Then, all ARBs are awarded based on their resource numbers. An ARB class with higher number of resources gets higher affinity values. In other words, the assigned affinity values are proportional to the number of resources for each ARB. The required number of resources may exceed the number of resources allowed by the system. In this case, the additional resources are removed beginning with the lowest affinity ARB until the number of resources is equal to the allowed number of resources. The stimulation levels of remaining ARBs are tested and the average value of these levels is determined for each class. If any of these average values is lower than a stimulation threshold determined by the user, the ARBs belonging to that class are mutated and resulted clones are added to the ARB pool. This step proceeds until the average stimulation of all classes is bigger than the stimulation threshold. To calculate the average stimulation value for each class, we use the following expression:</p><formula xml:id="formula_7">s i ← |ARB i | j =1 arb j .stim |ARB i | , arb j ∈ ARB i ,<label>(5)</label></formula><p>where i = 1 . . . nc, s = {s 1 , s 2 , . . . , s nc }, |ARB i | represents the number of ARBs belonging to ith class, and arb j .stim represents the stimulation level of jth ARB of ith class. d. MC introduction: After the total stimulation value of ARBs in all classes reaches stimulation threshold, the best ARB (i.e., ARB having the highest affinity) in the same class with training antigen is taken as a candidate mc. If the stimulation value between training antigen and the candidate mc is bigger than the stimulation value between training antigen and original mc selected for cloning in step 2, the candidate mc is added to the mc pool.</p><p>These steps are repeated for each training antigen. After training, test data are presented only to mc s . k-NN algorithm is used to determine the classes in test phase. For more detailed information about AIRS, the reader is referred to Refs. <ref type="bibr" target="#b6">[10,</ref><ref type="bibr" target="#b7">11]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">The experimental results</head><p>In this section, we first explain the heart disease database we used in our experiments. We then present the performance evaluation methods used to evaluate the proposed method. Finally, we give the experimental results and discuss our observations from the obtained results.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1.">Heart disease dataset</head><p>The heart disease database we used in our experiments are taken from the Cleveland Clinic Foundation. <ref type="bibr">It</ref>  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2.">Performance evaluation methods</head><p>We have used four methods for performance evaluation of heart disease diagnosis. These methods are classification accuracy, sensitivity and specificity analysis, k-fold cross validation, and confusion matrix. We explain these methods in the following subsections.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2.1.">Classification accuracy</head><p>In this study, the classification accuracies for the datasets are measured using Eq. ( <ref type="formula" target="#formula_8">6</ref>) <ref type="bibr" target="#b7">[11]</ref>: where T is the set of data items to be classified (the test set), t ∈ T , t.c is the class of item t, and classify(t) returns the classification of t by AIRS.</p><formula xml:id="formula_8">accuracy(T ) = |T | i=1 assess(t i ) |T | , t i ∈ T , assess(t) = 1 if classify(t) = t.c, 0 otherwise,<label>(6)</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2.2.">Sensitivity and specificity</head><p>For sensitivity and specificity analysis, we use the following expressions.</p><formula xml:id="formula_9">sensitivity = TP TP + FN (%),<label>(7) specificity</label></formula><formula xml:id="formula_10">= TN FP + TN (%),<label>(8)</label></formula><p>where TP, TN, FP and FN denote true positives, true negatives, false positives, and false negatives, respectively. True positive (TP): An input is detected as a patient with atherosclerosis diagnosed by the expert clinicians.</p><p>True negative (TN): An input is detected as normal that is labeled as a healthy person by the expert clinicians.</p><p>False positive (FP): An input is detected as a patient that is labeled as a healthy by the expert clinicians.</p><p>False negative (FN): An input is detected as normal with atherosclerosis diagnosed by the expert clinicians.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2.3.">k-fold cross validation</head><p>k-fold cross validation is one way to improve the holdout method. The data set is divided into k subsets, and the holdout method is repeated k times. Each time, one of the k subsets is used as the test set and the other k -1 subsets are put together to form a training set. Then the average error across all k trials is computed. The advantage of this method is that it is not important how the data is divided. Every data point appears in a test set exactly once, and appears in a training set k -1 times. The variance of the resulting estimate is reduced as k is increased. The disadvantage of this method is that the training algorithm must be rerun from scratch k times, which means it takes k times as much computation to make an evaluation. A variant of this method is to randomly divide the data into a test and training set k different times. The advantage of this method is that we can independently choose the size of the each test and the number of trials <ref type="bibr" target="#b8">[13]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2.4.">Confusion matrix</head><p>A confusion matrix <ref type="bibr" target="#b9">[14]</ref> contains information about actual and predicted classifications done by a classification system. Performance of such a system is commonly evaluated using the data in the matrix. Table <ref type="table" target="#tab_6">4</ref> shows the confusion matrix for a two class classifier. We can explain the entries of our confusion matrix:</p><p>• a is the number of correct predictions that an instance is negative, • b is the number of incorrect predictions that an instance is positive, • c is the number of incorrect of predictions that an instance is negative, and • d is the number of correct predictions that an instance is positive.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3.">Results and discussion</head><p>To evaluate the effectiveness of our method, we made experiments on the heart disease database mentioned above. We compare our results with the previous results reported by earlier methods. Table <ref type="table" target="#tab_7">5</ref> gives the classification accuracies of our method and previous methods. As we can see from these results, our method using 10-fold cross validation obtains the highest classification accuracy, 96.30%, reported so far.</p><p>In this study, there were two diagnosis classes: healthy and a patient who is subject to possible heart disease. Classification results of the system were displayed by using a confusion matrix. In a confusion matrix, each cell contains the raw number of exemplars classified for the corresponding combination of desired and actual network outputs. Table <ref type="table" target="#tab_8">6</ref> gives the confusion matrix showing the classification results of this network.</p><p>The obtained sensitivity and specificity values by AIRS classifier with fuzzy weighted pre-processing are 92.30% and 100%, respectively. From the above results, we conclude that the new hybrid system combining the fuzzy weighting pre-processing and AIRS obtains very promising results in classifying the possible heart disease patients. We believe that the proposed system can be very helpful to the physicians for their final decision on their patients. By using such an efficient tool, they can make very accurate decisions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Conclusion</head><p>In this study, fuzzy weighted pre-processing and AIRS classifier based on a medical decision making method was applied to the task of diagnosing heart disease and the most accurate learning methods was evaluated. Experiments were conducted on the heart disease dataset to diagnose heart disease in a fully automatic manner. The results strongly suggest that fuzzy weighted pre-processing and AIRS classifier based on a medical decision making method can assist in the diagnosis of heart disease. We hope that more interesting results will follow on further exploration of data.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. Immune response.</figDesc><graphic coords="2,328.98,71.96,212.88,287.40" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 .Fig. 3 .</head><label>23</label><figDesc>Fig. 2. The flow chart of proposed system.</figDesc><graphic coords="3,338.15,322.04,212.88,79.03" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Output membership functions.</figDesc><graphic coords="4,163.24,70.94,285.96,99.62" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 1 Fuzzy</head><label>1</label><figDesc></figDesc><table /><note><p>rule base for our system k-value Rules 1 if Input_value cuts mf (k) and mf (k + 1) then Output_value = (mf (k) (y) + mf (k + 1) (y))/2 2 if Input_value cuts mf (k) and mf (k + 1) then Output_value = (mf (k) (y) + mf (k + 1) (y))/2 3 if Input_value cuts mf (k) and mf (k + 1) then Output_value = (mf (k) (y) + mf (k + 1) (y))/2 4 if Input_value cuts mf (k) and mf (k + 1) then Output_value = (mf (k) (y) + mf (k + 1) (y))/2 5 if Input_value cuts mf (k) and mf (k + 1) then Output_value = (mf (k) (y) + mf (k + 1) (y))/2 6 if Input_value cuts mf (k) and mf (k + 1) then Output_value = (mf (k) (y)</p></note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head>Table 2</head><label>2</label><figDesc>Used parameter values in AIRS for the lung vancer</figDesc><table><row><cell>Used parameters</cell><cell>Value</cell></row><row><cell>Mutation rate</cell><cell>0.10</cell></row><row><cell>ATS (affinity threshold scalar)</cell><cell>0.2</cell></row><row><cell>Stimulation threshold</cell><cell>0.99</cell></row><row><cell>Clonal rate</cell><cell>10</cell></row><row><cell>Hyper clonal rate</cell><cell>2.0</cell></row><row><cell>Number of resources</cell><cell>250</cell></row><row><cell>Iteration number</cell><cell>30</cell></row><row><cell>k-value for nearest neighbor</cell><cell>1</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_3"><head>Table 3</head><label>3</label><figDesc>Mapping between the immune system and AIRS The parameter that indicates how many mc s</figDesc><table><row><cell>Immune system</cell><cell>AIRS</cell></row><row><cell>Antibody</cell><cell>Feature vector</cell></row><row><cell>Recognition ball</cell><cell>Combination of feature vector and vector class</cell></row><row><cell>Shape-space</cell><cell>Type and possible values of the data vector</cell></row><row><cell>Clonal expansion</cell><cell>Reproduction of ARBs that are well-matched</cell></row><row><cell></cell><cell>antigens</cell></row><row><cell>Antigens</cell><cell>Training data</cell></row><row><cell>Affinity maturation</cell><cell>Random mutation of ARB and removal of the</cell></row><row><cell></cell><cell>least stimulated ARBs</cell></row><row><cell>Immune memory</cell><cell>Memory set of mutated ARBs</cell></row><row><cell>Metadynamics</cell><cell>Continual removal and creation of ARBs and</cell></row><row><cell></cell><cell>memory cells</cell></row><row><cell cols="2">• Number of resources: A parameter that limits the number</cell></row><row><cell cols="2">of ARBs allowed in the system. Each ARB is allocated to</cell></row><row><cell cols="2">a number of resources based on its stimulation value and</cell></row><row><cell>the clonal rate.</cell><cell></cell></row><row><cell cols="2">• k-nearest neighbor (KNN): A classification scheme in</cell></row><row><cell cols="2">which the response of the classifier to a previously un-</cell></row><row><cell cols="2">seen item is determined by a majority vote among the k</cell></row><row><cell cols="2">closest data points.</cell></row><row><cell>• k value:</cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head></head><label></label><figDesc>Metadynamics of mc s : Select the highest affinity ARB of the same class as the antigen from the last antigenic interaction. If the affinity of this ARB with the antigenic pattern is better than that of the previously identified best mc then add the candidate (mccandidate) to memory set M. If the affinity of mc and mc-candidate are below the affinity threshold, remove mc from M. 3. Classify: Classify data items using the memory set M.</figDesc><table><row><cell>b) Affinity maturation: Mutate each ARB descendant</cell></row><row><cell>of the highest affinity mc. Place each mutated ARB</cell></row><row><cell>into P.</cell></row><row><cell>(c) Metadynamics of ARBs: Process each ARB using</cell></row><row><cell>the resource allocation mechanism. This process will</cell></row><row><cell>result in some ARB death, and ultimately controls</cell></row><row><cell>the population. Calculate the average stimulation for</cell></row><row><cell>each ARB, and check for termination condition.</cell></row><row><cell>(d) Clonal expansion and affinity maturation: Clone and</cell></row><row><cell>mutate the randomly selected subset of the ARBs</cell></row><row><cell>left in P based on their stimulation level.</cell></row><row><cell>(e) Cycle: While the average stimulation value of each</cell></row><row><cell>ARB class group is less than a given stimulation</cell></row><row><cell>threshold go to step 2.c.</cell></row><row><cell>(f)</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head></head><label></label><figDesc>was supplied by Robert Detrano, M.D., Ph.D. of the V.A. Medical Center, Long Beach, CA. This database is part of the collection of databases at the University of California, Irvine collected by David Aha. The purpose of this dataset is to predict the presence or absence of heart disease given the results of various medical tests carried out on a patient. We use 270 examples from 303 examples from this database since 23 of them has missing data. There are two classes: presence and absence (of heart-disease). This database contains 13 attributes. Attributes of symptoms that are obtained from patient are listed as follows [12]:</figDesc><table><row><cell>1. age</cell></row><row><cell>2. sex</cell></row><row><cell>3. chest pain type (4 values)</cell></row><row><cell>4. resting blood pressure</cell></row><row><cell>5. serum cholestoral in mg/dl</cell></row><row><cell>6. fasting blood sugar &gt; 120 mg/dl</cell></row><row><cell>7. resting electrocardiographic results (values 0, 1, 2)</cell></row><row><cell>8. maximum heart rate achieved</cell></row><row><cell>9. exercise induced angina</cell></row><row><cell>10. oldpeak = ST depression induced by exercise relative to</cell></row><row><cell>rest</cell></row><row><cell>11. the slope of the peak exercise ST segment</cell></row><row><cell>12. number of major vessels (0-3) colored by flourosopy</cell></row><row><cell>13. thal: 3 = normal; 6 = fixed defect; 7 = reversable defect</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6"><head>Table 4</head><label>4</label><figDesc></figDesc><table><row><cell cols="2">Representation of condusion matrix</cell><cell></cell></row><row><cell>Actual</cell><cell>Predicted</cell><cell></cell></row><row><cell></cell><cell>Negative</cell><cell>Positive</cell></row><row><cell>Negative</cell><cell>a</cell><cell>b</cell></row><row><cell>Positive</cell><cell>c</cell><cell>d</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7"><head>Table 5</head><label>5</label><figDesc>Classification accuracies obtained with our proposed system and other classifiers from literature</figDesc><table><row><cell>Author (year)</cell><cell>Method</cell><cell>Accuracy</cell></row><row><cell></cell><cell></cell><cell>(%)</cell></row><row><cell>ToolDiag, RA</cell><cell>IB1-4</cell><cell>50.00</cell></row><row><cell>WEKA, RA</cell><cell>InductH</cell><cell>58.50</cell></row><row><cell>ToolDiag, RA</cell><cell>RBF</cell><cell>60.00</cell></row><row><cell>WEKA, RA</cell><cell>FOIL</cell><cell>64.00</cell></row><row><cell>ToolDiag, RA</cell><cell>MLP+BP</cell><cell>65.60</cell></row><row><cell>WEKA, RA</cell><cell>T2</cell><cell>68.10</cell></row><row><cell>WEKA, RA</cell><cell>1R</cell><cell>71.40</cell></row><row><cell>WEKA, RA</cell><cell>IB1c</cell><cell>74.00</cell></row><row><cell>WEKA, RA</cell><cell>K  *</cell><cell>76.70</cell></row><row><cell>Robert Detrano</cell><cell>Logistic regression</cell><cell>77.00</cell></row><row><cell>Newton Cheung (2001)</cell><cell>C4.5</cell><cell>81.11</cell></row><row><cell>Newton Cheung (2001)</cell><cell>Naive Bayes</cell><cell>81.48</cell></row><row><cell>Newton Cheung (2001)</cell><cell>BNND</cell><cell>81.11</cell></row><row><cell>Newton Cheung (2001)</cell><cell>BNNF</cell><cell>80.96</cell></row><row><cell>WEKA, RA</cell><cell>Naive-Bayes</cell><cell>83.60</cell></row><row><cell>K. Polat et al. (2005)</cell><cell>AIRS</cell><cell>84.50</cell></row><row><cell>K. Polat et al. (2006)</cell><cell>Fuzzy-AIRS-Knn</cell><cell>87.00</cell></row><row><cell></cell><cell>based system</cell><cell></cell></row><row><cell>Our Work (2006)</cell><cell>Fuzzy weighting</cell><cell>96.30</cell></row><row><cell></cell><cell>and AIRS</cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_8"><head>Table 6</head><label>6</label><figDesc></figDesc><table><row><cell>Confusion matrix</cell><cell></cell><cell></cell></row><row><cell>Output/desired</cell><cell>Result (normal)</cell><cell>Result (patient)</cell></row><row><cell>Result (normal)</cell><cell>14</cell><cell>1</cell></row><row><cell>Result (patient)</cell><cell>0</cell><cell>12</cell></row></table></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgment</head><p>This study has been supported by Scientific Research Project of Selcuk University (Project no: 05401069).</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title level="m" type="main">Machine learning techniques for medical analysis, School of Information Technology and Electrical Engineering</title>
		<author>
			<persName><forename type="first">N</forename><surname>Cheung</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2001">2001</date>
		</imprint>
		<respStmt>
			<orgName>University of Queenland</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">B.Sc. Thesis</note>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">A new classification method to diagnosis heart disease: supervised artificial immune system (AIRS)</title>
		<author>
			<persName><forename type="first">K</forename><surname>Polat</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Şahan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Kodaz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Güneş</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the Turkish Symposium on Artificial Intelligence and Neural Networks (TAINN)</title>
		<meeting>the Turkish Symposium on Artificial Intelligence and Neural Networks (TAINN)</meeting>
		<imprint>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title level="m" type="main">Artificial Immune Systems: A New Computational Intelligence Approach</title>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">N</forename><surname>De Castro</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Timmis</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002">2002</date>
			<publisher>Springer</publisher>
			<pubPlace>UK</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<monogr>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">K</forename><surname>Abbas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">H</forename><surname>Lichtman</surname></persName>
		</author>
		<title level="m">Cellular and Molecular Immunology</title>
		<meeting><address><addrLine>Philadelphia, PA</addrLine></address></meeting>
		<imprint>
			<publisher>W.B. Saunders Company</publisher>
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
	<note>fifth ed.</note>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">A new classifier based on attribute weighted artificial immune system</title>
		<author>
			<persName><forename type="first">S</forename><surname>Şahan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Kodaz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Güneş</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Polat</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="s">Lecture Notes in Computer Science</title>
		<idno type="ISSN">0302-9743</idno>
		<imprint>
			<biblScope unit="volume">3280</biblScope>
			<biblScope unit="page" from="11" to="20" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Theoretical studies of clonal selection: minimal antibody repertoire size and reliability of self-nonself discrimination</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">S</forename><surname>Perelson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">F</forename><surname>Oster</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Theor. Biol</title>
		<imprint>
			<biblScope unit="volume">81</biblScope>
			<biblScope unit="page" from="645" to="670" />
			<date type="published" when="1979">1979</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">A new method to medical diagnosis: artificial immune recognition system (AIRS) with fuzzy weighted pre-processing and application to ECG arrhythmia</title>
		<author>
			<persName><forename type="first">K</forename><surname>Polat</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Şahan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Güneş</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Expert Systems with Applications</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="264" to="269" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<monogr>
		<title level="m" type="main">AIRS: a resource limited artificial immune classifier</title>
		<author>
			<persName><forename type="first">A</forename><surname>Watkins</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2001">2001</date>
		</imprint>
		<respStmt>
			<orgName>Mississippi State University</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">Master Thesis</note>
</biblStruct>

<biblStruct xml:id="b8">
	<monogr>
		<author>
			<persName><forename type="first">R</forename><surname>Kohavi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Provost</surname></persName>
		</author>
		<title level="m">Glossary of Terms. Editorial for the Special Issue on Applications of Machine Learning and the Knowledge Discovery Process</title>
		<imprint>
			<date type="published" when="1998">1998</date>
			<biblScope unit="volume">30</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">Jeff</forename><surname>Schneider</surname></persName>
		</author>
		<author>
			<persName><forename type="first">'</forename></persName>
		</author>
		<author>
			<persName><forename type="first">Home</forename><surname>Page</surname></persName>
		</author>
		<ptr target="http://www.cs.cmu.edu/∼schneide/tut5/node42.html" />
		<imprint>
			<date type="published" when="2006-04-17">April 17, 2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Subsequently, he is pursuing his Ph.D. degree at the Electrical-Electronics Engineering Department of Selcuk University. His current research interests are artificial immune systems, biomedical signals and digital signal processing, pattern recognition and classification. About the Author-SALIH GÜNES graduated from Erciyes University in 1989. He took his M.S. degree in 1993 all in Electrical and Electronics Engineering at Erciyes University. He took her Ph.D. degree in Electrical and Electronics Engineering at Selcuk University in 2000. He is an Assistant Prof. Dr. at the Department of Electrical and Electronics Engineering at Selcuk University. His interest areas are biomedical signal processing, artificial immune system, logic circuits and artificial intelligence</title>
	</analytic>
	<monogr>
		<title level="m">Electrical and Electronics Engineering from Selcuk University, Turkey, in 1997 and his M.Sc. and Ph.D. degrees in computer engineering from Syracuse University</title>
		<meeting><address><addrLine>NY</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2001">2004. 2001. 2005</date>
		</imprint>
		<respStmt>
			<orgName>About the Author-KEMAL POLAT graduated from Electrical-Electronics Engineering Department of Selcuk University with B.Sc. degree in 2000 and from Electrical-Electronics Engineering Department of Selcuk University with M.Sc</orgName>
		</respStmt>
	</monogr>
	<note>About the Author-SULEYMAN TOSUN received his B.Sc. respectively. His research interests are embedded system design, reliability, design automation, and high-level synthesis of digital circuits</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
