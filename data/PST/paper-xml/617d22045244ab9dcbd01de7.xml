<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main"></title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Jian</forename><surname>Hu</surname></persName>
							<idno type="ORCID">0000-0003-2852-7675</idno>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Biostatistics, Epidemiology and Informatics</orgName>
								<orgName type="department" key="dep2">Perelman School of Medicine</orgName>
								<orgName type="institution">University of Pennsylvania</orgName>
								<address>
									<settlement>Philadelphia</settlement>
									<region>PA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Xiangj</forename><surname>Li</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">School of Statistics and Data Science</orgName>
								<orgName type="institution">Nankai University</orgName>
								<address>
									<settlement>Tianjin</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Kyle</forename><surname>Coleman</surname></persName>
							<idno type="ORCID">0000-0002-9726-2335</idno>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Biostatistics, Epidemiology and Informatics</orgName>
								<orgName type="department" key="dep2">Perelman School of Medicine</orgName>
								<orgName type="institution">University of Pennsylvania</orgName>
								<address>
									<settlement>Philadelphia</settlement>
									<region>PA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Amelia</forename><surname>Schroed</surname></persName>
							<idno type="ORCID">0000-0003-2422-9494</idno>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Biostatistics, Epidemiology and Informatics</orgName>
								<orgName type="department" key="dep2">Perelman School of Medicine</orgName>
								<orgName type="institution">University of Pennsylvania</orgName>
								<address>
									<settlement>Philadelphia</settlement>
									<region>PA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Nan</forename><surname>Ma</surname></persName>
							<idno type="ORCID">0000-0001-8553-7808</idno>
							<affiliation key="aff2">
								<orgName type="department">Weitzman School of Design</orgName>
								<orgName type="institution">University of Pennsylvania</orgName>
								<address>
									<settlement>Philadelphia</settlement>
									<region>PA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">David</forename><forename type="middle">J</forename><surname>Irwin</surname></persName>
							<idno type="ORCID">0000-0002-5599-5098</idno>
							<affiliation key="aff3">
								<orgName type="department">Department of Neurology</orgName>
								<orgName type="institution" key="instit1">Perelman School of Medicine</orgName>
								<orgName type="institution" key="instit2">University of Pennsylvania</orgName>
								<address>
									<settlement>Philadelphia</settlement>
									<region>PA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Edward</forename><forename type="middle">B</forename><surname>Lee</surname></persName>
							<idno type="ORCID">0000-0002-4589-1180</idno>
							<affiliation key="aff4">
								<orgName type="department" key="dep1">Department of Pathology and Laboratory Medicine</orgName>
								<orgName type="department" key="dep2">Perelman School of Medicine</orgName>
								<orgName type="laboratory">Translational Neuropathology Research Laboratory</orgName>
								<orgName type="institution">University of Pennsylvania</orgName>
								<address>
									<settlement>Philadelphia</settlement>
									<region>PA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Russell</forename><forename type="middle">T</forename><surname>Shinohara</surname></persName>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Biostatistics, Epidemiology and Informatics</orgName>
								<orgName type="department" key="dep2">Perelman School of Medicine</orgName>
								<orgName type="institution">University of Pennsylvania</orgName>
								<address>
									<settlement>Philadelphia</settlement>
									<region>PA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Mingyao</forename><surname>Li</surname></persName>
							<idno type="ORCID">0000-0003-2422-9494</idno>
							<affiliation key="aff0">
								<orgName type="department" key="dep1">Department of Biostatistics, Epidemiology and Informatics</orgName>
								<orgName type="department" key="dep2">Perelman School of Medicine</orgName>
								<orgName type="institution">University of Pennsylvania</orgName>
								<address>
									<settlement>Philadelphia</settlement>
									<region>PA</region>
									<country key="US">USA</country>
								</address>
							</affiliation>
						</author>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="DOI">10.1038/s41592-021-01255-8</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.2" ident="GROBID" when="2023-01-01T13:37+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>R</head><p>ecent technological advances in SRT have enabled gene expression profiling with spatial information in tissues 1 . Knowledge of the relative locations of different cells in a tissue is critical for understanding disease pathology because spatial information helps in understanding how the gene expression of a cell is influenced by its surrounding environment. Popular experimental methods for SRT can be broadly classified into two categories. The first category is in situ hybridization or sequencing-based technologies with single-cell resolution, which includes seqFISH 2,3 , seqFISH+ 4 , MERFISH 5,6 , STARmap 7 and FISSEQ 8 that measure the expression level for hundreds to thousands of genes in cells within their tissue context. The second category is in situ capturing-based technologies with spatial barcoding followed by sequencing, which includes spatial transcriptomics (ST) 9 , SLIDE-seq 10 , SLIDE-seqV2 (ref. <ref type="bibr" target="#b10">11</ref> ), HDST 12 and 10x Visium that measure the expression level for thousands of genes in captured locations, referred to as spots. These different SRT technologies have made it possible to uncover the complex transcriptional architecture of heterogeneous tissues and enhanced our understanding of cellular mechanisms in diseases <ref type="bibr" target="#b12">13,</ref><ref type="bibr" target="#b13">14</ref> .</p><p>In SRT studies, an important step is identifying spatial domains defined as regions that are spatially coherent in both gene expression and histology. Traditional clustering methods such as K-means and Louvain's method 15 only take gene expression data as input, and the resulting clusters may not be contiguous due to the lack of consideration of spatial information and histology. To account for spatial dependency of gene expression, new methods have been</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>developed. For example, Zhu et al. <ref type="bibr" target="#b15">16</ref> uses a Hidden-Markov random field (HMRF) approach to model spatial dependency of gene expression; stLearn <ref type="bibr" target="#b16">17</ref> uses features extracted from histology image as well as expression of neighboring spots spatially to normalize gene expression data before clustering; BayesSpace <ref type="bibr" target="#b17">18</ref> employs a Bayesian approach for clustering by imposing a prior that gives higher weight to physically close spots. Although these methods can cluster spots or cells into distinct groups, the lack of flexibility with different modalities has made them less versatile. As newer SRT technologies continue to be developed <ref type="bibr" target="#b18">[19]</ref><ref type="bibr" target="#b19">[20]</ref><ref type="bibr" target="#b20">[21]</ref><ref type="bibr" target="#b21">[22]</ref> , it is desirable to have methods that are compatible with different SRT platforms.</p><p>To link spatial domains with biological functions, it is crucial to identify genes that show enriched expression in the identified domains. Methods such as Trendsceek <ref type="bibr" target="#b22">23</ref> , SpatialDE <ref type="bibr" target="#b23">24</ref> and SPARK <ref type="bibr" target="#b24">25</ref> have been developed to detect spatially variable genes (SVGs). These methods examine each gene independently and return a P value to represent the spatial variability of a gene. However, due to the lack of consideration of spatial domains, genes detected by these methods do not have guaranteed spatial expression patterns, making it difficult to utilize these genes for further biological investigations.</p><p>Rather than considering spatial domain and SVG identification as separate problems, we developed SpaGCN, a graph convolutional network (GCN)-based approach that considers these two problems jointly. SpaGCN first identifies spatial domains by integrating gene expression, spatial location and histology through the construction of an undirected weighted graph that represents the spatial dependency of the data. For each spatial domain, SpaGCN then detects</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SpaGCN: Integrating gene expression, spatial location and histology to identify spatial domains and spatially variable genes by graph convolutional network</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Articles</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>NATuRE METhoDS</head><p>SVGs that are enriched in the domain. By restricting the search space to spatial domains, the SVGs detected by SpaGCN are guaranteed to have spatial expression patterns. The spatial domains and the corresponding SVGs provide a comprehensive picture of the spatial gradients in gene expression in tissue. SpaGCN is versatile in analyzing many types of SRT data, including ST, 10x Visium, SLIDE-seqV2, STARmap, and MERFISH.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Results</head><p>Overview of SpaGCN and evaluation. We explain the workflow of SpaGCN using in situ capturing-based SRT data as an example, but the method can be easily modified to analyze other types of SRT data. As shown in Fig. <ref type="figure">1a</ref>, SpaGCN first builds a graph to represent the relationship of all spots considering both spatial location and histology information. Next, SpaGCN utilizes a graph convolutional layer to aggregate gene expression information from neighboring spots. Then, SpaGCN uses the aggregated expression matrix to cluster spots using an unsupervised iterative clustering algorithm <ref type="bibr" target="#b25">26</ref> . Each cluster is considered as a spatial domain from which SpaGCN then detects SVGs that are enriched in a domain by DE analysis (Fig. <ref type="figure">1b</ref>). When a single gene cannot mark the expression pattern of a domain, SpaGCN will construct a meta gene, formed by the combination of multiple genes, to represent the expression pattern of the domain.</p><p>To showcase the strength of SpaGCN, we applied it to seven publicly available datasets (Supplementary Table <ref type="table">1</ref>). The spatial domains identified by SpaGCN agree better with known tissue structures than Louvain, stLearn, and BayesSpace. We also compared SVGs detected by SpaGCN with those detected by SpatialDE and SPARK, and found that the SpaGCN-detected SVGs have more coherent expression patterns and better biological interpretability than the other two methods. The specificity of spatial expression patterns revealed by SpaGCN-detected SVGs were further confirmed by Moran's I and Geary's C statistics <ref type="bibr" target="#b26">27</ref> , two commonly used metrics for quantifying spatial autocorrelation of gene expression <ref type="bibr" target="#b27">28,</ref><ref type="bibr" target="#b28">29</ref> .</p><p>Application to human primary pancreatic cancer ST data. To demonstrate the importance of incorporating histology information, we analyzed a human primary pancreatic cancer dataset generated using the ST technology <ref type="bibr" target="#b12">13</ref> . This dataset includes 224 spots and 16,448 genes with three manually annotated tissue regions. The cancer region detected by Louvain based on gene expression alone did not closely match the pathologist-annotated cancer region (Fig. <ref type="figure">2a</ref>). Spatial clustering methods such as stLearn and BayesSpace did not detect the cancer region either. SpaGCN revealed a similar pattern when using default parameters. As the histology image shows a clear difference between the cancer and noncancer regions, it suggests histology is informative for clustering. SpaGCN has the flexibility of modeling histology with a scaling parameter s, which controls the weight given to histology when detecting neighbors for each spot. By increasing the value of s from 1 to 2, SpaGCN detected a cluster that agrees well with the manually annotated cancer region. It is worth noting that when s was set at the default value of 1, SpaGCN detected the noncancer regions well. When s was increased to 2, SpaGCN not only maintained the ability to detect the noncancer regions but also detected the cancer region. This example showed that SpaGCN is flexible in incorporating histology information in clustering. Although stLearn can incorporate histology data, its use of histology information is pre-fixed by the radius when defining neighboring spots. The lack of flexibility in adjusting histology weight led to the discrepancy between their clustering and the pathologist's manual annotation.</p><p>Next, we detected SVGs using SpaGCN, SPARK and SpatialDE. In total, SpaGCN detected 12 SVGs, with three, eight and one SVGs for domains 0, 1 and 2, respectively (Fig. <ref type="figure">2b</ref>; Supplementary Fig. <ref type="figure">1</ref>). Furthermore, a meta gene using KRT17, MMP11 and SERPINA1 marked the cancer region better than the originally identified KRT17 for domain 2 (Fig. <ref type="figure">2c</ref>). KRT17 functions as a tumor promoter and regulates proliferation in pancreatic cancer <ref type="bibr" target="#b29">30</ref> , and MMP11 is a prognostic biomarker for pancreatic cancer <ref type="bibr" target="#b30">31</ref> . Our identification of KRT17 and MMP11 as the two positive genes for the cancer region agrees well with pancreatic cancer biology. SPARK and SpatialDE detected 203 and 163 SVGs, with their P or Q values highly skewed towards 0 (Supplementary Figs. <ref type="figure" target="#fig_1">2 and 3</ref>). However, the Moran's I and Geary's C values for their SVGs are much lower than those detected by SpaGCN, suggesting their lack of spatial patterns (Fig. <ref type="figure">2d</ref>). Furthermore, genes with smaller P or Q values do not necessarily show better spatial expression patterns than those with larger P or Q values (Supplementary Figs. <ref type="figure" target="#fig_2">4 and 5</ref>). More stringent filtering of spots and genes did not improve the spatial pattern for SpatialDE and SPARK-detected SVGs (Supplementary Fig. <ref type="figure">6</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Application to human dorsolateral prefrontal cortex 10x</head><p>Visium data. To show quantitatively that SpaGCN outperforms Louvain, stLearn and BayesSpace in spatial domain detection, we analyzed the LIBD human dorsolateral prefrontal cortex (DLPFC) data generated using 10x Visium <ref type="bibr" target="#b31">32</ref> . This study sequenced 12 tissue slices that span six neuronal layers plus white matter from the DLPFC in three human brains. The manual annotation of the tissue layers provided by the original study allows us to evaluate the accuracy of spatial domain detection. Figure <ref type="figure" target="#fig_1">3a</ref> shows that for the representative tissue slice 151673, both SpaGCN and BayesSpace revealed spatial domains that agree better with the manually annotated tissue layers than Louvain. Although stLearn utilized histology information, its performance is not much better than Louvain and is substantially worse than SpaGCN and BayesSpace. The relative performance of these methods remains the same when considering all 12 slices (Fig. <ref type="figure" target="#fig_1">3b</ref> and Supplementary Table <ref type="table">2</ref>); the median ARI is 0.36 for stLearn, 0.42 for BayesSpace and 0.45 for SpaGCN.</p><p>To validate further the identified spatial domains, we detected SVGs for each domain in slice 151673. In total, SpaGCN detected 67 SVGs, with 53 of them being specific to domain 5, which corresponds to white matter (Supplementary Fig. <ref type="figure">7</ref>). Patterns of SVGs for other domains are not very clear. These results indicate that gene expression profiles of spots from white matter are distinct from spots in the neuronal layers, while gene expression differences among the six neuronal layers are much smaller and more difficult to distinguish using individual marker genes. SVGs detected by SPARK and SpatialDE also suffered from the same problem. SPARK detected 3,187 SVGs with 1,131 of them having false discovery rate (FDR)-adjusted P values equal to 0, most of which only marked the white matter region (Supplementary Figs. <ref type="figure">8 and  9</ref>). We also found that the SVGs detected by SPARK lack domain specificity (Supplementary Fig. <ref type="figure">10</ref>). SpatialDE detected 3,654 SVGs with 806 of them having Q values equal to 0, but these genes do not necessarily show better spatial patterns than genes with larger Q values (Supplementary Fig. <ref type="figure">11</ref>). Although SPARK and SpatialDE detected much larger numbers of SVGs than SpaGCN, the genes detected by these two methods cannot distinguish different degrees of spatial expression variability as their P or Q value distributions are highly skewed towards 0. Figure <ref type="figure" target="#fig_1">3c</ref> shows that the Moran's I values for SpaGCN-detected SVGs are significantly higher than genes detected by SpatialDE and SPARK (median of 0.39 for SpaGCN against 0.09 for SPARK and 0.08 for SpatialDE). More stringent filtering of spots and genes did not improve the performance of SpatialDE and SPARK (Supplementary Fig. <ref type="figure" target="#fig_0">12</ref>). For three out of the six neuronal layers, SpaGCN detected a single SVG to mark that region (Fig. <ref type="figure" target="#fig_1">3d</ref>). For example, CAMK2N1 is enriched in domain 0 (layers 1 and 2), PCP4 is enriched in domain 1 (layer 4) and NEFM is enriched in domain 3 (layer 3).</p><p>To show that SpaGCN-detected SVGs are useful for downstream analysis, we performed K-means clustering on slice 151507, which is from a different brain, using all 67 SVGs detected from slice 151673 by SpaGCN. Compared with manually curated layer assignment, this clustering analysis had a Adjusted Rand Index (ARI) of 0.23 (Fig. <ref type="figure" target="#fig_1">3e,f</ref>). We performed similar analysis using SVGs detected by SpatialDE and SPARK. When randomly selecting 67 SVGs with 0 P or Q value from genes detected by SpatialDE/SPARK, the ARI is only 0.13 for SpatialDE and 0.14 for SPARK. The ARIs for SpatialDE and SPARK did not improve even with increased numbers of SVGs (Fig. <ref type="figure" target="#fig_1">3e</ref>). These results further confirmed the lack of spatial patterns for genes detected by SPARK and SpatialDE.</p><p>Although it is difficult to identify single genes to mark certain neuronal layers, SpaGCN was able to find domain-specific meta genes. As shown in Fig. <ref type="figure" target="#fig_1">3g</ref>, SpaGCN detected meta genes for domains 1, 2, 4 and 6. The meta gene for domain 2 is specific to </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Articles</head><p>NATuRE METhoDS layer 1. As layer 1 only has a few spots, it is difficult to find a highly enriched gene. However, by adding depleted genes such as FTH1, MBP, MT-CO3 and PLP1, the expression pattern in this region is strengthened. Furthermore, the SVGs and meta genes detected by SpaGCN are transferrable to slice 151507 obtained from a different brain, in which the meta genes detected in slice 151673 mark the same layers in slice 151507 (Fig. <ref type="figure" target="#fig_1">3g</ref> and Supplementary Fig. <ref type="figure" target="#fig_1">13</ref>).</p><p>Application to mouse posterior brain 10x Visium data. Next, we analyzed a 10x Visium dataset generated from mouse posterior brain that includes 3,353 spots and 31,053 genes <ref type="bibr" target="#b32">33</ref> . This dataset shows much more complex tissue structure than the previous two datasets. We compared the clustering result of SpaGCN with Louvain, stLearn and BayesSpace when the number of clusters was set at ten for all methods. Figure <ref type="figure" target="#fig_2">4a</ref> shows that Louvain's clustering is similar to stLearn, BayesSpace and SpaGCN, but the spatial domains detected by the latter three methods are more spatially contiguous due to their ability to account for spatial dependency of gene expression.</p><p>We further investigated the ability of each method in detecting more refined tissue structure. Specifically, we performed subclustering analysis for spots in domain 5 detected by SpaGCN, which corresponds to the cortex (Fig. <ref type="figure" target="#fig_2">4b</ref>). The subdomains detected by SpaGCN agree well with the Allen Brain Institute reference atlas diagram of the mouse cortex (Fig. <ref type="figure" target="#fig_2">4c</ref>). The detected subdomains include layers 2/3, layers 4/5, layer 6, a hippocampal region (CA1) and the subiculum. Layers 2/3 are the 'external' cortical layers that are biologically responsible for local networks in which neurons in this subdomain communicate to other neurons in adjacent neocortical regions. Layers 4/5 are the 'internal' cortical layers that are biologically responsible for longer range neural networks. For example, the visual cortex, which corresponds to the neocortical region, is responsible for receiving visual information from the lateral geniculate nucleus that is far away. SpaGCN was able to separate the molecular (layer 1), external (layers 2/3), internal (layers 4/5) and the plexiform (6) layers. More importantly, SpaGCN outperformed Louvain and stLearn, which show combining of neocortical layers. SpaGCN also outperformed BayesSpace in distinguishing between the plexiform layer (subdomain 1) and the non-neocortical CA1 region of the hippocampus (subdomain 3). In contrast, BayesSpace combined layer 6 of the neocortex with the non-neocortical CA1 layer of the hippocampus.</p><p>Next, we compared SpaGCN with SPARK and SpatialDE for SVG detection. SpaGCN detected 1,028 SVGs for the ten spatial domains while SPARK and SpatialDE detected 9,678 and 12,676 SVGs, respectively (Supplementary Fig. <ref type="figure" target="#fig_2">14</ref>). As shown in Fig. <ref type="figure" target="#fig_2">4d</ref>, the Moran's I values of SpaGCN-detected SVGs are much higher than those detected by SPARK and SpatialDE (median of 0.54 for SpaGCN against 0.20 for SPARK and 0.16 for SpatialDE). More stringent filtering of spots and genes did not improve the performance of SPARK and SpatialDE (Supplementary Fig. <ref type="figure">15</ref>). The P or Q value distributions of SpatialDE and SPARK are highly skewed towards 0 (Supplementary Fig. <ref type="figure">16</ref>), and genes with similar P or Q values do not necessarily show similar spatial patterns and a smaller P or Q value does not guarantee a better spatial pattern (Supplementary Figs. <ref type="figure">17 and 18</ref>). In contrast, multiple domain adaptive filtering criteria implemented in SpaGCN allow it to eliminate false positive SVGs and ensure all detected SVGs have clear spatial expression patterns.</p><p>To illustrate how the filtering in SpaGCN works, we use domains 1, 5 and 8 as an example. For each of these domains, SpaGCN detected a single SVG enriched in that region. As shown in Fig. <ref type="figure" target="#fig_2">4e</ref>, PVALB is enriched in domain 1 and TRM62 is enriched in domain 8. Although domains 1 and 8 are adjacent to each other, these two SVGs can still well mark these domains. NRGN is a SVG that SpaGCN detected for domains 5 and 7. The high expression of NRGN in domains 5 and 7 also indicates that these two domains are neuroanatomically similar-both consisting of cortex and the pyramidal layer of the hippocampus. Both the cortex and hippocampus are regions that are on the curved surface of the brain. Domains 5 and 7, which would be contiguous in a three-dimensional (3D) reconstruction, are artifactually separated as a result of how the section was cut. Therefore, it is not surprising that in addition to NRGN, SpaGCN also detected many other SVGs for domains 5 and 7, some of which are highly expressed in both domains (Supplementary Fig. <ref type="figure">19</ref>). The unique and powerful SVG detection procedure in SpaGCN ensures that genes such as these are not missed.</p><p>SpaGCN only identified four SVGs for domain 0. However, we reason that a meta gene, formed by the combination of multiple genes, may better reveal spatial patterns than any single genes. We used domain 0 as an example to show how SpaGCN can create informative meta genes to mark a spatial domain (Fig. <ref type="figure" target="#fig_2">4f</ref>). First, by lowering the filtering thresholds, SpaGCN identified KLK6 which is highly expressed in the lower part of domain 0. Using KLK6 as a starting gene, SpaGCN used a novel approach to find a log-linear combination of gene expression of KLK6, MBP and ATP1B1, which accurately marked the spatial domain 0. In this meta gene, KLK6 and MBP are considered as positive markers because they are highly expressed in some spots in domain 0, whereas ATP1B1 is considered a negative marker as it is mainly expressed in regions other than domain 0. Previous studies have shown that KLK6 and MBP expression is restricted to oligodendrocytes, while ATP1B1 is mainly expressed in neurons and astrocytes <ref type="bibr" target="#b33">34</ref> . This resonates with the fact that domain 0 represents white matter which is dominated by oligodendrocytes and has few neuronal cell bodies. Therefore, the genes that make up this meta gene have meaningful biological interpretations.</p><p>While we focused our analyses on one tissue section, SpaGCN can also jointly analyze multiple tissue sections. We show two examples using this mouse brain Visium data provided by 10x Genomics. Figure <ref type="figure">5a</ref> shows SpaGCN clustering results for two mouse posterior sections. As these two tissue sections are from the same region, SpaGCN was able to infer cluster correspondence between the two tissue sections. Next, we used SpaGCN to analyze jointly two tissue </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Articles</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>NATuRE METhoDS</head><p>sections with one from the mouse posterior brain and the other from the mouse anterior brain. As the anterior section and posterior section are adjacent in the brain, we modified the coordinates for spots in the posterior section such that the revised coordinates reflect the spatial adjacency of the two tissue sections. Using the modified coordinates as input, SpaGCN was able to produce clustering results that reflect the shared layer structure in the anterior and posterior brain (Fig. <ref type="figure">5b</ref>). Application to mouse visual cortex STARmap data. Finally, we analyzed a STARmap dataset that has single-cell resolution <ref type="bibr">7</ref> . This dataset was generated from mouse visual cortex that spans from hippocampus to corpus callosum, and the six neocortical layers. In total, 1,020 genes were measured in 1,207 cells that include non-neuronal cells, excitatory and inhibitory neurons. The layer structure and cell type distribution of the tissue section provided by the original study are shown in Fig. <ref type="figure">6a</ref>. As the tissue capture area of STARmap is much smaller than 10x Visium, we increased the contribution of neighboring cells from 0.5 to 1 when calculating the weighted gene expression of each cell in SpaGCN. Using this approach, SpaGCN detected spatial domains that agreed well with the annotated tissue structure (Fig. <ref type="figure">6a,c</ref>), achieving an ARI of 0.51. By contrast, the ARIs of the other methods are much lower (0.30 for Louvain, 0.37 for BayesSpace and 0.03 for HMRF) (Fig. <ref type="figure">6b</ref>). This example demonstrates that SpaGCN utilizes spatial information more efficiently than BayesSpace and HMRF. Using SpaGCN, we further detected 25 SVGs including genes LAMP5, HPCAL1, CPLX1, PLP1, NRSN1, ATP1A2 and BSG that showed enriched expression patterns for domains 0 to 6 (Fig. <ref type="figure">6e</ref> and Supplementary Fig. <ref type="figure">20</ref>). Similar to previous analyses, SPARK and SpatialDE detected much larger number of SVGs but many of the SVGs lack spatial expression patterns (Fig. <ref type="figure">6d</ref> and Supplementary Figs. <ref type="figure" target="#fig_2">21-24</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Discussion</head><p>In this paper, we presented SpaGCN, a method that integrates gene expression, spatial location and histology to model spatial dependency of gene expression for the identification of spatial domains and domain enriched SVGs. SpaGCN has been extensively tested on datasets from different species, regions and tissues generated using diverse SRT technologies. Additional analyses on ST <ref type="bibr" target="#b8">9</ref> , SLIDE-seqV2 (ref. <ref type="bibr" target="#b10">11</ref> ) and MERFISH <ref type="bibr" target="#b4">5</ref> data are shown in Supplementary Notes 1-3. Our results consistently showed that SpaGCN can identify spatial domains with coherent gene expression and histology, and </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Articles</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>NATuRE METhoDS</head><p>detect SVGs and meta genes that have much clearer spatial expression patterns and biological interpretations than genes detected by SpatialDE and SPARK. Additionally, the SpaGCN-detected SVGs are transferrable and can be utilized for downstream analyses in independent tissue sections. SpaGCN is also computationally fast and memory efficient compared to SPARK and SpatialDE (Supplementary Note 4). The spatial domain detection step in SpaGCN is flexible. First, SpaGCN can adjust the weight of histology in gene expression smoothing. For datasets with clear tissue structure in histology, higher weight led to clearer separation of cancer versus noncancer regions. Second, during the GCN fitting procedure, the graph weights are updated, which allows SpaGCN to learn an efficient way to aggregate gene expression from neighboring spots for each gene. For data generated from different platforms, the spatial dependency between spots/cells is different as the size of the captured tissue area varies. The flexibility in modeling spatial dependency makes SpaGCN versatile for different types of SRT data.</p><p>A limitation of SpaGCN is that the spatial domain detection is mainly driven by gene expression, which may lead to the discrepancy between the detected domains and the underlying tissue anatomical structure. This is a general problem for gene expression-based clustering methods. Another limitation of SpaGCN is the lack of separation of spatial variation and cell type variation in gene expression patterns for the detected SVGs. To address these limitations, methods that can jointly consider gene expression and histological features in clustering are needed. Further, cell type-specific gene expression needs to be estimated to tease out the contribution of cell types and spatial location in gene expression variation. We anticipate that methods development along these directions is warranted for future research.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Articles</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>NATuRE METhoDS</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Methods</head><p>Data preprocessing. SpaGCN takes spatial gene expression and histology image data (when available) as input. For ease of explanation, we will use in situ capturing-based SRT data to illustrate the method. The spatial gene expression data are stored in an N × D matrix of unique molecular identifier (UMI) counts with N spots and D genes, along with the (x,y) two-dimensional (2D) spatial coordinates of each spot. Genes expressed in fewer than three spots are eliminated. The gene expression values in each spot are normalized such that the UMI count for each gene is divided by the total UMI count across all genes in a given spot, multiplied by 10,000, and then transformed to a natural log scale.</p><p>Conversion of SRT data into graph-structured data. After preprocessing, SpaGCN converts the gene expression and histology image data into a weighted undirected graph, G(V,E). In this graph, each vertex v∈V represents a spot and every two vertices in V are connected via an edge with a specified weight. We note that spage2vec <ref type="bibr" target="#b37">35</ref> also employed a graph-based approach, but with the goal of clustering messenger RNA molecules in which each node represents a mRNA. Such a segmentation-free approach may offer advantages over methods that require segmented cells as cell segmentation is still one of the hardest problems in single-cell analysis.</p><p>Calculation of distance between two vertices. The distance between any two vertices u and v in the graph reflects the relative similarity of the two corresponding spots. This distance is determined by two factors: (1) the physical locations of spots u and v in the tissue slice, and (2) the corresponding histology information of these two spots. Although some spots are physically close to each other in the tissue, the histology image may reveal them belonging to different tissue layers. Therefore, SpaGCN considers two spots to be close if and only if (1) the two spots are physically close, and (2) they have similar histological features as shown in the histology image. To define a distance metric considering both aspects, SpaGCN extends the 2D space in the tissue slice into a 3D space that incorporates histology information. For spot v, its physical location in the tissue slice is represented by 2D coordinates (xv, yv). To determine the corresponding pixel in the histology image for spot v, SpaGCN maps spot v to the histology image according to its pixel coordinates (xpv, ypv). Instead of using the color of the pixel at (xpv, ypv), SpaGCN draws a square centered on (xpv, ypv) containing 50 × 50 pixels and calculates the mean color value for the RGB channels, (rv, gv, bv), of all pixels that fall in the square. This step smooths the color value and ensures that the color is not dominated by a single pixel. To derive a single value to represent the histology image features, SpaGCN uses a weighted sum of the RGB values as follows,</p><formula xml:id="formula_0">zv = rv × Vr + gv × Vg + bv × V b Vr + Vg + V b ,</formula><p>where Vr = variance (rv), Vg = variance (gv) and V b = variance (bv) for all v∈V in this transformation, higher weight is given to the channel with larger variance so that this combined value z v captures an accurate representation of the patterns in the histology image. Next, SpaGCN rescales z v as</p><formula xml:id="formula_1">z * v = zv − μ z σz × max ( σx, σy ) × s,</formula><p>where μ z is the mean of z v , σx, σy, σz are the standard deviations of x v , y v and z v , respectively, for v∈V, and s is a scaling factor. By default, s is set at 1 to ensure that z * v has the same scale variance as x v and y y , and we set s to a value larger than 1 when the goal is to increase the weight of histology. The coordinates of spot v are set to be (xv, yv, z * v ) in the extended 3D space. Finally, the Euclidean distance between every two spots u and v is calculated as</p><formula xml:id="formula_2">d (u, v) = √ (xu − xv) 2 + (yu − yv) 2 + (z * u − z * v ) 2 .</formula><p>When histology information is not available, the Euclidean distance between every two spots will be calculated based on spatial location information only.</p><p>Calculation of weight for each edge and construction of graph. The weight of each edge (u,v) measures the degree of relatedness between spots u and v and is negatively associated with their distance. The graph structure G is stored in an N × N adjacency matrix A = [w (u, v)], where the edge weight between spot u and spot v is defined as</p><formula xml:id="formula_3">w (u, v) = exp ( − d (u, v) 2 2l 2</formula><p>) .</p><p>The hyperparameter l, also known as the characteristic length scale, determines how rapidly the weight decays as a function of distance. A similar function has been employed in SpatialDE <ref type="bibr" target="#b23">24</ref> . Let I denote the identity matrix. For spot v, the corresponding row sum of A − I, denoted by a v , can be interpreted as the relative contribution of other spots to its gene expression. By default, we choose the value of l such that the average of a v across all spots is equal to a prespecified value, for example, 0.5. For data generated from SRT platforms with small tissue capture areas, for example, SLIDE-seqV2, STARmap and MERFISH, we suggest choosing the value of l such that neighboring spots/cells contribute more information in gene expression aggregation.</p><p>Graph convolutional layer. SpaGCN reduces the dimension of the preprocessed gene expression matrix using principal component analysis (PCA). The top 50 principal components are used as input, which work well for all datasets analyzed in this paper. Next, utilizing the power of a graph convolutional network, SpaGCN concatenates the gene expression information and edge weights in G to cluster the nodes. Following Kipf and Welling <ref type="bibr" target="#b38">36</ref> , the graph convolutional layer can be written as</p><formula xml:id="formula_4">f (X, A) = δ (AXB) ,</formula><p>where X is the N × 50 embedding matrix obtained from PCA, B is a 50 × 50 matrix representing filter parameters of the convolutional layer, and δ(•) is a nonlinear activation function such as ReLU. The graph convolutional layer ensures that a corresponding row of parameters in B will control the aggregation of neighborhood information for each feature in X, thus offering the flexibility of feature-specific aggregation of information provided by neighboring spots. The filter parameters in B are shared across all vertices in the graph and are automatically updated during an iterative training progress. Through graph convolution, SpaGCN has aggregated the gene expression information according to the edge weights specified in G. The output of this layer is an aggregated matrix that includes information on gene expression, spatial location and histology. The graph convolutional layer was implemented based on Kipf and Welling <ref type="bibr" target="#b38">36</ref> , in which the backpropagation is operated via a localized first-order approximation of spectral graph convolution.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Spatial domain identification by clustering.</head><p>Next, based on the output from the above graph convolutional layer, SpaGCN employs an unsupervised clustering algorithm iteratively to cluster the spots into different spatial domains <ref type="bibr" target="#b25">26</ref> . Each cluster identified from this analysis is considered to be a spatial domain, which contains spots that are coherent in gene expression and histology. To initialize cluster centroids, we use Louvain's method <ref type="bibr" target="#b14">15</ref> on the aggregated output matrix from the graph convolutional layer. If the number of domains in the tissue is known, the resolution parameter in Louvain will be set to generate the same number of spatial domains. Otherwise, we vary the resolution parameter from 0.2 to 1.0 and select the resolution that gives the highest Silhouette score <ref type="bibr" target="#b39">37</ref> .</p><p>To update the cluster assignments iteratively, we define a metric to measure the distance from a spot to a cluster centroid using the Student's t-distribution as a kernel. The distance between the embedded point h i for spot i and centroid μ j for cluster j</p><formula xml:id="formula_5">qij = ( 1 + hi − μ 2 j ) −1 ∑ K j ′ =1 ( 1 + hi − μ 2 j ′ ) −1 ,</formula><p>can be interpreted as the probability of assigning cell i to cluster j. Next, we iteratively refine the clusters by defining an auxiliary target distribution P based on</p><formula xml:id="formula_6">q ij pij = q 2 ij / ∑ N i=1 qij ∑ K j ′ =1 ( q 2 ij ′ / ∑ N i=1 q ij ′ ) ,</formula><p>which upweights spots assigned with high confidence, and normalizes the contribution of each centroid to the overall loss function to prevent large clusters from distorting the hidden feature space. Now that we have the soft assignment q ij and the auxiliary distribution p ij , we can define the objective function as a Kullback-Leibler (KL) divergence loss,</p><formula xml:id="formula_7">L = KL(P||Q) = N ∑ i=1 K ∑ j=1 pijlog pij qij .</formula><p>The network parameters and cluster centroids are simultaneously optimized by minimizing L using stochastic gradient descent with momentum. This unsupervised iterative clustering algorithm has previously been utilized for scRNA-seq analysis and showed superior performance over Louvain's method <ref type="bibr" target="#b40">38,</ref><ref type="bibr" target="#b41">39</ref> .</p><p>After clustering, SpaGCN also provides an optional refinement step for the clustering result. In this step, SpaGCN examines the domain assignment of each spot and its surrounding spots. For a given spot, if more than half of its surrounding spots are assigned to a different domain, this spot will be relabeled to the same domain as the major label of its surrounding spots. As this refinement step only relabels a few spots, it has little impact on the downstream SVG detection. We performed cluster refinement only for the human dorsolateral prefrontal cortex 10x Visium data and the STARmap data when comparing to their manual annotations with clear domain boundaries.</p><p>NATuRE METHODS | www.nature.com/naturemethods Detection of SVGs. We are interested in detecting SVGs that are enriched in each spatial domain. We note that some genes may be expressed in multiple but disconnected domains. Although they are not uniquely expressed in a particular domain, these genes are still useful for understanding spatial variation of gene expression and can be used to form meta genes that are uniquely expressed in a specific domain. Therefore, rather than doing DE analysis using spots from a target domain versus all other spots, we first select spots to form a neighboring set of the target domain. The goal is to detect genes that are highly expressed in the target domain but are not expressed or are expressed at low levels in the neighboring spots. Supplementary Fig. <ref type="figure">25</ref> illustrates how a neighboring domain is identified. Briefly, we draw a circle with a prespecified radius around each spot in the target domain, and spots from nontarget domains but residing in the circle are considered its neighbors. The radius is set such that each spot in the target domain has approximately ten neighbors on average. Next, neighbors of all spots in the target domain are collected and form a neighboring set. For each nontarget domain, if more than 50% (default) of its spots are in the neighboring set, this domain is then selected as a neighboring domain. This criterion is set to avoid the situation in which a domain is selected as a neighboring domain, but only a small proportion of its spots are adjacent to the target domain.</p><p>After neighboring domains are determined, SpaGCN then performs DE analysis between spots in the target domain and the neighboring domain(s) using the Wilcoxon rank-sum test. Genes with a FDR-adjusted P value &lt;0.05 are selected as SVGs. To ensure only genes with enriched expression patterns in the target domain are selected, we further require a gene to meet the following three criteria: (1) the percentage of spots expressing the gene in the target domain, that is, in-fraction, is &gt;80%; (2) for each neighboring domain, the ratio of the percentages of spots expressing the gene in the target domain and the neighboring domain(s), that is, in/out fraction ratio, is &gt;1; and (3) the expression change between the target and neighboring domain(s) is &gt;1.5. If a user is interested in finding SVGs for a particular combination of spatial domains, SpaGCN offers the option to do so. Detection of spatially variable meta genes. The spatial domain-specific DE analysis described above typically detects SVGs with enriched expression for the majority of the domains. For domains in which no such SVGs are detected, we aim to identify a set of genes that, when combined to form a meta gene, shows an enriched expression pattern in the given domain. To identify genes to form a meta gene, we employ a multi-step approach. First, we lower the thresholds for SVG filtering, for example, change the minimum fold change threshold from 1.5 to 1.2, to identify genes showing a weaker enriched expression pattern in the target domain. In the presence of multiple such weaker SVGs, we randomly select one of them as the base gene and denote it as gene 0 . Second, we aim to aggregate expression from other genes to the base gene to enhance the spatial pattern for the target domain. To achieve this goal, we first calculate the mean expression level of gene 0 for spots in the target domain as e 0 . Then, all spots from nontarget domains with the expression level higher than e 0 of gene 0 are extracted to form a control group. Next, we perform DE analysis using spots from the target domain against spots in the control group using the Wilcoxon rank-sum test. The gene with the smallest FDR-adjusted P value and higher expression in the target domain is selected as gene 0+ . Similarly, we perform DE analysis using spots from the control group against those from the target domain and select a gene with the smallest FDR-adjusted P value and higher expression in the control group as gene 0− . The expression of the meta gene is calculated as</p><formula xml:id="formula_8">log (meta_gene1) = log (gene0) + log (gene0+) − log (gene0−) + C0,</formula><p>where C 0 is a constant to make log (meta_gene1) non-negative. The log transformation is used to rescale expression and make the expression levels comparable across different genes. We have found that including negative genes can strengthen the spatial expression pattern for domains that do not have enriched positive marker genes. This algorithm can be used iteratively to find additional genes to form an updated meta gene with a clearer spatial pattern for the target domain. For the (t + 1)th iteration, the meta gene expression is calculated as</p><formula xml:id="formula_9">log (meta_genet+1) = log (meta_genet) + log (genet+) − log (genet−) + Ct</formula><p>In the (t + 1)th iteration, after adding genet+ and subtracting genet−, SpaGCN will select the (t + 1)th control group based on meta_genet+1. The size of the new control group, which is the number of spots not in the target domain but have higher expression of meta_genet+1 than spots in the target domain, should be smaller than the size of the tth control group, to ensure that meta_genet+1 has a clearer spatial pattern than meta_genet. Also, meta_genet+1 is expected to have a larger difference of mean expression between the target and control groups than meta_genet. Therefore, at each iteration, SpaGCN checks whether both criteria are met, and the search of additional genes will stop otherwise. An illustration of this iterative meta gene search is shown in Supplementary Fig. <ref type="figure">26</ref>.</p><p>Evaluation of SVGs using Moran's I and Geary's C statistics. Gene expressions at different locations may not be independent. For example, the expression levels of a gene at nearby locations may be closer in value than expression levels at locations that are farther apart. This phenomenon is called spatial autocorrelation, which measures the correlation of a variable with itself through space. To evaluate whether the detected SVGs exhibit an organized spatial expression pattern, we used Moran's I and Geary's C, two commonly used statistics to quantify the degree of spatial autocorrelation of gene expression. Spatial autocorrelation can be positive or negative. Positive spatial autocorrelation occurs when similar values occur near one another. Negative spatial autocorrelation occurs when dissimilar values occur near one another. Moran's I metric <ref type="bibr" target="#b26">27</ref> is a correlation coefficient that measures the overall spatial autocorrelation of a dataset. Intuitively, for a given gene, it measures how one spot is similar to other spots surrounding it. If the spots are attracted (or repelled) by each other, it implies the spots are not independent. Thus, the presence of autocorrelation indicates the spatial pattern of gene expression. The Moran's I value ranges from -1 to 1, where a value close to 1 indicates a clear spatial pattern, a value close to 0 indicates random spatial expression, and a value close to -1 indicates a chess board-like pattern. To evaluate the spatial variability of a given gene, we calculate the Moran's I using the following formula,</p><formula xml:id="formula_10">I = N W ∑ i ∑ j [wij(xi − x)(xj − x)] ∑ i (xi − x) 2</formula><p>, where x i and x i are the gene expression of spots i and j, x is the mean expression of the gene, N is the total number of spots, w ij is spatial weight between spots i and j calculated using the 2D spatial coordinates of the spots, and W is the sum of w ij .</p><p>For each spot, we select the k nearest neighbors using spatial coordinates. Moran's I statistic is robust to the choice of k and is set at 4 in our analysis. We assign w ij =1 if spot j is in the nearest neighbors of spot 𝑖, and w ij =0 otherwise. Geary's C is another commonly used statistic for measuring spatial autocorrelation. It is calculated as</p><formula xml:id="formula_11">C = N 2W ∑ i ∑ j [wij(xi − xj) 2 ] ∑ i (xi − x) 2 ,</formula><p>The value of Geary's C ranges from 0 to 2. To make it on the same scale as Moran's I, we convert it to the [−1,1] scale by</p><formula xml:id="formula_12">C * = 1 − C,</formula><p>where 1 indicates perfect positive autocorrelation, 0 indicates no autocorrelation and −1 indicates perfect negative autocorrelation. For each gene, the values of Geary's C are similar but not identical to Moran's I.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Transferability of SpaGCN detected SVGs.</head><p>A genuine SVG should show transferability, that is, the spatial expression pattern should be similar across different datasets collected from the same tissue type. To show the transferability of SpaGCN-detected SVGs, first, we show that the SVGs detected in one dataset also show similar spatial expression patterns in an independent dataset. Second, we show that SVGs detected in one dataset can be used to cluster spots in an independent dataset and achieve relatively high clustering accuracy.</p><p>Comparison with other methods. To evaluate the performance of SpaGCN in identifying spatial domains, we compare with Louvain, BaysSpace, stLearn and HMRF. We use the default parameter settings for all methods and the same number of clusters in clustering. To evaluate the performance of SpaGCN in detecting SVGs, we compare with SPARK and SpatialDE. We initially detect SVGs using their default parameter settings. By default, both SPARK and SpatialDE filter out spots with total UMI counts less than ten. In SPARK, genes expressed in fewer than 10% of the spots are filtered out. In SpatialDE, genes expressed in fewer than three spots are filtered out. To evaluate the impact of filtering criteria on SPARK and SpatialDE, we further eliminate genes expressed in fewer than 20% of the spots. The specificity of spatial expression patterns of detected SVGs is evaluated by Moran's I and Geary's C statistics.</p><p>Reporting summary. Further information on research design is available in the Nature Research Reporting Summary linked to this article.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 |Fig. 2 |</head><label>12</label><figDesc>Fig. 1 | Workflow of SpaGCN. a, SpaGCN starts from integrating gene expression, spatial location, and histology information using a graph convolutional network (GCN), then separates spots into different spatial domains using unsupervised iterative clustering. The GCN is based on an undirected weighted graph in which the edge weight between every two spots is determined by Euclidean distance between the two spots, defined by the spatial coordinates (x,y) and the third dimensional coordinate z, obtained from the RGB values in the histology image. b, For each detected spatial domain, SpaGCN identifies SVGs or meta genes by domain guided DE analysis.</figDesc><graphic url="image-1.png" coords="3,231.63,508.25,118.08,69.12" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 3 |</head><label>3</label><figDesc>Fig. 3 | Spatial domains and SVGs detected in the LIBD human dorsolateral prefrontal cortex data. a, Histology and manually annotated layer structure for slice 151673 from the original study<ref type="bibr" target="#b31">32</ref> , and spatial domains detected by Louvain, stLearn, BayesSpace and SpaGCN. b, Boxplot of clustering ARIs for all 12 tissue slices for SpaGCN (n=12), stLearn (n=12) and BayesSpace (n=12). The lower and upper hinges correspond to the first and third quartiles and the center refers to the median value. The upper (lower) whiskers extend from the hinge to the largest (smallest) value no further (at most) than 1.5 × interquartile range from the hinge. Data beyond the end of the whiskers are plotted individually. c, Boxplot of Moran's I and Geary's C values for SVGs detected by SpaGCN (n=65), SPARK (n=3,187) and SpatialDE (n=3,654) for slice 151673. Boxplot hinges, median and whiskers are defined the same as in b and d. Spatial expression patterns of SVGs for domain 0 (CAMK2N1), domains 1 (PCP4) and domain 3 (NEFM) for slice 151673. e, ARIs between manually annotated layers and K-means' clustering using various numbers of SVGs detected by different methods. For SpaGCN, we used the 67 SVGs while for SPARK and SpatialDE, we used their top 67, 100, 200, 500 and all SVGs with the identical smallest FDR-adjusted P value or Q value. f, Manually annotated layer structure for slice 151507 from the original study. K-means clustering results for slice 151507 using the 67 SVGs detected by SpaGCN, and the top 67 SVGs with the identical smallest FDR-adjusted P value or Q value detected by SPARK and SpatialDE. g, Meta genes detected by SpaGCN in slice 151673 are transferrable to slice 151507 in a different brain.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 4 |</head><label>4</label><figDesc>Fig. 4 | Spatial domains and SVGs detected in the mouse brain posterior brain data. a, Histology image of the tissue section and spatial domains detected by Louvain, stLearn, BayesSpace and SpaGCN. b, Spatial subdomains of the cortex region detected by Louvain, stLearn, BayesSpace and SpaGCN. c, Allen Brain Institute reference atlas diagram of the mouse cortex and the subdomain manual annotation of SpaGCN. d, Boxplot of Moran's I and Geary's C values for SVGs detected by SpaGCN (n=815), SPARK (n=9,678) and SpatialDE (n=12,676). The lower and upper hinges correspond to the first and third quartiles, and the center refers to the median value. The upper (lower) whiskers extend from the hinge to the largest (smallest) value no further (at most) than 1.5 × interquartile range from the hinge. Data beyond the end of the whiskers are plotted individually. e, Spatial expression patterns of SVGs detected by SpaGCN for domain 1 (PVALB), 5 (NRGN) and 8 (TRIM62). f, Spatial expression patterns of genes KLK6, MBP, ATP1B1, which form the meta gene for domain 0 (KLK6 + MBP -ATP1B1).</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 5 |Fig. 6 |</head><label>56</label><figDesc>Fig. 5 | Joint spatial domain detection across multiple mouse brain tissue sections using SpaGCN. a, Joint analysis of two consecutive tissue sections from mouse posterior brain by SpaGCN. b, Joint analysis of a tissue section from mouse anterior brain and a section from mouse posterior brain by SpaGCN.</figDesc><graphic url="image-30.png" coords="8,82.45,302.86,380.04,195.84" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><head></head><label></label><figDesc></figDesc><graphic url="image-16.png" coords="4,57.34,499.64,477.60,112.56" type="bitmap" /></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_0">NATuRE METHODS | VOL 18 | NOVEMBER 2021 | 1342-1351 | www.nature.com/naturemethods</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_1">© The Author(s), under exclusive licence to Springer Nature America, Inc. 2021 NATuRE METHODS | VOL 18 | NOVEMBER 2021 | 1342-1351 | www.nature.com/naturemethods</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>This work was supported by the following grants: R01GM125301, R01EY030192, R01EY031209, R01HL113147 and R01HL150359 (to M.L.), and P01AG066597 (to D.J.I. and E.B.L.). We thank R. Moncada and I. Yanai for sharing the human pancreatic cancer histology image data, and R. Stickles, E. Murray, E. Macosko and F. Chen for sharing the SLIDE-seqV2 data.</p></div>
			</div>


			<div type="availability">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Data availability</head><p>The authors analyzed seven publicly available SRT datasets. The data were acquired from the following websites or accession numbers: (1) human primary pancreatic</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Code availability</head><p>An open-source implementation of the SpaGCN algorithm can be downloaded from https://github.com/jianhuupenn/SpaGCN.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Online content</head><p>Any methods, additional references, Nature Research reporting summaries, source data, extended data, supplementary information, acknowledgements, peer review information; details of author contributions and competing interests; and statements of data and code availability are available at https://doi.org/10.1038/ s41592-021-01255-8.</p><p>Received: 1 December 2020; Accepted: 29 July 2021; Published online: 28 October 2021</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Author contributions</head><p>This study was conceived of and led by M.L. J.H. designed the model and algorithm. J.H. implemented the SpaGCN software and led the data analysis with input from M.L., X.L., K.C., A.S., N.M., D.I., E.L. and R.T.S. N.M. contributed to figure design and generation. J.H. and M.L. wrote the paper with feedback from all other coauthors.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Competing interests</head><p>The authors declare no competing interests.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Additional information</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Supplementary information</head><p>The online version contains supplementary material available at https://doi.org/10.1038/s41592-021-01255-8.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Spatially resolved transcriptomes-next generation tools for tissue exploration</title>
		<author>
			<persName><forename type="first">M</forename><surname>Asp</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Bergenstrahle</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Lundeberg</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioessays</title>
		<imprint>
			<biblScope unit="volume">42</biblScope>
			<biblScope unit="page">e1900221</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Single-cell in situ RNA profiling by sequential hybridization</title>
		<author>
			<persName><forename type="first">E</forename><surname>Lubeck</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">F</forename><surname>Coskun</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Zhiyentayev</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Ahmad</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Cai</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page" from="360" to="361" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">In situ transcription profiling of single cells reveals spatial organization of cells in the mouse hippocampus</title>
		<author>
			<persName><forename type="first">S</forename><surname>Shah</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Lubeck</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Zhou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Cai</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neuron</title>
		<imprint>
			<biblScope unit="volume">92</biblScope>
			<biblScope unit="page" from="342" to="357" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Transcriptome-scale super-resolved imaging in tissues by RNA seqFISH</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">L</forename><surname>Eng</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">568</biblScope>
			<biblScope unit="page" from="235" to="239" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Molecular, spatial, and functional single-cell profiling of the hypothalamic preoptic region</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">R</forename><surname>Moffitt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">362</biblScope>
			<biblScope unit="page">5324</biblScope>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">RNA imaging. Spatially resolved, highly multiplexed RNA profiling in single cells</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">H</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">N</forename><surname>Boettiger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">R</forename><surname>Moffitt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Zhuang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">348</biblScope>
			<biblScope unit="page">6090</biblScope>
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Three-dimensional intact-tissue sequencing of single-cell transcriptional states</title>
		<author>
			<persName><forename type="first">X</forename><surname>Wang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">361</biblScope>
			<biblScope unit="page">5691</biblScope>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Highly multiplexed subcellular RNA sequencing in situ</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">H</forename><surname>Lee</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">343</biblScope>
			<biblScope unit="page" from="1360" to="1363" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Visualization and analysis of gene expression in tissue sections by spatial transcriptomics</title>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">L</forename><surname>Stahl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">353</biblScope>
			<biblScope unit="page" from="78" to="82" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Slide-seq: A scalable technology for measuring genome-wide expression at high spatial resolution</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">G</forename><surname>Rodriques</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">363</biblScope>
			<biblScope unit="page" from="1463" to="1467" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Highly sensitive spatial transcriptomics at near-cellular resolution with Slide-seqV2</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">R</forename><surname>Stickels</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page" from="313" to="319" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">High-definition spatial transcriptomics for in situ tissue profiling</title>
		<author>
			<persName><forename type="first">S</forename><surname>Vickovic</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page" from="987" to="990" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Integrating microarray-based spatial transcriptomics and single-cell RNA-seq reveals tissue architecture in pancreatic ductal adenocarcinomas</title>
		<author>
			<persName><forename type="first">R</forename><surname>Moncada</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">38</biblScope>
			<biblScope unit="page" from="333" to="342" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Spatial transcriptomics and in situ sequencing to study Alzheimer&apos;s disease</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">T</forename><surname>Chen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">182</biblScope>
			<biblScope unit="page">e919</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Fast unfolding of communities in large networks</title>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">D</forename><surname>Blondel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J.-L</forename><surname>Guillaume</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Lambiotte</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Lefebvre</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Stat. Mech.: Theory Exp</title>
		<imprint>
			<biblScope unit="page">P10008</biblScope>
			<date type="published" when="2008">2008. 2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Identification of spatially associated subpopulations by combining scRNAseq and sequential fluorescence in situ hybridization data</title>
		<author>
			<persName><forename type="first">Q</forename><surname>Zhu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Shah</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Dries</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Cai</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">C</forename><surname>Yuan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page" from="1183" to="1190" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<monogr>
		<title level="m" type="main">stLearn: Integrating spatial location, tissue morphology and gene expression to find cell types, cell-cell interactions and spatial trajectories within undissociated tissues</title>
		<author>
			<persName><forename type="first">D</forename><surname>Pham</surname></persName>
		</author>
		<idno type="DOI">10.1101/2020.05.31.125658</idno>
		<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
	<note type="report_type">Preprint at bioRxiv</note>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Spatial transcriptomics at subspot resolution with BayesSpace</title>
		<author>
			<persName><forename type="first">E</forename><surname>Zhao</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41587-021-00935-2</idno>
		<ptr target="https://doi.org/10.1038/s41587-021-00935-2" />
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<monogr>
		<title level="m" type="main">Continuous polony gels for tissue mapping with high resolution and RNA capture efficiency</title>
		<author>
			<persName><forename type="first">X</forename><surname>Fu</surname></persName>
		</author>
		<idno type="DOI">10.1101/2021.03.17.435795</idno>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
	<note type="report_type">Preprint at bioRxiv</note>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
		<title level="m" type="main">Large field of view-spatially resolved transcriptomics at nanoscale resolution</title>
		<author>
			<persName><forename type="first">A</forename><surname>Chen</surname></persName>
		</author>
		<idno type="DOI">10.1101/2021.01.17.427004</idno>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">High-spatial-resolution multi-omics sequencing via deterministic barcoding in tissue</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Liu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">183</biblScope>
			<biblScope unit="page">e1618</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Microscopic examination of spatial transcriptome using Seq-Scope</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">S</forename><surname>Cho</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell</title>
		<imprint>
			<biblScope unit="volume">184</biblScope>
			<biblScope unit="page">e3522</biblScope>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Identification of spatial expression trends in single-cell gene expression data</title>
		<author>
			<persName><forename type="first">D</forename><surname>Edsgard</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Johnsson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Sandberg</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="339" to="342" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">SpatialDE: Identification of spatially variable genes</title>
		<author>
			<persName><forename type="first">V</forename><surname>Svensson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">A</forename><surname>Teichmann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Stegle</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="page" from="343" to="346" />
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Statistical analysis of spatial expression patterns for spatially resolved transcriptomic studies</title>
		<author>
			<persName><forename type="first">S</forename><surname>Sun</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Zhu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Zhou</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Methods</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="193" to="200" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Unsupervised deep embedding for clustering analysis</title>
		<author>
			<persName><forename type="first">J</forename><surname>Xie</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Girshick</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Farhadi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. 33rd International Conference on Machine Learning</title>
				<meeting>33rd International Conference on Machine Learning</meeting>
		<imprint>
			<publisher>W&amp;CP</publisher>
			<date type="published" when="2016">2016</date>
			<biblScope unit="volume">48</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Beyond Moran&apos;s I: testing for spatial dependence based on the spatial autoregressive model</title>
		<author>
			<persName><forename type="first">H</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">A</forename><surname>Calder</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Cressie</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Geographical Anal</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page" from="357" to="375" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">SpaGE: Spatial Gene Enhancement using scRNA-seq</title>
		<author>
			<persName><forename type="first">T</forename><surname>Abdelaal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Mourragui</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Mahfouz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">J</forename><surname>Reinders</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">48</biblScope>
			<biblScope unit="page">e107</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Robust decomposition of cell type mixtures in spatial transcriptomics</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">M</forename><surname>Cable</surname></persName>
		</author>
		<idno type="DOI">10.1038/s41587-021-00830-w</idno>
		<ptr target="https://doi.org/10.1038/s41587-021-00830-w" />
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">KRT17 Functions as a tumor promoter and regulates proliferation, migration and invasion in pancreatic cancer via mTOR/S6k1 pathway</title>
		<author>
			<persName><forename type="first">D</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cancer Manag. Res</title>
		<imprint>
			<biblScope unit="volume">12</biblScope>
			<biblScope unit="page" from="2087" to="2095" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Identification of matrix metalloproteinase 11 as a prognostic biomarker in pancreatic cancer</title>
		<author>
			<persName><forename type="first">J</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">H</forename><surname>Kim</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Anticancer Res</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page" from="5963" to="5971" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Transcriptome-scale spatial gene expression in the human dorsolateral prefrontal cortex</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">R</forename><surname>Maynard</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Neurosci</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="425" to="436" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Mouse posterior brain data</title>
		<author>
			<persName><surname>Dataset</surname></persName>
		</author>
		<ptr target="https://support.10xgenomics.com/spatial-gene-expression/datasets/1.0.0/V1_Mouse_Brain_Sagittal_Posterior" />
	</analytic>
	<monogr>
		<title level="m">10x Genomics</title>
				<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">Purification and characterization of progenitor and mature human astrocytes reveals transcriptional and functional differences with mouse</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Zhang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Neuron</title>
		<imprint>
			<biblScope unit="volume">89</biblScope>
			<biblScope unit="page" from="37" to="53" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Publisher&apos;s note Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations. cancer ST data (GSE111672); (2) LIBD human dorsolateral prefrontal cortex</title>
		<ptr target="https://support.10xgenomics.com/spatial-gene-expression/datasets/1.0.0/V1_Mouse_Brain_Sagittal_Posterior" />
	</analytic>
	<monogr>
		<title level="m">dorsolateral prefrontal cortex 10x Visium data</title>
				<imprint/>
	</monogr>
	<note>); (3) mouse posterior brain 10x Visium data</note>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">highly-sensitive-spatial-transcriptomics-at-near-cellularresolution-with-slide-seqv2); (5) mouse visual cortex STARmap data</title>
		<ptr target="https://drive.google.com/drive/folders/1C4l3lBaYl7uuV2AA2o0WDzO_mkc_b0pv?usp=sharing" />
	</analytic>
	<monogr>
		<title level="m">) mouse olfactory bulb ST data</title>
				<imprint/>
	</monogr>
	<note>mouse cortex SLIDE-seqV2 data</note>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">Details of the datasets analyzed in this paper are described in Supplementary Table 1</title>
		<idno type="DOI">10.5061/dryad.8t8s248</idno>
		<ptr target="www.nature.com/naturemethods" />
	</analytic>
	<monogr>
		<title level="m">mouse hypothalamus MERFISH data</title>
				<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">Unsupervised representation of localized spatial gene expression signatures</title>
		<author>
			<persName><forename type="first">G</forename><surname>Partel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Wahlby</surname></persName>
		</author>
		<author>
			<persName><surname>Spage2vec</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">FEBS J</title>
		<imprint>
			<biblScope unit="volume">288</biblScope>
			<biblScope unit="page" from="1859" to="1870" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title level="a" type="main">Semi-supervised classification with graph convolutional networks</title>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">N</forename><surname>Kipf</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Welling</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1609.02907</idno>
	</analytic>
	<monogr>
		<title level="m">Proc. International Conference on Learning Representations</title>
				<meeting>International Conference on Learning Representations</meeting>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title level="a" type="main">Silhouettes: a graphical aid to the interpretaion and validation of cluster analysis</title>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">J</forename><surname>Rousseeuw</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computational Appl. Math</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="page" from="53" to="65" />
			<date type="published" when="1987">1987</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title level="a" type="main">A joint deep learning model enables simultaneous batch effect correction, denoising and clustering in single-cell transcriptomics</title>
		<author>
			<persName><forename type="first">J</forename><surname>Lakkis</surname></persName>
		</author>
		<idno type="DOI">10.1101/gr.271874.120</idno>
		<ptr target="https://doi.org/10.1101/gr.271874.120" />
	</analytic>
	<monogr>
		<title level="j">Genome Res</title>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<analytic>
		<title level="a" type="main">Deep learning enables accurate clustering with batch effect removal in single-cell RNA-seq analysis</title>
		<author>
			<persName><forename type="first">X</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Commun</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">2338</biblScope>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
