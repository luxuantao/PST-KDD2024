<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Efficient Methods for Topic Model Inference on Streaming Document Collections</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Limin</forename><surname>Yao</surname></persName>
							<email>lmyao@cs.umass.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of Massachusetts</orgName>
								<address>
									<settlement>Amherst</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">David</forename><surname>Mimno</surname></persName>
							<email>mimno@cs.umass.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of Massachusetts</orgName>
								<address>
									<settlement>Amherst</settlement>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Andrew</forename><surname>Mccallum</surname></persName>
							<email>mccallum@cs.umass.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of Massachusetts</orgName>
								<address>
									<settlement>Amherst</settlement>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Efficient Methods for Topic Model Inference on Streaming Document Collections</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">6E8168C01156FA19D238B24DD5A712A1</idno>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.3" ident="GROBID" when="2023-07-28T13:33+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>H.4 [Information Systems Applications]: Miscellaneous Experimentation</term>
					<term>Performance</term>
					<term>Design Topic modeling</term>
					<term>inference</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Topic models provide a powerful tool for analyzing large text collections by representing high dimensional data in a low dimensional subspace. Fitting a topic model given a set of training documents requires approximate inference techniques that are computationally expensive. With today's large-scale, constantly expanding document collections, it is useful to be able to infer topic distributions for new documents without retraining the model. In this paper, we empirically evaluate the performance of several methods for topic inference in previously unseen documents, including methods based on Gibbs sampling, variational inference, and a new method inspired by text classification. The classificationbased inference method produces results similar to iterative inference methods, but requires only a single matrix multiplication. In addition to these inference methods, we present SparseLDA, an algorithm and data structure for evaluating Gibbs sampling distributions. Empirical results indicate that SparseLDA can be approximately 20 times faster than traditional LDA and provide twice the speedup of previously published fast sampling methods, while also using substantially less memory.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1.">INTRODUCTION</head><p>Statistical topic modeling has emerged as a popular method for analyzing large sets of categorical data in applications from text mining to image analysis to bioinformatics. Topic models such as latent Dirichlet allocation (LDA) <ref type="bibr" target="#b3">[3]</ref> have the ability to identify interpretable low dimensional components in very high dimensional data. Representing documents as topic distributions rather than bags of words reduces the effect of lexical variability while retaining the overall semantic structure of the corpus.</p><p>Although there have recently been advances in fast inference for topic models, it remains computationally expensive. Full topic model inference remains infeasible in two common situations. First, data streams such as blog posts and news articles are continually updated, and often require real-time responses in computationally limited settings such as mobile devices. In this case, although it may periodically be possible to retrain a model on a snapshot of the entire collection using an expensive "offline" computation, it is necessary to be able to project new documents into a latent topic space rapidly. Second, large scale collections such as information retrieval corpora and digital libraries may be too big to process efficiently. In this case, it would be useful to train a model on a random sample of documents, and then project the remaining documents into the latent topic space independently using a MapReduce-style process. In both cases there is a need for accurate, efficient methods to infer topic distributions for documents outside the training corpus. We refer to this task as "inference", as distinct from "fitting" topic model parameters from training data.</p><p>This paper has two main contributions. First, we present a new method for topic model inference in unseen documents that is inspired by techniques from discriminative text classification. We evaluate the performance of this method and several other methods for topic model inference in terms of speed and accuracy relative to fully retraining a model. We carried out experiments on two datasets, NIPS and Pubmed. In contrast to Banerjee and Basu <ref type="bibr" target="#b1">[1]</ref>, who evaluate different statistical models on streaming text data, we focus on a single model (LDA) and compare different inference methods based on this model. Second, since many of the methods we discuss rely on Gibbs sampling to infer topic distributions, we also present a simple method, SparseLDA, for efficient Gibbs sampling in topic models along with a data structure that results in very fast sampling performance with a small memory footprint. SparseLDA is approximately 20 times faster than highly optimized traditional LDA and twice the speedup of previously published fast sampling methods <ref type="bibr" target="#b7">[7]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">BACKGROUND</head><p>A statistical topic model represents the words in documents in a collection W as mixtures of T "topics," which are multinomials over a vocabulary of size V . Each document d is associated with a multinomial over topics θ d . The probability of a word type w given topic t is represented by φ w|t . We refer to the complete V xT matrix of topic-word probabilities as Φ. The multinomial parameters θ d and φt are drawn from Dirichlet priors with parameters α and β respectively. In practice we use a symmetric Dirichlet with β = .01 for all word types and a T -dimensional vector of distinct positive real numbers for α. Each token wi in a given document is drawn from the multinomial for the topic represented by a discrete hidden indicator variable zi.</p><p>Fitting a topic model given a training collection W involves estimating both the document-topic distributions, θ d , and the topic-word distributions, Φ. MAP estimation in this model is intractable due to the interaction between these terms, but relatively efficient MCMC and variational methods are widely used <ref type="bibr" target="#b4">[4,</ref><ref type="bibr" target="#b3">3]</ref>. Both classes of methods can produce estimates of Φ, which we refer to as Φ. In the case of collapsed Gibbs sampling, the Markov chain state consists of topic assignments z for each token in the training corpus. An estimate of P (w|t) can be obtained from the predictive distribution of a Dirichlet-multinomial distribution:</p><formula xml:id="formula_0">φw|t = β + n w|t βV + n •|t (1)</formula><p>where n w|t is the number of tokens of type w assigned to topic t and n •|t = P w n w|t . The task of topic model inference on unseen documents is to infer θ for a document d not included in W. The likelihood function for θ is</p><formula xml:id="formula_1">L(θ|w, Φ, α) = Y i φ w i |z i θz i × Γ( P t αt) Q t Γ(αt) Y t θ α t -1 t<label>(2)</label></formula><formula xml:id="formula_2">∝ Y i φ w i |z i Y t θ n t|d +α t -1 t ,<label>(3)</label></formula><p>where n t|d is the total number of tokens in the document assigned to topic t. Even with a fixed estimate Φ, MAP estimation of θ is intractable due to the large number of discrete hidden variables z. Sections 3 through 5 present an array of approximate inference methods that estimate θ, which are empirically evaluated in the remaining sections of the paper.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">SAMPLING-BASED INFERENCE</head><p>We evaluate three different sampling-based inference methods for LDA. Gibbs sampling is an MCMC method that involves iterating over a set of variables z1, z2, ...zn, sampling each zi from P (zi|z \i , w). Each iteration over all variables is referred to as a Gibbs sweep. Given enough iterations, Gibbs sampling for LDA <ref type="bibr" target="#b4">[4]</ref> produces samples from the posterior P (z|w). The difference between the three methods we explore is in the set of variables z that are sampled, as illustrated in Figure <ref type="figure" target="#fig_0">1</ref>, and which portion of the complete data is used in estimating Φ.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.1">Gibbs1: Jointly resample all topics</head><p>In this method we define the scope of a single Gibbs sweep to be the hidden topic variables for the entire collection, including both the original documents and the new documents. After sampling the topic variables for the training documents to convergence without the new documents, we randomly initialize topic variables for the new documents  </p><p>where n •|d is the length of the document. Increasingly accurate estimates can be generated by averaging over values of Eq. 4 for multiple Markov chain states, but may cause problems due to label swapping. Inference method Gibbs1 is equivalent to fitting a new model for the complete data, including both the original documents and the new documents, after separately initializing some of the topic variables using Gibbs sampling. This method is as computationally expensive as simply starting with random initializations for all variables. It is useful, however, in that we can use the same initial model for all other inference methods, thereby ensuring that the topics will roughly match up across methods. We consider this inference procedure the most accurate, and the topic distribution for each test document estimated using Gibbs1 as a reference for evaluating other inference methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.2">Gibbs2: Jointly resample topics for all new documents</head><p>Inference method Gibbs2 begins with the same initialization as Gibbs1, but saves computation by holding all of the topic assignments for the training documents fixed. Under this approximation, one Gibbs sweep only requires updating topic assignments for the new documents.</p><p>Inference involves sampling topic assignments for the training data as in Gibbs1, randomly assigning values to the topic indicator variables z for the new documents, and then sampling as before, updating Φ as in Eq. 1 after each variable update.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.3">Gibbs3: Independently resample topics for new documents</head><p>Inference method Gibbs2 performs Gibbs sampling as a batch. As such, it samples from the posterior distribution over all z variables in the new documents given all the words in the new documents, accessing all the new documents in each iteration. Unfortunately, handling topic inference in a batch manner is both unrealistic in time-sensitive streaming document collections, and inefficient because it cannot be parallelized across documents without substantial interprocess communication.</p><p>Gibbs3 is an online version, which processes all documents independently. When a test document arrives, we sample topics for a number of iterations using only topicword counts in Φ from the training corpus and the current document. For the next incoming document we reset Φ to include only counts from the training corpus and that new document.</p><p>This algorithm differs from the previous two methods in that it produces estimates of θ d given only the words in the training documents and in document d. Gibbs1 and Gibbs2 produce estimates given the entire data set.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.4">Time-and Memory-Efficient Gibbs Sampling for LDA</head><p>The efficiency of Gibbs sampling-based inference methods depends almost entirely on how fast we can evaluate the sampling distribution over topics for a given token. We therefore present SparseLDA, our new algorithm and data structure that substantially improves sampling performance. Although we apply this method to topic inference on new documents, the method is applicable to model fitting as well.</p><p>The probability of a topic z in document d given an observed word type w is</p><formula xml:id="formula_4">P (z = t|w) ∝ (αt + n t|d ) β + n w|t βV + n •|t .<label>(5)</label></formula><p>Sampling from this distribution involves calculating the unnormalized weight in Eq. 5, which we refer to as q(z), for each topic; sampling a random variable U ∼ U (0, P z q(z)); and finding t such that P t-1 z=1 q(z) &lt; U &lt; P t z=1 q(z). This algorithm requires calculating q(z) for all topics in order to determine the normalizing constant for the distribution P z q(z), even though probability mass is generally concentrated on a small number of topics. Porteous et al. <ref type="bibr" target="#b7">[7]</ref> approach this problem by iteratively refining an approximation to P z q(z). We take an arguably simpler approach by caching most of the computation required to compute the normalizing constant. By rearranging terms in the numerator, we can divide Eq. 5 into three parts:</p><formula xml:id="formula_5">P (z = t|w) ∝ αtβ βV + n •|t + n t|d β βV + n •|t + (αt + n t|d )n w|t βV + n •|t .<label>(6)</label></formula><p>Note that the first term is constant for all documents and that the second term is independent of the current word type w. Furthermore, P z q(z) is equal to the sum over topics of each of the three terms in Equation <ref type="formula" target="#formula_5">6</ref>:</p><formula xml:id="formula_6">s = X t αtβ βV + n •|t (7) r = X t n t|d β βV + n •|t (8) q = X t (αt + n t|d )n w|t βV + n •|t .<label>(9)</label></formula><p>This process divides the full sampling mass into three "buckets." We can now sample U ∼ U(0, s + r + q). If U &lt; s, we have hit the "smoothing only" bucket. In this case, we can step through each topic, calculating and adding</p><formula xml:id="formula_7">up α t β</formula><p>|V |β+n t for that topic, until we reach a value greater than x. If s &lt; x &lt; (s + r), we have hit the "document topic" bucket. In this case, we need only iterate over the set of topics t such that n t|d = 0 -a number that is usually substantially less than the total number of topics. Finally, if x &gt; (s + r), we have hit the "topic word" bucket, and we need only consider topics such that n w|t = 0. Again, this number is usually very small compared to T .</p><p>The values of the three components of the normalization constant, s, r, q, can be efficiently calculated. The constant s only changes when we update the hyperparameters α. The constant r depends only on the document-topic counts, so we can calculate it once at the beginning of each document and then update it by subtracting and adding values for the terms involving the old and new topic at each Gibbs update. This process takes constant time, independent of the number of topics.</p><p>The topic word constant q changes with the value of w, so we cannot as easily recycle earlier computation. We can, however, substantially improve performance by observing that the expression for q can be broken into two components:</p><formula xml:id="formula_8">q = X t » αt + n t|d βV + n •|t × n w|t - .<label>(10)</label></formula><p>The coefficient</p><formula xml:id="formula_9">α t +n t|d</formula><p>|V |β+n t can therefore be cached for every topic, so calculating q for a given w consists of one multiply operation for every topic such that n w|t = 0. As n t|d = 0 for almost all topics in any given document, this vector of coefficients will also almost entirely consist of only α t |V |β+n t , so we can save additional operations by caching these coefficients across documents, only updating those topics that have non-zero counts in the current document as we begin each document, and resetting those values to the α-only values as we complete sampling for each document.</p><p>If the values of α and β are small, q will take up most of the total mass. Empirically, we find that more than 90% of samples fall within this bucket. In a Dirichlet-multinomial distribution with small parameter magnitudes, the likelihood of the distribution is roughly proportional to the concentration of the counts on a small number of dimensions. We find that the wallclock time per iteration is roughly proportional to the likelihood of the model. As the sampler approaches a region of high probability, the time per iteration declines, leveling off as the sampler converges.</p><p>Clearly, the efficiency of this sampling algorithm depends on the ability to rapidly identify topics such that n w|t = 0. Furthermore, as the terms in Eq. 10 are roughly proportional to n w|t , and since we can stop evaluating terms as soon as the sum of terms exceeds U -(s + r), it is desirable to be able to iterate over non-zero topics in descending order. We now present a novel data structure that meets these criteria.</p><p>We encode the tuple (t, n w|t ) in a single 32 bit integer by dividing the bits into a count segment and a topic segment. The number of bits in the topic segment is the smallest m such that 2 m ≥ T . We encode the values by shifting n w|t left by m bits and adding t. We can recover n w|t by shifting the encoded integer right m bits and t by a bitwise and with a "topic mask" consisting of m 1s. This encoding has two primary advantages over a simple implementation that stores n w|t in an array indexed by t for all topics. First, in natural languages most word types occur rarely. As the encoding no longer relies on the array index, if a word type w only occurs three times in the corpus, we need only reserve an array of at most three integers for it rather than T . Second, since the count is in the high bits, we can sort the array using standard sorting implementations, which do not need to know anything about the encoding.</p><p>By storing encoded values (t, n w|t ) in reverse-sorted arrays, we can rapidly calculate q, sample U , and then (if U &gt; (s + r)) usually within one calculation find the sampled t. Maintaining the data structure involves reencoding values for updated topics and ensuring that the encoded values remain sorted. As n w|t changes by at most one after every Gibbs update, a simple bubble sort is sufficient.</p><p>In order to evaluate the efficiency of SparseLDA, we measured the average time per iteration and memory usage, 1  shown in Figure <ref type="figure" target="#fig_1">2</ref> averaged over five runs for each value of T on NIPS data. As we increase the number of topics, the time per iteration increases slowly, with much lower overall time than a carefully optimized implementation of standard Gibbs sampling. Memory usage is also substantially lower and grows more slowly than standard Gibbs sampling. Empirical comparisons with the FastLDA method of Porteous et al. <ref type="bibr" target="#b7">[7]</ref> are difficult, but on the standard NIPS corpus with 800 topics, we found the ratio of per-iteration times between standard Gibbs sampling and SparseLDA to be approximately 20, compared to a speedup of approximately 11 times reported for FastLDA over standard Gibbs sampling using the same corpus and number of topics with αt = 0.001. In addition, FastLDA does not address memory efficiency, one of the primary benefits of SparseLDA.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">VARIATIONAL INFERENCE</head><p>Another class of approximate inference method widely used in fitting topic models is variational EM. Variational inference involves defining a parametric family of distributions 1 Memory use in Java was calculated as runtime.totalMemory() -runtime.freeMemory() that forms a tractable approximation to an intractable true joint distribution. In the case of LDA, Blei, Ng, and Jordan <ref type="bibr" target="#b3">[3]</ref> suggest a factored distribution consisting of a variational Dirichlet distribution αd for each document and a variational multinomial γdi over topics for each word position in the document. The parameters of these distributions can then be iteratively fitted using the following update rules:</p><formula xml:id="formula_10">αdt = αt + X i γdit (11) γdit ∝ φw i |t exp(Ψ( αdt )),<label>(12)</label></formula><p>where Ψ(x) is the digamma function. Variational approximations converge in fewer iterations than Gibbs sampling, but each iteration generally takes substantially longer due to the calculation of exp and Ψ functions.</p><p>We evaluate a variational method based on the update rules specified. Given a new document, we initialize αd to α and clamp Φ to the expression in Eq. 1 evaluated using the topic-word counts from the training documents. We then apply the update rules in Eq. 11 and 12 in turn until convergence. We then estimate θt ∝ αt. This method is a variational equivalent to inference method Gibbs3, being appropriate for parallelized, streaming environments. More complicated variational distributions have been shown to have lower bias <ref type="bibr">[9]</ref>, but are generally more computationally intensive per iteration than the simple fully factored variational distribution.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">CLASSIFICATION-BASED INFERENCE</head><p>The previous inference methods theoretically require many iterations to allow a Markov chain to achieve its stationary distribution or to fit a variational approximation. In some settings, however, it is necessary to estimate a topic distribution as fast as possible. As an alternative to iterative methods, we propose a classification-based approach to predicting θ for a new document.</p><p>In this task, each document has a labeled topic distribution, obtained from the trained topic model. Specifically, each document can be classified as multiple classes, each with a probability. This setting is an extension to the traditional classification task, in which an instance has only one class membership. In a traditional classifier, the training data is represented as D = {(xi, yi) | i = 1 . . . n}, where xi is a representation of the document (e.g. a feature vector) and yi is xi's label. yi is typically a vector of indicator variables, such that if xi belongs to the jth class, only the jth element of yi will be 1, and other elements will be 0. For simplicity, we often use the class label instead of the indicator vector to represent yi. For our task, we allow each element of yi to take values between 0 and 1 and the sum of all elements should be 1, so that yi indicates a probabilistic distribution over all classes. Classes in this setting are equivalent to topics. We investigate two classifiers in this paper, one of which is useful only as a baseline.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.1">Maximum Entropy Classifier (MaxEnt)</head><p>We first extend a traditional MaxEnt or logistic regression classifier to our new task. In the simple scenario in which each instance has one fully observed class label, any realvalued function fi(x, y) of the object x and class y can be treated as a feature. The constraints are the expected values of features computed using training data. Given a set Y of classes, and features f k , the parameters to be estimated λ k , the learned distribution p(y|x) is of the parametric exponential form <ref type="bibr" target="#b2">[2]</ref>:</p><formula xml:id="formula_11">P (y|x) = exp `Pk λ k f k (x, y) Ṕy exp `Pk λ k f k (x, y) ´.<label>(13)</label></formula><p>Given training data D = { x1, y1 , x2, y2 , ..., xn, yn }, the log likelihood of parameters Λ is</p><formula xml:id="formula_12">l(Λ|D) = log n Y i=1 p(yi|x i ) ! - X k λ 2 k 2σ 2 = n X i=1 X k (λ k f k (x i , yi) -log ZΛ(x)) - X k λ 2 k 2σ 2 , (<label>14</label></formula><formula xml:id="formula_13">)</formula><p>The last term represents a zero-mean Gaussian prior on the parameters, which reduces overfitting and provides identifiability. We find values of Λ that maximize l(Λ|D) using a standard numerical optimizer. The gradient with respect to feature index k is</p><formula xml:id="formula_14">δ(Λ|D) δλ k = n X i=1 f k (x i , yi) - X y f k (x i , y)p(y|x i ) ! - λ k σ 2 . (<label>15</label></formula><formula xml:id="formula_15">)</formula><p>In the topic distribution labeling task, each data point has a topic distribution, and is represented as (x i , y i ). We can also use the maximum log likelihood method to solve this model. The only required change is to substitute y for y. Using a distribution changes the empirical features of the data (f k (x i , yi)), also known as the constraints in a maximum entropy model, which are used to compute the gradient. Whereas in a traditional classifier we use f k (x i , yi) as empirical features, we now use f k (x i , y i ) instead, where y i is the labeled topic distribution of the ith data point. Suppose that we have two classes (i.e. topics) and each instance can contain two features (i.e. words). Training data might consist of x = (x1, x2), y = 1 for a traditional classifier and x = (x1, x2), y = (p1, p2) for a topic distribution classifier, such that p1 and p2 are the proportions of topic 1 and topic 2 for data point x and p1 + p2 = 1. Empirical features (sufficient statistics of training data) for traditional classifier would be (x1, 1) and (x2, 1). While the empirical features for a topic distribution classifier would be (x1, 1), (x2, 1), (x1, 2), and (x2, 2), with the first two weighted by p1, and the remaining two weighted by p2. This substitution changes the penalized log likelihood function:</p><formula xml:id="formula_16">l(Λ | D) = log n Y i=1 p(y i |x i ) ! - X k λ 2 k 2σ 2 = n X i=1 X k (λ k f k (x i , y i ) -log ZΛ(x)) - X k λ 2 k 2σ 2 ,<label>(16)</label></formula><p>Correspondingly, the gradient at feature index k is:</p><formula xml:id="formula_17">δ(Λ|D) δλ k = n X i=1 X y pi(y)f k (x i , y) - X y f k (x i , y)p(y|x i ) ! - λ k σ 2 . (<label>17</label></formula><formula xml:id="formula_18">)</formula><p>Where pi(y) stands for the probability of topic y in the current instance, i.e. one of the elements of y i .</p><p>Once we have trained a topic proportion classifier, we can use it to estimate θ for a new document. We compute the scores for each topic using Eq. 13. This process is essentially a table lookup for each word type, so generating θ requires a single pass through the document.</p><p>In experiments, we found that the output of the topic proportion classifier is often overly concentrated on the single largest topic. We therefore introduce a temperature parameter τ . Each feature value is weighted by 1 τ . Values of τ &lt; 1 increase the peakiness of the classifier, while values τ &gt; 1 decrease peakiness. We chose 1.2 for NIPS data and 0.9 for Pubmed data based on observation of the peakiness of predicted θ values for each corpus.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.2">Naive Bayes Classifier</head><p>From the trained topic model, we can estimate Φ, a matrix with T (#topics) rows and W (#words) columns representing the probability of words given topics. Combined with a uniform prior over topic distributions, we can use this matrix as a classifier, similar to the classifier we obtained from MaxEnt. This method performs poorly, and is presented only as a baseline in our experiments. A document d is represented as a vector, with each element an entry in the vocabulary, denoted as w and the value as the number of times that word occurs in the document, denoted as n w|d . Using Bayes' rule, the score for each topic is:</p><formula xml:id="formula_19">Score(z = t) = X w φw|t n w|d<label>(18)</label></formula><p>The estimated θ distribution is then simply the normalized scores.</p><p>In experiments, we compare both classification methods against the inference methods discussed in previous sections. The two classifiers take less time to predict topic distributions, as they do not require iterative updates. Provided they can achieve almost the same accuracy as the three inference methods or their performance is not much worse, for some particular task which requires real-time response, we can choose classification-based inference methods instead of sampling based or variational updated methods. The choice of estimator can be a trade-off between accuracy and time efficiency.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.3">Hybrid classification/sampling inference</head><p>A hybrid classification/sampling-based approach can be constructed by generating an estimate of θ d given w d using the MaxEnt classifier and then repeatedly sampling topic indicators z given θ and Φ. Note that given θ, P (zi|wi) ∝ θt φw|t is independent of all z \i . After the initial cost of setting up sampling distributions, sampling topic indicators for each word can be performed in parallel and at minimal cost. After collecting sampled z indicators, we can re-estimate the topic distribution θ according to the topic assignments as in Eq. 4. In our experiments, we find that this re-sampling process results in more accurate topic distributions than Max-Ent alone.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">EMPIRICAL RESULTS</head><p>In this section we empirically compare the relative accuracy of each inference method. We train a topic model on training data with a burn-in period of 1000 iterations for all inference methods. We explore the sensitivity of each method to the number of topics, the proportion between training documents and "new" documents, and the effect of topic drift in new documents. We evaluate different inference methods using two data sets. The first is 13 years of full papers published in the NIPS conference, in total 1,740 documents. The second is a set of 51,616 journal article abstracts from Pubmed. The NIPS data set contains fewer documents, but each document is longer. NIPS has around 70K unique words and 2.5M tokens. Pubmed has around 105.4K unique words and about 7M tokens. We also carried out experiments on New York Times data from LDC. We used the first six months of 2007, comprising 39,218 documents, around 12M tokens, about 900K unique words. We preprocessed the data by removing stop words.</p><p>We implemented the three sampling-based inference methods (using SparseLDA), the variational updated method, and the classification-based methods in the MALLET toolkit <ref type="bibr" target="#b5">[5]</ref>. They will be available as part of its standard open-source release.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.1">Evaluation Measures</head><p>It is difficult to evaluate topic distribution prediction results, because the "true" topic distribution is unobservable. We can, however, compare different methods with each other. We consider the Gibbs1 inference method to be the most accurate, as it is closest to Gibbs sampling over the entire corpus jointly, a process that is guaranteed to produce samples from the true posterior over topic distributions. In order to determine whether sampling to convergence is necessary, for inference methods Gibbs2 and Gibbs3, we report results using 1000 iterations of sampling (Gibbs2 and Gibbs3) and two iterations (Gibbs2.S and Gibbs3.S), which is the minimum number of Gibbs sweeps for all topic indicators to be sampled using information from all other tokens.</p><p>We represent the prediction results of each method as a T -dimensional vector θd for each document. We compare methods using three metrics. In all results we report the average of these measures over all "new" documents.</p><p>1. Cosine distance This metric measures the angle between two vectors P and Q representing θd as estimated by two different inference methods:</p><formula xml:id="formula_20">Dcos(P Q) = P t ptqt P Q<label>(19)</label></formula><p>Values closer to 1.0 represent closely matched distributions.</p><p>2. KL Divergence Another metric between distributions P and Q is KL divergence:</p><formula xml:id="formula_21">DKL(P Q) = X t pt log pt qt .<label>(20)</label></formula><p>Smaller values of this metric represent closer distributions. We use the "gold standard" inference method as P .</p><p>3. F1 The previous two metrics measure the divergence between probability distributions. As shown in Table 1, however, it is common for estimators to produce rather different distributions while maintaining roughly the same overall ordering of topics. In this metric, we attempt to predict the set of topics that account for the largest probability mass. Specifically, we sort the entries in θd for a given inference method in descending order and select a set of topics T such that P t∈T θtd ≤ 0.8. We can then treat T Gibbs1 as the correct topics and measure the precision and recall of Tm for all other methods m. The F1 measure is the harmonic mean between the precision and recall. Note that F1 does not take into account the order of topics, only whether they are in the set of topics selected by the gold standard method. Values close to 1.0 represent better matches.</p><p>For classification based inference methods we use unigram counts as input features. Normalized term frequency features (term counts normalized by document length) produced poorer results. We also tried including word-pair features, on the intuition that the power of topic models comes from cooccurrence patterns in words, but these features greatly increased inference time, never improved results over unigram features, and occasionally hurt performance. We hypothesize that the power of unigram features in the discriminatively trained MaxEnt classifier may be a result of the fact that the classifier can assign negative weights to words as well as positive weights. This capability provides extra power over the Naïve Bayes classifier, which cannot distinguish between words that are strongly negatively indicative of a topic and words that are completely irrelevant.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.2">Discussion</head><p>We first compare each method to the Gibbs1 inference method, which is equivalent to completely retraining a model given the original data and new data. We split the NIPS data set into training and testing documents in a 7:3 ratio and run an initial model on the training documents with 70 topics. We explore the effect of these settings later in this section.</p><p>Figure <ref type="figure">3</ref> shows results for the three evaluation metrics. The converged sampling methods Gibbs2 and Gibbs3 are closest to Gibbs1 in terms of cosine distance, F1, and KL divergence, but do not exactly match. The two-iteration versions Gibbs2.S and Gibbs3.S are close to Gibbs1 in terms of cosine distance and KL divergence, but MaxEnt and Variational EM are closer in terms of F1. Hybrid MaxEnt consistently outperforms MaxEnt. Figure <ref type="figure">4</ref> shows similar measures vs. Gibbs2, arguably a more meaningful comparison as Gibbs2 does not resample topics for the training documents. These results indicate that the MaxEnt inference method provides a reasonable ordering of topics for a new document, but that if the exact topic proportions are required, two-iteration Gibbs sampling and hybrid MaxEnt should be considered. We analyzed errors in precision and recall for the MaxEnt inference method. We discovered that for some documents, recall is high. In this case, MaxEnt can predict the major topics correctly, but it will include more topics within the 80% threshold, each with a lower weight compared to Gibbs1, Gibbs2 and Gibbs3. For some documents, precision is high. In this case, MaxEnt assigns more weight to the most prominent topics, causing other topics to fall outside the threshold. To demonstrate the comparison between topic proportions proposed by different inference methods, we show values of θ for a single document under different inference methods in Figure <ref type="figure" target="#fig_2">5</ref>. The proportions assigned by the MaxEnt inference method roughly match those of the sampling-based inference methods, especially compared to the naïve Bayes inference method.</p><p>We next compare the efficiency in time of each inference method. We perform experiments on a cluster of 2.66GHz Xeon X5355 processors. Figure <ref type="figure">6</ref> shows on a log scale that the methods can be loosely grouped into "fast" methods (classification-based, two-iteration sampling, and hybrid Max-Ent) that require a small number of passes through the data and use simple computations, and "slow" methods that require many iterations and complicated functions and 50-200 times slower.</p><p>Figure <ref type="figure">7</ref> shows the F1 measure of different methods given different values of T . The results indicate that the "fast" methods are relatively insensitive to the number of topics. Thus for more topics, the slow methods will be more than 100-200 times slower.</p><p>One scenario for topic model inference is in very large collections. Even with fast sampling methods, training topic models remains computationally expensive. Parallel implementations are hindered by the need for frequent interprocess communication <ref type="bibr" target="#b6">[6]</ref>. We would like to be able to train a model on a representative subset of a collection and then estimate topic distributions for the remaining documents using light-weight MapReduce-style processing, in which every document can be handled independently. In order to study whether training size will affect prediction performance, we carried out experiment on Pubmed. We fixed 30% of the whole data as test data, and vary the training proportion from 10% to 70%. Results are shown in Figure <ref type="figure">8</ref> for the most light-weight inference method, MaxEnt, relative to Gibbs2. Although the size of the training set does affect performance, the magnitude of variation is relatively small. Another application area is in streaming document collections. In this setting new documents may arrive more quickly than it is possible to train a complete model. Alternatively, we may wish to train a topic model on a central compute cluster and then "publish" a model to distributed devices that do not have the computational power to perform full topic inference, for example in an email tagging application on a smart phone. One difficulty in this setting is that the underlying topic distribution may shift over time, rendering the trained model less applicable. One easily measured proxy for topic drift is the proportion of words that are included in the training data. We analyze how the percentage of previously seen vocabulary affects the performance of topic distribution prediction on Pubmed. On the left side of Figure <ref type="figure" target="#fig_4">9</ref> the x axis is the ratio of unique words seen in training data to the number of unique words in test data, and the y axis is the values of all evaluation measures. Again, we present only results for the most light-weight inference method, MaxEnt. The performance of the estimator increases as the proportion of previously seen vocabulary increases, leveling off at around 70% for cosine and F1 metrics (the KL divergence metric appears more noisy). This result suggests a simple heuristic for determining when a new model should be retrained, i.e. the training set should contain roughly 70% of the distinct word types in the "new" documents.</p><p>We also explore the effect of topic drift in news data in the New York Times data set, using June 2007 documents as test data. We use five training corpora: Jan 2007, Jan and Feb, etc. Retraining after each month improves performance, as shown on the right side of Figure <ref type="figure" target="#fig_4">9</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.">CONCLUSIONS</head><p>Topic models provide a useful tool in analyzing complicated text collections, but their computation complexity has hindered their use in large-scale and real-time applications. Although there has been recent work on improving trainingtime estimation in topic models <ref type="bibr" target="#b6">[6,</ref><ref type="bibr" target="#b7">7]</ref>, there has been little attention paid to the practically important problem of inferring topic distributions given existing models. Exceptions include the dynamic mixture model for online pattern discovery in multiple time-series data <ref type="bibr" target="#b10">[10]</ref>, the online LDA algorithm <ref type="bibr" target="#b8">[8]</ref>, and especially the work of Banerjee and Basu <ref type="bibr" target="#b1">[1]</ref>, who advocate the use of mixture of von Mises-Fisher distributions for streaming data based on a relatively simple document-level clustering criterion. In this paper, we focus on the more flexible topic modeling framework, which is more effective at capturing combinations of aspects of documents, rather than simple document similarity. Focusing on LDA, we compare a number of different methods for inferring topic distributions.</p><p>We find that a simple discriminatively trained classificationbased method, MaxEnt, produces reasonable results with extremely small computational requirements. If more accu-racy is required, small numbers of iterations of Gibbs sampling or the hybrid MaxEnt method provide improved results with minimal extra computation.</p><p>Finally, the efficiency of Gibbs sampling both for training topic models and inferring topic distributions for new documents can be significantly improved by the SparseLDA method proposed in this paper. This method is valuable not only because of its reduction in sampling time (at least two times the speedup reported in previous work <ref type="bibr" target="#b7">[7]</ref>), but also because of its dramatically reduced memory usage, an issue not addressed previously.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: The three Gibbs sampling-based methods iterate over a set of words, updating the topic assignment for each word given the topic assignments for the remaining words. The methods vary only in the set of topic assignments they consider: Gibbs1 samples new topic assignments for the entire corpus, including the original training documents; Gibbs2 samples assignments for only the new documents, holding the parameters for the training corpus fixed; Gibbs3 samples each new document independently.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :</head><label>2</label><figDesc>Figure 2: A comparison of time and space efficiency between standard Gibbs sampling (dashed red lines) and the SparseLDA algorithm and data structure presented in this paper (solid black lines). Error bars show the standard deviation over five runs.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 5 :</head><label>5</label><figDesc>Figure 5: Examples of topic distribution obtained by different methods (NIPS)</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 7 :Figure 8 :</head><label>78</label><figDesc>Figure 7: Performance of different methods VS. Topic number on NIPS</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Figure 9 :</head><label>9</label><figDesc>Figure 9: The effect of "topic drift" on MaxEnt performance. The left figure shows the effect of the proportion of previously seen vocabulary. The right figure shows performance on news data: we predict topics for June 2007 using only Jan 2007, then Jan and Feb, and so on.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 1 :</head><label>1</label><figDesc>Top five topics predicted by different methods for a testing document</figDesc><table><row><cell>Method</cell><cell>θt Highest probability words in topic</cell></row><row><cell>Gibbs1</cell><cell>0.4395 learning generalization error</cell></row><row><cell></cell><cell>0.2191 function case equation</cell></row><row><cell></cell><cell>0.0734 figure time shown</cell></row><row><cell></cell><cell>0.0629 information systems processing</cell></row><row><cell></cell><cell>0.0483 training set data</cell></row><row><cell cols="2">MaxEnt 0.2736 learning generalization error</cell></row><row><cell></cell><cell>0.2235 function case equation</cell></row><row><cell></cell><cell>0.0962 figure time shown</cell></row><row><cell></cell><cell>0.0763 information systems processing</cell></row><row><cell></cell><cell>0.0562 learning error gradient</cell></row></table></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8.">ACKNOWLEDGMENTS</head><p>This work was supported in part by the Center for Intelligent Information Retrieval, in part by The Central Intelligence Agency, the National Security Agency and National Science Foundation under NSF grant #IIS-0326249, and in part by UPenn NSF medium IIS-0803847. Any opinions, findings and conclusions or recommendations expressed in this material are the authors' and do not necessarily reflect those of the sponsor.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Gibbs2</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Gibbs3</head><p>Gibbs2.S  </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<monogr>
		<title/>
		<author>
			<persName><surname>References</surname></persName>
		</author>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Topic models over text streams: A study of batch and online unsupervised learning</title>
		<author>
			<persName><forename type="first">A</forename><surname>Banerjee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Basu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">SIAM-DM</title>
		<imprint>
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">A maximum entropy approach to natural language processing</title>
		<author>
			<persName><forename type="first">A</forename><surname>Berger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">D</forename><surname>Pietra</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">D</forename><surname>Pietra</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Computational Linguistics</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="39" to="72" />
			<date type="published" when="1996">1996</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Latent Dirichlet allocation</title>
		<author>
			<persName><forename type="first">D</forename><surname>Blei</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Ng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Jordan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Machine Learning Research</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="page" from="993" to="1022" />
			<date type="published" when="2003-01">January 2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Finding scientific topics</title>
		<author>
			<persName><forename type="first">T</forename><surname>Griffiths</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Steyvers</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PNAS</title>
		<imprint>
			<biblScope unit="volume">101</biblScope>
			<biblScope unit="issue">Suppl. 1</biblScope>
			<biblScope unit="page" from="5228" to="5235" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">MALLET: A machine learning for language toolkit</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">K</forename><surname>Mccallum</surname></persName>
		</author>
		<ptr target="http://mallet.cs.umass.edu" />
		<imprint>
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Distributed inference for latent dirichlet allocation</title>
		<author>
			<persName><forename type="first">D</forename><surname>Newman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Asuncion</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Smyth</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Welling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">NIPS</title>
		<imprint>
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Fast collapsed Gibbs sampling for latent Dirichlet allocation</title>
		<author>
			<persName><forename type="first">I</forename><surname>Porteous</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Newman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Ihler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Asuncion</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Smyth</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Welling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">SIGKDD</title>
		<imprint>
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Modeling and predicting personal information dissemination behavior</title>
		<author>
			<persName><forename type="first">X</forename><surname>Song</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C.-Y</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">L</forename><surname>Tseng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M.-T</forename><surname>Sun</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">KDD</title>
		<imprint>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">A collapsed variational bayesian inference algorithm for latent dirichlet allocation</title>
		<author>
			<persName><forename type="first">Y</forename><forename type="middle">W</forename><surname>Teh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Newman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Welling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">NIPS</title>
		<imprint>
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Dynamic mixture models for multiple time series</title>
		<author>
			<persName><forename type="first">X</forename><surname>Wei</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Sun</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Wang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IJCAI</title>
		<imprint>
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
