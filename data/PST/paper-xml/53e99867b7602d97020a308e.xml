<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">A PDE Formalization of Retinex Theory</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Jean</forename><forename type="middle">Michel</forename><surname>Morel</surname></persName>
							<email>morel@cmla.ens-cachan.fr</email>
							<affiliation key="aff0">
								<orgName type="institution">CMLA ENS Cachan</orgName>
								<address>
									<postCode>94235</postCode>
									<settlement>Cachan Cédex, Paris</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Ana</forename><forename type="middle">Belén</forename><surname>Petro</surname></persName>
							<email>anabelen.petro@uib.es</email>
							<affiliation key="aff0">
								<orgName type="institution">CMLA ENS Cachan</orgName>
								<address>
									<postCode>94235</postCode>
									<settlement>Cachan Cédex, Paris</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Catalina</forename><surname>Sbert</surname></persName>
							<email>catalina.sbert@uib.es</email>
							<affiliation key="aff0">
								<orgName type="institution">CMLA ENS Cachan</orgName>
								<address>
									<postCode>94235</postCode>
									<settlement>Cachan Cédex, Paris</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><roleName>Prof</roleName><forename type="first">Ma</forename><forename type="middle">J M</forename><surname>Kai-Kuang</surname></persName>
							<affiliation key="aff1">
								<orgName type="institution">Universitat de les Illes Balears</orgName>
								<address>
									<settlement>Palma de Mallorca, Balearic Islands</settlement>
									<country key="ES">Spain</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><surname>Morel</surname></persName>
							<affiliation key="aff1">
								<orgName type="institution">Universitat de les Illes Balears</orgName>
								<address>
									<settlement>Palma de Mallorca, Balearic Islands</settlement>
									<country key="ES">Spain</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">A PDE Formalization of Retinex Theory</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">86A1D0A51AEC5C9E5A10690767E2D2F7</idno>
					<idno type="DOI">10.1109/TIP.2010.2049239</idno>
					<note type="submission">received April 08, 2009; revised September 21, 2009; accepted March 18, 2010. Date of publication May 03, 2010; date of current version October 15, 2010.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.3" ident="GROBID" when="2023-07-28T14:00+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<textClass>
				<keywords>
					<term>Color perception</term>
					<term>FFT</term>
					<term>PDE</term>
					<term>Retinex theory</term>
					<term>stochastic integral</term>
				</keywords>
			</textClass>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>In 1964, Edwin H. Land formulated the Retinex theory, the first attempt to simulate and explain how the human visual system perceives color. His theory and an extension, the "reset Retinex" were further formalized by Land and McCann [1]. Several Retinex algorithms have been developed ever since. These color constancy algorithms modify the RGB values at each pixel to give an estimate of the color sensation without a priori information on the illumination. Unfortunately, the Retinex Land-McCann original algorithm is both complex and not fully specified. Indeed, this algorithm computes at each pixel an average of a very large set of paths on the image. For this reason, Retinex has received several interpretations and implementations which, among other aims, attempt to tune down its excessive complexity. In this paper, it is proved that if the paths are assumed to be symmetric random walks, the Retinex solutions satisfy a discrete Poisson equation. This formalization yields an exact and fast implementation using only two FFTs. Several experiments on color images illustrate the effectiveness of the Retinex original theory.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>I. INTRODUCTION</head><p>O NE of the main enigmas of perception is the discrepancy between the physical reflectance of objects and the colors perceived by the human visual system (HVS). This system, made up of eye, retina and visual cortex, processes the photons reaching the eyes. Color processing is completed in the cortex V4 area. The result of this process is color sensation, which cannot be measured directly: it can be only experienced by the HVS. Color sensation is not directly linked to the spectral characteristics of the perceived signal <ref type="bibr" target="#b1">[2]</ref>.</p><p>One of the puzzling HVS features is color constancy, namely the ability to determine the colors of objects irrespective of the illumination conditions <ref type="bibr" target="#b2">[3]</ref>. Human and machine color constancy are different concepts. As impressively described in <ref type="bibr" target="#b1">[2]</ref>, the human color perception depends upon several factors such as overall illumination changes or the amount of detail in the scene <ref type="bibr" target="#b3">[4]</ref>. From the deep study of this HVS property one can deduce that the human color sensation is hardly influenced by the context. The reflectance, which is the amount of incident light reflected by an object for a given wavelength, defines the physical color of an object <ref type="bibr" target="#b2">[3]</ref>. The goal of machine color constancy is to determine reflectance regardless of illumination. This objective is quite different from the HVS modeling objectives. However, as we shall see, some striking similarities arise when these divergent theories are formalized as PDEs.</p><p>The Land and McCann Retinex theory <ref type="bibr" target="#b0">[1]</ref>, <ref type="bibr" target="#b4">[5]</ref> is the first attempt to simulate and explain how the HVS perceives color, based upon experiments using Mondrian patterns. In early results <ref type="bibr" target="#b5">[6]</ref>, Land assumed that three independent sets of receptors exist and that the comparison of these three receptor outputs gives the sense of color. He named Retinex this system and Retinex theory aims at reproducing the sensory response to color stimuly by the HVS <ref type="bibr" target="#b6">[7]</ref>. This name is a neologism made of retina and cortex. Indeed, Land postulates that the Retinex involves the structure and function of both retina and cortex <ref type="bibr" target="#b0">[1]</ref>. Land's Retinex theory is the first computational model to explain and simulate color constancy. In <ref type="bibr" target="#b7">[8]</ref>, Land proposed the three Retinex Theory statements:</p><p>1) the composition of the light from an area in an image does not specify the color of that area; 2) the color of a unit area is determined by a trio of numbers each computed on a single waveband to give the relationship for that waveband between the unit area and the rest of the unit areas in the scene; 3) the Retinex algorithm (described in Section II). In the past forty years, the Retinex model has inspired a wide range of implementations, improvements and discussions <ref type="bibr" target="#b8">[9]</ref>- <ref type="bibr" target="#b11">[12]</ref>. The Retinex algorithms have also been used by several authors as color constancy algorithms. As Provenzi et al. mention in <ref type="bibr" target="#b12">[13]</ref>, "there is a big interest in the comparison among spatial properties of all the different Retinex implementation available in literature." But this comparison is a challenging task because of the computational complexity of existing implementations and of their strong dependence on their own parameters <ref type="bibr" target="#b12">[13]</ref>. Hurlbert in <ref type="bibr" target="#b13">[14]</ref> tried to "clarify and formalize the lightness problem by proposing a new formulation of the intensity equation on which lightness algorithms are based," but she did not substantiate a unique mathematical formula from which the different lightness problems would be derived.</p><p>In this paper, the original Retinex algorithm will be formalized as a (discrete) partial differential equation. More precisely, it will be shown that if the Retinex paths are interpreted as symmetric random walks, then Retinex is equivalent to a Neumann problem for a linear Poisson equation. This result gives a fast algorithm involving just one parameter, also present in the original theory. The obtained Poisson equation turns out to be very similar to Horn's and Blake's equations, which were proposed as alternatives to Retinex. To the best of our knowledge, this striking similarity of the three models had not yet been pointed out. The obtained Retinex PDE also turns out to be one of the "Poisson editing" equations proposed in Perez et al. <ref type="bibr" target="#b14">[15]</ref>. We can directly quote from these authors: First, it is well known to psychologists <ref type="bibr" target="#b0">[Land and McCann 1971]</ref> that slow gradients of intensity, which are suppressed by the Laplacian operator, can be superimposed on an image with barely noticeable effect. Conversely, the second-order variations extracted by the Laplacian operator are the most significant perceptually. Secondly, a scalar function on a bounded domain is uniquely defined by its values on the boundary and its Laplacian in the interior. The Poisson equation therefore has a unique solution and this leads to a sound algorithm. The paper is organized as follows. In the next section we present the original Retinex algorithm and its modified version called reset Retinex. Section III gives a brief overview of several types of Retinex implementations in the literature. The equivalence of Retinex and the Retinex PDE is detailed in Section IV. An "Extrema Retinex" variant where the paths start from image extrema is also considered. A FFT fast implementation is described in Section IV-C. Section V displays results of the proposed algorithm illustrating the perception effects of the original Land method, depending upon the threshold parameter. These experiments seem to agree with the original scopes of Retinex, and confirm several color illusions.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>II. ORIGINAL RETINEX ALGORITHM</head><p>The basic Retinex model is based upon the assumption that the HVS operates with three retinal-cortical systems, each one processing independently the low, middle and high frequencies of the visible electromagnetic spectrum. Each system produces one lightness value which determines, by superposition, the perception of color in the HVS. On digital RGB images, the lightness is represented by the triplet ( , , ) of lightness values in the three chromatic channels.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Resetless Retinex</head><p>Inspired by several experiments, Land and McCann observed that edges are the main image feature invariant to illumination, and therefore the main source of information to achieve color constancy <ref type="bibr" target="#b0">[1]</ref>. They also realized that a luminance ratio threshold between two adjacent points maintains the edge if there is one between those points, but eliminates the gentle slopes caused by nonuniform illumination. Thus, obtaining the lightness values boils down to processing the entire image in terms of luminance ratios. In the case of two widely separated areas in the image, they therefore consider the sequential product of ratios across edges on a path joining both areas (see Fig. <ref type="figure" target="#fig_0">1</ref>). Since this generalized lightness ratio would then depend upon the chosen path, the Retinex algorithm considers all possible paths starting at random points and ending at the pixel at which the lightness value is computed. This lightness is then defined as the average of the products of ratios between the intensity values of subsequent edge points in the path. In order to remove the effects of nonuniform illumination over the scene, the ratio is considered unitary if it does not differ from 1 by more than a fixed threshold value.</p><p>The formula giving the lightness value of a pixel computed by Retinex in a given chromatic channel was proposed in <ref type="bibr" target="#b15">[16]</ref>, but the process itself is described in <ref type="bibr" target="#b0">[1]</ref>. The image data is the intensity value for each chromatic channel at . Land and McCann consider a collection of paths starting at and ending at an arbitrary image pixel . Let be the number of pixels of the path , and denote by for and by the subsequent pixel of the path so that and . Definition 1: The lightness of a pixel in a given chromatic channel is the average of the relative lightness at over all paths, that is <ref type="bibr" target="#b0">(1)</ref> where denotes the relative lightness of a pixel with respect to on the path defined by <ref type="bibr" target="#b1">(2)</ref> and, for a fixed contrast threshold</p><formula xml:id="formula_0">if if<label>(3)</label></formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Reset Mechanism</head><p>The reset mechanism proposes an adaptation of the previous definition to ensure that all paths start from regions where the maximal luminance value is attained. We quote from <ref type="bibr" target="#b0">[1]</ref>:</p><p>One that seems simple, but is not, is to scan the entire scene to find the area or areas with the highest reflectance. (…) Although this technique is mathematically valid we feel that it is not readily transposed into biological mechanisms. We therefore sought a technique that can automatically establish the highest reflectance without a separate first scanning step. We adopted the convention that the initial ratio is the ratio of the signal of the second receptor to that of the first (followed by the third to the second, etc.). Then, regardless of the true reflectance of an area, our technique supposes that the first receptor in any path is reporting from an area that reflects 100% of the light. (…) Attainment of a sequential product greater than 1.0 indicates that the sequence should be started afresh and that this new, higher reflectance should be next supposed to be 100%. (…) As the path proceeds, the sequential product always starts over at unity when the path encounters an area with a reflectance higher than the highest previously encountered. Notice that the previous quotation uses products of ratios (see Fig. <ref type="figure" target="#fig_0">1</ref>). Taking the logarithm of this product yields a sum of logarithms of ratios. In the reset formulation of Retinex, the average giving is taken over paths on which all partial sums leading to the complete sum must be nonpositive</p><formula xml:id="formula_1">(4)</formula><p>The value of the reset Retinex solution at a pixel depends upon the memory of each single path. To the best of our knowledge, this fact rules out any PDE formalization for reset Retinex. As shown by the previously shown Land and McCann quotation, the main goal of the reset mechanism was to ensure that all paths starting from end at points that are image extrema. This goal is not achieved by reset Retinex. The reset mechanism only selects paths along which there is no value larger than the initial value. This observation justifies defining an "Extrema Retinex", namely a variant where all paths only start from image extrema. Extrema Retinex is an easy adaptation of Def. 1:</p><p>Definition 2: (Extrema Retinex) The lightness of a pixel in a given chromatic channel is the average of the relative lightness at over all paths linking to an arbitrary image extremum , the path meeting no other extremum before reaching . We therefore have where is given by <ref type="bibr" target="#b1">(2)</ref>. In all that follows we shall analyze and compare both definitions, namely the original Retinex (Def. 1) and Extrema Retinex of Def. 2. Somehow, the result of reset Retinex should be intermediate between the result of Resetless Retinex and Extrema Retinex. As the previously shown quotation shows, Extrema Retinex was considered by Land and McCann, but only to be rejected as biologically not plausible. In recent papers, such as <ref type="bibr" target="#b6">[7]</ref>, McCann clearly refers this area or areas with the highest reflectance as "local maximum" zones. All the same, we consider it interesting and legitimate to compare it with the original Retinex, to see whether it makes a serious difference or not.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>III. STATE OF THE ART</head><p>Many interpretations, implementations and improvements of the Retinex algorithm can be found in the literature. The interpretations are usually categorized <ref type="bibr" target="#b10">[11]</ref>, <ref type="bibr" target="#b16">[17]</ref> as path-based algorithms, recursive algorithms, center/surround algorithms and physically-motivated variants (introduced by Horn <ref type="bibr" target="#b17">[18]</ref>). We shall now review briefly these categories.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Path-Based Algorithms</head><p>In these algorithms the lightness of each pixel depends upon the multiplication of ratios along random walks. The original works of Land <ref type="bibr" target="#b0">[1]</ref>, <ref type="bibr" target="#b7">[8]</ref>, belong to this category, jointly with recent implementations such as <ref type="bibr" target="#b18">[19]</ref> and <ref type="bibr" target="#b11">[12]</ref>.</p><p>The main drawbacks of path-based algorithms are the dependency of the path geometry, the computational complexity, and the large amount of free implementation parameters, such as the number of paths and their lengths.</p><p>In <ref type="bibr" target="#b18">[19]</ref>, the authors implemented the original Retinex using Brownian motion to approximate each path in the Retinex algorithm. This application greatly improves the effectiveness of the algorithm and its speed, but the new implementation still presents the two mentioned drawbacks. However, we follow these authors and adopt the Brownian motion as the likeliest interpretation of the set of paths that was left unspecified by Land and McCann.</p><p>In <ref type="bibr" target="#b11">[12]</ref>, Provenzi et al. presented a detailed mathematical analysis of the original Retinex algorithm proposing an analytic formula that describes the algorithm behavior. They postulate that the qualitative behavior of Retinex in relation to the variation of the different parameters can be predicted by using a direct mathematical formula. Unfortunately, their proof is reduced to a Retinex without threshold. Provenzi et al. in their last work <ref type="bibr" target="#b12">[13]</ref> replace paths by 2-D pixel sprays. The spray approach is faster than the path-based one.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Recursive Algorithms</head><p>Recursive algorithms were developed by Frankle and Mc-Cann. They replace the path computation by a recursive matrix comparison <ref type="bibr" target="#b19">[20]</ref>- <ref type="bibr" target="#b21">[22]</ref>. These algorithms compute long-distance iterations between pixels first and then progressively move to short-distance interactions. The spacing between pixels being compared decreases at each step in clockwise order. The comparison is implemented with ratio-product-reset-average operation at each space.</p><p>This algorithm is computationally more efficient than the previous ones. The main drawback is that it depends upon a crucial parameter, namely the number of times a pixel's neighbors are to be visited. This parameter is named number of iterations. The optimal value for this parameter is not clear and can strongly influence the final result (see <ref type="bibr" target="#b22">[23]</ref> for a discussion of this point).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C. Center/Surround Algorithms</head><p>Through the years, Land's views on Retinex evolved to its last form as a center/surround spatially opponent operation <ref type="bibr" target="#b23">[24]</ref>. This new technique introduces a weight in the reciprocal influence of two pixels, inversely proportional to their square distance.</p><p>These new implementations suggested to some authors the idea that the lightness values could be computed by subtracting a blurred version of the input image from the original image. Thus, Rahman et al. use a Gaussian to compute the blurred image and perform color correction at a single scale <ref type="bibr" target="#b24">[25]</ref>. They made later this algorithm multiscale <ref type="bibr" target="#b25">[26]</ref>. The algorithms in the center/surround class are faster than the path-based ones, and the amount of parameters is notably reduced. However, they still present a large amount of parameters which are difficult to formalize. Moreover, the Rahman et al. algorithms are based upon the "gray world" assumption, i.e., the assumption that, on average, the world is gray, and the results over color images with gray-world violations are unnatural.</p><p>There is growing interest in Retinex variants permitting local contrast enhancement and therefore an improved visual quality. Bertalmio et al. <ref type="bibr" target="#b26">[27]</ref> have recently proposed a novel interpretation of Land's Retinex theory, the Kernel-based Retinex (KBR), which relies on the computation of the expectation of a suitable random variable weighted with a kernel function. The authors prove that Retinex and KBR share the same intrinsic properties. The method has a low computational cost but "the set of parameters that correspond to the best visual performance varies with the input image." This work is based and compared with two previous works: <ref type="bibr" target="#b27">[28]</ref> and <ref type="bibr" target="#b3">[4]</ref>, in which color correction algorithms are devised in the framework of variational techniques and are inspired in the basic phenomenology of human color vision. Very recently, Bertalmio and Cowan <ref type="bibr" target="#b28">[29]</ref> have implemented the KBR as Wilson-Cowan equations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D. Physics-Based Algorithms</head><p>The algorithms in this category propose to translate the Retinex principles into a more physical form, leading to set of equations or to an optimization problem. Horn's work <ref type="bibr" target="#b17">[18]</ref> is the first of a group of articles <ref type="bibr" target="#b29">[30]</ref>- <ref type="bibr" target="#b31">[32]</ref> in which the authors propose to decompose the image intensity as a product of the reflectance and of the incident illumination intensity , so that . Horn separates reflectance and illumination by taking the logarithm of the image intensity, . Like in Retinex, the main assumption is that the illumination varies smoothly over the image, while sharp discontinuities are present only where the reflectance changes. Applying the Laplacian yields . Then the first component is zero almost everywhere, and is large only at the reflectance edges. The second component is bounded and small because varies smoothly. Thus, Horn proposes to apply a threshold operator to remove the second component. This yields . This relation can be viewed as a Poisson equation to find from , namely <ref type="bibr" target="#b4">(5)</ref> The solution of the Poisson equation is finally exponentiated to yield an estimate of the reflectance. Horn normalizes the result by assuming that there is at least one point in the image that reflects all the light, which is therefore assumed to be white.</p><p>The Poisson (5) in Horn's model is usually solved by an iterative scheme, certainly not an optimal method for this equation when the domain is a rectangle. The very same equation is actually called Poisson-equation-type Retinex algorithm in <ref type="bibr" target="#b32">[33]</ref>, which refers to Kimmel et al. <ref type="bibr" target="#b16">[17]</ref> variational model for Retinex. This last model is similar to the Horn model. It also assumes that the illumination field is smooth, and inserts in the variational model a knowledge of the limited reflectance dynamic range as a constraint. These authors also presented a fast multiresolution solution to the variational problem.</p><p>IV. PDE MODEL OF RETINEX THEORY Our limited aim is to propose a possible formalization of the original Retinex theory of lightness perception described by Land <ref type="bibr" target="#b15">[16]</ref> and Land-McCann <ref type="bibr" target="#b0">[1]</ref>, and, to some extent, its reset formulation. The main outcome of this formalization will be a Poisson equation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Random Path Model</head><p>The first thing to do is to give a formal definition for the paths used by Land et al. These authors did not give any definite indication on the set of paths to be used. Thus, most implementations tend to reduce the number of admissible paths for obvious computational reasons. However, in absence of any specification, it seems sound to do exactly the contrary, namely to consider the most general class of random paths compatible with image geometry. Such are the paths obtained by standard symmetric discrete random walks on the image grid <ref type="bibr" target="#b33">[34]</ref>. These paths start from the reference pixel and their stopping pixel is an arbitrary pixel on the image grid. Such random paths can of course have loops. In particular nothing excludes their passing more than once by before reaching . Notice that when the grid mesh tends to zero these random paths tend to Brownian paths that are isotropic. This Brownian path interpretation was already proposed in its asymptotic form in <ref type="bibr" target="#b18">[19]</ref>. Thanks to this isotropic limit, the anisotropy of the random symmetric walk is no serious objection to adopting a discrete random walk. In coherence with this remark, we shall see that the underlying PDE also tends to be isotropic when the image mesh tends to zero.</p><p>To define easily how the random walk bounces back when it meets the image boundary, the random walk is first considered as a random walk on the whole plane. To this aim, the rectangular image defined on the rectangular grid is first reflected through its boundaries to a rectangular image . For instance the reflection through the right vertical image side satisfies set for , which implies , so that the right hand side and the left hand side of the new image are equal (see Fig. <ref type="figure" target="#fig_2">2</ref> left). This symmetric image is then extended to the whole integer plane by making it periodic. When a function is obtained by this symmetrization and periodization, we shall say that it is  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>at</head><p>. We could have defined directly the reflected random walk but, both settings being equivalent, advantage can be taken of both. Indeed, standard theory on random walks in the plane <ref type="bibr" target="#b33">[34]</ref> applies to , while is a Markov chain with a finite number of states. The effect on the image is identical because . In agreement with the first Retinex theory, the stopping pixel is a uniformly distributed random pixel in the image rectangle. (Here and in all that follows, random variables are written with bold characters.) We say that the random path in the plane hits if does. This amounts to say that hits any pixel congruent to .</p><p>Lemma 1: For every specified stopping pixel the random walk stops almost surely in finite time, and the expectation of the stopping time is finite and uniformly bounded.</p><p>Proof: Indeed, since we can reach any pixel from any pixel, is an irreducible Markov chain on a finite set of states (the original image domain ). Thus, the announced properties are standard <ref type="bibr" target="#b33">[34]</ref>.</p><p>We can therefore consider the stopping time of the random walk at , and the stopped random walk at a pixel or at a set of pixels . The associated stopped symmetric random walk is defined by for for .</p><p>We denote the length of this random walk by (and similar notations for a stopping set : , ). The Retinex "average over paths" is nothing but an expectation in the random walk model. The next definition is therefore the straightforward translation of Land's original definition in more formal probabilistic terms.</p><p>Definition 3: Assume is a bounded symmetric image. Given a stopped symmetric random walk on the image grid starting at and stopping at a pixel , the relative lightness is <ref type="bibr" target="#b5">(6)</ref> The lightness of a pixel in a given chromatic channel is the expectation of the relative lightness (2) at of a stopped symmetric random walk on the image grid starting at and stopping at a random uniform image pixel . In other terms <ref type="bibr" target="#b6">(7)</ref> In the case of Extrema Retinex, denoting by the set of image maxima, we call lightness the function   walk starting at and ending at . Indeed, there is a bijection between: a) the set of random paths starting at and stopping at whose first step is , and b) the set of random paths starting from and stopping at . Thus which yields <ref type="bibr" target="#b8">(9)</ref>.</p><p>Remark 1: The result of lemma 2 can be reformulated as a discrete equation on the initial discrete image model : is the unique solution of the Poisson equation with Neumann boundary condition <ref type="bibr" target="#b10">(11)</ref> Theorem 1: The lightness value in a chromatic channel defined in Def. 3 is the unique solution of <ref type="bibr" target="#b11">(12)</ref> where is defined in <ref type="bibr" target="#b9">(10)</ref>.</p><p>Proof: By (7) Fig. <ref type="figure">6</ref>. On the left, the original image, the two X's have exactly the same color.</p><p>In the right image, Retinex simulates the illusion by which the left X gets an apparent color similar to the right purple background, and the right X gets an apparent color similar to the left yellow background.</p><p>By Lemma 2, we know the value of the first term but it remains to compute the second term. Using the discrete Green Formula we have By (11) we have Thus Finally, substituting these values in formula ( <ref type="formula" target="#formula_2">13</ref>) we obtain By symmetry, it is an easy check that , and we get <ref type="bibr" target="#b11">(12)</ref>. The existence and uniqueness of the symmetric and periodic solution of this discrete equation fol- , that is, Retinex without threshold, then the ( <ref type="formula">12</ref>) becomes <ref type="bibr" target="#b14">(15)</ref> An asymptotic of the previous equation is easily derived. Assume for simplicity that and that the discrete domain is a sampling of a continuous domain on which is assumed to be defined with arbitrarily sharp resolution. Assume also that is a function. Under these ideal circumstances, we can let and look for an asymptotic state for the solution of <ref type="bibr" target="#b14">(15)</ref>, which now depends upon . Set , the pixel mesh. Then by second-order Taylor expansion where the usual Laplacian. By a classic asymptotic argument using distribution theory, the solution of ( <ref type="formula">15</ref>) tends in the sense of distributions to the unique solution of the continuous Neumann problem <ref type="bibr" target="#b15">(16)</ref> This equation is similar to Horn's equation <ref type="bibr" target="#b17">[18]</ref> (see Section III-D) and is isotropic, thus, confirming the isotropy of the Retinex model.</p><p>Remark 3: The equation obtained in Theorem 1 is identical to the Poisson editing equation very recently proposed in Perez et al. <ref type="bibr" target="#b14">[15]</ref>. However, the arguments presented in this paper need be presented even if briefly. The authors remark that a vector field defined on the image domain is not necessarily a gradient field, namely there is not necessarily a function such that . But a natural variational formulation leads to compute a function whose gradient is closest to as a solution of the Poisson equation <ref type="bibr" target="#b16">(17)</ref> These authors also propose a texture flattening application, whose goal it is to wash out the texture and keep only the edges. This is obtained by solving <ref type="bibr" target="#b17">(18)</ref> where is a lower threshold on the gradient killing small gradients but maintaining the edges. This equation is actually identical to Blake's equation <ref type="bibr" target="#b29">[30]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Locality of Retinex</head><p>As suggested by one of our referees, the locality of the Retinex PDE could be evaluated by computing the average length of the paths. However, this average length with stopped brownian motion is already of order in one dimension, and much higher in dimension 2. Thus, this length does not really evaluate the locality of the Poisson equation. The reason is that random walks are twisted. The Retinex PDE locality can be measured more realistically by the standard deviation of the Poisson kernel underlying the equation. Actually, the Retinex equation is nonlinear and has no kernel unless we put the threshold in (3) to zero. In that case the equation becomes linear. Thus, its solution is equivalent to the convolution of the second member with a kernel . Anticipating on the next section and using <ref type="bibr" target="#b22">(23)</ref>, the equation kernel is defined on the Fourier domain by <ref type="bibr" target="#b18">(19)</ref> Convolving with this kernel a data is equivalent to solving the Poisson equation with as a second member. The standard deviation of for is and the kernel shape and locality can be appreciated in Fig. <ref type="figure" target="#fig_4">3</ref>. The effect of this kernel Retinex spreads as far as one third of the image. We refer to Fig. <ref type="figure">7</ref> to illustrate how Retinex gets less local when the threshold increases.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C. FFT Implementation</head><p>The discrete ( <ref type="formula">12</ref>) is easily solved using the discrete Fourier transform. The discrete Fourier transform of a two-dimensional </p><p>The discrete Fourier transform has the following property where <ref type="bibr" target="#b20">(21)</ref> Substituting the discrete Fourier transform in <ref type="bibr" target="#b11">(12)</ref> and using the property (21) yields <ref type="bibr" target="#b21">(22)</ref> which entails (for ) <ref type="bibr" target="#b22">(23)</ref> Using <ref type="bibr" target="#b19">(20)</ref> we obtain the value of at each point of the grid, and finally normalize to the interval . All of the previous computations are performed on the extended symmetric image defined on the grid. being symmetric, its Fourier coefficients are real. Since the coefficients of in <ref type="bibr" target="#b21">(22)</ref> are also real, this property is transferred by the equation to , and is also symmetric. In addition, the use of the discrete Fourier transform of and implicitly assumes and to be -periodic. Notice that we have found a unique solution in the class of the symmetric and periodic discrete functions, as announced in Theorem 1.</p><p>Notice that in the case of Extrema Retinex we cannot use this fast implementation. In this case we use an slower iterative method (Gauss-Seidel) for solving the corresponding linear system. The existence and uniqueness proof for a solution of the equation in Corollary 1 is also classic: It is the minimum of a strictly convex quadratic functional.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D. Advantages of the PDE Model</head><p>The new implementation of original Retinex has three advantages compared to previous implementations: Under the random walk assumption on the paths, it is completely faithful to the original idea of Land-McCann. It is fast in the original setting, and uses a unique parameter, the original Retinex threshold.</p><p>Table <ref type="table">I</ref> compares its computational cost with the previous implementations mentioned in Section III. In this table</p><p>is the number of pixels in the image. All previous pathbased implementation have obviously a higher computational cost, in spite of the fact that they consider considerably less paths and less seed points . Some of the given values for the computational costs depend upon parameters that have anyway high values. For example, in <ref type="bibr" target="#b12">[13]</ref>, the authors deduce that the ideal values of parameters are , Table <ref type="table">I</ref> compares the number of parameters involved in the various implementations. Only two implementations <ref type="bibr" target="#b19">[20]</ref>, <ref type="bibr" target="#b20">[21]</ref> restrict themselves to a unique parameter. But, as we mentioned before, this unique parameter in McCann and in Frankle et al. has a strong influence on the result: "this parameter can vary the output from radical to no dynamic range compression" <ref type="bibr" target="#b21">[22]</ref>. Variations of the Retinex parameter instead change only marginally the final result, as we shall observe in next section.</p><p>Since the Retinex PDE implementation proposed here is similar to the Horn and Blake models, Table II compares the computational costs of these models. Clearly the FFT implementation is much faster than any iterative scheme, and actually works for all of these Poisson equations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>V. EXPERIMENTAL RESULTS</head><p>In this section, we present several results of the PDE implementation, with a discussion about the threshold values. The proposed PDE implementation of Retinex can be tested on line by users on their own images at http://mw.cmla.ens-cachan.fr/megawave/demo/retinex_pde/. The choice of the threshold value is left to the user. We shall also discuss here the Extrema Retinex implementation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Gamma-Corrected Model</head><p>The experiments implement the Retinex theory using the new-introduced Poisson equation and the FFT (Section IV-C). In principle, Retinex should be applied to raw images and we will do so on several of our own. However, most classic test images are gamma-corrected images in JPEG format. Thus, we have to state how to deal with them. The gamma-correction consists of applying a concave function to the raw image, in practice a logarithm or a power with . Assuming that the gamma-correction is logarithmic is not restrictive: and have a very similar shape over the usual image range. As a rewarding consequence of this assumption, instead of working with differences between logarithms of intensities like in Retinex, we can deal directly with intensity differences when working with gamma-corrected images. Thus, we can write directly , instead of , with defined by <ref type="bibr" target="#b2">(3)</ref>. Then the function defined in <ref type="bibr" target="#b9">(10)</ref> simply becomes <ref type="bibr" target="#b23">(24)</ref> Then, the pseudo-code applied to the different images for obtaining the results showed in this section is:</p><formula xml:id="formula_4">for each color channel do</formula><p>Compute defined in (24), using the selected threshold Apply FFT to</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Compute with (23)</head><p>Apply inverse FFT to Convert to end for</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Visual Illusions: Experiments</head><p>Land's Retinex theory was postulated as a perception model and attempted to explain the HVS and in particular classic color perception illusions. In optical illusions the information gathered by the eye is processed in the brain to give a perception that does not tally with a physical measurement of the stimulus source. Applying the Retinex algorithm to an illusory image, it is expected that the result will be an image showing the same tendencies in the alteration of colors as the HVS. As a first classic example, Fig. <ref type="figure" target="#fig_5">4</ref> shows Adelson's checker shadow illusion. In the left image a green cylinder standing on a black and white checker-board casts a diagonal shadow across the board. The image has been so constructed that the white squares in the shadow, one of which is labeled "B," have actually the very same gray value as the black squares outside the shadow, one of which is labeled "A." The classic illusion is that the squares A and B appear, respectively, black and white, despite the fact that they share the same gray value, (88). If Retinex is faithful to human perception, it should make B much brighter than A. The image on the right shows the result of applying the PDE Retinex algorithm. The gray value in square A is now 75 and in square B it is 100, making the square A effectively darker than the square B, in agreement with our perception. The Retinex primary goal was to simulate our perceptual color illusions. Thus, the criterion here is whether the perceptual tendencies are adequately simulated and not by any image improvement.</p><p>Our next illusion is about simultaneous contrast, namely the fact that the appearance of a color depends upon the colors surrounding it. Fig. <ref type="figure" target="#fig_6">5</ref> shows a background with a smooth variation and two circles with the same gray value (170). One of them is placed in the darker part of the image, and the other one in the brighter part. The usual perception is that the circle in the darker part looks conspicuously brighter than the other. Again, this illusion is so strong that it needs masking the whole image by a white sheet, excepting only both disks, to check that they indeed share the same luminance. If we use a threshold larger than the background variation, in this case we take , the result is an image with constant background (45). The left circle gets a 13 gray value and the right circle a 245 gray value, which is coherent with our perception.</p><p>Finally, Fig. <ref type="figure">6</ref> shows the successful simulation of a color illusion. On the left image, two X's with exactly the same color are put on different backgrounds, one yellow and the other purple. The striking illusion is that the X on the left seems to have a color similar to the purple background color on the right, while the X on the right has an apparent color similar to the yellow background color on the left. By applying the Retinex algorithm with the X's really get these illusory colors. Retinex result applied to the gamma corrected image with t = 2. Notice how similar are the results. Both maintain an image that is close to the original, but the low contrasted texture on the wall has been wiped out.</p><p>Fig. <ref type="figure">9</ref>. Left: The result of Extrema Retinex with t = 3 on the image in Fig. <ref type="figure" target="#fig_5">4</ref>. The gray level of square A becomes 80 and the gray level of square B becomes 120. Right: The result of Extrema Retinex with t = 3 on the image in Fig. <ref type="figure" target="#fig_6">5</ref>. The background becomes constant and the left circle becomes darker than the right one. Thus, Extrema Retinex shows the same properties as Retinex simulating color perception.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C. Retinex Threshold</head><p>With the function defined in <ref type="bibr" target="#b23">(24)</ref>, the second member of the Poisson <ref type="bibr" target="#b11">(12)</ref> behaves as an edge detector and produces a positive impulse located on the brighter side of the edge and a negative impulse located on the darker side. The good point of expressing Land's model on the gamma-corrected image is that we can gain an intuitive meaning for the Retinex threshold used in the definition of . This threshold allows to eliminate the small impulses. Now, in gamma-corrected images, edges and image details are usually perceived when their gradient exceeds a value around 10 (for classic 0-255 ranges). Thus, to avoid squeezing contrast in the image the threshold must be significantly smaller than 10. It is surprisingly harder to fix a threshold on the raw image. The gamma-correction performed in Section V-A was made with and the color balance was a simple stretching of all channels with minimal value at 0 and maximal value at 255. For a deeper discussion of Retinex thresholds, see <ref type="bibr" target="#b21">[22]</ref> To understand the effect of this threshold Fig. <ref type="figure">7</ref> shows a noisy original and the result of Retinex with increasing threshold values , 10, and 15. The background clutter and the shades are progressively filtered out when increases, but the main edges are kept. At , however, edges start loosing contrast and low contrasted details could disappear.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D. Raw Images</head><p>In agreement with the original theory, several experiments have been performed directly on raw images. The procedure starts by applying the logarithmic function to the images, then solving the Retinex PDE, using the expression in <ref type="bibr" target="#b9">(10)</ref>, and finally exponentiating and quantifying the result. This last quantification step, necessary for the visualization of the image, makes the results on raw images and on JPEG images quite similar. Fig. <ref type="figure" target="#fig_3">8</ref> shows an example of this procedure, with thresholds and applied to the raw image. In the bottom right image we show the result of the direct application of Retinex to the JPEG image (obviously without the logarithm and exponentiation steps). The results are quite similar. The reason was explained previously: the gamma-correction applied to create JPEG images is very similar to a logarithm.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>E. Extrema Retinex</head><p>In this section, we present some results with Extrema Retinex. As we shall see, the results are similar to the results of the original Retinex. However, with Dirichlet conditions inside the image domain, the PDE can no more be solved by a fast Fourier implementation. A classic Gauss-Seidel iterative scheme was instead used. The algorithm searches first the image extrema and puts these points to zero. Then the lightness at the other points   is the solution of the linear system associated with the discrete PDE.</p><p>In Fig. <ref type="figure">9</ref>, we show the Extrema Retinex results on the images in Figs. <ref type="figure" target="#fig_5">4</ref> and<ref type="figure" target="#fig_6">5</ref>, respectively, with the usual conservative value threshold parameter . The results are very similar to the corresponding Retinex results. Fig. <ref type="figure" target="#fig_9">10</ref> compares the results on a real image of Retinex and Extrema Retinex. The results are again quite similar.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>F. Comparison</head><p>The comparison between PDE Retinex and other Retinex implementations is a hard work, due to the fact that most codes are not available. Luckily, the web page http://www.cs.sfu.ca/ </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>VI. DISCUSSION AND CONCLUSION</head><p>The main contribution of this paper is the proof of a mathematical equivalence between an interpretation of the original Land-McCann Retinex theory, where the paths, unspecified in the theory, are assumed Brownian, and a simple Poisson equation. The FFT solver of this equation permitted to install an on line demo where it can be tested with all values of the Retinex threshold parameter. But this analysis has also revealed that the underlying equation was already known for other scopes such as image editing, and that it was very similar to two physical models, namely the Horn and Blake equations.</p><p>While the equivalence in itself is true and proven, its interpretation is questionable. We thank one of the referees for making the following three comments, which we decided to reproduce textually because they reflect the main aspects of the discussion on Retinex.</p><p>The first comment roughly recalls that the basic assumptions of the original Retinex theory have been proven wrong. "The idea that HVS and consequently Retinex aims at separating illuminance from reflectance was an initial hypothesis that has been proven to be false in recent works <ref type="bibr" target="#b34">[35]</ref>, <ref type="bibr" target="#b35">[36]</ref>. This idea is at the base of the major part of the center-surround and physics based Retinex."</p><p>The second comment situates the Brownian path Retinex implementation proposed here in the rich literature of variants stemming from Retinex: "The proposed approach performs like an implementation of the physical Retinex family;" "The authors claim to be faithful to the original Retinex version, however this is not confirmed by the presented results. In fact the method presented in the paper and easily testable on internet performs quite differently from path based and iterative Retinex." This comment actually confirms the mathematical result: under the Brownian path assumption the original Retinex becomes a Poisson equation, very similar to Horn's physical model and almost identical to Blake's model.</p><p>The third valuable referee comment is that several recent and successful variants stemming from Retinex use a more restricted set of paths than the ones considered in the present paper: "The evidence from the mathematical analysis of locality should be related to the fact that in the original Retinex (and in HVS) locality depends upon image content. The limited path random sampling, together with the reset operator, change Retinex local effect, according to the image content. This is a key feature not always considered in the center-surround and physics based Retinex implementation. For an example of center-surround anisotropic implementation see <ref type="bibr" target="#b36">[37]</ref>. A lack of anisotropy can lead to a contrast decrement that in fact I have experienced using their web application and is often compensated with additional arbitrary color restoration methods. Thus, the random walk assumption is not enough to be completely faithful to the original Retinex idea. The comparison between proposed Retinex and Extrema Retinex can be seen as a different tradeoff between global and local effect."</p><p>The random path assumption taken in this paper can and will indeed be the object of discussion, because it seems to be too isotropic and too nonlocal. The last experiment in the experimental section actually illustrates better this discussion by comparing the results of the Poisson PDE with more local methods. There is indeed an interaction in the literature between two different scopes in Retinex theory: color balance, and local contrast adjustment. The relation between those two scopes should be further investigated. The experiments herewith actually confirmed that the simplest original Retinex interpreted with Brownian paths provides a local contrast adjustment, in the spirit of <ref type="bibr" target="#b37">[38]</ref> and <ref type="bibr" target="#b14">[15]</ref>.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. Original Land-McCann scheme without the reset mechanism: 140=80 2 115=150 2 215=82 2 145=400 2 510=104 = 6:25=1. "Luminances of Mondrian (illuminated from below) at particular points along the path from top to bottom. The numbers at the bottom indicate the ratios of luminances at adjacent edges along the path."</figDesc><graphic coords="2,390.48,66.18,75.00,111.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head></head><label></label><figDesc>symmetric and periodic. (This setting is the standard image representation used for the Discrete Cosinus Transform.) Two pixels in the plane are said congruent if they are obtained from the same original pixel in the initial image domain by reflection and periodization. Consider a standard symmetric random walk in . By taking the unique congruent point of belonging to the original image domain, we can associate with the random walk in the plane a random walk in the original image domain (see Fig. 2 right). In that way, the random walk is reflected when it hits the initial image boundary. More precisely, consider a generic boundary pixel belonging (e.g.,) to the right hand vertical image side. Then if the random walk is at , its next position can be up, down, right and left with probability 1/4. When the next position implies crossing the image boundary toward , then hits the boundary half-pixel , bounces back, and therefore stays for one more step</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. Left: Domain symmetrization. Center: A random walk in the plane. Right: The congruent random walk in the image domain.</figDesc><graphic coords="5,79.68,66.58,430.00,113.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>( 8 )</head><label>8</label><figDesc>The only difference with the original Land definition is that the Retinex walk is specified to be a standard random walk. The previously defined values are finite. Indeed, the function is uniformly bounded, and by Lemma 1 the expectation of the stopping time is finite. The discrete Laplace operator on a grid is defined byThe discrete normal boundary operator on the boundary of the rectangular domain is defined, for example on the right vertical boundary, by . Lemma 2: The relative lightness in a chromatic channel as defined in Def. 3 is a symmetric and periodic solution of the discrete Poisson equation<ref type="bibr" target="#b8">(9)</ref> where denotes the discrete Laplace operator with respect to<ref type="bibr" target="#b9">(10)</ref> and , has been defined in (3), , , , and . Proof: Consider the stopped random walk starting at and ending at . If , then , since . If , this path hits first, with probability 1/4, one of the four -neighbors, , , , and . Let us denote this neighborhood by. By removing the first step of , the shortened path becomes the symmetric random</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 3 .</head><label>3</label><figDesc>Fig. 3. Central section of the Poisson kernel.</figDesc><graphic coords="6,112.08,68.00,106.00,79.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Adelson's checker shadow illusion and the same image applying the Retinex algorithm with t = 3.</figDesc><graphic coords="6,45.72,191.11,238.85,90.95" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig. 5 .</head><label>5</label><figDesc>Fig. 5. Simultaneous contrast illusion. Left: the original image. Right: Retinex result with t = 3. By Retinex the background slope is eliminated and therefore the shape-background contrast enhanced. In the left image the two disks have exactly the same grey level. Retinex is an attempt to formalize the process by which the right disk appears conspicuously brighter than the left one. After applying Retinex, this disk indeed becomes brighter.</figDesc><graphic coords="6,304.32,66.68,247.35,59.50" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig. 7 . 14 ) 2 :</head><label>7142</label><figDesc>Fig. 7. Left: Original image. Center left: Retinex with t = 0. Center right: Retinex with t = 10. Right: Retinex with t = 15. Observe how colors are slightly enhanced and the background clutter progressively eliminated when the threshold t grows.</figDesc><graphic coords="7,53.58,67.80,483.00,84.00" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Fig. 8 .</head><label>8</label><figDesc>Fig.8. Top Left: Original image. Top Right: Retinex result applied to the raw image with t = 0. Bottom Left: Retinex result with t = 0:05. Bottom Right: Retinex result applied to the gamma corrected image with t = 2. Notice how similar are the results. Both maintain an image that is close to the original, but the</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Fig. 10 .</head><label>10</label><figDesc>Fig. 10. Left: Original image. Center: The result of Retinex with threshold t = 3. Right: The result of Extrema Retinex with t = 3. They are not identical, but extremely similar.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Fig. 11 .</head><label>11</label><figDesc>Fig. 11. Left: Original image, Left Center: Result of McCann99 with four iterations, Right Center: Result of Frankle-McCann with four iterations, Right: Result of PDE Retinex.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Fig. 12 .</head><label>12</label><figDesc>Fig. 12. Top Left: Original image, Top Right: Result of McCann99 with four iterations, Bottom Left: Result of Frankle-McCann with four iterations, Bottom Right: Result of PDE Retinex.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head></head><label></label><figDesc>colour/publications/IST-2000/ gives the results of McCann99 and Frankle-McCann Retinex [22] over two images. Figs. 11 and 12 show a comparison between these results and the PDE Retinex result. The first image is a synthetic image, where the PDE Retinex implementation does not produce any change, and McCann99 and Frankle-McCann lighten the black square. Fig. 12 is a bluish image. The three implementations successfully remove the blue tone in the image. Probably because of its lack of locality (see the section on locality), the PDE Retinex result is darker. Yet the locality in McCann99 and Frankle-Mc-Cann results lead to the creation of local halos, such as those around the letters in the blue book. This artefact is typical of center-surround methods and, in general, of methods where the paths are made more local.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><head></head><label></label><figDesc></figDesc><graphic coords="8,94.02,93.42,405.00,147.00" type="bitmap" /></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>ACKNOWLEDGMENT</head><p>The authors would like to thank L. Ambrosio for several valuable conversations.</p></div>
			</div>


			<div type="funding">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The work of A. B. Petro and C. Sbert was supported by Project TIN2008-04752 of the Ministerio de Educación y Cultura. This work was supported in part by the Centre National d'Etudes Spatiales (MISS project) and by the Office of Naval Research under Grant N00014-97-1-0839.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Jean-Michel</head></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Lightness and retinex theory</title>
		<author>
			<persName><forename type="first">E</forename><surname>Land</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Opt. Soc. Amer</title>
		<imprint>
			<biblScope unit="volume">61</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="11" />
			<date type="published" when="1971-01">Jan. 1971</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">On the behavior of spatial models of color</title>
		<author>
			<persName><forename type="first">A</forename><surname>Rizzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Symp. Electron. Imag</title>
		<meeting>Symp. Electron. Imag</meeting>
		<imprint>
			<date type="published" when="2007">2007</date>
			<biblScope unit="volume">649302</biblScope>
			<biblScope unit="page" from="24" to="35" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">M</forename><surname>Ebner</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2007">2007</date>
			<publisher>Wiley</publisher>
			<pubPlace>Hoboken, NJ</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">A perceptually inspired variational framework for color enhancement</title>
		<author>
			<persName><forename type="first">R</forename><surname>Palma-Amestoy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Provenzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Bertalmio</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Caselles</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Pattern Anal. Mach. Intell</title>
		<imprint>
			<biblScope unit="volume">31</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="458" to="474" />
			<date type="published" when="2009-03">Mar. 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">The retinex theory of color vision</title>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">H</forename><surname>Land</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Sci. Amer</title>
		<imprint>
			<biblScope unit="volume">237</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="108" to="128" />
			<date type="published" when="1977-12">Dec. 1977</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">The retinex</title>
		<author>
			<persName><forename type="first">E</forename><surname>Land</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Amer. Sci</title>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="247" to="264" />
			<date type="published" when="1964-06">Jun. 1964</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Capturing a black cat in shade: Past and present of retinex color appearance models</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Electron. Imag</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page">36</biblScope>
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Recent advances in retinex theory</title>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">H</forename><surname>Land</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Vis. Res</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="7" to="21" />
			<date type="published" when="1986">1986</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Analysis of the retinex theory of color vision</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">H</forename><surname>Brainard</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">A</forename><surname>Wandell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Opt. Soc. Amer. A</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page">1651</biblScope>
			<date type="published" when="1986-10">Oct. 1986</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Retinex at 40: A joint special session</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Electron. Imag</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page">6</biblScope>
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">An investigation of retinex algorithms for image enhancement</title>
		<author>
			<persName><forename type="first">L</forename><surname>Lei</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Zhou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Electron</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="696" to="700" />
			<date type="published" when="2007-09">Sep. 2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Mathematical definition and analysis of the retinex algorithm</title>
		<author>
			<persName><forename type="first">E</forename><surname>Provenzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">D</forename><surname>Carli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Rizzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Marini</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Opt. Soc. Amer. A</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="2613" to="2621" />
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Random spray retinex: A new retinex implementation to investigate the local properties of the model</title>
		<author>
			<persName><forename type="first">E</forename><surname>Provenzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Fierro</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Rizzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">De</forename><surname>Carli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Gadia</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Marini</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="162" to="171" />
			<date type="published" when="2007-01">Jan. 2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Formal connections between lightness algorithms</title>
		<author>
			<persName><forename type="first">A</forename><surname>Hurlbert</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Opt. Soc. Amer. A</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">10</biblScope>
			<biblScope unit="page">1684</biblScope>
			<date type="published" when="1986-10">Oct. 1986</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Poisson image editing</title>
		<author>
			<persName><forename type="first">P</forename><surname>Perez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Gangnet</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Blake</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">ACM Trans. Graph</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="313" to="318" />
			<date type="published" when="2007-07">Jul. 2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Recent advances in retinex theory and some implications for cortical computations: Color vision and the natural image</title>
		<author>
			<persName><forename type="first">E</forename><surname>Land</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Nat. Acad. Sci</title>
		<imprint>
			<biblScope unit="volume">80</biblScope>
			<biblScope unit="page" from="5163" to="5169" />
			<date type="published" when="1983">1983</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">A variational framework for retinex</title>
		<author>
			<persName><forename type="first">R</forename><surname>Kimmel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Elad</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Shaked</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Keshet</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><surname>Sobel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Int. J. Comput. Vis</title>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="7" to="23" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Determining lightness from an image</title>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">K P</forename><surname>Horn</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Comput. Graph. Image Process</title>
		<imprint>
			<biblScope unit="page" from="277" to="299" />
			<date type="published" when="1974">1974</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">A computational approach to color adaptation effects</title>
		<author>
			<persName><forename type="first">D</forename><surname>Marini</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Image Vis. Comput</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="issue">13</biblScope>
			<biblScope unit="page" from="1005" to="1014" />
			<date type="published" when="2000-10">Oct. 2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Method and Apparatus for Lightness Imaging</title>
		<author>
			<persName><forename type="first">J</forename><surname>Frankle</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">U.S. Patent</title>
		<imprint>
			<biblScope unit="volume">4384336</biblScope>
			<date type="published" when="1983-05-17">May 17, 1983</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Lesson learned from mondrians applied to real images and color gamuts</title>
		<author>
			<persName><forename type="first">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IST/SID 7th Color Imag. Conf</title>
		<meeting>IST/SID 7th Color Imag. Conf</meeting>
		<imprint>
			<date type="published" when="1999">1999</date>
			<biblScope unit="page" from="1" to="8" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Retinex in matlab</title>
		<author>
			<persName><forename type="first">B</forename><surname>Funt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Ciurea</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Electron. Imag</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="48" to="57" />
			<date type="published" when="2004-01">Jan. 2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Tuning retinex parameters</title>
		<author>
			<persName><forename type="first">F</forename><surname>Ciurea</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Funt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Electron. Imag</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="58" to="64" />
			<date type="published" when="2004-01">Jan. 2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">An alternative technique for the computation of the designator in the retinex theory of color vision</title>
		<author>
			<persName><forename type="first">E</forename><surname>Land</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Nat. Acad. Sci. USA</title>
		<imprint>
			<biblScope unit="volume">83</biblScope>
			<biblScope unit="page" from="3078" to="3080" />
			<date type="published" when="1986">1986</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Properties and performance of a center/surround retinex</title>
		<author>
			<persName><forename type="first">D</forename><surname>Jobson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Rahman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Woodell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="451" to="462" />
			<date type="published" when="1997-03">Mar. 1997</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Retinex processing for automatic image enhancement</title>
		<author>
			<persName><forename type="first">Z</forename><surname>Rahman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">J</forename><surname>Jobson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">A</forename><surname>Woodell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Electron. Imag</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="100" to="110" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Issues about retinex theory and contrast enhancement</title>
		<author>
			<persName><forename type="first">M</forename><surname>Bertalmo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Caselles</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Provenzi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Int. J. Comput. Vis</title>
		<imprint>
			<biblScope unit="volume">83</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="101" to="119" />
			<date type="published" when="2009-06">Jun. 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">Perceptual color correction through variational techniques</title>
		<author>
			<persName><forename type="first">M</forename><surname>Bertalmio</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Caselles</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Rizzi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1058" to="1072" />
			<date type="published" when="2007-04">Apr. 2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Implementing the retinex algorithm with wilson-cowan equations</title>
		<author>
			<persName><forename type="first">M</forename><surname>Bertalmio</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Cowan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Physiol</title>
		<imprint>
			<biblScope unit="volume">103</biblScope>
			<biblScope unit="page" from="69" to="72" />
			<date type="published" when="2009-05">May 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Boundary conditions for lightness computation in mondrian world</title>
		<author>
			<persName><forename type="first">A</forename><surname>Blake</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Comput. Vis. Graph. Image Process</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="page" from="314" to="327" />
			<date type="published" when="1985">1985</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Recovering shading from color images</title>
		<author>
			<persName><forename type="first">B</forename><surname>Funt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Drew</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Brockington</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. 2nd Eur. Conf. Comput. Vis</title>
		<meeting>2nd Eur. Conf. Comput. Vis</meeting>
		<imprint>
			<date type="published" when="1992">1992</date>
			<biblScope unit="page" from="124" to="132" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Image analysis using multigrid relaxation methods</title>
		<author>
			<persName><forename type="first">D</forename><surname>Terzepoulos</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Pattern Anal. Mach. Intell</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="129" to="139" />
			<date type="published" when="1986-03">Mar. 1986</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Variational retinex algorithm with its application to a high-quality chroma key</title>
		<author>
			<persName><forename type="first">H</forename><surname>Takahashi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Saito</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Komatsu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE Int. Conf. Image Process</title>
		<meeting>IEEE Int. Conf. Image ess</meeting>
		<imprint>
			<date type="published" when="2006-10">Oct. 2006</date>
			<biblScope unit="page" from="977" to="980" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<monogr>
		<title level="m" type="main">Probability and Random Processes</title>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">R</forename><surname>Grimmett</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">R</forename><surname>Stirzaker</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2001">2001</date>
			<publisher>Oxford</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Reflectance illumination and edges in 3-d mondrian colour-constancy experiments</title>
		<author>
			<persName><forename type="first">J</forename><surname>Mccann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Parraman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Rizzi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. 11th Congr</title>
		<meeting>11th Congr</meeting>
		<imprint>
			<date type="published" when="2009-10">Sep.-Oct. 2009</date>
			<biblScope unit="page" from="2" to="7" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">Measuring hdr rendering for colour appearance: An experiment</title>
		<author>
			<persName><forename type="first">C</forename><surname>Parraman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Rizzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Mccann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Electron. Imag</title>
		<meeting>Electron. Imag</meeting>
		<imprint>
			<date type="published" when="2009-01">Jan. 2009</date>
			<biblScope unit="page" from="7241" to="7267" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">High dynamic range image rendering using a retinex-based adaptive filter</title>
		<author>
			<persName><forename type="first">L</forename><surname>Meylan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Ssstrunk</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="2820" to="2830" />
			<date type="published" when="2006-09">Sep. 2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">Shape preserving local histogram modification</title>
		<author>
			<persName><forename type="first">V</forename><surname>Caselles</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J.-L</forename><surname>Lisani</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J.-M</forename><surname>Morel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Sapiro</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Image Process</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="220" to="230" />
			<date type="published" when="1999-02">Feb. 1999</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
