<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Data reduction for spectral clustering to analyze high throughput flow cytometry data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2010-07-28">28 July 2010</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Habil</forename><surname>Zare</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Terry Fox Laboratory</orgName>
								<orgName type="institution">BC Cancer Agency</orgName>
								<address>
									<addrLine>675 W 10th Ave</addrLine>
									<settlement>Vancouver</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Parisa</forename><surname>Shooshtari</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Terry Fox Laboratory</orgName>
								<orgName type="institution">BC Cancer Agency</orgName>
								<address>
									<addrLine>675 W 10th Ave</addrLine>
									<settlement>Vancouver</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Arvind</forename><surname>Gupta</surname></persName>
							<affiliation key="aff0">
								<orgName type="laboratory">Terry Fox Laboratory</orgName>
								<orgName type="institution">BC Cancer Agency</orgName>
								<address>
									<addrLine>675 W 10th Ave</addrLine>
									<settlement>Vancouver</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName><forename type="first">Ryan</forename><forename type="middle">R</forename><surname>Brinkman</surname></persName>
							<email>rbrinkman@bccrc.ca</email>
							<affiliation key="aff0">
								<orgName type="laboratory">Terry Fox Laboratory</orgName>
								<orgName type="institution">BC Cancer Agency</orgName>
								<address>
									<addrLine>675 W 10th Ave</addrLine>
									<settlement>Vancouver</settlement>
									<region>BC</region>
									<country key="CA">Canada</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Data reduction for spectral clustering to analyze high throughput flow cytometry data</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2010-07-28">28 July 2010</date>
						</imprint>
					</monogr>
					<idno type="MD5">2048D8DCCB96E9D18371CE5E04B2B1D8</idno>
					<idno type="DOI">10.1186/1471-2105-11-403</idno>
					<note type="submission">Received: 21 December 2009 Accepted: 28 July 2010</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.3" ident="GROBID" when="2023-07-28T11:48+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Background: Recent biological discoveries have shown that clustering large datasets is essential for better understanding biology in many areas. Spectral clustering in particular has proven to be a powerful tool amenable for many applications. However, it cannot be directly applied to large datasets due to time and memory limitations. To address this issue, we have modified spectral clustering by adding an information preserving sampling procedure and applying a post-processing stage. We call this entire algorithm SamSPECTRAL. Results: We tested our algorithm on flow cytometry data as an example of large, multidimensional data containing potentially hundreds of thousands of data points (i.e., "events" in flow cytometry, typically corresponding to cells). Compared to two state of the art model-based flow cytometry clustering methods, SamSPECTRAL demonstrates significant advantages in proper identification of populations with non-elliptical shapes, low density populations close to dense ones, minor subpopulations of a major population and rare populations.</p><p>Conclusions: This work is the first successful attempt to apply spectral methodology on flow cytometry data. An implementation of our algorithm as an R package is freely available through BioConductor.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Background</head><p>High throughput data analysis is a crucial step in research endeavours involving gene expression, protein classification, and flow cytometry. A classical approach for analysing biological data is to first group individual data points based on some similarity criterion, a process known as clustering, and then compare the outcome of clustering with the biological hypotheses. An example of this approach is in the analysis of flow cytometry data where populations of cells that express specific intracellular or surface proteins are identified. Flow cytometry is a technique for measuring physical, chemical and biological characteristics of individual microscopic particles such as cells and chromosomes. It has many applications in molecular and cell biology for both clinical diagnosis and research purposes <ref type="bibr" target="#b0">[1]</ref>. In cytometers, cells are individually passed through a laser beam and the scattered light is captured to measure up to 19 characteristic of each cell <ref type="bibr" target="#b1">[2]</ref>. As thousands of cells can be analyzed per second, cytometers can generate large-sized datasets. Recently, sophisticated methods have been developed for automatic analysis of flow cytometry data <ref type="bibr" target="#b2">[3]</ref><ref type="bibr" target="#b3">[4]</ref><ref type="bibr" target="#b4">[5]</ref>. The proposed clustering techniques include: mixture modeling approach <ref type="bibr" target="#b5">[6]</ref>, model-based cluster analysis <ref type="bibr" target="#b6">[7]</ref>, feature-guided clustering <ref type="bibr" target="#b7">[8]</ref>, density-based clustering <ref type="bibr" target="#b8">[9]</ref>, combining the curvature information with density information <ref type="bibr" target="#b9">[10]</ref>, and image processing <ref type="bibr" target="#b10">[11]</ref>. The automatic techniques are useful in clinical and research applications such as: application of highcontent flow cytometric screening (FC-HCS) to the problem of cellular signature definition for acute graftversus-host-disease <ref type="bibr" target="#b11">[12]</ref>, vaccine trials <ref type="bibr" target="#b12">[13]</ref>, visualizing data in stem cell research <ref type="bibr" target="#b13">[14]</ref>, and immunophenotypic characterization of B-cell chronic lymphoproliferative disorders (B-CLPD) <ref type="bibr" target="#b14">[15]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Problem Statement</head><p>Automated identification of flow cytometry cell populations is complicated by overlapping and adjacent populations, especially when low and high density populations are close to each other. Analysing such data requires clustering methods that can separate these populations. Non-parametric methods include density clustering <ref type="bibr" target="#b15">[16]</ref>, real-time adaptive clustering <ref type="bibr" target="#b16">[17]</ref>, and Kohonen self-organizing maps <ref type="bibr" target="#b17">[18]</ref>. The application of these methods is restricted since the first two are subjective due to a dependency on user-defined thresholds, and the latter one requires the number of clusters to be determined by the user. While accurately determining the number of clusters may not be a key issue in some clinical cytometry analysis <ref type="bibr" target="#b18">[19]</ref>, this requirement can be a critical obstacle for other analyses such as identifying novel populations for biomarker discovery <ref type="bibr" target="#b2">[3]</ref>.</p><p>Model-based clustering techniques such as FLAME <ref type="bibr" target="#b19">[20]</ref>, flowClust <ref type="bibr" target="#b20">[21]</ref> and flowMerge <ref type="bibr" target="#b21">[22]</ref> have been developed to improve results. flowMerge uses the flowClust framework to identify clusters based on a t-mixture model methodology, followed by a merging step to account for overestimation of the number of clusters by the Bayesian information criterion. FLAME uses a skew t-mixture model, which is in theory more robust to skew, because unlike t-distributions, skew t-distributions can be asymmetric <ref type="bibr" target="#b19">[20]</ref>. However, the running time of this algorithm increases with the fourth degree of the number of dimensions. In practice this tends to make the algorithm impractical for more than five dimensions, while flow cytometry data can have up to 19 dimensions. Overall, the major drawback of these parametric methods is the requirement for assumptions on either the size of the clusters or the cluster distributions and shapes <ref type="bibr" target="#b22">[23]</ref>, which could result in incorrect identification of biologically interesting populations. In addition, one challenge for existing approaches is the identification of rare populations. Spectral clustering is a nonparametric clustering method that avoids the problems of estimating probability distribution functions by using a heuristic based on graphs <ref type="bibr" target="#b23">[24]</ref>. It has proved useful in many pattern recognition areas <ref type="bibr" target="#b24">[25]</ref><ref type="bibr" target="#b25">[26]</ref><ref type="bibr" target="#b26">[27]</ref><ref type="bibr" target="#b27">[28]</ref>. Not only does it not require a priori assumptions on the size, shape or distribution of clusters, but it has features that make it particularly well-suited to clustering biological data:</p><p>• It is not sensitive to outliers, noise or shape of clusters;</p><p>• It is adjustable so that biological knowledge can be utilized to adapt it for a specific problem or dataset; • There is mathematical evidence to guarantee its proper performance <ref type="bibr" target="#b28">[29]</ref>.</p><p>Two main challenges in applying spectral clustering algorithm on large data sets are the computationally expensive steps of constructing the normalized matrix and computing its eigenspace. For instance, for high throughput biological data containing one million data points (i.e., vertices), it requires computing eigenspace of a million by million matrix, which is infeasible in terms of memory and time. Although there are some approximation methods for speeding up this computation <ref type="bibr" target="#b29">[30,</ref><ref type="bibr" target="#b30">31]</ref>, these could produce undesired errors in the final results. The problem of applying this algorithm on large datasets has been studied in <ref type="bibr" target="#b31">[32]</ref> using Nyström's method. They suggest a strategy of sampling data uniformly, clustering the sampled points and extrapolating this solution to the full set of points. However, sampling data uniformly can miss low-density populations entirely when the density of adjacent populations varies considerably, a situation that often arises for biologically interesting populations in flow cytometry data. Appendix 3 includes an experiment to explain the effect of uniform sampling in such cases.</p><p>Data reduction schemes have been developed to reduce the complexity of the flow cytometry data while preserving the information <ref type="bibr" target="#b32">[33,</ref><ref type="bibr" target="#b33">34]</ref>. These methods reduce the dimensionality but not the size of the dataset, the latter being the more important bottleneck for spectral clustering.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Our Approach</head><p>We hypothesized that spectral clustering could significantly improve high throughput biological data analysis. However, serious empirical barriers are encountered when applying this method to large data sets. Specifically, for n data points, the running time is O(n 3 ), requiring O(n 2 ) units of memory. For instance, it would take 2 years and 5 terabytes of memory to analyze a typical flow cytometry sample with 300,000 events. We developed a novel solution for this problem through our non-uniform information preserving sampling. Our heuristic approach is specific to cytometry applications and made it possible for the first time, to apply spectral clustering method on flow cytometry data.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Results</head><p>In this paper, we distinguish between the terms biological populations, clusters and components as follows. A population is a set of cells with similar functionality or molecular content. By a cluster, we mean a set of data points that are grouped together by spectral clustering algorithm. We incorporate a post-processing stage on spectral clusters to find the connected components intended to estimate the biological populations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Algorithm</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Spectral Clustering</head><p>The first step is to build a graph. The vertices represent the n data points (e.g., cells in flow cytometry data), and the edges between the vertices are weighted based on some similarity criterion. The adjacency matrix of the graph is then normalized using the following formula:</p><formula xml:id="formula_0"> A D AD = - - 1 2 1 2 , (<label>1</label></formula><formula xml:id="formula_1">)</formula><p>where A is the adjacency matrix of the graph and D is a diagonal matrix where the (i, i) entry is equal to the sum of the weights on the edges that are adjacent to vertex i.</p><p>The next step is to compute eigenspace of the normalized matrix. That is, all vectors V i and values l i satisfying the following equation are computed:</p><formula xml:id="formula_2">   AV V i i =  .<label>(2)</label></formula><p>In order to find k clusters, an n by k matrix is built using the k eigenvectors with highest eigenvalues. The rows of this matrix are normalized and finally k-means is used to cluster the rows.</p><p>However, the above method cannot be directly applied to flow cytometry data due to large number of data points (cells) per sample. Our solution for this problem is a data reduction scheme developed specifically for this purpose. This reduces the number of vertices significantly, but in a way such that biological information can be preserved by updating the weights on the edges.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Data Reduction Scheme</head><p>While data size can be reduced by known sampling methods <ref type="bibr" target="#b34">[35]</ref>, a very delicate method should be used to preserve biologically important information. From a highlevel perspective, our data reduction scheme (Figure <ref type="figure" target="#fig_0">1</ref>) consists of two major steps; first we sample the data in a representative manner to reduce the number of vertices of the graph (Figure <ref type="figure" target="#fig_0">1b</ref>). Sample points cover the whole data space uniformly (Figures 2b), a property that aids in the identification of both low density and rare populations. In the second step as described below, we define a similarity matrix that assigns weights to the edges between the sampled data points. Higher weights are assigned to the edges between nodes in dense regions so that information about the density is preserved (Figure <ref type="figure" target="#fig_0">1c</ref>).</p><p>Faithful Sampling Algorithm After faithful sampling is completed, the set of all representatives can be regarded as a sample from the data. Reducing the value of parameter h will increase the number of sample points, resulting in increased computation time and required memory. Conversely, increasing h will result in fewer sample points that may lead to too low a resolution. In such a case, the computed spectral clusters may fail to estimate the real cell populations appropriately. In our implementation, we use an iterative procedure (explained in the overview of our algorithm) to adjust h automatically such that the number of representatives will be in range 1500-3000. As a result of this adjustment, the following two objectives are achieved. First, computing the eigenspace of a graph with a number of points in this range is feasible, (it takes less than one minute by a 2.7 GHz processor.) Second, the communities are "small" (Figure <ref type="figure" target="#fig_1">2</ref>) and the resulting resolution is high enough such that no biologically interesting information is lost.</p><p>In the sampling stage, there is no preference in picking up the next data point, therefore, the final distribution of the sampled points will be uniform in the "effective" space. That is, the representatives are distributed almost uniformly in the space where data points were present (Figure <ref type="figure" target="#fig_1">2</ref>). As a consequence, by repeating sampling procedure the final results of clustering will not change significantly. This observation is confirmed quantitatively in Appendix 1. By considering just the representatives, density information is effectively ignored so working directly with these representatives results in improper outcome. On the other hand, some biological information from the original data is preserved by the above algorithm that can be retrieved to guide the clustering algorithm. More precisely, for each sample point, we know the list of all points in its neighbourhood (i.e., the members of the corresponding community). In the next stage, we use this information to define the similarity between two sample points to modify the behaviour of spectral clustering. In this sense, our sampling scheme is faithful, meaning that the valuable biological information from the original data points is preserved even after sampling. We call the overall procedure, which consists of faithful sampling, computing modified similarity matrix and spectral clustering, SamSPECTRAL clustering.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Similarity Matrix</head><p>In this study, we use the following heat kernel formula <ref type="bibr" target="#b35">[36]</ref> to compute the similarity between two vertices i and j:</p><formula xml:id="formula_3">s e p i p j i j , ( ) , , = -  2 2 2  (<label>3</label></formula><formula xml:id="formula_4">)</formula><p>where  (p i , p j ) is the Euclidean distance between them. s is a scaling parameter that controls how rapidly similarity between p i and p j falls off with increasing distance. We define the similarity between two communities c and c' as the sum of all pairwise similarities between all members of the first community and all members of the second community. That is,</p><formula xml:id="formula_5">S s c c i j j c i c , , , ′ ∈ ′ ∈ = ∑ ∑ (4)</formula><p>where i and j are members of c and c' respectively. We do not normalize the similarity by dividing the above sum by the size of communities because we would lose valuable biological information that is supposed to be preserved. In short, the size of the communities determines the local density of the data points, which is biologically of great importance.</p><p>The above definition is motivated by the following intuition from potential theory that explains how biological information is preserved after faithful sampling by assigning similarities in this way. The eigenvectors of a graph are interpreted as potential functions on the electric network modeled by the graph <ref type="bibr" target="#b36">[37]</ref>. Assuming the radius of each community is small enough, the potential values of the community members are almost the same. On the other hand, in potential theory, the equivalent conductance between a group of nodes {v i } with equal potential values and another group of nodes {w j } that also have equal potential values is computed by the summation of pairwise conductance between nodes v i and w j for all i and j. Since in our model, the similarity between two vertices is equivalent to the conductance between the corresponding electrical nodes, it is reasonable to sum up pairwise similarities to estimate the equivalent similarity between communities (Figure <ref type="figure" target="#fig_4">3a</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Number of Clusters</head><p>The number of clusters must be determined before running the spectral clustering algorithm <ref type="bibr" target="#b37">[38]</ref>. To find this number automatically and in an efficient manner, we propose a method that is motivated by the following observation from spectral graph theory:</p><p>Theorem <ref type="bibr" target="#b38">[39]</ref>: The number of connected partitions of a graph is equal to the number of eigenvectors with eigenvalue 1.</p><p>We observed that typically for flow cytometry data, if s is adjusted properly as explained in the SamSPECTRAL package vignette <ref type="bibr" target="#b39">[40]</ref>, the first few eigenvalues are close to one and at a point we call knee point they start to decrease almost linearly. We compute the knee point by applying linear regression to the eigenvalues curve (Figure <ref type="figure" target="#fig_4">3b</ref>) and use the horizontal coordinate of this point as a rough estimate for the number of spectral clusters.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Combining Clusters</head><p>Applying spectral clustering on sampled data results in graph partitioning, which is almost optimum in the sense of having minimum normalized cut <ref type="bibr" target="#b40">[41,</ref><ref type="bibr" target="#b41">42]</ref>. However, in some cases, a biologically interesting population might be split into two or more smaller clusters by SamSPECTRAL. We addressed this issue by adding a post-processing stage wherein the partitions of a population are combined based on known properties of flow cytometry cell populations. Typically, biologically meaningful cell populations in flow cytometry data have their highest density at the centre, and their density decreases towards the border of the population. Since higher density regions indicate communities with relatively more members, the conductance between them is expected to be relatively higher (Equation <ref type="formula">4</ref>). Thus, similarity between communities is higher in regions with higher densities and the highest similarity is expected to be at the centre of the biological population. This observation forms the basis for our criterion for combining clusters. Specifically, similarity between communities determines the weight on graph edges and we define the maximum weight of the edges of a spectral cluster as within similarity of that cluster. Also, the maximum weight of the edges between two different spectral clusters is defined as between similarity. If the ratio of between similarity to within similarity is greater than a predefined threshold (separation factor), we conclude that these clusters are partitions of a single population, and should combine them to form a component. We repeat this stage until no two components can be combined. The final components computed in this way are called connected components of the data, and estimate the real biological populations. With smaller separation factors, spectral clusters tend to combine more often.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Overview of SamSPECTRAL Algorithm</head><p>In summary, the stages of our algorithm are as follows, assuming the data contains n points in a d dimensional space of volume V, and the parameters m (max number of communities), s (scaling parameter), and separation factor are set properly. • Run faithful (biological information preserving) sampling algorithm. Suppose m′ communities are built.</p><formula xml:id="formula_6">• Update: h h m m d = ( ) ′ .</formula><p>Until m m m 2 ≤ ′ ≤ . 2. Compute the similarities between communities by adding pairwise similarities s i , j defined by 3: </p><formula xml:id="formula_7">S s c c i j j c i c , , . ′ ∈ ′ ∈ = ∑ ∑ (5)</formula><formula xml:id="formula_8">C i C j t ty( , ) C i C j (6)</formula><p>• For each component C i , compute:</p><formula xml:id="formula_9">M i C C j i i j ( ) : max( _ ( , )) = ≠ separation ratio</formula><p>• If for all i, M(i) ≤ separation_factor, break.</p><p>• Pick an i such that M(i) &gt; separation_factor and let:</p><formula xml:id="formula_10">j C C j i i j = ≠ arg separation ratio max( _ ( , ))</formula><p>• Combine C i and C j , then update list of components. Until number of components &gt; 1.</p><p>In the sampling stage, we start with the initial value h</p><formula xml:id="formula_11">V m d = 1 2</formula><p>for the neighbourhood. m is a parameter that controls m′, the final number of sample points such that m m m 2 ≤ ′ ≤ . Since in our implementation, we use Manhattan metric to measure the distance between points, the volume of a community can be estimated by ( ) 2h d V m = . Therefore if the the data points were distributed uniformly in the space, we would get m sample points in the first run. However, in practice, we need to repeat the procedure after updating the neighbourhood value. According to our experiments, a few iterations are enough to fulfil the terminating condition m m m 2 ≤ ′ ≤ . As the running time of this part of Sam-SPECTRAL is O(nm), which is negligible compared to eigenspace computation time, we did not attempt to optimize the sampling loop.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Modified Markov Clustering Algorithm (MCL)</head><p>Step 4 in the above algorithm is the classic spectral clustering method. This step potentially could be substituted by any clustering algorithm for weighted graphs. To verify that our approach is extensible in this sense, we substituted classic spectral clustering with Markov Clustering (MCL) <ref type="bibr" target="#b42">[43]</ref> keeping the rest of our algorithm, sampling and post-processing steps, unchanged.</p><p>MCL finds the partitions of a graph by simulating flow on the nodes. Simulation is done by iteratively multiplying two type of matrices that correspond to expansion and inflation operations <ref type="bibr" target="#b42">[43]</ref>. Because flow and eigenspace of a graph are strongly related 1 , the outcome of this approach tends to be similar to spectral clustering through computing eigenspace.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Testing</head><p>We implemented our algorithm with R, and applied it on four different datasets. We were able to identify some types of biologically interesting populations that were previously known to be hard to distinguish, including:</p><p>1. Overlapping populations (Figure <ref type="figure" target="#fig_5">4a-c</ref>). 2. Subpopulations of a major population (Figure <ref type="figure" target="#fig_5">4d-f</ref>). 3. Non-elliptical shaped populations (Figures 5 and Figure <ref type="figure" target="#fig_7">6a-c</ref>). 4. Low density populations close to dense ones (Figures 6d-f and Figure <ref type="figure" target="#fig_8">7</ref>). 5. Rare populations comprising less than 2% of all data points (Figure <ref type="figure" target="#fig_9">8</ref>). Here, we demonstrate the capabilities of SamSPEC-TRAL in identifying biological populations in these cases and compare our results with two state of the art methods for clustering flow cytometry data, flowMerge (version 0.4.1) and FLAME (version 3), respectively obtained through BioConductor and GenePattern.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Overlapping Populations</head><p>Traditionally, identifying cell populations in flow cytometry data is accomplished by visualizing the multidimensional data as a series of bivariate plots, and separating interesting sections manually, in a process termed gating. Gating becomes challenging for high dimensional data since when the data is mapped to two dimensions, some clusters may overlap, resulting in the mixing of different populations. Consequently, even a trained operator cannot identify overlapping populations properly in all cases. However, our algorithm prevents this undesired error by considering all data dimensions together (Figure <ref type="figure" target="#fig_5">4a-c</ref>). Model based multidimensional techniques also perform generally well in this regard.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Subpopulations of a Population</head><p>Figure <ref type="figure" target="#fig_5">4d</ref>-f shows a major blood population (granulocytes) formed from two distinct subpopulations as verified by expert manual analysis. SamSPECTRAL could clearly distinguish between two subpopulations. flow-Merge merged these two populations into one, while FLAME split both subpopulations.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Non-elliptical Shaped Populations</head><p>While most model based techniques have a priori assumptions on the shape of populations that resulted in mixing or splitting populations, our method worked relatively well on the samples with arbitrary shape populations. In Figure <ref type="figure" target="#fig_6">5</ref>, the PI positive population (blue diagonal one) was clearly identified despite its non-elliptical shape. flowMerge could also distinguish this population, but it incorrectly split the PI negative population into two parts. FLAME did not correctly distinguish the two populations. Figure <ref type="figure" target="#fig_7">6a-c</ref> shows the output of the three algorithms on a four dimensional sample from GvHD dataset. While the red population has a complex shape, it could be identified with high accuracy by SamSPECTRAL. While FLAME produced a satisfactory result, flowMerge mixed this population with the one below it.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Low Density Populations Close to Dense Populations</head><p>Figure <ref type="figure" target="#fig_7">6d</ref>-f shows a sample from GvHD dataset containing a relatively low density and a high density population close together. SamSPECTRAL clearly distinguished the red population in the centre of the plot from the yellow dense population to its left. Moreover, it did not mix the red population with the other low density population to its right. FlowMerge also clustered this sample relatively well, requiring five times more processing time. The performance of FLAME was not satisfactory for this sample due to mixing the desired population with the other low density ones.</p><p>Figure <ref type="figure" target="#fig_8">7</ref> depicts a sample from the stem cell dataset containing a relatively low density population shown in blue. In each row, three 2-dimensional plots of the 3dimensional data sample are presented. SamSPECTRAL could distinguish the blue population although it was surrounded by three relatively denser populations (the yellow, green and red ones). FlowMerge mixed this population with the yellow one, while FLAME mixed it with the red one.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Rare Populations</head><p>Identifying rare populations has many significant applications in flow cytometry experiments including distinguishing cancer stem cells, hematopoietic stem cell transplantation, detection of fetal cells in maternal   blood, detection of leukocytes in leukocyte-depleted platelet products, detection of injected cells for biotherapy and malaria diagnosis <ref type="bibr" target="#b43">[44]</ref>.</p><p>Figure <ref type="figure" target="#fig_9">8</ref> shows a typical sample from the stem cell data set that contains a rare population in red. This population is positive for all the three markers and in each sample, it comprises between 0.1% to 2% of total cells. We performed an experiment on 34 samples from the stem cell data set and compared the performance of Sam-SPECTRAL, flowMerge and FLAME. This rare population was distinguished manually and the result of manual gating was considered as the basis for our comparison. FLAME and flowMerge could identify this population only in 11 (32%) and 9 (26%) of samples, respectively. SamSPECTRAL could distinguish this population in 27 (79%) samples including all the ones that were identified by FLAME and flowMerge. In the 7 (21%) samples that SamSPECTRAL failed, the rare population of interest contained less than 0.15% of all data points.</p><p>To measure the accuracy of SamSPECTRAL, we define sensitivity and specificity as follows. For each sample, we call a cell positive if it belongs to the rare population of interest, and it is negative otherwise. Sensitivity is defined to be the number of truly identified rare cells divided by the total number of rare cells. Accordingly, specificity is the number of cells identified as negative divided by the total number of truly negative cell. The 27 (79%) cases where SamSPECTRAL correctly identified the rare population, had a 0.83 mean sensitivity with a 0.26 standard deviation. The median sensitivity was .99. Specificity was 1 except for one sample. If we consider the samples with a rare population bigger than 0.2% of the total data, we obtained median = 1, mean = 0.93 and standard deviation of 0.15 for sensitivity. A detailed report of the results of this experiment is provided as a table in additional file 1.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>SamSPECTRAL with MCL</head><p>Figure <ref type="figure" target="#fig_8">7j</ref>-l depicts the output of MCL on a sample from stem cells dataset. We ran MCL on the sampled data obtained by our faithful sampling algorithm and then the post-processing step was applied to the resulting clusters. This experiment showed there was no significant difference for SamSPECTRAL in clustering either through computing eigenvectors (Figure <ref type="figure" target="#fig_8">7a-c</ref>) or by MCL (Figure <ref type="figure" target="#fig_8">7j</ref>-l) 2 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Discussion</head><p>Although spectral clustering algorithm is a powerful technique, it can not be directly applied to large datasets as it is computationally expensive both in time and memory. In this study, we developed a sampling method and combined it with spectral clustering by modifying the similarity matrix based on potential theory. As a result, for the first time, analysing flow cytometry data using spectral methods becomes possible and practical. We applied SamSPECTRAL to four different flow cytometry datasets to demonstrate its applicability on a broad spectrum of flow cytometry data, and compared its performance to two state of the art model-based clustering methods optimized for flow cytometry data.</p><p>Detecting rare populations is a challenging problem and in spite of its significant applications in medical and biological research, little progress has been achieved in automatic identification of such populations. Our data reduction scheme is delicate enough not to miss rare populations comprising between 0.2% to 2% of the total data. SamSPECTRAL can identify populations of relative size in this range with acceptable accuracy.</p><p>Since our method, SamSPECTRAL, is a multidimensional clustering approach, it can identify overlapping populations that are generally hard to identify by manual gating that uses sequential two dimensional visualizations of the data. SamSPECTRAL is the first method that has demonstrated the ability to correctly identify subpopulations of major flow cytometry cell populations.</p><p>An important challenge in analysing flow cytometry data is in clustering data files that contain populations that significantly differ in density. Model-based techniques can produce errors in identifying a low density population close to denser populations because they typically make assumptions on the density of clusters <ref type="bibr" target="#b22">[23]</ref>. Our experiments demonstrated that SamSPEC-TRAL can properly tackle this problem. Besides the practical observations, this capability is justified by the following observation. Spectral methodology clusters the graph such that the normal cut is "almost" optimum <ref type="bibr" target="#b40">[41]</ref>. Now, assume that it can distinguish between two clusters when their densities are comparable. Then, if the size of the smaller cluster is reduced without change in its shape or distribution, the normal cut between them remains similar because the number of vertices and edges reduces almost proportionally to each other. Therefore, the clusters remain distinguishable. This explains why the overall performance of SamSPECTRAL is independent of cluster densities as long as their shapes are preserved.</p><p>Since parametric methods such as FLAME and flow-Merge make a priori assumptions on the distribution or shape of the clusters <ref type="bibr" target="#b22">[23]</ref>, they may fail in identifying populations with arbitrary shapes. Although flow-Merge attempts to solve this issue by finding more clusters than needed and then merging them together, it still does not produce satisfactory results when the shape of the cluster is complex. SamSPECTRAL has the capability of identifying arbitrary shape clusters since it is a non-parametric approach that makes no assumptions on the shape and distribution of clusters, and clusters data based only on similarity between data points. Compared to other non-parametric methods, our algorithm has the advantages of automatically identifying the number of clusters and having low sensitivity to the predefined thresholds. Therefore, users can adjust the parameters only once by running Sam-SPECTRAL on one or two random samples from a flow cytometry data set. Then, the algorithm can be run on the rest of data set without changing the parameters.</p><p>Not only does our sampling scheme increase the speed of spectral clustering without losing important biological information, but the resulting algorithm is faster than other methods considered in this study. More precisely, the running time of SamSPECTRAL is O (dmn) + O(m 3 ) where O(dmn) is the running time for building m communities from n points in d dimension and O(m 3 ) is the running time for computing the eigenspace. After this step, the k-means clustering runs very fast in time O(k m t) to find k clusters using eigenvectors by t iterations. In comparison, the time complexity of the original MCL method is O(nr 2 ) with no guarantee on upper bound for number of iterations r, other than n. Practically, for our model of flow cytometry data where all pairs of data points are connected, we could not run MCL before applying our modification to it. Moreover, SamSPECTRAL running time is significantly less than model-based techniques. The running time of flowMerge is O(d 2 k 2 nt) and FLAME runs in time O (d 4 klnt) where l is the number of times it runs to find the optimal number of clusters. In practice, we can keep m as small as 1500-3000 without loosing important biological information, and consequently SamSPECTRAL ran at least 5-10 times faster than flowMerge and FLAME on the studied datasets. Furthermore, the time efficiency of our algorithm is more noticeable for higher dimensional data such as the one provided as additional file 2. This sample contains 100,000 events in 23 dimensions and SamSPECTRAL can analyze it in less than 25 minutes by a 2.7 GHz processor.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Conclusions</head><p>Faithful sampling is based on potential theory. It reduces the size of input for spectral clustering algorithms and consequently they can now be efficiently applied on flow cytometry data in spite of its large size. Practically, our approach demonstrated significant advantages in proper identification of populations with non-elliptical shapes, low density populations close to dense ones, minor subpopulations of a major population, rare populations, and overlapping populations. No state of the art method can solve the challenges in identifying populations with the above properties simultaneously. Moreover, applying SamSPECTRAL to other biological data such as microarrays and protein databases may result in significant improvements in gene expression and protein classification.</p><p>Besides, our faithful sampling algorithm can have interesting applications by itself. For instance, it can be used appropriately to reduce the size of input for other clustering algorithms that are based on spectral graph theory such as Markov Clustering Algorithm (MCL), electrical circuit based clustering, and agent based graph clustering <ref type="bibr" target="#b44">[45]</ref>. We have shown the extendibility of our approach in this sense by substituting classic spectral clustering with MCL, a method that has many applications in bioinformatics.</p><p>Other directions for future work include applying other schemes for estimating similarities between communities, combining clusters based on other combinatorial algorithms or biological criteria, and repeating the algorithm several times to obtain a more stable outcome.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Methods</head><p>To run flowMerge and FLAME optimally, we used several settings for their parameters, finally selecting those that gave us the best results. For SamSPECTRAL algorithm, we set m = 3000 to keep the running time bellow 1 minute by a 2.7 GHz processor and the obtained results remained satisfactory for all samples we analyzed. The separation factor and scaling parameter (s) are two main parameters that needed to be adjusted. Decreasing s and increasing the separation factor will result in identifying more populations. In particular, if s is decreased, then according to the heat kernel formula, the weights on the edges of the graph will decrease exponentially. Therefore, the graph will be sparser and tends to obtain more partitions. In consequence, the algorithm identifies more spectral clusters. This phenomenon can be useful in identifying rare populations. On the other hand, if separation factor is too high, a single population may be split into parts. In our experiments, we applied SamSPECTRAL on one or two random data samples of a data set and tried different values. Then, the selected parameters were fixed and used to apply SamSPECTRAL on the rest of data samples. The parameters values for the data sets presented in this paper are provided in additional file 3, 4, 5, and 6. The reader is referred to the SamSPECTRAL Bioconductor package vignette for more explanation on how to adjust parameters for a given data set 3 .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Datasets</head><p>We tested our algorithm on four different flow cytometry datasets as explained briefly here. The GvHD dataset is available in flowCore package through BioConductor, and the rest are available upon request.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Stem Cells</head><p>To investigate heterogeneity in the differentiation behaviour of hematopoietic stem cells, a subpopulation of adult mouse bone marrow was isolated and then each single stem cell was transplanted into one of 352 recipients <ref type="bibr" target="#b45">[46]</ref>. 16 blood samples were taken from the recipients in biweekly intervals and were studied in a cytometer. The investigation contained hundreds of data files that needed to be analyzed to count the frequency of each subtype of white cells they contained.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Telomere</head><p>In all vertebrates, telomeres consist of tandem DNA repeats of the sequence d(TTAGGG) and associated proteins. Telomere length is known to be crucial elements in ageing and various diseases including cancer and it can be estimated by flow cytometry <ref type="bibr" target="#b46">[47]</ref>. Since telomere length is different for various cell populations, these need to be distinguished before calculating telomere length.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>GvHD</head><p>Acute graft versus host disease (GvHD) is a common outcome after bone marrow transplantation. It is difficult to diagnose in its early stages in order to provide timely treatment. To investigate how flow cytometry can help predict the development of GvHD, and to study its advantages over microarrays, peripheral blood samples from 31 patients undergoing allogeneic blood and marrow transplant were analyzed <ref type="bibr" target="#b47">[48]</ref>. The samples were taken at progressive time points post-transplant and were stained with four appropriate lymphocyte phenotypic and activation markers defining 121 different populations using six markers.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Viability</head><p>Propidium iodide (PI) is a widely used marker for determining viability of mammalian cells <ref type="bibr" target="#b48">[49]</ref> because it has the capability of passing through only damaged cell membranes. However, depending on the complexity of the data, identifying dead cells automatically might still be difficult even if this marker is used. We tested the capability of our algorithm in identifying dead cells using PI marker on a dataset from the Terry Fox Laboratory.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix 1</head><p>In the results section, we explained that the resolution of the sample points (Figure <ref type="figure" target="#fig_1">2</ref>) is high enough such that by repeating the randomized faithful sampling procedure, the outcome of SamSPECTRAL does not vary significantly. The following experiment is performed to confirm this observation quantitatively. In this experiment we used F-measure, which is known to be appropriate for comparing clustering results of flow cytometry data <ref type="bibr" target="#b49">[50]</ref>. F-measure varies in range 0-1 and reaches its best value at 1 when the two clustering results are identical. We ran SamSPECTRAL on a sample from the stem cell data set 20 times and compared the final results. The F-measure values obtained by pairwise comparison between the final results had mean = 0.98, median = 0.98 and standard deviation 0.0097.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix 2</head><p>We performed the following experiment to show the effect of edge weights on performance of spectral clustering. As shown in Figure <ref type="figure" target="#fig_11">9</ref>, we produced synthetic data containing one normal distribution with relatively high density surrounded by four relatively small clusters with lower densities. The number of points in each small cluster is less than 0.01% of the whole data and noise is added to the data space uniformly (Figure <ref type="figure" target="#fig_11">9a</ref>). . The R code to produce this synthetic data and run SamSPECTRAL on it is provided in additional file 7.</p><p>After faithful sampling is done (Figure <ref type="figure" target="#fig_11">9b</ref>), the sample points are distributed almost uniformly, and the information about the local density of original data is lost. However, faithful sampling provides us with more information than only the sample points. It will also return the members of each community and our data reduction scheme uses this information to assign weight to the edges. According to formulas 3 and 4, the more populated and closer two communities are, the higher the weight between them will be (Figure <ref type="figure" target="#fig_0">1c</ref>). According to Figure <ref type="figure" target="#fig_11">9c</ref>, this strategy is successful in retrieving information about local density as all the five clusters are distinguished properly by SamSPECTRAL.  </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1</head><label>1</label><figDesc>Figure 1 Data reduction scheme. (a) Running spectral clustering is impractical on data that contains thousands of points. (b) Faithful sampling picks up a reasonable subset of points such that running spectral clustering is possible on them. However, all information about the local density is lost by considering only these sample points. (c) We assign weights to the edges of the graph; the edges between the nodes in denser regions are weighted considerably higher. The information about the local density is retrieved in this way.</figDesc><graphic coords="3,63.84,605.25,467.81,76.88" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2</head><label>2</label><figDesc>Figure 2 Faithful sampling. (a) Original data from telomere data set before sampling. (b) The distribution of representatives is almost uniform in the space after faithful sampling.</figDesc><graphic coords="4,63.84,95.87,467.96,237.85" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 3</head><label>3</label><figDesc>Figure 3 Defining the similarity between two communities and identifying the number of clusters. (a) We define the similarity between two communities c and c' as the sum of pairwise similarities between the members of c and the members of c'. (b) This figure shows the largest eigenvalues of a sample from the stem cell dataset. The number of clusters is estimated according to the knee point of eigenvalues curve. This point is defined as the intersection of the above regression line and the line y = 1. The horizontal coordinate of the knee point estimates the number of spectral clusters.</figDesc><graphic coords="5,127.56,95.87,340.19,236.50" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head></head><label></label><figDesc>1. Sampling: (a) Let h=12Vmd. (b) Repeat:</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>3 .</head><label>3</label><figDesc>Build a graph wherein each community is a vertex. Put edges between all pairs of vertices and weight them by similarity between corresponding communities. 4. Analyze the spectrum of the above graph to find the clusters; (a) Normalize the adjacency matrix of the graph according to Equation 1. (b) Compute the eigenspace of the graph and set k, number of clusters, according to the knee point of eigenvalues curve. (c) Run classical spectral clustering algorithm to find k clusters. 5. Combine the clusters to find connected components: (a) Initiate the list of components equal to the list of spectral clusters. (b) Repeat:• For any pairs of components C i , C j , set:</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 4</head><label>4</label><figDesc>Figure 4 Comparative clustering of the telomere dataset. (a-c) Proper identification of overlapping populations. Although two populations shown by red and blue contours are overlapping in all bi-variant plots of this 3-dimensional sample, SamSPECTRAL can properly distinguish them by considering multiple parameters simultaneously.(d) SamSPECTRAL can also identify two major subpopulations of granulocytes correctly, as verified by expert analysis. (e) flowMerge does not distinguish between two populations of interest, and (f) FLAME improperly splits the same sample into several clusters.</figDesc><graphic coords="7,87.19,95.87,421.02,571.25" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 5</head><label>5</label><figDesc>Figure 5 Comparative clustering of dead cells (PI positive) and live cells (PI negative) in the viability data. (a) SamSPECTRAL could distinguish between dead cells (blue) and live cells (red) properly. (b) flowMerge identified dead cells correctly, but split live cells into two clusters. (c) FLAME did not distinguish between these two population.</figDesc><graphic coords="8,63.84,95.87,467.80,151.53" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Figure 6</head><label>6</label><figDesc>Figure 6 Comparative clustering of the GvHD dataset. (Left) Identification of non-elliptical shaped populations. (a) SamSPECTRAL could properly identify the red, non-elliptical population, while (b) flowMerge mixed this population with the one below it. (c) FLAME produced satisfactory results in identifying this population. (Right) Identification of low density populations close to dense populations. (d) SamSPECTRAL and (e) flowMerge could identify the low density population shown in red at the centre of the figure correctly, while (f) FLAME merged this population with the other ones surrounding it.</figDesc><graphic coords="9,80.50,95.87,434.33,579.97" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 7</head><label>7</label><figDesc>Figure 7 Comparative identification of a low density population surrounded by much denser populations in the stem cell data set. (ac) SamSPECTRAL correctly identified the blue, low density population, while (d-f) flowMerge merged it to the yellow, high density population. (g-i) FLAME merged it to the red population. (j-l) The outcome of our modified MCL was similar to that obtained by SamSPECTRAL using classic spectral clustering. This shows that SamSPECTRAL is extensible by substituting classic spectral clustering with other clustering algorithms for weighted graph.</figDesc><graphic coords="10,80.16,95.87,435.04,576.75" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Figure 8</head><label>8</label><figDesc>Figure 8 Rare population in the stem cell data set. (a-c) This is a typical sample from the stem cell data set that contains a rare population. In these three dimensional plots, the red dots represent the cells that are positive for all three markers. Only 23/9721 (0.24%) events belong to this population in this sample. SamSPECTRAL could properly identify the rare population in 27/34 (79.4%) samples from the stem cell data set.</figDesc><graphic coords="11,63.84,95.87,467.90,113.59" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head></head><label></label><figDesc>For the central dense distribution, we set s xx = s yy = 2, s xy = s yx = 0 and the surrounding clusters are normal distributions with</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Figure 9</head><label>9</label><figDesc>Figure 9 Performance of SamSPECTRAL on synthetic data. (a) This synthetic two dimensional data consists of a normal distribution with 30,000 points, four normal distribution each with 300 points and a uniform background noise with 4000 points. (b) Around 3000 sample points are picked up by faithful sampling. These are distributed almost uniformly in the space, therefore, almost all information about density will be lost if one considers only the samples points. (c) The final outcome of SamSPECTRAL confirms that the information about density could be retrieved by properly assigning weights to the edges of the graph. The high density cluster is shown in red and the surrounding sparser clusters are shown in yellow, light blue, green and black.</figDesc><graphic coords="14,63.84,95.87,467.82,113.06" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head>Figure 10</head><label>10</label><figDesc>Figure 10 Comparing Uniform sampling with faithful sampling. Directly applying classical spectral clustering is not efficient on this sample of the stem cell dataset which contains 48000 cytometry events in 3 dimensions. (a) Although only 2115 data points were selected by faithful sampling, each population has a considerable number of representatives in the selected points. (b) 3000 points were selected by uniform sampling. The low density population in the middle of the plot consists of only 55 sample points resulting in mixing this population with a high density one incorrectly (d). (c) The result of SamSPECTRAL on the original data is satisfactory because the low density red population and other high density populations are identified properly.</figDesc><graphic coords="14,115.26,397.47,365.05,263.07" type="bitmap" /></figure>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgements</head><p>The authors would like to thank Adrian Cortes, Connie Eaves, Peter Lansdorp and Keith Humphries for providing data, Bari Zahedi and Irma Vulto for their biological insight and manual data analysis, Josef Spidlen for assistance in running FLAME, Aaron Barsky and Nima Aghaeepour for their editorial comments, and Mani Ranjbar for programming guidance. This work was supported by NIH grants 1R01EB008400 and 1R01EB005034, the Michael Smith Foundation for Health Research, the National Science and Engineering Research Council and the MITACS Network of Centres of Excellence.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Appendix 3</head><p>We observed that some low density populations disappeared entirely when simple uniform sampling was employed. To investigate the effect of this phenomenon on the final clustering results, we performed an experiment on a sample of the stem cell dataset that contained 48,000 events in 3 dimensions. First, 3,000 data points were selected uniformly at random. Then, we assigned a label to each of these selected points by applying classical spectral clustering on them. Finally, for each original data point, the label of the closest selected point was considered as its cluster label. Figures <ref type="figure">10d</ref> and<ref type="figure">10c</ref> show the results of this approach and SamSPECTRAL, accordingly. The red population that was distinguished by SamSPECTRAL correctly in Figure <ref type="figure">10c</ref> consists of only 4% of the data. This population could not be distinguished properly by any setting of the parameters after uniform sampling (Figure <ref type="figure">10d</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Footnotes</head><p>1 Cheeger inequality is an example of such a relation <ref type="bibr" target="#b40">[41]</ref>. 2 The CD45+ cells that are considered as outliers by MCL are not plotted in Figure <ref type="figure">7j</ref>-l. 3 The vignette is located at: http://bioconductor.org/ packages/devel/bioc/vignettes/SamSPECTRAL/inst/doc/ Clustering_by_SamSPECTRAL.pdf</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Additional material</head><p>Additional file 1: Report on identification of rare population. The table contains the full detailed report on our comparative experiment for identifying rare populations.</p><p>Additional file 2: High dimensional flow cytometry data. This data file contains a matrix with 100,000 rows and 23 columns that represents a flow cytometry sample with 100,000 events. It can be directly loaded in R and analyzed by SamSPECTRAL. It takes less than 12 minutes to perform faithful sampling on this 23 dimensional data. Additional file 7: Simulation with synthetic data. This R source code produces synthetic data with 5 clusters shown in Figure <ref type="figure">5</ref>. The resulting data is passed to SamSPECTRAL to be clustered.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Author details</head><p>1 Department of Computing Science, University of British Columbia, Vancouver, BC, Canada. 2 Terry Fox Laboratory, BC Cancer Agency, 675 W 10th Ave., Vancouver, BC, Canada. 3 Faculty of Science, University of British Columbia, Vancouver, BC, Canada. 4 Department of Medical Genetics, University of British Columbia, Vancouver, BC, Canada.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Authors' contributions</head><p>The authors wish it to be known that, in their opinion, the first two authors, HZ and PS, should be regarded joint first authors. HZ designed and implemented the faithful sampling algorithm, and the method for computing similarity between communities. PS developed the idea of nonuniform sampling for spectral clustering and experimentally verified the stability of the algorithm. HZ and PS jointly worked on the method for estimating the number of clusters, and post-processing steps. HZ and PS performed the experiments. HZ, PS and RB wrote the paper. RB provided data and computing facilities. AG studied the convergence of faithful sampling. AG and RB supervised the project. All authors read, edited and approved the final manuscript.</p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Flow Cytometry Protocols</title>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">S</forename><surname>Hawley</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">G</forename><surname>Hawley</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Methods in Molecular Biology</title>
		<imprint>
			<date type="published" when="2005-02">2 2005</date>
			<publisher>Humana Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">Seventeen-colour flow cytometry: unravelling the immune system</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">P</forename><surname>Perfetto</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">K</forename><surname>Chattopadhyay</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Roederer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat Rev Immunol</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="648" to="655" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">A survey of flow cytometry data analysis methods</title>
		<author>
			<persName><forename type="first">A</forename><surname>Bashashati</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Brinkman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Advances in Bioinformatics</title>
		<imprint>
			<biblScope unit="page" from="1" to="19" />
			<date type="published" when="2009">2009. 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Scalable analysis of flow cytometry data using R/ Bioconductor</title>
		<author>
			<persName><forename type="first">D</forename><surname>Klinke</surname></persName>
		</author>
		<author>
			<persName><surname>Ii</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Brundage</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry Part A</title>
		<imprint>
			<biblScope unit="volume">75</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="699" to="706" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Data analysis in flow cytometry: The future just started</title>
		<author>
			<persName><forename type="first">E</forename><surname>Lugli</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Roederer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Cossarizza</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry Part A</title>
		<imprint>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page" from="705" to="713" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Mixture modeling approach to flow cytometry data</title>
		<author>
			<persName><forename type="first">M</forename><surname>Boedigheimer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Ferbas</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry Part A</title>
		<imprint>
			<biblScope unit="volume">73</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="421" to="429" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Model-based cluster analysis applied to flow cytometry data</title>
		<author>
			<persName><forename type="first">U</forename><surname>Simon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Mucha</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Bruggemann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Innovations in Classification, Data Science, and Information Systems</title>
		<imprint>
			<date type="published" when="2005">2005</date>
			<biblScope unit="page" from="69" to="76" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Feature-guided clustering of multi-dimensional flow cytometry datasets</title>
		<author>
			<persName><forename type="first">Q</forename><surname>Zeng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Pratt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Pak</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Ravnic</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Huss</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Mentzer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Biomedical Informatics</title>
		<imprint>
			<biblScope unit="volume">40</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="325" to="331" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">ImmPort FLOCK: Automated cell population identification in high dimensional flow cytometry data</title>
		<author>
			<persName><forename type="first">R</forename><surname>Scheuermann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Qian</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Wei</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><surname>Sanz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Journal of Immunology</title>
		<imprint>
			<biblScope unit="volume">182</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="42" to="59" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">The curvHDR method for gating flow cytometry samples</title>
		<author>
			<persName><forename type="first">U</forename><surname>Naumann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Luta</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Wand</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC bioinformatics</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="page">44</biblScope>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Analysis of flow cytometry data using an automatic processing tool</title>
		<author>
			<persName><forename type="first">D</forename><surname>Jeffries</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><surname>Zaidi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>De Jong</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Holland</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Miles</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry Part A</title>
		<imprint>
			<biblScope unit="volume">73</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="857" to="867" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Automation in high-content flow cytometry screening</title>
		<author>
			<persName><forename type="first">U</forename><surname>Naumann</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Wand</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry Part A</title>
		<imprint>
			<biblScope unit="volume">75</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="789" to="797" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Development of an automated analysis system for data from flow cytometric intracellular cytokine staining assays from clinical vaccine trials</title>
		<author>
			<persName><forename type="first">N</forename><surname>Shulman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Bellew</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Snelling</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Carter</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Huang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Self</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Mcelrath</surname></persName>
		</author>
		<author>
			<persName><forename type="first">De</forename><surname>Rosa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry Part A</title>
		<imprint>
			<biblScope unit="volume">73</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="847" to="856" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Advances in complex multiparameter flow cytometry technology: Applications in stem cell research</title>
		<author>
			<persName><forename type="first">F</forename><surname>Preffer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Dombkowski</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry Part B: Clinical Cytometry</title>
		<imprint>
			<biblScope unit="volume">76</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="295" to="314" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Generation of flow cytometry data files with a potentially infinite number of dimensions</title>
		<author>
			<persName><forename type="first">C</forename><surname>Pedreira</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Costa</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Barrena</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Q</forename><surname>Lecrevisse</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Almeida</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Van Dongen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Orfao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry Part A</title>
		<imprint>
			<biblScope unit="volume">73</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="834" to="846" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">A rapid, non-parametric clustering scheme for flow cytometric data</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">P</forename><surname>Conrad</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pattern Recognition</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="229" to="235" />
			<date type="published" when="1987">1987</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Real-time adaptive clustering of flow cytometric data</title>
		<author>
			<persName><forename type="first">L</forename><surname>Fu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Braylan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Benson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pattern Recognition</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="365" to="373" />
			<date type="published" when="1993">1993</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Pattern recognition in flow cytometry</title>
		<author>
			<persName><forename type="first">L</forename><surname>Boddy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Wilkins</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Morris</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="195" to="209" />
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Analysis of clinical flow cytometric immunophenotyping data by clustering on statistical manifolds: Treating flow cytometry data as high-dimensional objects</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">G</forename><surname>Finn</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">M</forename><surname>Carter</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Raich</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">M</forename><surname>Stoolman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">O</forename><surname>Hero</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry Part B: Clinical Cytometry</title>
		<imprint>
			<biblScope unit="volume">76</biblScope>
			<biblScope unit="page" from="1" to="7" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Automated high-dimensional flow cytometric data analysis</title>
		<author>
			<persName><forename type="first">S</forename><surname>Pyne</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Hu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Rossin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">I</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">M</forename><surname>Maier</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Baecher-Allan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">J</forename><surname>Mclachlan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Tamayo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">A</forename><surname>Hafler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">De</forename><surname>Jager</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">L</forename><surname>Mesirov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">P</forename></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proceedings of the National Academy of Sciences</title>
		<imprint>
			<biblScope unit="volume">106</biblScope>
			<biblScope unit="issue">21</biblScope>
			<biblScope unit="page" from="8519" to="8524" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">flowClust: a Bioconductor package for automated gating of flow cytometry data</title>
		<author>
			<persName><forename type="first">K</forename><surname>Lo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Hahne</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Brinkman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Gottardo</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">BMC Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="page" from="1" to="145" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Merging Mixture Components for Cell Population Identification in Flow Cytometry</title>
		<author>
			<persName><forename type="first">G</forename><surname>Finak</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Bashashati</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">R</forename><surname>Brinkman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Gottardo</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Advances in Bioinformatics</title>
		<imprint>
			<biblScope unit="page" from="1" to="12" />
			<date type="published" when="2009">2009. 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Statistical mixture modeling for cell subtype identification in flow cytometry</title>
		<author>
			<persName><forename type="first">C</forename><surname>Chan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Feng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Ottinger</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Foster</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>West</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">B</forename><surname>Kepler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry Part A</title>
		<imprint>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="693" to="701" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">A tutorial on spectral clustering</title>
		<author>
			<persName><forename type="first">U</forename><surname>Von Luxburg</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Statistics and Computing</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="395" to="416" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">On Spectral Clustering: Analysis and an algorithm</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">Y</forename><surname>Ng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">I</forename><surname>Jordan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Weiss</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Advances in Neural Information Processing Systems</title>
		<imprint>
			<biblScope unit="volume">14</biblScope>
			<biblScope unit="page" from="849" to="856" />
			<date type="published" when="2001">2001</date>
			<publisher>MIT Press</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Spectral Methods for Automatic Multiscale Data Clustering. Computer Vision and Pattern Recognition</title>
		<author>
			<persName><forename type="first">A</forename><surname>Azran</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Ghahramani</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Computer Society Conference on</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="190" to="197" />
			<date type="published" when="2006">2006. 2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<monogr>
		<author>
			<persName><forename type="first">W</forename><surname>Pentney</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Meila</surname></persName>
		</author>
		<title level="m">Spectral Clustering of Biological Sequence Data. AAAI 2005</title>
		<imprint>
			<biblScope unit="page" from="845" to="850" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">Learning Spectral Clustering, With Application To Speech Separation</title>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">R</forename><surname>Bach</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">I</forename><surname>Jordan</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Mach Learn Res</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="1963" to="2001" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Consistency of Spectral Clustering</title>
		<author>
			<persName><forename type="first">U</forename><surname>Von Luxburg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Belkin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Bousquet</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annals of Statistics</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="555" to="586" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<monogr>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">N</forename><surname>Trefethen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Bau</surname></persName>
		</author>
		<title level="m">Numerical Linear Algebra SIAM 1997</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<monogr>
		<title level="m" type="main">Lanczos Algorithms for Large Symmetric Eigenvalue Computations SIAM</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">K</forename><surname>Cullum</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">A</forename><surname>Willoughby</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Spectral Grouping Using the Nystrom Method</title>
		<author>
			<persName><forename type="first">C</forename><surname>Fowlkes</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Belongie</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Chung</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Malik</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Pattern Analysis and Machine Intelligence</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="214" to="225" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Information Preserving Component Analysis: Data Projections for Flow Cytometry Analysis</title>
		<author>
			<persName><forename type="first">K</forename><forename type="middle">M</forename><surname>Carter</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Raich</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">G</forename><surname>Finn</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">O</forename><surname>Hero</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Journal of Selected Topics in Signal Processing</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="148" to="158" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">On multiparameter data analysis in flow cytometry</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">C</forename><surname>Mann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cytometry A</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="184" to="189" />
			<date type="published" when="1987">1987</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<monogr>
		<title level="m" type="main">Fast Approximate Spectral Clustering</title>
		<author>
			<persName><forename type="first">D</forename><surname>Yan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Huang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Jordan</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2009">2009</date>
			<pubPlace>Berkeley</pubPlace>
		</imprint>
		<respStmt>
			<orgName>EECS Department, University of California</orgName>
		</respStmt>
	</monogr>
	<note type="report_type">Tech. Rep. UCB/EECS-2009-45</note>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">Diffusion Kernels on Graphs and Other Discrete Structures</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">I</forename><surname>Kondor</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Lafferty</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the ICML 2002</title>
		<meeting>the ICML 2002</meeting>
		<imprint>
			<biblScope unit="page" from="315" to="322" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">Laplacian eigenvectors of graphs</title>
		<author>
			<persName><forename type="first">T</forename><surname>Biyikoglu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Leydold</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">F</forename><surname>Stadler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="s">Lecture notes in mathematics</title>
		<imprint>
			<date type="published" when="1915">1915 Springer 2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">Spectral clustering with eigenvector selection</title>
		<author>
			<persName><forename type="first">T</forename><surname>Xiang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Gong</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Pattern Recogn</title>
		<imprint>
			<biblScope unit="volume">41</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="1012" to="1029" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<monogr>
		<author>
			<persName><forename type="first">N</forename><surname>Biggs</surname></persName>
		</author>
		<title level="m">Topics in Algebraic Graph Theory: Encyclopedia of Mathematics and its Applications</title>
		<imprint>
			<date type="published" when="2007">2007</date>
			<biblScope unit="volume">16</biblScope>
			<biblScope unit="page" from="171" to="172" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<monogr>
		<ptr target="http://www.bioconductor.org/packages/devel/bioc/html/SamSPECTRAL.html" />
		<title level="m">SamSPECTRAL</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<monogr>
		<author>
			<persName><forename type="first">Frk</forename><surname>Chung</surname></persName>
		</author>
		<title level="m">Spectral Graph Theory (CBMS Regional Conference Series in Mathematics</title>
		<imprint>
			<publisher>American Mathematical Society</publisher>
			<date type="published" when="1997">1997</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<analytic>
		<title level="a" type="main">Normalized Cuts and Image Segmentation</title>
		<author>
			<persName><forename type="first">J</forename><surname>Shi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Malik</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Transactions on Pattern Analysis and Machine Intelligence</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="page" from="888" to="905" />
			<date type="published" when="1997">1997</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<analytic>
		<title level="a" type="main">Graph Clustering Via a Discrete Uncoupling Process</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">V</forename><surname>Dongen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">SIAM Journal on Matrix Analysis and Applications</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="121" to="141" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title level="a" type="main">Rare-Event Analysis in Flow Cytometry</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">D</forename><surname>Donnenberg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">S</forename><surname>Donnenberg</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Clinics in Laboratory Medicine</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="627" to="652" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b44">
	<monogr>
		<title level="m" type="main">Automation in proteomics and genomics: an engineering case-based approach</title>
		<author>
			<persName><forename type="first">Gil</forename><surname>Alterovitz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">R</forename></persName>
		</author>
		<author>
			<persName><forename type="first">Benson</forename><surname>Roseann</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2009">2009</date>
			<publisher>Wiley</publisher>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b45">
	<analytic>
		<title level="a" type="main">Long-term propagation of distinct hematopoietic differentiation programs in vivo</title>
		<author>
			<persName><forename type="first">B</forename><surname>Dykstra</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Kent</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Bowie</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Mccaffrey</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Hamilton</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Lyons</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Brinkman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Eaves</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell Stem Cell</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="218" to="229" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b46">
	<analytic>
		<title level="a" type="main">Lansdorp P: Flow cytometry and FISH to measure the average length of telomeres (flow FISH)</title>
		<author>
			<persName><forename type="first">G</forename><surname>Baerlocher</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><surname>Vulto</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">G</forename><surname>De</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature protocols</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page">2365</biblScope>
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b47">
	<analytic>
		<title level="a" type="main">High-content flow cytometry and temporal data analysis for defining a cellular signature of graft-versus-host disease</title>
		<author>
			<persName><forename type="first">R</forename><surname>Brinkman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Gasparetto</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Ribickas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Perkins</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Janssen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Smiley</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Smith</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Biol Blood Marrow Transplant</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="issue">6</biblScope>
			<biblScope unit="page" from="691" to="700" />
			<date type="published" when="2007">2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b48">
	<analytic>
		<title level="a" type="main">Propidium iodide as a nuclear marker in immunofluorescence. II. Use with cellular identification and viability studies</title>
		<author>
			<persName><forename type="first">C</forename><surname>Yeh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Hsi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Lee</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Faulk</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J Immunol Methods</title>
		<imprint>
			<biblScope unit="volume">43</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="269" to="275" />
			<date type="published" when="1981">1981</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b49">
	<analytic>
		<title level="a" type="main">An Empirical Study of Cluster Evaluation Metrics using Flow Cytometry Data</title>
		<author>
			<persName><forename type="first">N</forename><surname>Aghaeepour</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">H</forename><surname>Khodabakhshi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">R</forename><surname>Brinkman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of NIPS workshop &quot;Clustering: Science or Art</title>
		<meeting>NIPS workshop &quot;Clustering: Science or Art</meeting>
		<imprint>
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
