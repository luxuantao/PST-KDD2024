<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Q</forename><surname>Sun</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Information Science and Engineering</orgName>
								<orgName type="institution">Northeastern University</orgName>
								<address>
									<postCode>110819</postCode>
									<settlement>Shenyang</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">R</forename><surname>Han</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Information Science and Engineering</orgName>
								<orgName type="institution">Northeastern University</orgName>
								<address>
									<postCode>110819</postCode>
									<settlement>Shenyang</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">H</forename><surname>Zhang</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Information Science and Engineering</orgName>
								<orgName type="institution">Northeastern University</orgName>
								<address>
									<postCode>110819</postCode>
									<settlement>Shenyang</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">J</forename><surname>Zhou</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">School of Information Science and Engineering</orgName>
								<orgName type="institution">Northeastern University</orgName>
								<address>
									<postCode>110819</postCode>
									<settlement>Shenyang</settlement>
									<country key="CN">China</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Guerrero</surname></persName>
							<affiliation key="aff1">
								<orgName type="department">Institute of Energy Technology</orgName>
								<orgName type="institution">Aalborg University</orgName>
								<address>
									<postCode>9220</postCode>
									<settlement>Aalborg</settlement>
									<country key="DK">Denmark</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">This article has been accepted for inclusion in a future issue of this journal. Content is final as presented, with the exception of pagination</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
					<idno type="MD5">82963C40B9223A483245F7F7EF95A510</idno>
					<idno type="DOI">10.1109/TSG.2015.2412779</idno>
					<note type="submission">received July 3, 2014; revised October 21, 2014, January 19, 2015, and February 25, 2015; accepted March 10, 2015.</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.3" ident="GROBID" when="2023-07-27T10:06+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract/>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Abstract-With the bidirectional power flow provided by the Energy Internet, various methods are promoted to improve and increase the energy utilization between Energy Internet and main grid (MG). This paper proposes a novel distributed coordinated controller combined with a multiagent-based consensus algorithm, which is applied to distributed generators in the Energy Internet. Then, the decomposed tasks, models, and information flow of the proposed method are analyzed. The proposed coordinated controller installed between the Energy Internet and MG keeps voltage angles and amplitudes consensus, while providing accurate power-sharing and minimizing circulating currents. Finally, the Energy Internet can be integrated into the MG seamlessly if necessary. Hence, the Energy Internet can be operated as a spinning reserve system. Simulation results are provided to show the effectiveness of the proposed controller in an Energy Internet.</p><p>Index Terms-Distributed coordinated control, distributed generators (DGs), Energy Internet, multiagent consensus algorithm, spinning reserve.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>NOMENCLATURE I a</head><p>Active circulating current.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>I r</head><p>Reactive circulating current. q-axis reference of voltage amplitude in the voltage controller for DG. φ odi d-axis auxiliary state variables in the voltage controller for DG. φ oqi q-axis auxiliary state variables in the voltage controller for DG. F Feedforward parameter in the voltage controller. C fi Filter capacitor for DG. i * ldi d-axis current reference in the current controller for DG. i * lqi q-axis current reference in the current controller for DG. k pVodi d-axis proportion parameters in the voltage controller for DG. k qVodi q-axis proportion parameters in the voltage controller for DG. k iVodi d-axis integral parameters in the voltage controller for DG. k iVoqi q-axis integral parameters in the voltage controller for DG. γ di d-axis auxiliary state variables in the current controller for DG γ qi q-axis auxiliary state variables in the current controller for DG. i ldi d-axis filter current components for DG. i lqi q-axis filter current components for DG. v * idi d-axis output of current controller for DG. v * iqi q-axis output of current controller for DG.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>L fi</head><p>Filter inductance for DG. k pildi d-axis proportion parameters in the current controller for DG. k pilqi q-axis proportion parameters in the current controller for DG. k iildi d-axis integral parameters in the current controller for DG.</p><p>k iilqi q-axis integral parameters in the current controller for DG. θ park Angle used for Park transformation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>I. INTRODUCTION</head><p>W ITH THE large penetration of renewable energy in power systems, flexible energy management and power sharing among different distributed generators (DGs) have raised a major concern. Therefore, the concept of "Energy Internet," motivated by the Internet, has been proposed recently <ref type="bibr" target="#b0">[1]</ref> and can provide promising solutions. Previous literatures about Energy Internet mainly focused on its architecture, system integration, and control of the solid-state transformer <ref type="bibr" target="#b1">[2]</ref>, <ref type="bibr" target="#b2">[3]</ref>. However, in order to realize the envisioned Energy Internet conception, the critical design and control objectives should be considered: 1) maintaining flexible and proportional power-sharing among DGs; 2) maintaining system continuous synchronization with the main grid (MG) considering load variations; 3) minimizing circulating currents between DGs; and 4) achieving seamless energy transitions between Energy Internet and MG if necessary.</p><p>To realize proportional power-sharing among DGs in the Energy Internet, various control schemes have been proposed. The most important one is the droop control <ref type="bibr" target="#b3">[4]</ref>, an attractive distributed control scheme that has been widely studied recently since its operation does not require for high-bandwidth communication systems. In addition, a power sharing unit is proposed to achieve power management strategy in a hybrid microgrid architecture in <ref type="bibr" target="#b4">[5]</ref>. However, the conventional droop controller has several drawbacks such as load-dependent frequencies and voltage amplitudes, large circulating currents among DGs <ref type="bibr" target="#b5">[6]</ref>, and the tradeoff between power-sharing accuracy and voltage synchronization <ref type="bibr" target="#b6">[7]</ref>, <ref type="bibr" target="#b7">[8]</ref>. To overcome these shortcomings, a modified droop control strategy <ref type="bibr" target="#b8">[9]</ref> has been proposed to improve the power-sharing accuracy considering the line-impedance effect through designing a proper virtual impedance. To restore the voltage and frequency of DGs to nominal values, the so-called secondary control has been recently investigated in <ref type="bibr" target="#b9">[10]</ref> and <ref type="bibr" target="#b10">[11]</ref>, which demonstrate that proper communication systems are necessary to realize the control goals. The secondary control can be classified into centralized control and distributed control in general. The centralized control <ref type="bibr" target="#b11">[12]</ref>, <ref type="bibr" target="#b12">[13]</ref> requires a central unit to receive all the information and to broadcast the decisions. Due to the centralized nature, it presents a single point failure, which can reduce the reliability and stability of the whole system. Alternatively, the multiagent system as a kind of distributed control structure has drawn much attention due to its flexibility and computational efficiency <ref type="bibr" target="#b13">[14]</ref>, <ref type="bibr" target="#b14">[15]</ref>. In <ref type="bibr" target="#b15">[16]</ref>, the participation of a multiagent-system-based microgrid into the energy market is proposed. In order to charge electric vehicles (EVs) at low electricity prices, an agent-based control system that coordinates the battery charging of EVs in distribution networks is presented in <ref type="bibr" target="#b16">[17]</ref>. In <ref type="bibr" target="#b17">[18]</ref>, the multiagent system for EV charging control is proposed based on the Nash certainty equivalence in order to solve the grid impact. Meanwhile, the multiagent consensus algorithm has been applied into control system based on the multiagent system structure <ref type="bibr" target="#b18">[19]</ref>, <ref type="bibr" target="#b19">[20]</ref>. However, these applications solved only a single problem of voltage restoration or frequency restoration. Furthermore, Energy Internet always suffers from large circulating currents caused by the slight differences among phases and amplitudes of the output voltages <ref type="bibr" target="#b20">[21]</ref>, which cannot be eliminated only by maintaining the synchronization of the output voltage angles or amplitudes.</p><p>In order to overcome the aforementioned challenges, this paper proposes a novel distributed coordinated controller combined with the multiagent-based consensus algorithm to control DGs in the Energy Internet. Two main control objectives are achieved by the proposed control scheme: 1) keep angles and amplitudes of all DGs' output voltages being synchronized with the MG information (restore to their nominal values), while keeping accurate proportional power-sharing; and 2) eliminate (minimize) circulating currents among DGs in the Energy Internet. Specifically, P-δ and Q-V droop controls are adopted to suppress the circulating currents, while achieving proportional power-sharing. This can be achieved by regulating both angles (δ) and amplitudes (V) at the same time. Due to the nonlinear feature of DGs in the Energy Internet, the proposed control approach is designed based on the input-output feedback linearization control principle <ref type="bibr" target="#b21">[22]</ref> and related stability analysis approach <ref type="bibr" target="#b22">[23]</ref>.</p><p>The main features and benefits of the proposed controller are given as follows.</p><p>1) The structure of the proposed controller related to the conception of the multiagent system is proposed including tasks decomposition, types of agents, and information flow.</p><p>2) The novel distributed coordinated controller combined with the multiagent consensus algorithm is proposed to control DGs in the Energy Internet.</p><p>3) The power can be shared in proportional and the angles and amplitudes of output voltages can be synchronized with the MG. 4) The circulating currents among DGs can be suppressed effectively. 5) The control method requires only a sparse communication structure which means each DG needs its only local information and its neighbor's information to achieve control objectives, then the controller can be more reliable and less expensive. It is worthwhile to remark here that the proposed controller can bring extra benefits.</p><p>1) Energy Internet can be operated as a spinning reserve system when the leader information is from MG, then it can achieve seamless integration into MG; roughly speaking, the spinning reserve means that the bidirectional power flow between Energy Internet and MG could respond voluntarily to load disturbances within a given period of time <ref type="bibr" target="#b23">[24]</ref>, <ref type="bibr" target="#b24">[25]</ref>. 2) Facilitated by this advanced control and communication scheme, Energy Internet can provide opportunities to other smart end users (flexible loads such as intelligence data centers) in our daily lives to satisfy the needs of their power demands while minimizing their energy cost <ref type="bibr" target="#b25">[26]</ref>. 3) The system can supply other ancillary services such as market participation as well required by MG <ref type="bibr" target="#b26">[27]</ref>, <ref type="bibr" target="#b27">[28]</ref>. 4) With the increasing number of renewable sources and the development of Energy Internet, the fuel crisis and environmental problems can be solved gradually. This paper is organized as follows. In Section II, the architecture of the proposed controller based on multiagent system is presented; the conception of different agents and information flow among agents are described. In Section III, the dynamic model of the single-inverter-based DG is established. Section IV discusses the distributed coordinated controller designed by the input-output feedback linearization and the multiagent consensus algorithm. In Section V, simulation results verify the effectiveness of the proposed controller. In Section VI, the comparisons of the proposed distributed approach versus centralized approach are illustrated. Section VII concludes this paper. Section VIII illustrates the future work.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>II. ARCHITECTURE OF THE DISTRIBUTED COORDINATED CONTROL BASED ON MULTIAGENT SYSTEM</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Requirements of the Proposed Distributed Coordinated Control</head><p>In order to achieve voltage synchronization, proportional power-sharing and spinning reserve requirements for Energy Internet, the distributed coordinated controller combined with multiagent consensus algorithm is proposed. A typical architecture of Energy Internet integrated with the proposed controller is shown in Fig. <ref type="figure" target="#fig_0">1</ref>. The energy sources in an Energy Internet consists of distributed renewable energy resources (DRERs), distributed energy storage devices (DESDs), and MG. In this paper, the designation of the controller structure used in an Energy Internet is based on the multiagent system structure <ref type="bibr" target="#b28">[29]</ref>- <ref type="bibr" target="#b30">[31]</ref> and each DRER, DESD, and MG is controlled by each different agent taking advantages of the autonomous, intelligent, cooperative proactive, and adaptive features of the multiagent system. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Definitions of Agents</head><p>Each agent in the proposed controller has its own goals and functions. According to different goals and functions, there are three different agents designed for the distributed coordinated controller and two additional agents in the normal multiagent system. The three different agents include the MG agent (MGA), the DG agents (DGAs) which consist of the primary-DGA (PDGA), the secondary-DGA (SDGA), and the energy storage agents (ESAs). The MGA is also called energy router which is used to regulate the power flow between Energy Internet and MG. The ESA and SDGA are all called energy switcher which is used to regulate the power flow inside Energy Internet. The other two necessary agents in a multiagent system include the agent management service agent (AMSA) which is compulsory and the directory facilitator agent (DFA) <ref type="bibr" target="#b28">[29]</ref>. In addition, the intelligent fault management and fault isolation device are also installed on the transition lines, whose functions are not discussed in this paper. The reference architecture of multiagent system is shown in Fig. <ref type="figure" target="#fig_1">2</ref>.</p><p>1) Main Grid Agent: In this paper, it is mainly used to choose the operation modes (grid-connected mode or islanded mode) for Energy Internet and calculate circulating currents between MG and Energy Internet. It provides the control information for the ESA and DGA. The general architecture of MGA is illustrated in Fig. <ref type="figure">3</ref>.</p><p>2) DG Agent: It consists of two sub-agent called the PDGA and SDGA, respectively. The PDGA is used to achieve local control objectives for each the DG and SDGA is used to IEEE TRANSACTIONS ON SMART GRID Fig. <ref type="figure">3</ref>. Architecture of MGA. achieve the distributed coordinated control among different DGs. The general architecture of DGA is illustrated in Fig. <ref type="figure" target="#fig_2">4</ref>.</p><p>3) Energy Storage Agent: It is used to control the energy storage to compensate the power unbalance timely by which the control system can provide enough time for DGA to response to the load disturbance. The architecture of ESA is shown in Fig. <ref type="figure" target="#fig_3">5</ref>.</p><p>4) Agent Management Service Agent: It acts as a white page, maintaining a directory of agents registered within the control system.</p><p>5) Directory Facilitator Agent: It acts as a yellow page, maintaining a directory of agents and the services they can offer other agents.</p><p>The general architectures of AMSA and DFA are illustrated in <ref type="bibr" target="#b28">[29]</ref> and <ref type="bibr" target="#b29">[30]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C. Implementation of Proposed Distributed Coordinated Control</head><p>Energy Internet can be operated under two modes. The first mode is that Energy Internet has no responsibility to connect with MG and can be operated in the isolated mode. In this mode, one of the DGs should be chosen as the leader in the control system. In addition, the leader DG should be controlled to output rated power in order to guarantee its leader information with constant and normal values. The second mode is that Energy Internet should be connected to the MG if necessary; the information from MG should be as the leader information. In this mode, Energy Internet can be operated under the spinning reserve condition with bidirectional power flow to compensate the power disturbance in both MG and Energy Internet. The main difference between the two modes is whether Energy Internet should be connected with the MG. Except for that, other operations of the proposed controller of Energy Internet are same.</p><p>Fig. <ref type="figure" target="#fig_4">6</ref> illustrates the flowchart of the proposed controller combined with the algorithms, task decomposition, and information flow required for the control system.</p><p>Step  This information is embedded in each PDGA which is used to control the local DG. Then, by using the information sent from the SDGAs, the PDGAs can calculate the local control signal according to <ref type="bibr" target="#b42">(43)</ref>. Finally, the amplitudes and angles of voltages can be synchronized with the leader's information thus the circulating current can be effectively minimized and the output power of DGs can be shared in proportion according to <ref type="bibr" target="#b6">(7)</ref> and ( <ref type="formula">8</ref>) and the power unbalance can be compensated effectively. It should be emphasized that not every DGA needs to receive the leader's information because if one DGA can receive the leader information, the other DGAs can produce the reasonable control signal to its own DGs. Thus, Energy Internet can be highly efficient and reliable.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>III. ANALYSIS OF CIRCULATING CURRENT AND DESIGN OF THE PDGA BASED ON NONLINEAR MODEL OF DG</head><p>The control loop, including the power calculation, voltage and current controllers, and second-order generalized integrator, droop control is used to achieve local control about the amplitude and angle of output voltage produced by different DGs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Circulating Current Analysis</head><p>Through the circulating current analysis between DGs in <ref type="bibr" target="#b6">[7]</ref> the circulating current between two parallel connected DG is divided into active circulating and reactive circulating current as 2 İ = I a -jI r</p><p>(1)</p><formula xml:id="formula_0">I a = X 2 k + 4R 2 o R o E 1 sin φ 1 -E 2 sin φ 2 1 A (2) I r = X 2 k + 4R 2 o R o E 1 cos φ 1 -E 2 cos φ 2 1 A (3)</formula><p>where E 1 is output voltage of the first DG, E 2 is output voltage of the second DG, X k1 , X k2 are line parameters between two DGs, R o is the load between two DGs,</p><formula xml:id="formula_1">E 1 = X k2 /R o E 1 and E 2 = X k1 /R o E 2 A = (X k1 + X k2 ) 2 + (X k1 X k2 /R o ) 2 .</formula><p>From ( <ref type="formula">2</ref>) and (3), it can be found that active and reactive circulating currents cannot be effectively eliminated only by controlling the amplitudes or phase angles of the output voltages. Thus, the P-δ and Q-V droops are used to control output voltages amplitudes and angles. In order to mimic the behavior of a synchronous generator, the P-δ droop control represents the linear relationships between active power and angle of output voltage and the Q-V droop control represents the linear relationships between reactive power and amplitude of output voltage.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Design of PDGA Combined With Nonlinear DG Model</head><p>In this paper, dc-bus dynamics can be safely neglected, since a dc-link feed forward loop can be used <ref type="bibr" target="#b31">[32]</ref>. The block diagram of a DG based on a single-phase inverter is presented in Fig. <ref type="figure" target="#fig_5">7</ref>.</p><p>The nonlinear dynamics of DGs are controlled under d-q reference frame. In order to mimic a synchronous generator, the d-axis represents direction of rotor magnetic flux linkage and the q-axis is of 90 • ahead of d-axis. Thus, d-q reference usually forms a rotating orthogonal reference frame used by three-phase DG. However, in this paper, single-phase inverters are considered, so that the inverters output voltage and current should be divided first into α-β components through a second-order generalized integrator, as shown in Fig. <ref type="figure" target="#fig_6">8</ref>  <ref type="bibr" target="#b32">[33]</ref>. To be more specific, the α-β components are the transition reference frame from single-phase reference frame to the d-q reference frame. IEEE TRANSACTIONS ON SMART GRID  The phase of output voltage of one DG δ i can be expressed as</p><formula xml:id="formula_2">δi = ω i . (<label>4</label></formula><formula xml:id="formula_3">)</formula><p>Because the P-δ droop control is used in the system, no frequency deviations would occur under load disturbances.</p><p>The power controller shown in Fig. <ref type="figure" target="#fig_7">9</ref> consists of the second-order generalized integrator, park transformation, phase-locked loop, power calculation, low-pass filter, and droop controller. The power controller can provide the amplitude reference of voltage v * odi for the first stage bridge and the angle reference of output voltage δ * i for the second stage bridge. The differential equations of the active and reactive power can be expressed as</p><formula xml:id="formula_4">Ṗi = -ω ci P i + ω ci v odi i odi + v oqi i oqi 2 (5) Qi = -ω ci Q i + ω ci v odi i oqi -v oqi i odi 2 . (<label>6</label></formula><formula xml:id="formula_5">)</formula><p>The P-δ and Q-V droop controls are presented as</p><formula xml:id="formula_6">δ * i = δ seti -m i P i (7) v * odi = v seti -n i Q i (8) v * oqi = 0. (<label>9</label></formula><formula xml:id="formula_7">)</formula><p>By inserting <ref type="bibr" target="#b6">(7)</ref> and ( <ref type="formula">8</ref>) into ( <ref type="formula">5</ref>) and ( <ref type="formula" target="#formula_4">6</ref>), it yields to</p><formula xml:id="formula_8">Ṗi = ω ci m i δ * i -δ seti + ω ci v odi i odi + v oqi i oqi 2 (10) Qi = ω ci n i v * odi -v seti + ω ci v odi i oqi -v oqi i odi 2 . (<label>11</label></formula><formula xml:id="formula_9">)</formula><p>During the process of our model, the normal control about voltage and current should be included according to <ref type="bibr" target="#b33">[34]</ref>, as shown in Appendix A. From ( <ref type="formula" target="#formula_2">4</ref>), ( <ref type="formula">10</ref>)-( <ref type="formula" target="#formula_8">11</ref>), ( <ref type="formula" target="#formula_39">27</ref>), ( <ref type="formula" target="#formula_42">30</ref>)- <ref type="bibr" target="#b31">(32)</ref>, and ( <ref type="formula" target="#formula_49">35</ref>)- <ref type="bibr" target="#b39">(40)</ref> shown in Appendix A, the model of ith DG can be rewritten into a matrix formation as</p><formula xml:id="formula_10">ẋ = F(x) + gu y = hx (<label>12</label></formula><formula xml:id="formula_11">)</formula><p>where the state vector is</p><formula xml:id="formula_12">x = [δ i , P i , Q i , φ di , φ qi , γ di , γ qi , i ldi , i lqi , v odi , v oqi , i odi , i oqi ].</formula><p>In order to keep the angle δ i and amplitude v oi of the ith DG being synchronized with other DGs, the δ seti and v seti are selected to be the control inputs. Since v oqi is kept to be zero, the amplitude of output voltage is</p><formula xml:id="formula_13">v oi = v odi . (<label>13</label></formula><formula xml:id="formula_14">)</formula><p>Therefore, the inputs of the system are u = [ δ seti v seti ] T and outputs of the system are y = [ δ i v odi ] T . In the next section, the feedback linearization method combined with the multiagent consensus algorithm is used to design the SDGAs.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>IV. DESIGN OF THE SDGA BASED ON MULTIAGENT CONSENSUS ALGORITHM</head><p>In this section, the design of the SDGA based on the multiagent consensus algorithm is proposed by using feedback linearization, which can transform the nonlinear model to the linear model. Each SDGA has two control inputs and two outputs. The consensus problem about angles and amplitudes of output voltages among DGs is the synchronization tracking problem, which needs a leader in the system. The leader information is decided by the energy router. Each SDGA requires only local and its neighbors' information, which can be used to produce the control decision signal. To be more specific, if the leader information in the energy router comes from MG, the Energy Internet can be operated under spinning reserve condition, which means it can be connected to MG and immediately provide power if necessary.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Graph Theory</head><p>The distributed coordinated controller should use a communication network called directed graph, which can be expressed as G r = (V G , E G , A G ) <ref type="bibr" target="#b34">[35]</ref>. The set of nodes in the network can be expressed as V G = {v 1 , v 2 , . . . , v n }, the set of edges can be expressed as E G ⊆ V G × V G , and the weighted adjacency matrix can be expressed as A G = [a ij ] n×n with nonnegative adjacency element a ij . An edge rooted at node j and ended at node i is denoted by (v j , v i ), which means that information can flow from the node j to node i. For a graph with 0-1 adjacency elements, the in-degree and out-degree of node v i are defined as follows:</p><formula xml:id="formula_15">deg in (v i ) = n j=1 a ji , deg out (v i ) = n j=1 a ij . (<label>14</label></formula><formula xml:id="formula_16">)</formula><p>The degree matrix of diagraph G r is a diagonal matrix = [ ij ], where ij = 0 for all i = j and ii = deg out (v i ). The Laplacian matrix associated with the digraph G r is defined as</p><formula xml:id="formula_17">L(G r ) = -A. (<label>15</label></formula><formula xml:id="formula_18">)</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Designation of SDGA</head><p>From the discussion in Section III-B, the δ seti is used as the input to control angles of output voltages among different DGs to track the leader y leader,1 and v seti is used as the input to control the amplitude of output voltage to track the voltage y leader,2 .</p><p>The feedback linearization method can establish the relationship between the control outputs and inputs. For the sake of space, the feedback linearization procedures are shown in Appendix B according to <ref type="bibr" target="#b35">[36]</ref>.</p><p>According to the process in Appendix B, the relative degree should be calculated first. The relative degree of the nonlinear system is <ref type="bibr" target="#b0">[1,</ref><ref type="bibr" target="#b0">1]</ref>. The decoupling matrix is calculated as</p><formula xml:id="formula_19">A i (x) = ω ci δ seti 0 0 ω ci V seti . (<label>16</label></formula><formula xml:id="formula_20">)</formula><p>The matrix A i (x) is nonsingular. The matrix b i (x) is calculated as</p><formula xml:id="formula_21">b i (x) = L f h 1 (x) L f h 2 (x) T (<label>17</label></formula><formula xml:id="formula_22">)</formula><p>where</p><formula xml:id="formula_23">L f h 1 (x) = ω i + ω ci (δ seti -δ * i ) -m i ω ci (v odi i odi + v oqi i oqi )/2 and L f h 2 (x) = ω ci v seti -v * odi + n i ω ci v odi i oqi -v oqi i odi 2 + ω i v oqi + 1 C fi (i ldi -i odi ).</formula><p>From ( <ref type="formula" target="#formula_19">16</ref>) and ( <ref type="formula" target="#formula_21">17</ref>), the control law u i (x) can be calculated as in <ref type="bibr" target="#b42">(43)</ref> (see Appendix B). The v i (x) can be calculated as follows to achieve the synchronization of y i :</p><formula xml:id="formula_24">v i (x) = A i (x)u i (x) + b i (x) (<label>18</label></formula><formula xml:id="formula_25">)</formula><p>where</p><formula xml:id="formula_26">v i = [ v i,1 v i,2 ] T .</formula><p>The nonlinear system can be transformed into the following linear system:</p><formula xml:id="formula_27">ẏi,1 ẏi,2 = 1 0 0 1 v i,1 v i,2<label>(19)</label></formula><p>where y i = [ y i,1 y i,2 ] T , y i,1 = δ i , y i,2 = v odi , and ∀i, B = 1 0 0 1 .</p><p>The nonlinear system ( <ref type="formula" target="#formula_10">12</ref>) is transformed to the linear system ( <ref type="formula" target="#formula_27">19</ref>) by using the well-known feedback linearization method. Note that ( <ref type="formula" target="#formula_27">19</ref>) presents the ith DG linear dynamics.</p><p>The control of angles of output voltage is the tracking synchronization problem with a leader in the system. The aim is to make all the angles be equal to the leader. The tracking error is given by</p><formula xml:id="formula_28">e i,1 = j∈N i a ij y i,1 -y j,1 + ε i,1 y i,1 -y leader,1<label>(20)</label></formula><p>where a ij is the element of adjacency matrix and e i,1 represents the error of angles of output voltage about the ith DG.</p><p>If the node i can receive the leader's angle information and edge (v leader,1 , v i ) is said to exist with weighting gain ε i,1 . The node i with ε i,1 = 1 is used as a pinned and controlled node about angle. The ε i,1 can be written into matrix as</p><formula xml:id="formula_29">E 1 = diag{ε i,1 } ∈ R N×N .</formula><p>The control of amplitude of the output voltage is also the tracking synchronization problem with the system leader. Thus, the tracking error is given as</p><formula xml:id="formula_30">e i,2 = j∈N i a ij y i,2 -y j,2 + ε i,2 y i,2 -y leader,2<label>(21)</label></formula><p>where e i,2 represents the error of amplitudes of output voltage about the ith DG. If the node i can receive the leader's amplitude information and edge (v leader,2 , v i ) is said to exist with weighting gain ε i,2 . The node i with ε i,2 = 1 is used as a pinned and controlled node about amplitude. The ε i,2 can be written into matrix as</p><formula xml:id="formula_31">E 2 = diag{ε i,2 } ∈ R N×N .</formula><p>The errors can be rewritten by using matrixes such as the following:</p><formula xml:id="formula_32">e 1 = (L + E 1 ) Y 1 -Y leader,1<label>(22)</label></formula><formula xml:id="formula_33">e 2 = (L + E 2 ) Y 2 -Y leader,2<label>(23)</label></formula><p>where e 1 = e 1,1 e 2,1  </p><formula xml:id="formula_34">Y 1 = y 1,1 y 2,1 • • • y n,1 T , Y leader,1 = 1 N y leader,1 Y 2 = y 1,2 y 2,2 • • • y n,2</formula><p>T , and Y leader,2 = 1 N y leader,2 .</p><p>The system <ref type="bibr" target="#b18">(19)</ref> can be rewritten as</p><formula xml:id="formula_35">Ẏ1 = I N v 1 Ẏ2 = I N v 2 (<label>24</label></formula><formula xml:id="formula_36">)</formula><p>where</p><formula xml:id="formula_37">v 1 = v 1,1 v 2,1 • • • v n,1 T v 2 = v 1,2 v 2,2 • • • v n,2 T .</formula><p>The relationship between e 1 , e 2 and v 1 , v 2 should be designed in order to keep the system stable with the control input.</p><p>Let the auxiliary control v i,1 and v i,2 be defined as follows:</p><formula xml:id="formula_38">v i,1 = -c 1 k 1 e i,1 v i,2 = -c 2 k 2 e i,2<label>(25)</label></formula><p>where c 1 , c 2 ∈ R is the coupling gain and k 1 , k 2 ∈ R is the feedback control gain. For sake of space, the detailed design process is not included in this paper. Remark 1: According to the IEEE 1547-2003 <ref type="bibr" target="#b36">[37]</ref>, if the amplitudes and angles of output voltages can be kept tracking with the MG, the system can be connected with MG if necessary and provide power, which is called spinning reserved condition. Under this condition, the system can compensate the power unbalance with the help from MG and can also provide the surplus power for MG. Along with the novel distributed coordinated controller ( <ref type="formula" target="#formula_32">22</ref>)-( <ref type="formula" target="#formula_38">25</ref>), Energy Internet can IEEE TRANSACTIONS ON SMART GRID be integrated into the MG seamlessly to provide reserve services at any time to ensure the reliability of the power system as long as the leader information comes from MG. To be specific, from the perspective of power management, the bidirectional power flow between MG and Energy Internet can be achieved to compensate power unbalance in both sides. Then Energy Internet can be operated under spinning reserve condition. From the perspective of control method, the angle and amplitude deviations between MG and Energy Internet are within a small range all the time, thus Energy Internet can be connected to the MG at any time. Furthermore, various methods on the optimization of spinning reserve condition have also been investigated in <ref type="bibr" target="#b37">[38]</ref>- <ref type="bibr" target="#b39">[40]</ref>, which is out of the scope of this paper.</p><p>Remark 2: Microgrids and virtual power plants (VPPs) are two recently proposed concepts. Even though lots of control methods for microgrid have been studied, the framework that may encompass a large number of control methods is not completed yet. It means each new control method needs a new control architecture. Meanwhile, VPPs are used to introduce to energy and CO 2 -reduction markets more aggressively <ref type="bibr" target="#b40">[41]</ref>, in which various power production units can cooperate and behave as a single aggregated unit. The power market in microgrids is introduced by the conception of VPPs <ref type="bibr" target="#b41">[42]</ref>. Compared with the above two conceptions, the control architecture of Energy Internet including energy router and energy switcher is proposed based on multiagent system. Meanwhile, the algorithms applied in each agent are studied in this paper.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>V. SIMULATION RESULTS</head><p>In order to test the proposed approach, a number of simulations under different scenarios have been performed through MATLAB/SIMULINK. The electrical part of the simulation is established through the SIMULINK, meanwhile the control method including the feedback linearization and multiagent consensus algorithm is programmed through the S-function. Different configurations of loads and DGs are considered in this section. Fig. <ref type="figure" target="#fig_9">10</ref> shows the configuration of the Energy Internet test system. In addition, the communication structure between agents is also shown in Fig. <ref type="figure" target="#fig_9">10</ref> by dotted lines. In the system, the DG-1 and DG-2 are connected in series and the DG-3 and DG-4 are connected in parallel. This configuration consists of series and parallel connected DGs, which are common in Energy Internet, thus the simulation results can be more convincing. The system data used for simulation are listed in Table <ref type="table">I in</ref>  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Case 1: Conventional Controller</head><p>In this case, the desired active and reactive ratio of DG-1, DG-2, DG-3, and DG-4 is 1:2:1.33:1.33. To investigate the load sharing with reduced system, DG-4 is disconnected at 0.4 s and the load power is shared by DG-1, DG-2, and DG-3. At 0.7 s, load-4 and load-5 are also disconnected. The three DGs connected to the Energy Internet supply the 30 kW and 28 kVAr load.   It can be seen that the system operation is stable. As shown in Figs. <ref type="figure" target="#fig_10">11</ref> and<ref type="figure" target="#fig_11">12</ref>, the DGs cannot share loads in the desired ratio of 1:2:1.33. The numerical results can be seen in Table <ref type="table">II</ref> in Appendix C. In Table <ref type="table">II</ref>, the output active power and reactive power from four DGs are shown in numerical results and the ratio between each DG output power to DG-1 output power are also shown in Table <ref type="table">II</ref>. The ratios in "()" are desired ratios  between each DG and DG-1. From the numerical results, it can be found that the output power from four DGs are not according to the desired ratios.</p><p>From Figs. 13 and 14, the deviations of the output voltages from different DGs are large. For one thing, from Fig. <ref type="figure" target="#fig_12">13</ref>, at the beginning of the simulation, the angle deviations among four DGs output voltages exist. After 0.4 s, the deviations are becoming larger. For another thing, from Fig. <ref type="figure" target="#fig_13">14</ref>, after 0.4 s, the amplitude deviations between the output voltages are becoming larger. Thus the conventional control method cannot be effective to control the Energy Internet.</p><p>From the above discussion, the deviation angles among the four output currents shown in Fig. <ref type="figure" target="#fig_14">15</ref> are large. According to (1)-( <ref type="formula">3</ref>), the circulating currents between DGs exist very largely in the system. Thus, with big deviations between output voltages, if the Energy Internet need to be connected to the MG, another synchronization algorithm should be added to control the Energy Internet. Thus, through the conventional method, the Energy Internet cannot be operated under the spinning reserve condition. And the big circulating currents in Energy Internet can cause unreliability and low power efficiency of the whole system.  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Case 2: Proposed Controller</head><p>To validate the performance of the proposed controller, the Energy Internet is operated at same situation as described in case 1.</p><p>The proposed controller is started at 0.2 s. From the communication structure, only DG-1's SDGA can receive the MG information from the energy router. The leader's information is shown in Table <ref type="table">I</ref> in Appendix C. The numerical values of power can be seen in Table <ref type="table" target="#tab_6">III</ref> in Appendix C. In Table <ref type="table" target="#tab_6">III</ref>, the output active power and reactive power from four DGs are shown in numerical results and the ratio between each DG output power to DG-1 output power are also shown in Table <ref type="table" target="#tab_6">III</ref>. The ratios in () are desired ratios between each DG and DG-1. Compared with the numerical results in Table <ref type="table">II</ref>, it can be found that the output power-sharing ratios from four DGs are same with the desired ratios. The accuracies about power sharing can be verified.</p><p>Compared with results in case 1, DGs can share the active power and reactive power in the desired ratio as shown in Figs. <ref type="bibr" target="#b15">16</ref>   leader shown in Figs. <ref type="figure" target="#fig_17">18</ref> and<ref type="figure" target="#fig_18">19</ref>. Thus, the amplitude of output currents of four DGs are in desired ratio and the deviation angles between four output currents are very small as shown in Fig. <ref type="figure" target="#fig_19">20</ref>. From ( <ref type="formula">2</ref>) and ( <ref type="formula">3</ref>), the circulating current between DGs can be minimized.</p><p>Furthermore, since both angles and amplitudes of DGs output voltages in the Energy Internet can be controlled to reach consensus with the MG information due to the proposed method. With enough energy storage, the Energy Internet can be operated under spinning reserve condition.</p><p>Remark 3: Since large circulating currents in the Energy Internet can cause large unnecessary power losses, to reduce the circulating current can effectively decrease power losses in the Energy Internet.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>VI. COMPARISON BETWEEN THE PROPOSED DISTRIBUTED APPROACH WITH THE CENTRALIZED APPROACH</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A. Comparison About Computational Power</head><p>When a centralized controller is used, all the system information should be communicated to the central unit. With the increasing number of DGs and other energy sources,  the communication burden may increase due to the additional variables and constraints. Meanwhile, the computation time of such a central controller is highly dependent on the number of devices in the control system. Thus, large communication delays may occur in the system which may cause serious negative influence on the stability and system performances, thus reducing the system scalability drastically.</p><p>By comparison, in proposed controller, there is no centralized controller in the system and communication load for each controller is uncorrelated with the increasing number of controllers in the system. Since the multiagent consensus algorithm is applied in this paper, each controller needs only its local information and at least one of its neighbors' information. Thus, each controller's computation load is nearly constant when controllers are added or removed from the control system.</p><p>The same results about the comparison of the computational power between distributed controller and centralized controller can be also found in <ref type="bibr" target="#b19">[20]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B. Comparison With the Performance, Resilience, and Scalability</head><p>When the system does not present faults, the performances between distributed or centralized controllers are almost equal.</p><p>Indeed the centralized controller gives all the local DGs the same control signal, while the distributed controller make control decision of each DG according to its neighbors information. Thus, the response speed of the distributed controller can be faster than that of centralized controller.</p><p>Under fault conditions, if the centralized controller fails down, the whole system will lose the control and may become unstable. By comparison, once one distributed controller fails down, it cannot cause serious influence on the whole system. The reason of this is that each controller needs only its local and neighbors' information based on sparse communication structure. Furthermore, if this controller cannot be recovered in a short time, we can disconnect it to maintain the stability of the whole system. However, if the centralized controller cannot be recovered timely, it may not be possible to maintain stable operation. The stability about multiagent consensus algorithm considering switching topology has been proved in several previous works like those in <ref type="bibr" target="#b42">[43]</ref> and <ref type="bibr" target="#b43">[44]</ref>. In the future, this algorithm may be extended to the distributed controllers. Thus, resilience of the distributed controller can be much better than the centralized controller one.</p><p>Based on the proposed algorithm combined with the multiagent system, the distributed controller in this paper is still open for improvement, because several conditions are not included in this paper. Section VIII discusses some possibilities of improvement for reference to the interested reader. Meanwhile, the scale of the distributed system can be enlarged without communication limits, computation limits, and algorithm limits. By comparison, the scale of the centralized controller is limited by its communication and computation ability. Thus, the scalability of distributed controller is much higher than that of centralized controller.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>VII. CONCLUSION</head><p>The control issues of in Energy Internet were investigated in this paper. The multiagent consensus algorithm and multiagent system architecture are combined to design the control structure and control method applied in Energy Internet. The decomposed tasks, established and transformed model, and information flow for each agent are studied. The benefits of this paper are as follows.</p><p>1) The combination of multiagent system and multiagent consensus algorithm will provide an infrastructure for future research used in Energy Internet.</p><p>2) The circulating current reduction in Energy Internet and proportional power-sharing to the desired ratio among DGs can be guaranteed by combining with the P-δ and Q-V controllers and multiagent consensus algorithms.</p><p>3) The output voltages in Energy Internet can be recovered while being synchronized with the leader information from MG, which means the Energy Internet can operate as spinning reserve system. 4) For daily life, with sparse communication systems and bidirectional power flows, Energy Internet provides customers a reliable and efficient power supply, while minimizing energy costs and providing the different types of renewable energy resources the possibility to plug-in/out at any time.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>VIII. FUTURE WORK</head><p>Future work will consist of, but will not be limited to, the following aspects.</p><p>1) The cost and location elements should be considered when the proposed algorithm decides the power sharing in Energy Internet. In this paper, the power sharing between different DGs base only on their rated power, but in practical the economic element is another important index. Meanwhile, the power market should be studied in Energy Internet in order to make the system operated more economical.</p><p>2) The changes of communication topology should be considered in the future. In this paper, the communication topology in the control system is kept constant. In the future, the switching topology multiagent consensus algorithm should be applied in the control system. With this application, the comparison about resilience between distributed controller and centralized controller could be more obvious.</p><p>3) The cost about hardware during the process of designation should be considered in the future. In this paper, the cost about hardware between distributed controller and centralized controller are not compared which can illustrate benefits about distributed controller furthermore. 4) In this paper, we introduce a little about the energy storage without its control strategy. Because the energy storage is very important under some extremely conditions, the control strategy for energy storage should be studied based on the proposed control architecture in the future.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>APPENDIX A</head><p>The block diagram of the voltage and current controller is shown in Fig. <ref type="figure" target="#fig_20">21</ref>. </p><formula xml:id="formula_39">)<label>27</label></formula><p>The outputs of the voltage controller are presented as</p><formula xml:id="formula_40">i * ldi = Fi odi -ω f C f v oqi + k pVodi v * odi -v odi + k iVodi φ odi (28) i * lqi = Fi oqi -ω f C f v odi + k pVoqi v * oqi -v oqi + k iVoqi φ oqi . (<label>29</label></formula><formula xml:id="formula_41">) IEEE TRANSACTIONS ON SMART GRID</formula><p>In addition, inserting (8) into <ref type="bibr" target="#b25">(26)</ref>, we obtain</p><formula xml:id="formula_42">φodi = v seti -n i Q i -v odi . (<label>30</label></formula><formula xml:id="formula_43">)</formula><p>The differential equations of the current controller are presented as</p><formula xml:id="formula_44">γdi = i * ldi -i ldi (31) γqi = i * lqi -i lqi . (<label>32</label></formula><formula xml:id="formula_45">)</formula><p>The outputs of the current controller are presented as</p><formula xml:id="formula_46">v * idi = -ω f L f i lqi + k pildi i * ldi -i ldi + k iildi γ di (<label>33</label></formula><formula xml:id="formula_47">) v * iqi = ω f L f i ldi + k pilqi i * lqi -i lqi + k iilqi γ qi . (<label>34</label></formula><formula xml:id="formula_48">)</formula><p>Fig. <ref type="figure" target="#fig_1">2</ref> shows that the connection between inverters are inductive. The differential equations for the output LCL filter L fi and C fi and the output inductor L Ci are expressed as follows:</p><formula xml:id="formula_49">ildi = - R fi L fi i ldi + ω i i lqi + 1 L fi (v idi -v odi ) (<label>35</label></formula><formula xml:id="formula_50">) ilqi = - R fi L fi i lqi -ω i i ldi + 1 L fi v iqi -v oqi (<label>36</label></formula><formula xml:id="formula_51">) vodi = ω i v oqi + 1 C fi (i ldi -i odi ) (37) voqi = -ω i v odi + 1 C fi i lqi -i oqi (<label>38</label></formula><formula xml:id="formula_52">) iodi = ω i i oqi + 1 L ci (v odi -v bdi ) (39) ioqi = -ω i i odi + 1 L ci v oqi -v bqi . (<label>40</label></formula><formula xml:id="formula_53">)</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>APPENDIX B</head><p>The process of establishing the relationship in multi-input and multi-output (MIMO) nonlinear system described in <ref type="bibr" target="#b11">(12)</ref> is explained below.</p><p>First, the relative degree [r 1 , r 2 , . . . , r m ] should be calculated.</p><p>Second, according to the relative degree, a decoupling matrix A(x) which should be nonsingular should be calculated as given in <ref type="bibr" target="#b40">(41)</ref>, another vector b(x) should be calculated at the same time as in <ref type="bibr" target="#b41">(42)</ref>. In <ref type="bibr" target="#b40">(41)</ref> and <ref type="bibr" target="#b41">(42)</ref>, L f h i (x) is the Lie derivative of h i (x) with respect to f and is defined as</p><formula xml:id="formula_54">L f h i (x) = (∂(h i )/∂x i )f A(x) = ⎛ ⎜ ⎜ ⎝ L g 1 L r 1 -1 f h 1 (x) . . . L g m L r 1 -1 f h 1 (x) . . . . . . L g 1 L r 1 -1 f h m (x) • • • L g m L r 1 -1 f h m (x) ⎞ ⎟ ⎟ ⎠ (41) b(x) = L r 1 f h 1 (x) • • • L r m f h m (x) T . (<label>42</label></formula><formula xml:id="formula_55">)</formula><p>Third, based on the defined relative degree, the control law of an MIMO nonlinear system is defined as</p><formula xml:id="formula_56">u(x) = A -1 (x)[-b(x) + v(x)] (<label>43</label></formula><formula xml:id="formula_57">)</formula><p>where</p><formula xml:id="formula_58">v(x) = [v 1 • • • v m ] T = [y (r 1 ) 1 • • • y (r m ) m ] T .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>APPENDIX C</head><p>See Tables I-III.  </p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 .</head><label>1</label><figDesc>Fig. 1. Architecture of the Energy Internet.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Fig. 2 .</head><label>2</label><figDesc>Fig. 2. Reference architecture of multiagent system.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Fig. 4 .</head><label>4</label><figDesc>Fig. 4. Architecture of DGA.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Fig. 5 .</head><label>5</label><figDesc>Fig. 5. Architecture of ESA.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>Fig. 6 .</head><label>6</label><figDesc>Fig. 6. Flowchart of the proposed controller for Energy Internet based on multiagent system.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Fig. 7 .</head><label>7</label><figDesc>Fig. 7. Block diagram of a DG based on a single-phase inverter.</figDesc><graphic coords="6,55.49,53.56,237.84,116.64" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Fig. 8 .</head><label>8</label><figDesc>Fig. 8. Second-order generalized integrator.</figDesc><graphic coords="6,75.49,202.40,198.00,92.76" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head>Fig. 9 .</head><label>9</label><figDesc>Fig. 9. Block diagram of power controller.</figDesc><graphic coords="6,313.00,53.12,249.60,79.08" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head></head><label></label><figDesc>Appendix C. The numerical values of simulation results are shown in Tables II and III in Appendix C.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Fig. 10 .</head><label>10</label><figDesc>Fig. 10. Configuration of the Energy Internet test system.</figDesc><graphic coords="8,319.50,235.99,236.16,182.64" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Fig. 11 .</head><label>11</label><figDesc>Fig. 11. Active power sharing in case 1.</figDesc><graphic coords="8,313.00,452.39,248.64,178.68" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head>Fig. 12 .</head><label>12</label><figDesc>Fig. 12. Reactive power sharing in case 1.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head>Fig. 13 .</head><label>13</label><figDesc>Fig. 13. Angles of output voltages from four DGs in case 1.</figDesc><graphic coords="9,51.99,52.88,245.04,184.32" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_13"><head>Fig. 14 .</head><label>14</label><figDesc>Fig. 14. Per unit value of output voltages from four DGs in case 1.</figDesc><graphic coords="9,53.49,272.55,242.16,167.16" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_14"><head>Fig. 15 .</head><label>15</label><figDesc>Fig. 15. Output current in case 1.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_15"><head>Fig. 16 .</head><label>16</label><figDesc>Fig. 16. Active power sharing in case 2.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_16"><head></head><label></label><figDesc>Fig. 17. Reactive power sharing in case 2.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_17"><head>Fig. 18 .</head><label>18</label><figDesc>Fig. 18. Angles of output voltages from 4 DGs in case 2.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_18"><head>Fig. 19 .</head><label>19</label><figDesc>Fig. 19. Per unit value of output voltages from 4 DGs in case 2.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_19"><head>Fig. 20 .</head><label>20</label><figDesc>Fig. 20. Output current in case 2.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_20"><head>Fig. 21 .</head><label>21</label><figDesc>Fig. 21. Block diagram of the voltage and current controller.The differential equations of the voltage controller are presented asφodi = v * odiv odi (26) φoqi = v * oqiv oqi . (27)    </figDesc><graphic coords="11,313.51,516.46,248.40,86.52" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head></head><label></label><figDesc>A Multiagent-Based Consensus Algorithm for Distributed Coordinated Control of Distributed Generators in the Energy Internet Qiuye Sun, Member, IEEE, Renke Han, Huaguang Zhang, Fellow, IEEE, Jianguo Zhou, and Josep M. Guerrero, Fellow, IEEE</figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head></head><label></label><figDesc>Angular velocity of DG to represent the frequency. v odi d-axis output voltage components for DG. v oqi q-axis output voltage components for DG. Voltage-reactive droop parameter for DG.δ seti Set value of angle-active droop control for DG. v seti Set value of voltage-reactive droop control for DG.</figDesc><table><row><cell></cell><cell>ω ci</cell><cell>Cutoff frequency of power filter.</cell></row><row><cell></cell><cell>m i</cell><cell>Angle-active droop parameter for DG.</cell></row><row><cell></cell><cell>n i</cell></row><row><cell></cell><cell>δ  *  i v  *  odi</cell><cell>Reference of voltage angle for DG. d-axis reference of voltage amplitude in the voltage</cell></row><row><cell></cell><cell></cell><cell>controller for DG.</cell></row><row><cell></cell><cell>v  *  oqi</cell></row><row><cell>I</cell><cell>Total circulating current.</cell></row><row><cell>i</cell><cell>Number of DG.</cell></row><row><cell>δ i</cell><cell>Angle of voltage from DG.</cell></row><row><cell>ω i</cell><cell></cell></row><row><cell>i odi</cell><cell>d-axis output voltage components for DG.</cell></row><row><cell>i oqi</cell><cell>q-axis output current components for DG.</cell></row><row><cell>P i</cell><cell>Average active power for DG.</cell></row><row><cell>Q i</cell><cell>Average reactive power for DG.</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6"><head>TABLE III NUMERICAL</head><label>III</label><figDesc>RESULTS OFCASE 2   </figDesc><table /></figure>
		</body>
		<back>

			<div type="funding">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>This work was supported in part by the National Natural Science Foundation of China under Grant 61203086 and Grant 61433004, and in part by the Fundamental Research Funds for the Central Universities under Grant N140402001. Paper no. TSG-00676-2014.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Qiuye Sun (M'11) received the B.S. degree in power system and automation from the Northeast Dianli University of China, Jilin, China, in 2000, and the M.S. degree in power electronics and drives, and the Ph.D. degree in control theory and control engineering from Northeastern University, Shenyang, China, in 2004 and 2007, respectively.</p><p>Since 2014, he has been a Full Professor with the School of Information Science and Engineering, Northeastern University. His current research interests include optimization and control of smart grid, network control of distributed generation system, microgrids, and Energy Internet. He has authored and co-authored over 280 journal and conference papers and six monographs, and has co-invented 90 patents.</p><p>Renke Han was born in Anshan, China, in 1991. He received the B.S. degree in automation from Northeastern University, Shenyang, China, in 2013, where he is currently pursuing the M.S. degree in control theory and control engineering.</p><p>His current research interests include network control, hierarchical and distributed coordinated control, and power flow management strategy in microgrid, and Energy Internet. His current research interests include power electronics, hierarchical and distributed cooperative control, power quality improvement of microgrids, synchronization of complex/multiagent networks and their applications in microgrids, and Energy Internet. </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">The future renewable electric energy delivery and management system: The Energy Internet</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">Q</forename><surname>Huang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">L</forename><surname>Crow</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><forename type="middle">T</forename><surname>Heydt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">P</forename><surname>Zheng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">J</forename><surname>Dale</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE</title>
		<meeting>IEEE</meeting>
		<imprint>
			<date type="published" when="2011-01">Jan. 2011</date>
			<biblScope unit="volume">99</biblScope>
			<biblScope unit="page" from="133" to="148" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<analytic>
		<title level="a" type="main">System integration and hierarchical power management strategy for a solid-state transformer interfaced microgrid system</title>
		<author>
			<persName><forename type="first">X</forename><surname>Yu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>She</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Ni</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">Q</forename><surname>Huang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Electron</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="4414" to="4425" />
			<date type="published" when="2014-08">Aug. 2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Power management for DC microgrid enabled by solid-state transformer</title>
		<author>
			<persName><forename type="first">X</forename><surname>Yu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>She</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Zhou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">Q</forename><surname>Huang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Smart Grid</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="954" to="965" />
			<date type="published" when="2014-03">Mar. 2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Control of parallel connected inverters in standalone AC supply systems</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">C</forename><surname>Chandorkar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">M</forename><surname>Divan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Adapa</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Ind. Appl</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="136" to="143" />
			<date type="published" when="1993-02">Jan./Feb. 1993</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Hybrid three-phase/single-phase microgrid architecture with power management capabilities</title>
		<author>
			<persName><forename type="first">Q</forename><surname>Sun</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Zhou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Guerrero</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Zhang</surname></persName>
		</author>
		<idno type="DOI">10.1109/TPEL.2014.2379925</idno>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Electron., to be published</title>
		<imprint/>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Analysis and mitigation of voltage offsets in multi-inverter microgrids</title>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">V</forename><surname>Iyer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">N</forename><surname>Belur</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">C</forename><surname>Chandorkar</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Energy Convers</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="354" to="363" />
			<date type="published" when="2011-03">Mar. 2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Circulating current minimization in high-frequency AC power distribution architecture with multiple inverter modules operated in parallel</title>
		<author>
			<persName><forename type="first">Z</forename><surname>Ye</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">K</forename><surname>Jain</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">C</forename><surname>Sen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Ind. Electron</title>
		<imprint>
			<biblScope unit="volume">54</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="2673" to="2687" />
			<date type="published" when="2007-10">Oct. 2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Hierarchical control of droop-controlled AC and DC microgrids-A general approach toward standardization</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Guerrero</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">C</forename><surname>Vasquez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Matas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">G</forename><surname>De Vicuna</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Castilla</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Ind. Electron</title>
		<imprint>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="158" to="172" />
			<date type="published" when="2011-01">Jan. 2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">An accurate power control strategy for power-electronics-interfaced distributed generation units operating in a low-voltage multibus microgrid</title>
		<author>
			<persName><forename type="first">Y</forename><forename type="middle">W</forename><surname>Li</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C.-N</forename><surname>Kao</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Electron</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="2977" to="2988" />
			<date type="published" when="2009-12">Dec. 2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Distributed adaptive voltage control of inverter-based microgrids</title>
		<author>
			<persName><forename type="first">A</forename><surname>Bidram</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Davoudi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">L</forename><surname>Lewis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">S</forename><surname>Ge</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Energy Convers</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="862" to="872" />
			<date type="published" when="2014-12">Dec. 2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Control of distributed uninterruptible power supply systems</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Guerrero</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Hang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Uceda</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Ind. Electron</title>
		<imprint>
			<biblScope unit="volume">55</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="2845" to="2859" />
			<date type="published" when="2008-08">Aug. 2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Hierarchical control of parallel AC-DC converter interfaces for hybrid microgrids</title>
		<author>
			<persName><forename type="first">X</forename><surname>Lu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Smart Grid</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="683" to="692" />
			<date type="published" when="2014-03">Mar. 2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Secondary control scheme for voltage unbalance compensation in an islanded droop-controlled microgrid</title>
		<author>
			<persName><forename type="first">M</forename><surname>Savaghebi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Jalilian</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">C</forename><surname>Vasquez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Guerrero</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Smart Grid</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="797" to="807" />
			<date type="published" when="2014-03">Mar. 2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Distributed cooperative optimal control for multiagent systems on directed graphs: An inverse optimal approach</title>
		<author>
			<persName><forename type="first">H</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Feng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Liang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Cybern</title>
		<imprint/>
	</monogr>
	<note>to be published</note>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Leader-based optimal coordination control for the consensus problem of multi-agent differential games via fuzzy adaptive dynamic programming</title>
		<author>
			<persName><forename type="first">H</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Luo</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Fuzzy Syst</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="152" to="163" />
			<date type="published" when="2015-02">Feb. 2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Operation of a multiagent system for microgrid control</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">L</forename><surname>Dimeas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">D</forename><surname>Hatziargyriou</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Syst</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="1447" to="1455" />
			<date type="published" when="2005-08">Aug. 2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Coordination of the charging of electric vehicles using a multiagent system</title>
		<author>
			<persName><forename type="first">P</forename><surname>Papadopoulos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Jenkins</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">M</forename><surname>Cipcigan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><surname>Grau</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Zabala</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Smart Grid</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1802" to="1809" />
			<date type="published" when="2013-12">Dec. 2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">A multi-agent system for controlled charging of a large population of electric vehicles</title>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">L</forename><surname>Karfopoulos</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">D</forename><surname>Hatziargyriou</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Syst</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="1196" to="1204" />
			<date type="published" when="2013-05">May 2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Distributed cooperative secondary control of microgrids using feedback linearization</title>
		<author>
			<persName><forename type="first">A</forename><surname>Bidram</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Davoudi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">L</forename><surname>Lewis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Guerrero</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Syst</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="3462" to="3470" />
			<date type="published" when="2013-08">Aug. 2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Decentralized multi-agent system-based cooperative frequency control for autonomous microgrid with communication constraints</title>
		<author>
			<persName><forename type="first">W</forename><surname>Liu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Sustain. Energy</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="446" to="456" />
			<date type="published" when="2014-04">Apr. 2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Design and analysis of the droop control method for parallel inverters considering the impact of the complex impedance on the power sharing</title>
		<author>
			<persName><forename type="first">W</forename><surname>Yao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Chen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Matas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Guerrero</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><forename type="middle">M</forename><surname>Qian</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Ind. Electron</title>
		<imprint>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="576" to="588" />
			<date type="published" when="2011-02">Feb. 2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<monogr>
		<title level="m" type="main">Applied Nonlinear Control</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">E</forename><surname>Slotine</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W</forename><surname>Li</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2009">2009</date>
			<publisher>Prentice-Hall</publisher>
			<pubPlace>Upper Saddle River, NJ, USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<monogr>
		<title level="m" type="main">Adaptive Dynamic Programming for Control-Algorithms and Stability</title>
		<author>
			<persName><forename type="first">H</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Luo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Wang</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2013">2013</date>
			<publisher>Springer</publisher>
			<pubPlace>New York, NY, USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Spinning reserve estimation in microgrids</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">Q</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">B</forename><surname>Gooi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Syst</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="1164" to="1174" />
			<date type="published" when="2011-08">Aug. 2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<monogr>
		<title level="m" type="main">What is Spinning Reserve?</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Rebours</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">S</forename><surname>Kirschen</surname></persName>
		</author>
		<ptr target="http://eee.dev.ntweb.mcc.ac.uk/research/groups/eeps/publications/reportstheses/aoe/reboursetal_techrep_2005A.pdf" />
		<imprint>
			<date type="published" when="2005">2005</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Distributed coordination of Internet data centers under multiregional electricity markets</title>
		<author>
			<persName><forename type="first">L</forename><surname>Rao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">X</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">D</forename><surname>Ilic</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Liu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE</title>
		<meeting>IEEE</meeting>
		<imprint>
			<date type="published" when="2012-01">Jan. 2012</date>
			<biblScope unit="volume">100</biblScope>
			<biblScope unit="page" from="269" to="282" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Microgrids: Hierarchical control and overview of the control and reserve management strategies</title>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">L</forename><surname>Vandoorn</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">C</forename><surname>Vasquez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">D</forename><surname>Kooning</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Guerrero</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Vandevelde</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Ind. Electron. Mag</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="42" to="55" />
			<date type="published" when="2013-12">Dec. 2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">The provision of frequency control reserves from multiple microgrids</title>
		<author>
			<persName><forename type="first">C</forename><surname>Yuen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Oudalov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Timbus</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Ind. Electron</title>
		<imprint>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="173" to="183" />
			<date type="published" when="2011-01">Jan. 2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Applying multi-agent system technology in practice: Automated management and analysis of SCADA and digital fault recorder data</title>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">M</forename><surname>Davidson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">D J</forename><surname>Mcarthur</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">R</forename><surname>Mcdonald</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><surname>Cumming</surname></persName>
		</author>
		<author>
			<persName><forename type="first">I</forename><surname>Watt</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Syst</title>
		<imprint>
			<biblScope unit="volume">21</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="559" to="567" />
			<date type="published" when="2006-08">Aug. 2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">A multiagent architecture for protection engineering diagnostic assistance</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">A</forename><surname>Hossack</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Menal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">D J</forename><surname>Mcarthur</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">R</forename><surname>Mcdonald</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Syst</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="639" to="647" />
			<date type="published" when="2003-05">May 2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">The Gaia methodology for agent-oriented analysis and design</title>
		<author>
			<persName><forename type="first">M</forename><surname>Wooldridge</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">R</forename><surname>Jennings</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Kinny</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Auton. Agents Multi-Agent Syst</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="285" to="312" />
			<date type="published" when="2000">2000</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Modeling, analysis, and design of stationary-reference-frame droop-controlled parallel three-phase voltage source inverters</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">C</forename><surname>Vasquez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Guerrero</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Savaghebi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Eloy-Garcia</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Teodorescu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Ind. Electron</title>
		<imprint>
			<biblScope unit="volume">60</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1271" to="1280" />
			<date type="published" when="2013-04">Apr. 2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">A new single-phase PLL structure based on second order generalized integrator</title>
		<author>
			<persName><forename type="first">M</forename><surname>Ciobotaru</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Teodorescu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Blaabjerg</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. IEEE Power Electron. Spec. Conf</title>
		<meeting>IEEE Power Electron. Spec. Conf<address><addrLine>Jeju, Korea</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2006">2006</date>
			<biblScope unit="page" from="1" to="6" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">Modeling, analysis and testing of autonomous operation of an inverter-based microgrid</title>
		<author>
			<persName><forename type="first">N</forename><surname>Pogaku</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Prodanovic</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T</forename><forename type="middle">C</forename><surname>Green</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Electron</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="613" to="625" />
			<date type="published" when="2007-03">Mar. 2007</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Algebraic Graph Theory</title>
		<author>
			<persName><forename type="first">C</forename><surname>Godsil</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Royle</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="s">Graduate Texts in Mathematics</title>
		<imprint>
			<biblScope unit="volume">207</biblScope>
			<date type="published" when="2001">2001</date>
			<publisher>Springer</publisher>
			<pubPlace>New York, NY, USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title/>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">L</forename><surname>Lewis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><forename type="middle">L</forename><surname>Syrmos</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Optimal Control</title>
		<imprint>
			<date type="published" when="1995">1995</date>
			<publisher>Wiley</publisher>
			<pubPlace>Hoboken, NJ, USA</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<monogr>
		<title level="m" type="main">Standard for Interconnecting Distributed Resources With Electric Power System[S], IEEE Standard 1547</title>
		<imprint>
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">Incorporating demand response with spinning reserve to realize an adaptive frequency restoration plan for system contingencies</title>
		<author>
			<persName><forename type="first">L.-R</forename><surname>Chang-Chien</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">N</forename><surname>An</surname></persName>
		</author>
		<author>
			<persName><forename type="first">T.-W</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W.-J</forename><surname>Lee</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Smart Grid</title>
		<imprint>
			<biblScope unit="volume">3</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="1145" to="1153" />
			<date type="published" when="2012-09">Sep. 2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title level="a" type="main">Probabilistic spinning reserve provision model in multi-control zone power system</title>
		<author>
			<persName><forename type="first">A</forename><surname>Ahmadi-Khatir</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Bozorg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Cherkaoui</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Syst</title>
		<imprint>
			<biblScope unit="volume">28</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="2819" to="2829" />
			<date type="published" when="2013-08">Aug. 2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title level="a" type="main">Optimizing spinning reserve requirement of power system with carbon capture plants</title>
		<author>
			<persName><forename type="first">S</forename><surname>Lou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Lu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Y</forename><surname>Wu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">S</forename><surname>Kirschen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Power Syst</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="1056" to="1063" />
			<date type="published" when="2015-03">Mar. 2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title level="a" type="main">Agent based control of virtual power plants</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">L</forename><surname>Dimeas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">D</forename><surname>Hatziargyriou</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proc. Int. Conf</title>
		<meeting>Int. Conf<address><addrLine>Toki Messe, Japan</addrLine></address></meeting>
		<imprint>
			<date type="published" when="2007-01">Jan. 2007</date>
			<biblScope unit="page" from="1" to="6" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<analytic>
		<title level="a" type="main">Microgrids in active network management-Part I: Hierarchical control, energy storage, virtual power plants, and market participation</title>
		<author>
			<persName><forename type="first">O</forename><surname>Palizban</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Kauhaniemi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">M</forename><surname>Guerrero</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Renew. Sustain. Energy Rev</title>
		<imprint>
			<biblScope unit="volume">36</biblScope>
			<biblScope unit="page" from="428" to="439" />
			<date type="published" when="2014-08">Aug. 2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<analytic>
		<title level="a" type="main">Consensus in multi-agent systems with coupling delays and switching topology</title>
		<author>
			<persName><forename type="first">U</forename><surname>Munz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Papachristodoulou</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Allgower</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Autom. Control</title>
		<imprint>
			<biblScope unit="volume">56</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="2976" to="2982" />
			<date type="published" when="2011-12">Dec. 2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title level="a" type="main">Stationary consensus of asynchronous discrete-time second-order multi-agent systems under switching topology</title>
		<author>
			<persName><forename type="first">J</forename><surname>Qin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Yu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Hirche</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE Trans. Ind. Informat</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="986" to="994" />
			<date type="published" when="2012-11">Nov. 2012</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
