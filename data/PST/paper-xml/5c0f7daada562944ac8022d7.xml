<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">Renewing Felsenstein&apos;s phylogenetic bootstrap in the era of big data</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
				<date type="published" when="2017-06">June 2017</date>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">F</forename><surname>Lemoine</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution" key="instit1">Unité Bioinformatique Evolutive</orgName>
								<orgName type="institution" key="instit2">Institut Pasteur &amp; CNRS</orgName>
								<address>
									<postCode>C3BI USR 3756</postCode>
									<settlement>Paris</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
							<affiliation key="aff1">
								<orgName type="laboratory">Hub Bioinformatique et Biostatistique</orgName>
								<orgName type="institution">Institut Pasteur &amp; CNRS</orgName>
								<address>
									<postCode>C3BI USR 3756</postCode>
									<settlement>Paris</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">J.-B</forename><surname>Domelevo Entfellner</surname></persName>
							<affiliation key="aff2">
								<orgName type="department">Department of Computer Science</orgName>
								<orgName type="institution">University of the Western Cape</orgName>
								<address>
									<settlement>Cape Town</settlement>
									<country key="ZA">South Africa</country>
								</address>
							</affiliation>
							<affiliation key="aff3">
								<orgName type="laboratory">South African MRC Bioinformatics Unit</orgName>
								<orgName type="institution" key="instit1">South African National Bioinformatics Institute</orgName>
								<orgName type="institution" key="instit2">University of the Western Cape</orgName>
								<address>
									<settlement>Cape Town</settlement>
									<country key="ZA">South Africa</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><surname>Wilkinson</surname></persName>
							<affiliation key="aff4">
								<orgName type="department" key="dep1">KwaZulu-Natal Research Innovation and Sequencing Platform (KRISP)</orgName>
								<orgName type="department" key="dep2">School of Laboratory Medicine and Medical Sciences</orgName>
								<orgName type="department" key="dep3">College of Health Sciences</orgName>
								<orgName type="institution">University of KwaZulu-Natal</orgName>
								<address>
									<settlement>Durban</settlement>
									<country key="ZA">South Africa</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">D</forename><surname>Correia</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution" key="instit1">Unité Bioinformatique Evolutive</orgName>
								<orgName type="institution" key="instit2">Institut Pasteur &amp; CNRS</orgName>
								<address>
									<postCode>C3BI USR 3756</postCode>
									<settlement>Paris</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">M</forename><surname>Dávila</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution" key="instit1">Unité Bioinformatique Evolutive</orgName>
								<orgName type="institution" key="instit2">Institut Pasteur &amp; CNRS</orgName>
								<address>
									<postCode>C3BI USR 3756</postCode>
									<settlement>Paris</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><surname>De Oliveira</surname></persName>
							<affiliation key="aff4">
								<orgName type="department" key="dep1">KwaZulu-Natal Research Innovation and Sequencing Platform (KRISP)</orgName>
								<orgName type="department" key="dep2">School of Laboratory Medicine and Medical Sciences</orgName>
								<orgName type="department" key="dep3">College of Health Sciences</orgName>
								<orgName type="institution">University of KwaZulu-Natal</orgName>
								<address>
									<settlement>Durban</settlement>
									<country key="ZA">South Africa</country>
								</address>
							</affiliation>
							<affiliation key="aff5">
								<orgName type="laboratory">Centre for the AIDS Programme of Research in South Africa (CAPRISA)</orgName>
								<orgName type="institution">University of KwaZulu-Natal</orgName>
								<address>
									<settlement>Durban</settlement>
									<country key="ZA">South Africa</country>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">&amp;</forename><forename type="middle">O</forename><surname>Gascuel</surname></persName>
							<affiliation key="aff0">
								<orgName type="institution" key="instit1">Unité Bioinformatique Evolutive</orgName>
								<orgName type="institution" key="instit2">Institut Pasteur &amp; CNRS</orgName>
								<address>
									<postCode>C3BI USR 3756</postCode>
									<settlement>Paris</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
							<affiliation key="aff6">
								<orgName type="laboratory" key="lab1">Méthodes et Algorithmes pour la Bioinformatique</orgName>
								<orgName type="laboratory" key="lab2">UMR 5506</orgName>
								<orgName type="institution" key="instit1">LIRMM</orgName>
								<orgName type="institution" key="instit2">Université de Montpellier &amp; CNRS</orgName>
								<address>
									<settlement>Montpellier</settlement>
									<country key="FR">France</country>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">Renewing Felsenstein&apos;s phylogenetic bootstrap in the era of big data</title>
					</analytic>
					<monogr>
						<imprint>
							<date type="published" when="2017-06">June 2017</date>
						</imprint>
					</monogr>
					<idno type="MD5">53961E3268A8879C15E6C4C04B1F2023</idno>
					<idno type="DOI">10.1038/s41586-018-0043-0</idno>
					<note type="submission">Received: 23 June 2017; Accepted: 1 March 2018;</note>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.3" ident="GROBID" when="2023-07-28T14:11+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Felsenstein's application of the bootstrap method to evolutionary trees is one of the most cited scientific papers of all time. The bootstrap method, which is based on resampling and replications, is used extensively to assess the robustness of phylogenetic inferences. However, increasing numbers of sequences are now available for a wide variety of species, and phylogenies based on hundreds or thousands of taxa are becoming routine. With phylogenies of this size Felsenstein's bootstrap tends to yield very low supports, especially on deep branches. Here we propose a new version of the phylogenetic bootstrap in which the presence of inferred branches in replications is measured using a gradual 'transfer' distance rather than the binary presence or absence index used in Felsenstein's original version. The resulting supports are higher and do not induce falsely supported branches. The application of our method to large mammal, HIV and simulated datasets reveals their phylogenetic signals, whereas Felsenstein's bootstrap fails to do so.</p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>The bootstrap method is a widely used statistical approach to study the robustness, bias and variability of numerical estimates <ref type="bibr" target="#b0">1,</ref><ref type="bibr" target="#b1">2</ref> . It involves resampling with replacement from the original dataset to obtain replications of the original estimate and then, typically, computing the variance and distribution of this estimate. In 1985, Joseph Felsenstein proposed the use of the bootstrap to assess the robustness, or repeatability, of phylogenetic trees <ref type="bibr" target="#b2">3</ref> . Given a sequence alignment and a reference tree inferred from it, the procedure is: (i) resample, with replacement, the sites of the alignment to obtain pseudo-alignments of the same length, (ii) infer pseudo-trees using the same inference method and (iii) measure the support of every branch in the reference tree as the proportion of pseudo-trees containing that branch. The usefulness, simplicity and interpretability of this method has made it extremely popular in evolutionary studies, to the point that it is generally required for publication of tree estimates in a wide variety of domains (molecular biology, genomics, systematics, ecology, epidemiology and so on). As a result, Felsenstein's article has been cited more than 35,000 times and is ranked in the top 100 of the most cited scientific papers of all time <ref type="bibr" target="#b3">4</ref> . However, the use of Felsenstein's bootstrap has been questioned on biological grounds, notably regarding assumptions of site independence and homogeneity <ref type="bibr" target="#b4">5</ref> . Furthermore, the statistical meaning of Felsenstein's bootstrap proportions (FBPs) has been the subject of intense debate <ref type="bibr" target="#b5">6</ref> , the main questions being whether FBPs can be seen as the confidence levels of some test and whether or not they are biased <ref type="bibr" target="#b6">[7]</ref><ref type="bibr" target="#b7">[8]</ref><ref type="bibr" target="#b8">[9]</ref><ref type="bibr" target="#b9">[10]</ref> . Several methods <ref type="bibr" target="#b8">9,</ref><ref type="bibr" target="#b10">11,</ref><ref type="bibr" target="#b11">12</ref> have been proposed to correct FBP to better agree with standard ideas of confidence levels and hypothesis testing. These works have greatly contributed to the understanding of what Felsenstein's bootstrap is and what it is not. However, FBP correction methods are limited to relatively small datasets for mathematical and computational reasons (for example, double bootstrapping), and the original method is still often used; a Google Scholar search reveals about 2,000 citations of Felsenstein's paper in 2017. As has previously been stated <ref type="bibr" target="#b12">13</ref> , "consensus has been reached among practitioners, if not among statisticians and theoreticians" and "many systematists have adopted Hillis and Bull's "70%" value as an indication of support". The alternatives to FBPs are the Bayesian posterior probabilities of the tree branches <ref type="bibr" target="#b13">14</ref> -which are difficult to obtain with large datasets for computational reasons-and the approximate branch supports <ref type="bibr" target="#b14">15,</ref><ref type="bibr" target="#b15">16</ref> , which are computed quickly but provide only a local view. The bootstrap is also computationally heavy, but is easily parallelized and fast algorithms have been designed <ref type="bibr" target="#b16">17,</ref><ref type="bibr" target="#b17">18</ref> .</p><p>It is commonly acknowledged <ref type="bibr" target="#b12">13</ref> that Felsenstein's bootstrap is not appropriate for large datasets that contain hundreds or thousands of taxonomic units (taxa), which are now common as a result of high-throughput sequencing technologies. Though such datasets generally contain a lot of phylogenetic information, the bootstrap proportions tend to be low, especially when the tree is inferred from a single gene, or only a few genes, as illustrated in Fig. <ref type="figure" target="#fig_0">1a</ref> with a dataset of approximately 9,000 HIV-1 group M (HIV-1M) DNA polymerase (pol) sequences. The strongest signal in such a phylogeny generally corresponds to the deep branching of the subtypes. This signal is immediately visible here and is consistent with the common belief regarding subtype branching <ref type="bibr" target="#b18">19</ref> but some of the HIV-1M subtypes (A, B, D and G) are not supported, and neither is their branching (for example, the grouping of C and H). When using a medium-sized dataset of about 550 randomly selected sequences the FBPs are higher, with most subtypes supported at 70% or more. However, their deep branching is still unresolved (Extended Data Fig. <ref type="figure">5</ref>).</p><p>The reason for such degradation is explained by the core methodology of Felsenstein's bootstrap. A replicated branch must match a reference branch exactly to be accounted for in the FBP value. A difference of just one taxon-which is highly likely to be the case in large datasetsis sufficient for the replicated branch to be counted as absent, even though it is nearly identical to the reference branch <ref type="bibr" target="#b12">13,</ref><ref type="bibr" target="#b19">20</ref> . There are many biological and computational reasons for the existence of 'rogue' taxa with unstable phylogenetic positions: convergence, recombination, sequence and tree errors, and so on. The standard approach <ref type="bibr" target="#b19">[20]</ref><ref type="bibr" target="#b20">[21]</ref><ref type="bibr" target="#b21">[22]</ref><ref type="bibr" target="#b22">[23]</ref><ref type="bibr" target="#b23">[24]</ref> is to remove these taxa and relaunch the analysis, but this is statistically questionable and computationally expensive. Furthermore, with a large number of taxa and a low number of sites the phylogenetic signal is weak. The inferred branches are then likely to have errors and a large Article reSeArcH fraction of taxa may be unstable, even in the absence of model misspecification of any sort and without long branches.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A statistical approach</head><p>Our approach has a simple but sound statistical basis that is partly inspired by Sanderson's monophyly index <ref type="bibr" target="#b24">25</ref> and partly by our work on gene clusters obtained from expression data <ref type="bibr" target="#b25">26</ref> , both of which are tailored for rooted trees. We replace the branch presence proportionthat is, the expectation of a {0,1} indicator function-of Felsenstein's bootstrap, by the expectation of a refined, gradual function in the [0,1] range, quantifying the branch presence in the bootstrap trees. In doing so, we admit that the inferred branch is not simply correct or incorrect (as with FBP), but that it may contain some errors. Our ultimate aim is to quantify these errors and the presence of the inferred branch in the true tree, using the plug-in principle (see below). We use the transfer distance <ref type="bibr" target="#b26">[27]</ref><ref type="bibr" target="#b27">[28]</ref><ref type="bibr" target="#b28">[29]</ref> , in which the distance δ(b,b*) between a branch b of the reference tree T and a branch b* of a bootstrap tree T* is equal to the number of taxa that must be transferred (or removed) to make both branches identical (that is, both branches split the set of taxa identically). To measure the presence of b in T*, we search the branch in T* that is closest to b and use the 'transfer index' ,</p><formula xml:id="formula_0">φ(b,T*) = Min b*∈T* {δ(b,b*)}.</formula><p>This index has several important and useful properties. Any branch b splits the taxa into two subsets. If l is the number of taxa and p is the size of the smaller subset induced by b, we have the following properties (see Methods): φ(b,T*) = 0 if and only if b belongs to T*; φ(b,T*) ≤ p -1; φ(b,T*)/(p -1) is very close to 1 when T* is random and l is large (&gt; 100); and φ(b,T*) is computed recursively in time proportional to l, just as is FBP. On the basis of these properties, we define the transfer bootstrap expectation (TBE) as:</p><formula xml:id="formula_1">φ = - - * b b T p TBE( ) 1 ( , )<label>1</label></formula><p>in which the numerator is the average transfer index among all bootstrap trees. It can easily be seen that TBE ranges from 0 to 1, in which 0 means that the bootstrap trees are random regarding b and 1 means that b appears in all bootstrap trees. Considering the same set of bootstrap trees, TBE(b) is necessarily larger than FBP(b) and the difference is substantial for deep branches, whereas TBE(b) = FBP(b) when b defines a (shallow) 'cherry' , which is a clade comprising only two taxa (that is, p = 2). Importantly, we shall see that TBE supports very few branches showing substantial contradictions with the true tree when used with common thresholds (typically 70% 7 or higher; Fig. <ref type="figure">2c,</ref><ref type="figure">d</ref> and Extended Data Figs. 2, 3, 7, 8). These properties-easy computation, higher supports than FBP and a low number of falsely supported branches-are all highly desirable. Furthermore, TBE has a simple and natural interpretation; for instance, with l = 1,000 and p = 200, TBE(b) = 95% means that, on average, (200 -1) × 0.05 ≈ 10 taxa have to be transferred to recover b in bootstrap replicate trees. This interpretation is radically different from that of FBP, in which b is assessed globally as correct or erroneous. With TBE, branches that are nearly correct are also likely to be supported. Moreover, we can define an instability score for each taxon based on the number of times it is transferred in TBE computations.</p><p>TBE uses the same procedure of resampling with replacement as does FBP and thus inherits some of the statistical properties of FBP <ref type="bibr" target="#b2">3,</ref><ref type="bibr" target="#b5">6,</ref><ref type="bibr" target="#b8">9</ref> , as well as the usual properties of the bootstrap method <ref type="bibr" target="#b0">1,</ref><ref type="bibr" target="#b1">2</ref> . Notably, TBE relies on the same assumptions as FBP regarding site independence and homogeneity, but these assumptions can be relaxed <ref type="bibr" target="#b5">6</ref> , for instance, by using block bootstrapping <ref type="bibr" target="#b29">30</ref> . Just as with FBP <ref type="bibr" target="#b2">3</ref> , TBE(b) cannot be interpreted as the probability for the branch b to belong to the true phylogeny. Although deep mathematical approaches <ref type="bibr" target="#b5">6,</ref><ref type="bibr" target="#b8">[9]</ref><ref type="bibr" target="#b9">[10]</ref><ref type="bibr" target="#b10">[11]</ref><ref type="bibr" target="#b11">[12]</ref><ref type="bibr" target="#b30">31</ref> have previously been proposed to connect FBP to hypothesis-testing theory, TBE should not be interpreted as the confidence level of some statistical test (with null and alternative hypotheses, distribution of test statistics under the null and so on). TBE is better and more simply interpreted in terms of repeatability: TBE(b) estimates the extent to which branches identical or similar to b would be recovered when applying the same tree inference method to a new sample of the same size drawn from the same site distribution as the original sample. With large samples, the empirical distribution obtained from observed data comes close to the unknown underlying distribution of this data, and sampling with replacement in the empirical distribution is asymptotically equivalent to drawing . Supports (orange and blue percentages in a and b, respectively) are given for the tree clades that are closer to the subtypes (red stars, filled when support &gt; 70%); for each of these clades we use jpHMM predictions to provide the number of wrong taxa (w) that do not belong to the corresponding subtype, and the number of missing taxa (m) that belong to the subtype but not to the clade. The C and the H clades are not supported by FBP but there exist neighbouring clades with FBP supports larger than 70%, which are shown in square brackets. The same approach is applied to the C sub-epidemics in India (IND) and East Africa (EA). The ratio provides the coverage of the clade: the number of studied taxa (for example, from India) in the clade versus the total number of these taxa in the dataset. The South American clade (SA, included in EA, not shown) is supported by TBE but not by FBP (73% versus 14%, respectively, for 15 taxa in total, with above-defined ratio of 14/14). The histograms provide the number of branches with &gt; 70% support depending on branch depth, which is measured by the number of taxa in the smaller of the two clades defined by the given branch.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>samples from the underlying distribution <ref type="bibr" target="#b0">1,</ref><ref type="bibr" target="#b1">2</ref> . The convergence rate is unknown with models as complex as the ones used in phylogenetics, but our simulation results show that moderate sample sizes suffice to obtain good approximations (Extended Data Fig. <ref type="figure" target="#fig_0">10</ref>). When the sample size is extremely large, as in phylogenomic studies using genome-scale sequence alignments <ref type="bibr" target="#b31">32</ref> , both FBP and TBE are expected to be nearly equal to 1 for all branches. Again, this should not be interpreted in terms of absolute truth regarding the phylogenetic inferences, but it simply reflects the closeness of the empirical and underlying distributions and the very small variability of tree estimates. In fact, a high level of repeatability is necessary to trust phylogenetic inferences, but it may be not sufficient. <ref type="bibr">Felsenstein 3</ref> states that the bootstrap "may be misleading if the method used to infer phylogenies is inconsistent". This applies both to FBP and TBE, and is typical for inference methods subject to longbranch attraction. With a consistent, unbiased inference method, we expect the plug-in principle <ref type="bibr" target="#b0">1,</ref><ref type="bibr" target="#b1">2,</ref><ref type="bibr" target="#b5">6,</ref><ref type="bibr" target="#b8">9</ref> to apply; this principle states that the distribution of the distance between the true tree and the inferred tree can be well-approximated by the distribution of the distance between the inferred and bootstrap trees. Using both real and simulated data, here we show that this principle does apply with maximum-likelihood estimation, a phylogenetic inference method that is typically consistent <ref type="bibr" target="#b32">33</ref> .</p><p>In this setting, TBE provides information on the (transfer, quartet-based) distance between the inferred branch and the true tree, and rarely supports poor branches. Moreover, the ability of TBE to identify rogue taxa makes it possible to study them further, to understand why they are phylogenetically unstable and to revise the branch supports.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Analysis of mammal data</head><p>We first studied the advantage of using TBE on a large phylogeny of 1,449 mammals, obtained from a usual barcoding marker (COI-5P).</p><p>The reference and bootstrap trees were inferred by maximum likelihood from the protein alignment (527 sites) using both FastTree <ref type="bibr" target="#b33">34</ref> and RAxML with rapid bootstrap <ref type="bibr" target="#b16">17</ref> to check that similar conclusions were drawn with different inference methods. To study the effect of the number of taxa, we randomly selected small-(22 taxa) and medium-sized (181 taxa) datasets and performed the same analyses. The results were compared to the NCBI taxonomy (https://www.ncbi.nlm.nih.gov/ taxonomy, accessed April 2016), which represents current thinking about the evolutionary history of mammals. To cope with the low resolution of the NCBI taxonomy, we used a quartet-based topological distance rather than the transfer distance. For all inferred branches, we measured the quartet-based percentage of conflicts with the NCBI taxonomy, and the same approach was used to assess the topological accuracy of FastTree and RAxML phylogenies. As expected in this type of study based on a unique marker, the inferred topologies were relatively poor, and thus challenging for branch support methods. However, RAxML was more accurate than FastTree and had higher branch supports, as is generally observed with rapid bootstrap <ref type="bibr" target="#b15">16</ref> (Extended Data Figs. <ref type="figure">2,</ref><ref type="figure">3</ref>). Our results (Fig. <ref type="figure">2a-c</ref> and Extended Data Figs. <ref type="figure">2,</ref><ref type="figure">3</ref>) indicate clearly that TBE provides some support for deep branches, whereas FBP does not. As expected, the supports for shallow branches are similar between the two methods, and the advantage of TBE is more pronounced with a large number of taxa but still of interest with medium-sized datasets. Comparisons with the NCBI taxonomy show that TBE supports a larger number of weakly contradicted branches than FBP-which fulfils one of the objectives of TBE (nearly correct branches must be supported)and the number of supported branches with moderate-to-high quartet conflicts remains very low. These results are confirmed by simulations (Fig. <ref type="figure">2d</ref> and Extended Data Figs. <ref type="figure">7,</ref><ref type="figure">8</ref>).</p><p>The advantage of TBE appears clearly when inspecting the tree clades. For example (Fig. <ref type="figure">3</ref>), the simian clade inferred by FastTree has a strong support with TBE; by contrast, when using FBP, support for this clade is nearly null owing to a large number of rogue taxa in the bootstrap trees, and the same holds true for several sub-clades. The simian clade includes all 152 simian sequences plus two non-simian taxa </p><formula xml:id="formula_2">T = 241 T = 85 T = 712 T = 325 T = 404 c ≤ 5% 5% &lt; c ≤ 20% c &gt; 20% c ≤ 5% 5% &lt; c ≤ 20% c &gt; 20%</formula><p>Fig. <ref type="figure">2</ref> | FBP and TBE bootstrap supports on the same phylogeny with 1,449 COI-5P mammal sequences using FastTree. The graphs in a-d refer to branches with supports &gt; 70% <ref type="bibr" target="#b6">7</ref> , with the vertical axes denoting the percentage of these branches in a given condition (in b for example, 22-taxon trees contain 19 internal branches (T), and 2/19 ≈ 10% of branches have FBP &gt; 70%). a, Supports regarding branch depth (see definition in Fig. <ref type="figure" target="#fig_0">1</ref>). b, Supports regarding tree size (that is, number of taxa). c, Supports regarding percentage of quartet conflicts (c) with NCBI taxonomy (c ≤ 5%, low level of conflict; 5% &lt; c ≤ 20%, moderate level of conflict; c &gt; 20%, high level of conflict). d, As in c but regarding the true tree used for simulations (noisy condition). T, number of internal branches. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Canis adustus Maxomys rajah</head><p>Fig. <ref type="figure">3</ref> | FBP and TBE bootstrap supports on the simian clade. The complete tree inferred by FastTree using 1,449 COI-5P mammal sequences is the same as in Fig. <ref type="figure">2</ref>, but we focus on the simian clade. All simian sequences are included in this clade and two additional non-simian sequences are added, one rogue taxon (Maxomys rajah, detected by TBE) and one stable but erroneous taxon with partial sequence (Canis adustus); this simian tree is very close to the NCBI taxonomy (&lt; 2.5% of contradicted quartets, when both erroneous taxa are pruned). Platyrrhini, New World monkeys; Cercopithecoidae, Old World monkeys.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>(Maxomys rajah and Canis adustus). The latter is not a rogue taxon: its sequence is incomplete and very close to the simian sequences for the part that is available, and its position is very stable in the bootstrap trees. By contrast, Maxomys rajah is a rogue taxon and is detected as such by TBE (transferred in 659 out of 1,000 bootstrap trees when computing the support of the simian clade). Similar results were found with other well-established clades when using RAxML (Fig. <ref type="figure">4</ref>). Both FBP and TBE support some small clades, namely the Monotremata and Elephantidae. However, FBP does not support any deep branches, except for the Cetacea (67%) and, to some extent, the simians (50%). TBE provides strong supports for these two groups, but also for five other groups, including the Marsupiala and Insectivora. The latter clade (FBP: 0%, TBE: 78%) contains all Insectivora of the NCBI taxonomy, plus one extra taxon (Plecotus strelkovi), which again is detected by TBE as a rogue taxon (transferred in 965 out of 1,000 bootstrap trees). By comparison, the removal of rogue taxa <ref type="bibr" target="#b23">24</ref> does not substantially improve FBP: eight and three taxa are removed with FastTree and RAxML, respectively, but the number of branches with FBP &gt; 70% remains the same. This is explained by hundreds of taxa, which are relatively unstable but not removed.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Analysis of HIV data</head><p>We applied our method to a large dataset of 9,147 HIV-1M pol sequences. Datasets of this size are increasingly common in molecular epidemiology and phylodynamics <ref type="bibr" target="#b34">35</ref> . We retained only sequences that were annotated as non-recombinant by the Los Alamos HIV-1 database using a fast-filtering approach. Among these sequences, 48 recombinant sequences were detected by jpHMM <ref type="bibr" target="#b35">36</ref> . These 48 sequences were kept in the analyses to study the effect of recombinant sequences, as their presence is inevitable in any HIV dataset. In contrast to that of mammals, the tree topology of HIV-1M strains is essentially unknown. Moreover, it is intrinsically unstable because reconstructing a tree with so many relatively short and possibly recombinant sequences is challenging. Thus, the main expectation is to observe a clear separation between the subtypes. We built the reference and bootstrap trees using FastTree on the DNA sequence alignment (1,043 sites), and performed the same analyses using smaller subsets of 35 and 571 sequences.</p><p>Although the deep branching of the subtypes <ref type="bibr" target="#b18">19</ref> is poorly supported by FBP (Fig. <ref type="figure" target="#fig_0">1a</ref>), it becomes apparent with TBE, as when using this approach all subtypes have a support larger than 80% and close to 100% in most cases (Fig. <ref type="figure" target="#fig_0">1b</ref> and Extended Data Fig. <ref type="figure">5</ref>). For example, the subtype B clade (3,559 taxa) has a support of only 3% using FBP, but a support of 99% using TBE. This clade contains all subtype B sequences, plus two taxa detected as recombinant by jpHMM; this means that both supports are likely to be correct insofar as they state that this clade is incorrect (FBP) or nearly correct (TBE). However, FBP fails to detect any phylogenetic signal, whereas TBE reveals that this signal is very strong. The same holds true with other well-described clades. For example, TBE supports the identification of regional variants of HIV-1 subtypes that are of epidemiological importance (such as the East African, Indian and South American subtype C variants), which FBP fails to support. TBE provides a substantial support to a much larger number of deep branches. Again, the advantage of using TBE is higher with large datasets (Extended Data Fig. <ref type="figure">4</ref>), but is still apparent when using 571-taxon datasets, for which the deep subtype branching and C sub-epidemics are supported by TBE but not FBP (Extended Data Fig. <ref type="figure">5</ref>). An important feature of TBE is that the supports may be non-local, but attached to 'caterpillar-like' paths, in which the main phylogenetic backbone is connected to a few isolated taxa (Fig. <ref type="figure" target="#fig_0">1b</ref>; for example, subtype C). With HIV-1M data, this corresponds to the fact that the subtype roots are usually not well defined owing to recombinant and ancient sequences, which tend to be isolated in basal position. Moreover, the instability score among recombinant sequences is clearly higher than in the sequences that were not detected as recombinant (Extended Data Fig. <ref type="figure">6</ref>), which supports the biological soundness of the approach and its power to detect recombinant and rogue taxa.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Analysis of simulated data</head><p>To check that TBE does not support erroneous branches, we performed extensive computer simulations with various tree sizes and phylogenetic signal levels. We also added unstable taxa that had a weaker phylogenetic signal than the others. The results are highly similar to those obtained using real data, regarding the support of deep branches and the tree size (Extended Data Figs. <ref type="figure">7,</ref><ref type="figure">8</ref>). In all the conditions we</p><formula xml:id="formula_3">Monotremata Marsupialia Afrotheria Rodentia Primates Insectivora Chiroptera Carnivora Cetartiodactyla Perissodactyla a b FBP &gt; 70% TBE &gt; 70% Monotremata 92% 3 (0 w, 0 m) Insectivora 0% 57 (1 w, 0 m) Marsupialia 0% 66 (2 w, 0 m) Simians (Simiiformes) 50% 153 (1 w, 0 m) Cetacea 67% 55 (0 w, 0 m) Geomyidae 4% 22 (0 w, 0 m) Mustelinae 19% 9 (0 w, 0 m) Elephantidae 98% 8 (0 w, 0 m) Perognathinae 11% 16 (1 w, 0 m) Monotremata 96% 3 (0 w, 0 m) Insectivora 78% 57 (1 w, 0 m) Marsupialia 89% 66 (2 w, 0 m) Simians (Simiiformes) 99% 153 (1 w, 0 m) Cetacea 98% 55 (0 w, 0 m) Mustelinae 71% 9 (0 w, 0 m) Elephantidae 100% 8 (0 w, 0 m) Geomyidae 84% 22 (0 w, 0 m) Perognathinae 80%</formula><p>16 (1 w, 0 m) Fig. <ref type="figure">4</ref> | FBP and TBE supports on the same phylogeny with 1,449 COI-5P mammal sequences using RAxML with rapid bootstrap. a, FBP. b, TBE. This phylogeny is more accurate than the one inferred using FastTree (27% versus 38% of contradicted quartets, respectively) but is still relatively poor, especially regarding deep nodes and larger groups. For example, rodents and chiropterans are not monophyletic and are distributed in several subtrees. However, some parts of the tree are more accurate. A few clades are highlighted, corresponding almost exactly to the NCBI taxonomy. For example, all Elephantidae taxa are recovered by RAxML in a single clade that contains only Elephantidae, and Insectivora taxa are included in a clade containing one extra taxon. To select these clades, we minimized the transfer distance with the NCBI taxonomy, in case of ambiguity. See Fig. <ref type="figure" target="#fig_0">1</ref> and Methods for details.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>examined, TBE supported very few branches that showed substantial contradictions with the true tree, and the rogue taxa exhibited lower stability (Extended Data Fig. <ref type="figure">9</ref>). In the absence of rogue taxa (Extended Data Fig. <ref type="figure">7</ref>), the gain of TBE was still substantial compared to FBP, with almost twice as many branches with support &gt; 70%, thus demonstrating the importance of accounting for the global instability of the inferred tree. Furthermore, we checked the interpretation of TBE as a measure of repeatability (Extended Data Fig. <ref type="figure" target="#fig_0">10</ref>) by comparing TBE to its counterpart computed from simulated alignments, rather than bootstrap pseudo-alignments; both simulation-and bootstrap-based supports are highly correlated (Pearson's ρ = 0.85) with alignments of moderate length (about 500) and have analogous performance in detecting rogue taxa. Lastly, we checked the validity of the plug-in principle by comparing TBE to the similarity-measured using the normalized transfer index-between the inferred branch and the true tree (Extended Data Fig. <ref type="figure" target="#fig_0">10</ref>). Again a high correlation (Pearson's ρ = 0.74) was found. When performing the same experiments with FBP similar or slightly lower correlations were observed, probably owing to the discontinuous nature of FBP.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Discussion</head><p>The transfer bootstrap thus provides a measure of branch repeatability, or robustness. Our results clearly demonstrate its usefulness, especially with deep branches and large datasets, for which branches known to be essentially correct are supported by TBE but not by FBP. Furthermore, when combined with consistent maximum-likelihood tree estimation, TBE rarely supports poor branches. Importantly, TBE supports are easily interpreted as fractions of unstable taxa. Although our results suggest that 70% is a reasonable threshold from which to start (Extended Data Figs. 2, 3, 4, 8), we suggest that it is better to interpret TBE values depending on the data and the phylogenetic question being addressed; for example, using a lower TBE support threshold with HIV and possibly recombinant sequences, than with mammals. Moreover, our experiments demonstrate the ability of the transfer index to detect unstable taxa responsible for low supports. Lastly, the approach is applicable to rapid bootstrap <ref type="bibr" target="#b16">17,</ref><ref type="bibr" target="#b17">18</ref> (Fig. <ref type="figure">4</ref> and Extended Data Fig. <ref type="figure">3</ref>) and could be extended to parametric bootstrap 2 and Bayesian branch supports <ref type="bibr" target="#b13">14</ref> .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Online content</head><p>Any Methods, including any statements of data availability and Nature Research reporting summaries, along with any additional references and Source Data files, are available in the online version of the paper at https://doi.org/10.1038/s41586-018-0043-0.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>MEthodS</head><p>Definitions and properties of transfer distance and index. The transfer distance <ref type="bibr" target="#b26">27</ref> , also called R-distance <ref type="bibr" target="#b27">28</ref> , was introduced to compare partitions in cluster analysis. In this context, the transfer distance is equal to the minimum number of elements to be transferred (or removed) to transform one partition into the other. Tree branches are commonly seen as bipartitions or splits, as a branch divides the taxa into two subsets situated on its two sides. The most used topological distance between two trees is the Robinson-Foulds distance <ref type="bibr" target="#b36">37</ref> , which is equal to the number of bipartitions that belong to one tree but not the other. The bipartition distance is overly sensitive to some small tree changes, possibly involving a unique taxon <ref type="bibr" target="#b28">29</ref> . Previous authors <ref type="bibr" target="#b28">29</ref> have proposed using the transfer distance and designed algorithms to compute a more robust 'matching' distance between trees; although a different task, this is related to the aim of this article. In the following, we first provide basic definitions-following the standard text book for phylogenetic trees <ref type="bibr" target="#b37">38</ref> -and then demonstrate the properties of the transfer distance in a bootstrap context.</p><p>Let X be a fixed set of l taxa. An X-tree is a phylogenetic tree with l leaves labelled by the taxa of X. All reference and bootstrap trees discussed here are X-trees, meaning that they are labelled by the same set of l taxa. Any branch of an X-tree defines a bipartition of X, and the topology of an X-tree can be recovered from its bipartition set. Thus, we will use the terms branch and bipartition to mean the same thing in different contexts. Any bipartition, b, of X can be encoded by a {0,1} vector v(b) of length l, in which the taxa on the same side of the bipartition are encoded by the same value. Note that b is also encoded by v b ( ), the negation of v(b) (that is, the zeros are turned into ones, and vice versa). Moreover, the smaller of the two subsets induced by a bipartition b will be called here the 'light side' of b, and p will denote the size of the light side of b (p ≤ lp). A bipartition is 'trivial' when it has a unique taxon in its light side (p = 1). An X-tree defines l trivial bipartitions corresponding to each of the taxa. These trivial bipartitions are contained in every X-tree, while the other non-trivial bipartitions define the core of the tree topology and are the central subject of phylogenetic studies.</p><p>The transfer distance δ(b,b*) between a bipartition b of the reference tree T and a bipartition b* of a bootstrap tree T* is equal to the number of taxa that must be transferred (or removed) to make both bipartitions identical. The transfer distance is easily defined and computed using the Hamming distance, Recursive computation of the transfer index. A recursive algorithm to compute all transfer distances between any given bipartition b of T and all bipartitions of another tree T′ has previously been described <ref type="bibr" target="#b25">26,</ref><ref type="bibr" target="#b28">29</ref> . This algorithm is easily transformed to compute the transfer index. The principle is as follows:</p><p>(1) Map all the leaves of the light side of b to 0, the others to 1 and apply the same mapping to the leaves of T*. Furthermore, root T* at any internal node.</p><p>(2) With a single post-order tree traversal, one can compute the number of leaves labelled 0 and the number of leaves labelled 1 for every subtree in T*.</p><p>(3) Let l 0 be the number of leaves labelled 0 and l 1 be the number of leaves labelled 1 in the subtree attached below a given bipartition b*. The transfer distance between b and b* is given by δ(b,b*) = Min{pl 0 + l 1 ,lpl 1 + l 0 } (think to the missing zeros and the ones to be removed in b* below subtree, and vice versa). This distance can be computed during the post-order traversal as well as the transfer index φ(b,T*), which is the minimum of δ(b,b*) for all bipartitions of T*.</p><p>This algorithm has linear time complexity, and thus computing TBE for all bipartitions in T with r bootstrap replicates has a time complexity in O(rl <ref type="bibr" target="#b1">2</ref> ). FBP has the same time complexity, but very efficient implementations have been developed (for example, using bit vectors to encode bipartitions). In practice, computing all TBE supports with 4,000 taxa and 1,000 replicates requires less than one hour (5 core Intel Xeon 3.5 GHz), which is negligible compared to the time required to infer the reference and bootstrap trees. Expected transfer index with random trees and TBE distribution. We have seen that the transfer index satisfies φ(b,T*) ≤ p -1. We show here that the expected transfer index is very close to this upper bound with random 'bootstrap' trees when the number of taxa is large enough. Consequently, the transfer bootstrap expectation of any branch b</p><formula xml:id="formula_4">φ = - / - * b bT p (TBE( ) 1 ( , )<label>( 1)</label></formula><p>) is close to 0 when the boot- strap trees seem to be random and do not contain any signal regarding b. This property explains why moderate supports-for example, 70% as used throughout this paper-are sufficient to reject poor branches, as a branch support of 70% cannot be observed by chance.</p><p>We This result shows that the expected transfer distance between b and b* is larger than or equal to p, for any value of p and p*. Moreover, with a lower p*, the expected transfer distance is closer to p. As a first approximation, we thus see that the transfer index should be close to its upper-bound p -1, because it is equal to the minimum of distances which taken separately are all expected to be larger than p.</p><p>However, these distances fluctuate around their expected values, and their minimum may be lower than the minimum of their individual expectations, especially when using small samples (that is, low number of taxa). We performed computer simulations to measure the extent of this phenomenon and the validity of the E[φ(b,T*)] ≈ p -1 approximation. We used four tree sizes: l = 16, 128, 1,024 and 8,192 taxa, and four models of random phylogenetic trees: caterpillars (fully imbalanced), PDA, Yule-Harding and perfectly balanced <ref type="bibr" target="#b37">38</ref> . For the bipartition b, all possible integer values of p in the [2, l/2] range were used. The number of random bootstrap trees was equal to 1,000, and we performed 100 runs per tree size.</p><p>Results are displayed in Extended Data Fig. <ref type="figure" target="#fig_0">1</ref>. With l ≥ 1,024, the average transfer index with random trees is very close in relative value to the upper bound p -1, and the approximation is already satisfying with l = 128. Moreover, the results are nearly the same for the four random tree models, suggesting that the property holds in a number of settings. As expected, the approximation is better with small p. Indeed, note that the upper bound p -1 is obtained with a trivial bipartition b* made of a unique taxon belonging to the light side of b. When a cherry in T* contains two taxa from the light side of b, then φ(b,T*) ≤ p -2. Similar deviations are observed with subtrees in T* containing a large fraction of taxa belonging to the light side of b. With a larger p, there is a higher probability for such an event to occur. Note, however, that large values of p (that is, p ≈ 2) are relatively rare for most tree models (for example, Yule-Harding). Looking at the distribution of TBE, we see that having TBE larger than a moderate threshold (such as 50%)</p><p>Article reSeArcH is very unlikely, even with 16 taxa, thus explaining that TBE rarely supports poor branches with real and simulated data (Fig. <ref type="figure">2c,</ref><ref type="figure">d</ref> and Extended Data Figs. 2, 3, 7, 8). Software programs and web server. We developed several tools to compute the transfer bootstrap. We first implemented a command line tool in C, 'Booster' (open source, available at https://github.com/evolbioinfo/booster). This tool computes TBE as well as FBP supports, and the stability scores of the taxa (globally or per branch). It takes two files as input: (1) a reference tree file in Newick format and (2) a bootstrap tree file in Newick format, containing all bootstrap trees. A number of software programs can be used to infer trees from multiple sequence alignments (MSAs) and produce these reference and bootstrap files in the desired format; these include RAxML, FastTree and PhyML-used in this article-as well as many others (see examples in Booster GitHub repository).</p><p>We also developed 'BoosterWeb' (http://booster.c3bi.pasteur.fr), a freely available web interface that enables users to compute bootstrap supports (TBE and FBP) easily without installing any tool on their own computer. Computations are launched on the Institut Pasteur cluster throughout a Galaxy instance. As with the command line tool, this includes the option to input reference and bootstrap trees inferred using any phylogenetic program. Another option is to upload an MSA and then run PhyML-SMS <ref type="bibr" target="#b38">39</ref> (for medium-size datasets) or FastTree (for large datasets) to infer the trees. We propose a basic visualization of the resulting tree highlighting highly supported branches at a given threshold. The resulting tree can be uploaded in one-click on iTOL <ref type="bibr" target="#b39">40</ref> for further manipulation. Moreover, BoosterWeb is self-contained and can be easily installed on any desktop computer (Windows, MacOS and Linux) by downloading the BoosterWeb executable.</p><p>For the sake of reproducibility, all analyses described in this article were implemented in the NextFlow workflow manager <ref type="bibr" target="#b40">41</ref> , and are accessible along with all our data at https://github.com/evolbioinfo/booster-workflows. The software programs that we developed to manipulate data are available for download at http://github. com/fredericlemoine/goalign and http://github.com/fredericlemoine/gotree, for manipulating alignments and trees, respectively. Mammal dataset and analyses. We downloaded all aligned mammals COI-5P amino acid sequences from the Barcode of Life Data System (http://www. barcodinglife.org, accessed September 2015). We removed all sequences shown to be identical among several species, kept one sequence per species (several gene versions are available for some species, but no paralogues), and converted the resulting multiple alignment (1,449 sequences, 527 sites) into FASTA format. This alignment was subsampled to study the effect of tree size. We randomly drew 8 samples with 1/8th of the sequences (that is, 181) and 64 samples with 1/64th of the sequences (that is, 22). We then generated 1,000 bootstrap alignments for the full alignment and each of the 72 subsampled alignments by drawing sites with replacement.</p><p>We used FastTree <ref type="bibr" target="#b33">34</ref> (options: -nopr -nosupport -wag -gamma) to infer trees from each of these reference (1 + 8 + 64 = 73) and bootstrap (73,000) alignments. To ensure that the results and conclusions were independent of the tree inference method, we also performed the same analyses using RAxML with rapid bootstrap <ref type="bibr" target="#b16">17</ref> (options: -f a -m PROTGAMMA -c 6 -T 10 -p $RANDOM -x $RANDOM -#1000). The FBP and TBE supports for the (73 × 2) reference trees were computed using Booster (command-line version written in C). All trees were drawn using iTOL and are available in the Booster GitHub repository, along with the sequence alignments. To assess whether rogue taxa removal improves FBP supports, we ran RAxML rogue-detection tool <ref type="bibr" target="#b23">24</ref> (options: -J MR_DROP -z bootstrap_trees -m PROTGAMMAWAG -c 6 -T 4) and recomputed FBP supports without the detected taxa.</p><p>The FastTree and RAxML complete tree topologies were compared to the NCBI taxonomy (https://www.ncbi.nlm.nih.gov/taxonomy), which was converted to Newick format and reduced to the 1,444 taxa common to both our alignment and the NCBI taxonomy. This NCBI tree is not fully resolved and summarizes common belief about the evolutionary history of mammals, resulting from a number of phylogenetic studies based on numerous markers. The unresolved part of the NCBI tree (~4.35 descendants per node on average, instead of 2 for a fully resolved tree) corresponds to the unknown or uncertain part of that history. To cope with uncertainty, we used quartets to compare the (fully resolved) inferred trees to the NCBI tree. A quartet is a tree topology with four taxa; AB|CD is the standard notation for quartets, indicating that taxa A and B form a cherry separated by an internal branch from the cherry formed by C and D; a quartet is unresolved when the four taxa are connected to a single central node. A bipartition b induces a quartet AB|CD when A and B belong to the same side of b, and C and D to the other side. We used tqDist <ref type="bibr" target="#b41">42</ref> to count the number of quartets induced by the reference branches, which appeared to contradict the quartets induced by the NCBI tree and its bipartitions; for example, AB|CD was found in the studied branch, whereas AC|BD was found in the NCBI tree. Unresolved quartets of the NCBI tree were not counted as contradictory, as they represent an unknown evolutionary truth and the inferred resolution could be correct. Such an approach would be difficult to implement with the transfer distance. The number of contradicted quartets was divided by the total number of quartets induced by the studied branch, to obtain a normalized measurement in the [0,1] range (0: no contradiction; 1: all induced quartets are contradicted). We used the same approach to check the accuracy of the FastTree and RAxML tree topologies, comparing the whole set of quartets induced by the inferred tree to those induced by the NCBI tree. HIV dataset and analyses. From the HIV database (https://www.hiv.lanl.gov/ content/index) we retrieved pol sequences of the nine 'pure' subtypes of HIV-1 group M, corresponding to positions 2258-3300 relative to the HXB2 reference strain (accessed September 2014). The 'one sequence per patient' option was used and we randomly selected samples of the over-sampled subtypes (A1, B, C, D and G), resulting in a final dataset of 9,147 sequences. These sequences are annotated as 'pure' (that is, non-recombinant) in the database, using a fast filtering approach. However, 48 recombinant sequences were still detected using the standalone version of jpHMM <ref type="bibr" target="#b35">36</ref> (version March 2015; options: -v HIV, with default input and priors). These 48 sequences were kept in the analyses to study the effect of recombinant sequences, as their presence is inevitable in any HIV dataset. jpHMM was also used to annotate the whole set of sequences depending on their subtype or recombinant status.</p><p>Sequences were aligned using MAFFT <ref type="bibr" target="#b42">43</ref> (version 7.0; default parameters) along with the HXB2 reference strain. Codon positions associated with major drug resistance mutations were removed before tree inference, resulting in an alignment of 1,043 DNA sites (R source code available at https://github.com/olli0601/big. phylo). This alignment was subsampled to study the effect of tree size. We randomly drew 16 samples with 1/16th of the sequences (that is, 571), and 256 samples with 1/256th of the sequences (that is, 35). Then, we generated 1,000 bootstrap alignments for the full alignment and each of the 272 subsampled alignments, by drawing sites with replacement.</p><p>We used FastTree 34 (options: -nopr -nosupport -gtr -nt -gamma) to infer trees from each of these reference (1 + 16 + 256 = 273) and bootstrap (273,000) alignments. The FBP and TBE supports for the 273 reference trees were computed using Booster (command-line version written in C). All trees were drawn using iTOL (http://itol.embl.de/) and are available on the Booster-workflows GitHub repository, along with the sequence alignments. The instability score was computed considering the reference branches with TBE &gt; 70% (the signal becomes noisy when incorporating branches with lower supports in the calculation, as these branches may be erroneous and thus non-informative about taxon stability). For every taxon, the instability score is equal to the average number of times it has to be transferred to recover these branches from the bootstrap trees, divided by the number of these branches.</p><p>The most representative clades for each of the subtypes in the reference trees (Fig. <ref type="figure" target="#fig_0">1</ref> and Extended Data Fig. <ref type="figure">5</ref>) were obtained by minimizing the transfer distance. For example, in Fig. <ref type="figure" target="#fig_0">1</ref> with the full dataset, we obtained a clade very close to subtype B, with 3,559 taxa, 2 wrong taxa (that is, non-B), and all (3,557 taxa) B taxa included, resulting in the values 3,559, 2 wrong (w) and 0 missing (m) shown in this figure . 
A similar approach was used for the regional variants of subtype C, which is responsible for approximately 50% of the HIV-1 infections in the world. Three monophyletic variants of subtype C have been identified by phylogenetic analysis in East Africa <ref type="bibr" target="#b43">44</ref> , South America 45 and India <ref type="bibr" target="#b45">46</ref> . Furthermore, the South American epidemic was shown to originate in the East African cluster <ref type="bibr" target="#b43">44</ref> . To identify these variants in the inferred trees (Fig. <ref type="figure" target="#fig_0">1</ref> and Extended Data Fig. <ref type="figure">5</ref>) we again used the transfer distance. Following previous publications <ref type="bibr" target="#b43">[44]</ref><ref type="bibr" target="#b44">[45]</ref><ref type="bibr" target="#b45">[46]</ref> , we extracted three groups of C sequences from the whole dataset, based on their geographic origins: East Africa (EA: 440 sequences, originating from Burundi (288), Djibouti (1), Ethiopia (9), Kenya (41), Somalia (1), Sudan (11), Tanzania (78) and Uganda ( <ref type="formula">11</ref>)), India (IND: 154 sequences, originating from India (133), Nepal (13) and Myanmar ( <ref type="formula">8</ref>)) and South America (SA: 14 sequences, originating from Brazil (12), Uruguay (1)  and Argentina (1)). We then searched for the tree clades that were closer to these three sets of sequences. The South American sequences were not accounted for in transfer distance computations when searching for the East African clade, as they originate from East Africa. Moreover, we checked that no neighbouring, nearly optimal clade was supported by FBP. In all three cases, we found clades closely related to the sequence sets. As expected, the South American clade was included in the East African clade. The features of these clades are displayed in Fig. <ref type="figure" target="#fig_0">1</ref> and Extended Data Fig. <ref type="figure">5</ref>. The fractions correspond to the number of studied sequences included in these clades, versus the total number of such sequences in the whole dataset (for example, 360 East African sequences in the East African clade in Fig. <ref type="figure" target="#fig_0">1</ref>, among 440 in the whole tree). The 'wrong' sequences were expected in most cases. For example, the Indian clade (167 sequences, 143 from IND among 154 in the whole tree) contains 19 sequences from China corresponding to the spread of the virus in Asia via heroin trafficking routes <ref type="bibr" target="#b45">46</ref> . Simulated data and analyses. The aim of our simulation experiments was to check that the results observed with the mammal and HIV-1 datasets are reproducible and quantifiable when the simulation conditions and correct tree are known, notably regarding the support of poor branches and the ability to detect rogue taxa. Simulated data mimicked the mammal dataset. We used the tree inferred by PhyML <ref type="bibr" target="#b46">47</ref> (options: -b 0 -m WAG -a e -t e -o tlr -d aa) from the full COI-5P protein alignment with 1,449 taxa. Protein sequences were evolved along this tree using INDELible <ref type="bibr" target="#b47">48</ref> , which was launched with options and parameter values derived from the PhyML analysis, and similar to previously conducted experiments <ref type="bibr" target="#b23">24</ref> to assess the accuracy of rogue-taxon detection. The length of the root sequence was 250 AAs; the substitution model was WAG; amino acid frequencies were estimated from the COI-5P alignment; the rates across-sites model used 4 gamma categories with 'alpha' = 0.441 and no invariant sites; and the indel model used 'power law' , 'parameter' = 1.5, 'indel max size' = 5, and 'indel rate' = 0.02.</p><p>In this manner, we obtained a first 'non-noisy' MSA of length ~500 with ~50% gaps. Noise was added to this MSA to mimic rogue taxa and homoplasy. We shuffled the amino acids vertically for 50% of the sites (MSA columns), thus making these sites homoplasic. For 5% of the sequences (MSA rows), 25% additional sites were shuffled vertically, thus making these sequences unstable and 'rogue' , as they contained half of the phylogenetic signal compared to the other (95%) sequences. Both noisy and non-noisy MSAs were used to compare FBP and TBE. To measure the effect of tree size, both MSAs (comprising 1,449 sequences) were sampled to obtain 8 MSAs with 181 sequences (~1/8 of the full sequence set) and 64 MSAs with 22 sequences (~1/64 of the full sequence set). For each of these reference MSAs we sampled with replacement 1,000 pseudo-alignments to compare the two bootstrap methods. All trees were inferred using FastTree (options: -nopr -nosupport -wag -gamma). Just as with the mammal dataset, for each of the branches in the reference trees we computed the percentage of quartet-based conflicts with the correct (PhyML) tree used to generate the data. We also computed the instability score of all taxa in the complete noisy MSA, using only the branches with TBE &gt; 70%.</p><p>To check the repeatability of FBP and TBE, we generated 1,000 noisy MSAs using the same phylogenetic tree, simulation procedure and set of rogue taxa as the reference noisy MSA (1,449 sequences, ~500 sites and ~50% gaps). We then compared the branch supports of the inferred branches computed using the pseudoalignments to those obtained using the simulated MSAs. The bootstrap theory <ref type="bibr" target="#b1">2</ref> indicates that both types of supports are close when the sample size is large enough. The goal was thus to check that 500 sites are enough to obtain a good approximation, and that the bootstrap-based and simulation-based supports are clearly correlated (Pearson's and Spearman's coefficients), as well as the instability score (again computed using branches with TBE &gt; 70%). This experiment was performed with FBP and TBE, with both FastTree (options: -nopr -nosupportwag -gamma) and RAxML (options: -f d -m PROTGAMMAWAG -c 6).</p><p>Lastly, the same experiment was used to check the validity of the plug-in principle: we compared the FBP and TBE supports of every inferred branch (both FastTree and RAxML) to the presence or absence (1/0) of that branch in the true tree (FBP), and the normalized transfer distance between that branch and the true tree (TBE). Reporting summary. Further information on experimental design is available in the Nature Research Reporting Summary linked to this paper.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>Extended Data Fig. <ref type="figure" target="#fig_0">1</ref> | Transfer index expectation and TBE support with random trees. a-d, For each number of taxa (16, 128, 1024 and 8,  191 in a, b, c and d, respectively) and random tree model, we compare the transfer index average over 100 runs with the upper-bound p -1 (top graphs in each panel). We also compare the average transfer bootstrap support (TBE) to 0, and provide the maximum value observed among 100 runs (dashed lines), thus approximating the 1% quantile of the distribution (bottom graphs). In these experiments, the number of random 'bootstrap' trees is equal to 1,000. With l ≥ 1,024 (c), the average transfer index with random trees is very close in relative value to the upper-bound p -1 and the approximation is already satisfying with l = 128 (b). Furthermore, the results are nearly the same for the four random tree models, suggesting that the asymptotic behaviour holds in a number of settings. As expected, the approximation of the transfer index over random bootstrap trees by p -1 is better with small values of p. These results explain why moderate TBE supports-for example, 70% as used in this article-are sufficient to reject poor branches, as a TBE branch support of 70% cannot be observed by chance, even with a small number of taxa (for example, 16, as in a).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>Extended Data Fig. <ref type="figure">2</ref> | Comparison of FBP and TBE using the mammal dataset and FastTree phylogeny. FBP and TBE supports are compared with respect to branch depth, quartet conflicts with the NCBI taxonomy and tree size (see main text and legends of Figs. 1, 2 for explanations). Three support cut-offs are used to select the branches: 50%, 70% and 90% (for example, 28 branches among the 1,446 in total have TBE ≥ 90% and 11 have FBP ≥ 90%). The FastTree topology is poor, with 38% of quartets contradicted by the NCBI taxonomy, and 404 of the 1,441 branches with contradictions above 20%. Despite this difficulty, FBP and TBE perform well: they give supports larger than 70% to a very low number of moderately ((5,20]%) and highly (&gt; 20%) conflictual branches. FBP supports very few deep branches, whereas TBE supports a larger number of branches and is especially useful with large trees. Comparing the three cut-offs, we see that with a 50% cut-off the selected branches are still weakly contradicted, especially with FBP; as expected, with TBE the fraction of contradicted branches (&gt; 5%) is a bit higher but still low (∼7%). With a cut-off of 90% very few branches are selected (∼2% with TBE), thus justifying the use of the 70% threshold for TBE-as is standard with FBP.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>Extended Data Fig. <ref type="figure">3</ref> | Comparison of FBP and TBE using the mammal dataset and the phylogeny inferred by RAxML with rapid bootstrap. FBP and TBE supports are compared with respect to branch depth, quartet conflicts with the NCBI taxonomy and tree size (see main text and legends of Figs. 1, 2 for explanations). Three support cut-offs are used to select the branches: 50%, 70% and 90% (for example, 41 branches among the 1,446 in total have TBE ≥ 90% and 19 have FBP ≥ 90%). The RAxML topology is closer to the NCBI taxonomy than is the FastTree topology (27% versus 38% of contradicted quartets, and 353 versus 404 branches with contradiction &gt; 20%, respectively). However, the RAxML topology is still relatively poor, as expected in this type of phylogenetic study based on a unique marker (Fig. <ref type="figure">4</ref> and main text). Despite this difficulty, FBP and TBE perform well as they give supports larger than 70% to a very low number of moderately ((5,20]%) and highly (&gt; 20%) conflictual branches. The supports obtained with RAxML are higher than those obtained with FastTree (47 versus 29 branches with FBP &gt; 70% for RAxML and FastTree, respectively; 158 versus 108 branches with TBE &gt; 70% for RAxML and FastTree, respectively). Part of the explanation could be that the RAxML tree is more accurate than that of FastTree, and is thus better supported. Another factor is that the rapid bootstrap tends to be more supportive than the standard procedure, as shown in previous publications <ref type="bibr" target="#b15">16</ref> . Indeed, the rapid bootstrap uses already inferred trees to initiate tree searching, and therefore tends to produce less diverse bootstrap trees than the standard, slower procedure, which restarts tree searching from the very beginning for each replicate. Despite these differences between FastTree and RAxML with rapid bootstrap, similar conclusions are drawn when comparing FBP and TBE: FBP supports very few deep branches, whereas TBE supports a larger number of them; TBE is especially useful with large trees; and both methods support a very low number of contradicted branches. Comparing the support cut-offs, 70% again appears as a good compromise for both FBP and TBE.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>Extended Data Fig. <ref type="figure">4</ref> | Comparison of FBP and TBE using the HIV dataset and FastTree phylogeny. FBP and TBE supports are compared with respect to branch depth, and tree size (see main text and legends of Figs. 1, 2 for explanations). Three support cut-offs are used to select the branches: 50%, 70% and 90% (for example, 1,624 branches among the 9,144 in total have TBE &gt; 70% and 1,031 have FBP &gt; 70%). Results are for the most part similar to those observed with the mammal dataset. We see a major effect of depth on FBP supports: with the full dataset, less than 1% of the deep (p &gt; 16) branches have FBP support larger than 70%, whereas this percentage is higher than 20% with TBE. The effect of tree size is less pronounced. The fraction of supported branches decreases when the tree size increases from 35 to 571 taxa, but is analogous between 571 and 9,147 taxa. Furthermore, the gap between FBP and TBE remains similar, probably owing to the very large number of cherries and small clades, for which TBE and FBP are nearly equivalent. Regarding the support cut-off, 70% again appears as a good compromise for TBE, though there is no way to evaluate the fraction of supported branches that is actually erroneous. The interpretability of TBE will be a major asset for choosing the support level depending on the phylogenetic question being addressed. Here, as recombinant sequences are inevitable, lower supports than with mammals are likely to be acceptable. Extended Data Fig. <ref type="figure">5</ref> | Subtype deep branching and comparison of FBP and TBE using medium-sized HIV datasets. As the taxa were randomly drawn from the full dataset, the supports and findings show some fluctuations. a, b, Trees obtained with two of the medium-sized datasets; branches with FBP &gt; 70%: yellow dots; branches with TBE &gt; 70%: blue dots; subtype clades: red stars, filled if support &gt; 70% (see Methods and Fig. <ref type="figure" target="#fig_0">1</ref> legend for further details). c, Deep branching of the subtypes <ref type="bibr" target="#b18">19</ref> and supports obtained on the full dataset (see also Fig. <ref type="figure" target="#fig_0">1</ref>). Rare subtypes (H, J and K) are absent in the medium-sized datasets, and the subtype clades are almost perfectly recovered (only one incorrect taxon in A clade for both trees). FBP supports are higher when using mediumsized datasets than when using the full dataset (for example, 58% and 99% for subtype B, versus 3% in Fig. <ref type="figure" target="#fig_0">1</ref>). However, some subtype clades (for example, D) have moderate FBP support, though the clade matches the subtype perfectly. When using TBE, all subtype supports are higher than 95%. The deep branching is the same for all full and medium-sized datasets, and is identical to that found in a previous study <ref type="bibr" target="#b18">19</ref> , but is not supported by FBP, whereas TBE is larger than 70% for every branch (or path in Fig. <ref type="figure" target="#fig_0">1</ref>). Again, the Indian and East African sub-epidemics of subtype C are supported by TBE, but not by FBP.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>Extended Data Fig. <ref type="figure">6</ref> | Distribution of the instability score in HIV recombinants. We see a clear difference between the distributions of the instability score for the recombinant and non-recombinant sequences, which means that this score can be used to detect or confirm the recombinant status of sequences (box quantiles: 25%, 50% and 75%). See main text for details.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>Extended Data Fig. <ref type="figure">7</ref> | Comparison of FBP and TBE using non-noisy and noisy simulated data. Noisy data include rogue taxa and homoplasy and non-noisy data do not (see Methods for details). The graphs display the distribution of branches with FBP or TBE support &gt; 70%. Supports are compared regarding branch depth, tree size and quartet conflicts with the model tree used for simulations (see main text and legends of Figs. 1, 2 for explanations). Results are fully congruent with those obtained with real datasets. TBE supports more deep branches than FBP, especially with noisy data. The effect of tree size is also more visible with noisy MSA, and the number of supported branches with moderate ((5,20]%) and high (&gt; 20%) conflict levels is very low, for both FBP and TBE.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>Extended Data Fig. <ref type="figure">8</ref> | Comparison of FBP and TBE at different support cut-offs using simulated, noisy data. Comparison of FBP and TBE with respect to branch depth, quartet conflicts and tree size, at different support cut-offs (see main text and legends of Figs. 1, 2 for explanations). A cut-off of 50% seems to be acceptable, as neither FBP nor TBE support highly contradicted branches. However, this could be due to the low level of contradiction compared to real datasets (85 branches with contradiction &gt; 20%, versus about 400 in the mammal dataset in Extended Data Figs. <ref type="figure">2,</ref><ref type="figure">3</ref>).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>Extended Data Fig. <ref type="figure">9</ref> | Distribution of the instability score in rogue taxa using simulated, noisy data. TBE again appears to be useful for detecting and confirming rogue taxa (box quantiles: 25%, 50% and 75%). See main text for details.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Article reSeArcH</head><p>Extended Data Fig. <ref type="figure" target="#fig_0">10</ref> | Repeatability and accuracy of FBP and TBE using simulated data. The bootstrap theory <ref type="bibr" target="#b0">1,</ref><ref type="bibr" target="#b1">2</ref> indicates that with large samples the supports estimated using bootstrap replicates should be close to supports obtained with datasets of the same size drawn from the same distribution as the original sample. We used simulated data to check that this property holds with protein MSAs of 1,449 taxa and about 500 sites (see main text for details). a, b, Comparison of the two supports (a, FBP; b, TBE) for all branches in the tree inferred by RAxML from the original MSA. We observe a clear correlation, which is higher for TBE (ρ = 0.85) than for FBP (ρ = 0.75) using Pearson's linear correlation coefficient, but identical (0.83) using Spearman's rank coefficient, which is better suited to the discontinuous nature of FBP. These results appear to contradict previous conclusions 7 that the bootstrap is a highly imprecise measure of repeatability. However, this previous work measured the probability of inferring the correct tree (not the supports of inferred branches, as consistent in the bootstrap context) and its main result was based on 50 sites, which is probably too low for the bootstrap theory to apply.</p><p>The bootstrap also relies on the plug-in principle <ref type="bibr" target="#b1">2,</ref><ref type="bibr" target="#b2">3,</ref><ref type="bibr" target="#b5">6,</ref><ref type="bibr" target="#b8">9</ref> , which states that the distribution of the distance between the true tree and the inferred tree can be well-approximated by the distribution of the distance between the inferred and bootstrap trees. c, The accuracy of TBE in predicting the topological distance between b and the true tree as measured using the normalized transfer index, for every branch b inferred by RAxML from the original MSA. Again, we observe a clear correlation (ρ = 0.74, rank coefficient = 0.70). We performed the same experiment with FBP, seeking to predict the presence or absence (1/0) of the inferred branch in the tree true; a lower but significant correlation was found (ρ = 0.59, Spearman's rank coefficient = 0.54). d, Comparison using RAxML of the performance of simulation-based and bootstrap-based instability scores in detecting rogue taxa; both are nearly identical. TPR, true positive rate; FPR, false positive rate. e, Table summarizing the results described above and those of FastTree, which are nearly identical to those of RAxML, except regarding topological accuracy (%Correct, fraction of correct branches) for which RAxML is again more accurate than FastTree.</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Fig. 1 |</head><label>1</label><figDesc>Fig. 1 | FBP and TBE bootstrap supports on the same phylogeny with 9,147 HIV-1M pol sequences. a, FBP. b, TBE. Subtypes are colourized; recombinant sequences are black; dots correspond to branches with support &gt; 70%<ref type="bibr" target="#b6">7</ref> . Supports (orange and blue percentages in a and b, respectively) are given for the tree clades that are closer to the subtypes (red stars, filled when support &gt; 70%); for each of these clades we use jpHMM predictions to provide the number of wrong taxa (w) that do not belong to the corresponding subtype, and the number of missing taxa (m) that belong to the subtype but not to the clade. The C and the H clades are not supported by FBP but there exist neighbouring clades with FBP</figDesc><graphic coords="2,175.23,181.25,89.15,56.36" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head></head><label></label><figDesc>Min{ ( ( ), ( )), ( ( ), ( ))} To measure the presence of b in T*, we search the bipartition in T* that is closest to b and use the transfer index φ(b,T*) = Min b*∈T* {δ(b,b*)}. Based on above definitions, δ(b,b*) = 0 if and only if v(b) and v(b*) define the same bipartition of X. Thus, the transfer index satisfies φ(b,T*) = 0 if and only if b∈T*. Moreover, let b be any given bipartition of T and t be a taxon on the light side of b. The trivial bipartition b* = {t}|X -{t} is found in any bootstrap tree T* and δ(b,b*) = p -1. There may well be another bipartition closer to b in T*, but at least this ensures that φ(b,T*) ≤ p -1, and thus the transfer support, TS, satisfies: b,T*) = 1 if and only if b∈T*. Let 1 b (T*) be the indicator function equal to 1 when b∈T* and 0 otherwise. For any bipartition b and tree T*, we have 1 b (T*) ≤ TS(b,T*). The FBP is equal to the average of 1 b (T*) over the set of bootstrap trees, while the TBE is equal to the average of TS(b,T*). Thus, when using the same set of bootstrap trees, we necessarily have FBP(b) ≤ TBE(b). When b is a cherry (p = 2), we have 1 b (T*) = TS(b,T*) and thus FBP(b) = TBE(b). With deeper bipartitions, we generally observe that in the presence of a clear phylogenetic signal, only a small number of taxa need to be transferred to make b identical to a bipartition in T*, while the strict presence of b in T* can be relatively rare; the difference between FBP(b) and TBE(b) can then be substantial. The transfer distance and index are related to parsimony. The branch b is equivalent to a binary {0,1} character; assuming that the tips of T* are labelled accordingly, we can define PA(b,T*), which is the minimum number of changes along T* branches required to explain the labels of the tips. When b belongs to T*, we have PA(b,T*) = 1, and the more shuffled the zeros and ones among the tips of T*, the higher is PA(b,T*). It is easy to see that PA(b,T*) ≤ φ(b,T*) + 1. Indeed, let b* be a branch in T* such that φ(b,T*) = δ(b,b*) and assume, without loss of generality, that δ(b,b*) is equal to the number of tips labelled 1 in the light side of b* plus the number of tips labelled 0 in the heavy side of b* (in other words, the light side of b* is mostly 0 and the heavy side is mostly 1). Now consider that all internal nodes in the light side are 0 and all internal nodes in the heavy side are 1; this implies a number of changes equal to φ(b,T*) + 1, which by the definition of parsimony is larger than or equal to PA(b,T*). Parsimony is thus another option to measure branch presence, but it is inappropriate in our context. For example, consider a reference branch b = AB|CD, in which A, B, C and D are four large 'corner' subtrees, and a tree T* with an internal branch b* grouping the corner subtrees the other way around (for example, b* = AC|BD, meaning that A and C sit on one side of b*, and B and D on the other side). Then, PA(b,T*) is equal to 2, a very low value, whereas T* is phylogenetically very different from b because both clades defined by b are mixed. In this case, the transfer index between b and T* is much larger and equal to the minimum size of A, B, C and D.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head></head><label></label><figDesc>first provide a simple argument to explain this result, based on the expected transfer distance between a fixed bipartition b and a random bipartition b* with fixed light-side size p*. Let x = p/l denote the proportion of taxa in the light side of b (x ≤ 1x because p≤ lp). Both bipartitions b (fixed) and b* (random) define four taxon subsets, the sizes of which follow hypergeometric distributions with expectations: E(light side of b ∩ light side of b*) = xp*; E(light side of b ∩ heavy side of b*) = x(lp*); E(heavy side of b ∩ light side of b*) = (1x)p*; and E(heavy side of b ∩ heavy side of b*) = (1x)(lp*). It is easily seen that under these assumptions, the expected transfer distance between b and b* is equal to the sum of the second and third (anti-diagonal) terms: that is, E[δ(b,b*)] = (1 -2x)p* + p. As p* &gt; 0 and (1 -2x) ≥ 0, we have: E[δ(b,b*)] ≥ p.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0"><head></head><label></label><figDesc></figDesc><graphic coords="18,96.34,57.45,396.98,453.62" type="bitmap" /></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_0"><p>N A t U r e | www.nature.com/nature © 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_1"><p>© 2018 Macmillan Publishers Limited, part of Springer Nature. All rights reserved.</p></note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" xml:id="foot_2"><p>© 2018 Macmillan Publishers Limited, part Springer Nature. All rights reserved.</p></note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Acknowledgements We thank F. Delsuc, S. Holmes, L. Chindelevitch and E. Susko for help and suggestions. This work was supported by the EU-H2020 Virogenesis project (grant number 634650, to E.W., T.D.O. and O.G.), by the INCEPTION project (PIA/ANR-16-CONV-0005, to F.L., D.C., M.D.F. and O.G.), by the Institut Français de Bioinformatique (IFB -ANR-11-INBS-0013, to D.C.), by the Flagship grant from the South African Medical Research Council (MRC-RFA-UFSP-01-2013/UKZN HIVEPI to E.W., T.D.O. and J.-B.D.E.) and by the H3ABioNet project (NIH grant number U41HG006941 to J.-B.D.E. and U24HG006941 to E.W. and T.D.O.). Reviewer information Nature thanks E. Susko and the other anonymous reviewer(s) for their contribution to the peer review of this work.</p></div>
			</div>


			<div type="availability">
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Code availability. Our web interface and software programs are available from Booster website (http://booster.c3bi.pasteur.fr) and GitHub (https://github.com/ evolbioinfo/booster). The transfer bootstrap is available in several phylogenetic programs, including PhyML, SeaView, RAxML-NG and others (see http://booster. c3bi.pasteur.fr). Data availability. All our multiple alignments, phylogenetic trees and workflows are available as Source Data. This material is also available from Booster website (http://booster.c3bi.pasteur.fr). All other data are available from the corresponding author upon reasonable request.</p></div>
			</div>

			<div type="annex">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Competing interests</head><p>The authors declare no competing interests.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Additional information</head><p>Extended data is available for this paper at https://doi.org/10.1038/s41586-018-0043-0. Supplementary information is available for this paper at https://doi. org/10.1038/s41586-018-0043-0.  Life Sciences Reporting Summary Nature Research wishes to improve the reproducibility of the work that we publish. This form is intended for publication with all accepted life science papers and provides structure for consistency and transparency in reporting. Every life science submission will use this form; some list items might not apply to an individual manuscript, but all fields must be completed for clarity.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Reprints and permissions information</head><p>For further information on the points included in this form, see Reporting Life Sciences Research. For further information on Nature Research policies, including our data availability policy, see Authors &amp; Referees and the Editorial Policy Checklist.</p><p>Experimental design </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.">Data exclusions</head><p>Describe any data exclusions. With COI-5P, species having identical sequences were removed from the dataset. For HIV, see above.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3.">Replication</head><p>Describe whether the experimental findings were reliably reproduced.</p><p>All our code is publicly available on GitHub as Nextflow workflows, and thus can be checked and rerun to reproduce all our findings, graphs, etc.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4.">Randomization</head><p>Describe how samples/organisms/participants were allocated into experimental groups.</p><p>NA (no "experimental groups")</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="5.">Blinding</head><p>Describe whether the investigators were blinded to group allocation during data collection and/or analysis.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>NA</head><p>Note: all studies involving animals and/or human research participants must disclose whether blinding and randomization were used.</p><p>nature research | life sciences reporting summary June 2017</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="6.">Statistical parameters</head><p>For all figures and tables that use statistical methods, confirm that the following items are present in relevant figure legends (or in the Methods section if additional space is needed).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>n/a Confirmed</head><p>The exact sample size (n) for each experimental group/condition, given as a discrete number and unit of measurement (animals, litters, cultures, etc.)</p><p>A description of how samples were collected, noting whether measurements were taken from distinct samples or whether the same sample was measured repeatedly A statement indicating how many times each experiment was replicated</p><p>The statistical test(s) used and whether they are one-or two-sided (note: only common tests should be described solely by name; more complex techniques should be described in the Methods section)</p><p>A description of any assumptions or corrections, such as an adjustment for multiple comparisons</p><p>The test results (e.g. P values) given as exact values whenever possible and with confidence intervals noted A clear description of statistics including central tendency (e.g. median, mean) and variation (e.g. standard deviation, interquartile range)</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Clearly defined error bars</head><p>See the web collection on statistics for biologists for further resources and guidance.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Software</head><p>Policy information about availability of computer code</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="7.">Software</head><p>Describe the software used to analyze the data in this study.</p><p>We used several publicly available software programs: PhyML, FastTree, RAxML, python, perl, mafft, R, along with the following packages: ape, big.phylo, reshape2, ggplot2, jpHMM, tqdist, Seq-Gen, INDELible, Nextflow. The program and package versions are detailed on GitHub. We also used custom algorithms that we made publicly available on GitHub: booster, goalign, gotree (see https://github.com/fredericlemoine and https:// github.com/evolbioinfo).</p><p>For manuscripts utilizing custom algorithms or software that are central to the paper but not yet described in the published literature, software must be made available to editors and reviewers upon request. We strongly encourage code deposition in a community repository (e.g. GitHub). Nature Methods guidance for providing algorithms and software for publication provides further information on this topic.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Materials and reagents</head><p>Policy information about availability of materials</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="8.">Materials availability</head><p>Indicate whether there are restrictions on availability of unique materials or if these materials are only available for distribution by a for-profit company.</p><p>No restricton for material availability</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="9.">Antibodies</head><p>Describe the antibodies used and how they were validated for use in the system under study (i.e. assay and species).</p><p>No antibodies were used </p></div>			</div>
			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">Bootstrap methods: another look at the jackknife</title>
		<author>
			<persName><forename type="first">B</forename><surname>Efron</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Stat</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page" from="1" to="26" />
			<date type="published" when="1979">1979</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">An Introduction to the Bootstrap</title>
		<author>
			<persName><forename type="first">B</forename><surname>Efron</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">J</forename><surname>Tibshirani</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1993">1993</date>
			<publisher>Chapman &amp; Hall</publisher>
			<pubPlace>New York</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b2">
	<analytic>
		<title level="a" type="main">Confidence limits on phylogenies: an approach using the bootstrap</title>
		<author>
			<persName><forename type="first">J</forename><surname>Felsenstein</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Evolution</title>
		<imprint>
			<biblScope unit="volume">39</biblScope>
			<biblScope unit="page" from="783" to="791" />
			<date type="published" when="1985">1985</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">The top 100 papers</title>
		<author>
			<persName><forename type="first">R</forename><surname>Van Noorden</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Maher</surname></persName>
		</author>
		<author>
			<persName><forename type="first">R</forename><surname>Nuzzo</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">514</biblScope>
			<biblScope unit="page" from="550" to="553" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Objections to bootstrapping phylogenies: a critique</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">J</forename><surname>Sanderson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="page" from="299" to="320" />
			<date type="published" when="1995">1995</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<analytic>
		<title level="a" type="main">Bootstrapping phylogenetic trees: theory and methods</title>
		<author>
			<persName><forename type="first">S</forename><surname>Holmes</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Sci</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="241" to="255" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">An empirical test of bootstrapping as a method for assessing confidence in phyogenetic analysis</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">M</forename><surname>Hillis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">J</forename><surname>Bull</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">42</biblScope>
			<biblScope unit="page" from="182" to="192" />
			<date type="published" when="1993">1993</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Is there something wrong with the bootstrap on phylogenies? A reply to</title>
		<author>
			<persName><forename type="first">J</forename><surname>Felsenstein</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><surname>Kishino</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Hillis and Bull. Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">42</biblScope>
			<biblScope unit="page" from="193" to="200" />
			<date type="published" when="1993">1993</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Bootstrap confidence levels for phylogenetic trees</title>
		<author>
			<persName><forename type="first">B</forename><surname>Efron</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Halloran</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><surname>Holmes</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Proc. Natl Acad. Sci. USA</title>
		<imprint>
			<biblScope unit="volume">93</biblScope>
			<biblScope unit="page" from="7085" to="7090" />
			<date type="published" when="1996">1996</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<analytic>
		<title level="a" type="main">Bootstrap support is not first-order correct</title>
		<author>
			<persName><forename type="first">E</forename><surname>Susko</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">58</biblScope>
			<biblScope unit="page" from="211" to="223" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Estimation of confidence in phylogeny: the completeand-partial bootstrap technique</title>
		<author>
			<persName><forename type="first">A</forename><surname>Zharkikh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">W.-H</forename><surname>Li</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Phylogenet. Evol</title>
		<imprint>
			<biblScope unit="volume">4</biblScope>
			<biblScope unit="page" from="44" to="63" />
			<date type="published" when="1995">1995</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">First-order correct bootstrap support adjustments for splits that allow hypothesis testing when using maximum likelihood estimation</title>
		<author>
			<persName><forename type="first">E</forename><surname>Susko</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="1621" to="1629" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Applying the bootstrap in phylogeny reconstruction</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">E</forename><surname>Soltis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">S</forename><surname>Soltis</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Stat. Sci</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="256" to="267" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Frequentist properties of Bayesian posterior probabilities of phylogenetic trees under simple and complex substitution models</title>
		<author>
			<persName><forename type="first">J</forename><surname>Huelsenbeck</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><surname>Rannala</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="page" from="904" to="913" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Approximate likelihood-ratio test for branches: a fast, accurate, and powerful alternative</title>
		<author>
			<persName><forename type="first">M</forename><surname>Anisimova</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Gascuel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">55</biblScope>
			<biblScope unit="page" from="539" to="552" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Survey of branch support methods demonstrates accuracy, power, and robustness of fast likelihood-based approximation schemes</title>
		<author>
			<persName><forename type="first">M</forename><surname>Anisimova</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Gil</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">F</forename><surname>Dufayard</surname></persName>
		</author>
		<author>
			<persName><forename type="first">C</forename><surname>Dessimoz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Gascuel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">60</biblScope>
			<biblScope unit="page" from="685" to="699" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">A rapid bootstrap algorithm for the RAxML Web servers</title>
		<author>
			<persName><forename type="first">A</forename><surname>Stamatakis</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Hoover</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><surname>Rougemont</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="page" from="758" to="771" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Ultrafast approximation for phylogenetic bootstrap</title>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">Q</forename><surname>Minh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A T</forename><surname>Nguyen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Haeseler</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="1188" to="1195" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">The origin and diversity of the HIV-1 pandemic</title>
		<author>
			<persName><forename type="first">J</forename><surname>Hemelaar</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Trends Mol. Med</title>
		<imprint>
			<biblScope unit="volume">18</biblScope>
			<biblScope unit="page" from="182" to="192" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<analytic>
		<title level="a" type="main">Troubleshooting molecular phylogenetic analyses</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">J</forename><surname>Sanderson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">B</forename><surname>Shaffer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Annu. Rev. Ecol. Syst</title>
		<imprint>
			<biblScope unit="volume">33</biblScope>
			<biblScope unit="page" from="49" to="72" />
			<date type="published" when="2002">2002</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">Majority-rule reduced consensus trees and their use in bootstrapping</title>
		<author>
			<persName><forename type="first">M</forename><surname>Wilkinson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">13</biblScope>
			<biblScope unit="page" from="437" to="444" />
			<date type="published" when="1996">1996</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">Testing the phylogenetic stability of early tetrapods</title>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">L</forename><surname>Thorley</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><surname>Wilkinson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Theor. Biol</title>
		<imprint>
			<biblScope unit="volume">200</biblScope>
			<biblScope unit="page" from="343" to="344" />
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Sparse supermatrices for phylogenetic inference: taxonomy, alignment, rogue taxa, and the phylogeny of living turtles</title>
		<author>
			<persName><forename type="first">R</forename><forename type="middle">C</forename><surname>Thomson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">B</forename><surname>Shaffer</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">59</biblScope>
			<biblScope unit="page" from="42" to="58" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Pruning rogue taxa improves phylogenetic accuracy: an efficient algorithm and webservice</title>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">J</forename><surname>Aberer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><surname>Krompass</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Stamatakis</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">62</biblScope>
			<biblScope unit="page" from="162" to="166" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Confidence limits on phylogenies: the bootstrap revisited</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">J</forename><surname>Sanderson</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cladistics</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page" from="113" to="129" />
			<date type="published" when="1989">1989</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Using repeated measurements to validate hierarchical gene clusters</title>
		<author>
			<persName><forename type="first">L</forename><surname>Bréhélin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Gascuel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Martin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">24</biblScope>
			<biblScope unit="page" from="682" to="688" />
			<date type="published" when="2008">2008</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">Maximum transfer distance between partitions</title>
		<author>
			<persName><forename type="first">I</forename><surname>Charon</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><surname>Denoeud</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><surname>Guénoche</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Hudry</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Classif</title>
		<imprint>
			<biblScope unit="volume">23</biblScope>
			<biblScope unit="page" from="103" to="121" />
			<date type="published" when="2006">2006</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">The complexity of computing metric distances between partitions</title>
		<author>
			<persName><forename type="first">W</forename><forename type="middle">H E</forename><surname>Day</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Math. Soc. Sci</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="page" from="269" to="287" />
			<date type="published" when="1981">1981</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">A metric for phylogenetic trees based on matching</title>
		<author>
			<persName><forename type="first">Y</forename><surname>Lin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">V</forename><surname>Rajan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">M E</forename><surname>Moret</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">IEEE/ACM Trans. Comput. Biol. Bioinform</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="1014" to="1022" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">The jackknife and the bootstrap for general stationary observations</title>
		<author>
			<persName><forename type="first">H</forename><forename type="middle">R</forename><surname>Künsch</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Ann. Stat</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="1217" to="1241" />
			<date type="published" when="1989">1989</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Geometry of the space of phylogenetic trees</title>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">J</forename><surname>Billera</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">P</forename><surname>Holmes</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Vogtmann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Adv. Appl. Math</title>
		<imprint>
			<biblScope unit="volume">27</biblScope>
			<biblScope unit="page" from="733" to="767" />
			<date type="published" when="2001">2001</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Statistics and truth in phylogenomics</title>
		<author>
			<persName><forename type="first">S</forename><surname>Kumar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">J</forename><surname>Filipski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><forename type="middle">U</forename><surname>Battistuzzi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">S</forename><forename type="middle">L</forename><surname>Kosakovsky Pond</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K</forename><surname>Tamura</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">29</biblScope>
			<biblScope unit="page" from="457" to="472" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b32">
	<analytic>
		<title level="a" type="main">Maximum likelihood phylogenetic inference is consistent on multiple sequence alignments, with or without gaps</title>
		<author>
			<persName><forename type="first">J</forename><surname>Truszkowski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">N</forename><surname>Goldman</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">65</biblScope>
			<biblScope unit="page" from="328" to="333" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">FastTree 2-approximately maximumlikelihood trees for large alignments</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">N</forename><surname>Price</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><forename type="middle">S</forename><surname>Dehal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">A</forename><forename type="middle">P</forename><surname>Arkin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS ONE</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="page">9490</biblScope>
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Unifying the epidemiological and evolutionary dynamics of pathogens</title>
		<author>
			<persName><forename type="first">B</forename><forename type="middle">T</forename><surname>Grenfell</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">303</biblScope>
			<biblScope unit="page" from="327" to="332" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">jpHMM: improving the reliability of recombination prediction in HIV-1</title>
		<author>
			<persName><forename type="first">A.-K</forename><surname>Schultz</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">37</biblScope>
			<biblScope unit="page">651</biblScope>
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<analytic>
		<title level="a" type="main">Comparison of phylogenetic trees</title>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">F</forename><surname>Robinson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">L</forename><forename type="middle">R</forename><surname>Foulds</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Math. Biosci</title>
		<imprint>
			<biblScope unit="volume">53</biblScope>
			<biblScope unit="page" from="131" to="147" />
			<date type="published" when="1981">1981</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b37">
	<monogr>
		<title/>
		<author>
			<persName><forename type="first">C</forename><surname>Semple</surname></persName>
		</author>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A</forename><surname>Steel</surname></persName>
		</author>
		<author>
			<persName><surname>Phylogenetics</surname></persName>
		</author>
		<imprint>
			<date type="published" when="2003">2003</date>
			<publisher>Oxford Univ. Press</publisher>
			<pubPlace>Oxford</pubPlace>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title level="a" type="main">SMS: smart model selection in PhyML</title>
		<author>
			<persName><forename type="first">V</forename><surname>Lefort</surname></persName>
		</author>
		<author>
			<persName><forename type="first">J</forename><forename type="middle">E</forename><surname>Longueville</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Gascuel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">34</biblScope>
			<biblScope unit="page" from="2422" to="2424" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title level="a" type="main">Interactive tree of life (iTOL) v3: an online tool for the display and annotation of phylogenetic and other trees</title>
		<author>
			<persName><forename type="first">I</forename><surname>Letunic</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P</forename><surname>Bork</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nucleic Acids Res</title>
		<imprint>
			<biblScope unit="volume">44</biblScope>
			<biblScope unit="page" from="242" to="W245" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title level="a" type="main">Nextflow enables reproducible computational workflows</title>
		<author>
			<persName><forename type="first">P</forename><surname>Di Tommaso</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nat. Biotechnol</title>
		<imprint>
			<biblScope unit="volume">35</biblScope>
			<biblScope unit="page" from="316" to="319" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<analytic>
		<title level="a" type="main">tqDist: a library for computing the quartet and triplet distances between binary or general trees</title>
		<author>
			<persName><forename type="first">A</forename><surname>Sand</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Bioinformatics</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="2079" to="2080" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<analytic>
		<title level="a" type="main">MAFFT multiple sequence alignment software version 7: improvements in performance and usability</title>
		<author>
			<persName><forename type="first">K</forename><surname>Katoh</surname></persName>
		</author>
		<author>
			<persName><forename type="first">D</forename><forename type="middle">M</forename><surname>Standley</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">30</biblScope>
			<biblScope unit="page" from="772" to="780" />
			<date type="published" when="2013">2013</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title level="a" type="main">Phylodynamics of HIV-1 subtype C epidemic in east Africa</title>
		<author>
			<persName><forename type="first">E</forename><forename type="middle">O</forename><surname>Delatorre</surname></persName>
		</author>
		<author>
			<persName><forename type="first">G</forename><surname>Bello</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">PLoS ONE</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="page">41904</biblScope>
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b44">
	<analytic>
		<title level="a" type="main">A specific subtype C of human immunodeficiency virus type 1 circulates in Brazil</title>
		<author>
			<persName><forename type="first">M</forename><forename type="middle">A</forename><surname>Soares</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">AIDS</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="page" from="11" to="21" />
			<date type="published" when="2003">2003</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b45">
	<analytic>
		<title level="a" type="main">Identification of subtype C human immunodeficiency virus type 1 by subtype-specific PCR and its use in the characterization of viruses circulating in the southern parts of India</title>
		<author>
			<persName><forename type="first">N</forename><forename type="middle">B</forename><surname>Siddappa</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">J. Clin. Microbiol</title>
		<imprint>
			<biblScope unit="volume">42</biblScope>
			<biblScope unit="page" from="2742" to="2751" />
			<date type="published" when="2004">2004</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b46">
	<analytic>
		<title level="a" type="main">New algorithms and methods to estimate maximumlikelihood phylogenies: assessing the performance of PhyML 3.0</title>
		<author>
			<persName><forename type="first">S</forename><surname>Guindon</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Syst. Biol</title>
		<imprint>
			<biblScope unit="volume">59</biblScope>
			<biblScope unit="page" from="307" to="321" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b47">
	<analytic>
		<title level="a" type="main">INDELible: a flexible simulator of biological sequence evolution</title>
		<author>
			<persName><forename type="first">W</forename><surname>Fletcher</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Z</forename><surname>Yang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Mol. Biol. Evol</title>
		<imprint>
			<biblScope unit="volume">26</biblScope>
			<biblScope unit="page" from="1879" to="1888" />
			<date type="published" when="2009">2009</date>
		</imprint>
	</monogr>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
