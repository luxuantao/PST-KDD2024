<?xml version="1.0" encoding="UTF-8"?>
<TEI xml:space="preserve" xmlns="http://www.tei-c.org/ns/1.0" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
xsi:schemaLocation="http://www.tei-c.org/ns/1.0 https://raw.githubusercontent.com/kermitt2/grobid/master/grobid-home/schemas/xsd/Grobid.xsd"
 xmlns:xlink="http://www.w3.org/1999/xlink">
	<teiHeader xml:lang="en">
		<fileDesc>
			<titleStmt>
				<title level="a" type="main">GEOMOL: Torsional Geometric Generation of Molecular 3D Conformer Ensembles</title>
			</titleStmt>
			<publicationStmt>
				<publisher/>
				<availability status="unknown"><licence/></availability>
			</publicationStmt>
			<sourceDesc>
				<biblStruct>
					<analytic>
						<author>
							<persName><forename type="first">Octavian-Eugen</forename><surname>Ganea</surname></persName>
							<affiliation key="aff1">
								<orgName type="laboratory">Computer Science and Artificial Intelligence Laboratory</orgName>
								<orgName type="institution">MIT</orgName>
								<address>
									<postCode>02139</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
								</address>
							</affiliation>
						</author>
						<author role="corresp">
							<persName><forename type="first">Lagnajit</forename><surname>Pattanaik</surname></persName>
							<email>lagnajit@mit.edu</email>
							<affiliation key="aff0">
								<orgName type="department">Department of Chemical Engineering</orgName>
								<orgName type="institution">MIT</orgName>
								<address>
									<postCode>02139</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Connor</forename><forename type="middle">W</forename><surname>Coley</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Chemical Engineering</orgName>
								<orgName type="institution">MIT</orgName>
								<address>
									<postCode>02139</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Regina</forename><surname>Barzilay</surname></persName>
							<affiliation key="aff1">
								<orgName type="laboratory">Computer Science and Artificial Intelligence Laboratory</orgName>
								<orgName type="institution">MIT</orgName>
								<address>
									<postCode>02139</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Klavs</forename><forename type="middle">F</forename><surname>Jensen</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Chemical Engineering</orgName>
								<orgName type="institution">MIT</orgName>
								<address>
									<postCode>02139</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">William</forename><forename type="middle">H</forename><surname>Green</surname></persName>
							<affiliation key="aff0">
								<orgName type="department">Department of Chemical Engineering</orgName>
								<orgName type="institution">MIT</orgName>
								<address>
									<postCode>02139</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
								</address>
							</affiliation>
						</author>
						<author>
							<persName><forename type="first">Tommi</forename><forename type="middle">S</forename><surname>Jaakkola</surname></persName>
							<affiliation key="aff1">
								<orgName type="laboratory">Computer Science and Artificial Intelligence Laboratory</orgName>
								<orgName type="institution">MIT</orgName>
								<address>
									<postCode>02139</postCode>
									<settlement>Cambridge</settlement>
									<region>MA</region>
								</address>
							</affiliation>
						</author>
						<title level="a" type="main">GEOMOL: Torsional Geometric Generation of Molecular 3D Conformer Ensembles</title>
					</analytic>
					<monogr>
						<imprint>
							<date/>
						</imprint>
					</monogr>
				</biblStruct>
			</sourceDesc>
		</fileDesc>
		<encodingDesc>
			<appInfo>
				<application version="0.7.2" ident="GROBID" when="2022-12-25T13:37+0000">
					<desc>GROBID - A machine learning software for extracting information from scholarly documents</desc>
					<ref target="https://github.com/kermitt2/grobid"/>
				</application>
			</appInfo>
		</encodingDesc>
		<profileDesc>
			<abstract>
<div xmlns="http://www.tei-c.org/ns/1.0"><p>Prediction of a molecule's 3D conformer ensemble from the molecular graph holds a key role in areas of cheminformatics and drug discovery. Existing generative models have several drawbacks including lack of modeling important molecular geometry elements (e.g. torsion angles), separate optimization stages prone to error accumulation, and the need for structure fine-tuning based on approximate classical force-fields or computationally expensive methods such as metadynamics with approximate quantum mechanics calculations at each geometry. We propose GEOMOL-an end-to-end, non-autoregressive and SE(3)-invariant machine learning approach to generate distributions of low-energy molecular 3D conformers. Leveraging the power of message passing neural networks (MPNNs) to capture local and global graph information, we predict local atomic 3D structures and torsion angles, avoiding unnecessary over-parameterization of the geometric degrees of freedom (e.g. one angle per non-terminal bond). Such local predictions suffice both for the training loss computation, as well as for the full deterministic conformer assembly (at test time). We devise a non-adversarial optimal transport based loss function to promote diverse conformer generation. GEOMOL predominantly outperforms popular open-source, commercial, or state-of-the-art machine learning (ML) models, while achieving significant speed-ups. We expect such differentiable 3D structure generators to significantly impact molecular modeling and related applications. 4  </p></div>
			</abstract>
		</profileDesc>
	</teiHeader>
	<text xml:lang="en">
		<body>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="1">Overview</head><p>Problem &amp; importance. We tackle the problem of molecular conformer generation (MCG), i.e. predicting the ensemble of low-energy 3D conformations of a small molecule solely based on the molecular graph (fig. <ref type="figure" target="#fig_0">1</ref>). A single conformation is represented by the list of 3D coordinates for each atom in the respective molecule. In this work, we assume that the low-energy states are implicitly defined by the given dataset, i.e. our training data consist of molecular graphs and corresponding sets of energetically favorable 3D conformations. Low-energy structures are the most stable configurations and, thus, expected to be observed most often experimentally.</p><p>Dealing with molecules in their natural 3D structure is of great importance in areas such as cheminformatics or computational drug discovery because conformations determine biological, chemical, and physical properties <ref type="bibr" target="#b15">[Guimaraes et al., 2012</ref><ref type="bibr" target="#b41">, Schütt et al., 2018</ref><ref type="bibr" target="#b29">, Klicpera et al., 2019</ref><ref type="bibr" target="#b2">, Axelrod and Gomez-Bombarelli, 2020b</ref><ref type="bibr" target="#b42">, Schütt et al., 2021</ref><ref type="bibr" target="#b32">, Liu et al., 2021]</ref> such as charge distribution, potential energy, docking poses <ref type="bibr" target="#b34">[McGann, 2011]</ref>, shape similarity <ref type="bibr" target="#b30">[Kumar and Zhang, 2018]</ref>, pharmacophore searching <ref type="bibr" target="#b43">[Schwab, 2010]</ref>, or descriptors for 3/4D QSAR <ref type="bibr" target="#b50">[Verma et al., 2010]</ref>. For instance, in drug design it is crucial to understand how a molecule binds to a specific target protein; this process heavily depends on the 3D structures of the two components, both in terms of geometric (shape matching) and chemical (hydrophobic/hydrophilic) interactions <ref type="bibr" target="#b11">[Gainza et al., 2020</ref><ref type="bibr">, Sverrisson et al., 2020]</ref>.</p><p>Motivation &amp; challenges of existing methods. The main challenge in MCG comes from the enormous size of the 3D structure space consisting of bond lengths, bond angles, and torsion angles. It is known that the molecular graph imposes specific constraints on possible 3D conformations, e.g. bond length ranges depend on the respective bond types, while chiral centers dictate local spatial arrangement. However, the space of possible conformations grows exponentially with the graph size and number of rotatable bonds, thus hindering exhaustive brute force exploration even for relatively small molecules. Additionally, the number of plausibly-stable low-energy states is unknown a priori and can vary between one and several thousand conformations for a single molecule <ref type="bibr" target="#b6">[Chan et al., 2021]</ref>. Nevertheless, various facets of the curse of dimensionality have been favorably tackled by ML models in different contexts, and our goal is to build on the recent ML efforts for MCG <ref type="bibr" target="#b33">[Mansimov et al., 2019</ref><ref type="bibr" target="#b46">, Simm and Hernandez-Lobato, 2020</ref><ref type="bibr">, Lemm et al., 2021</ref><ref type="bibr">, Xu et al., 2021]</ref>.</p><p>Molecular conformations can be determined experimentally, but existing techniques are very expensive. As a consequence, predictive computational models have been developed over the past few decades, traditionally being categorized as either stochastic or systematic (rule-based) methods <ref type="bibr" target="#b22">[Hawkins, 2017]</ref>. Stochastic approaches have traditionally been based on molecular dynamics (MD) or Markov chain Monte Carlo (MCMC) techniques, potentially combined with genetic algorithms (GAs). They can do extensive explorations of the energy landscape and accurately sample equilibrium structures, but quickly become prohibitively slow for larger molecules <ref type="bibr" target="#b45">[Shim and MacKerell Jr, 2011</ref><ref type="bibr" target="#b3">, Ballard et al., 2015</ref><ref type="bibr" target="#b8">, De Vivo et al., 2016</ref><ref type="bibr" target="#b22">, Hawkins, 2017]</ref>, e.g. they require several CPU minutes for a single drug-like molecule. Moreover, stochastic methods have difficulties sampling diverse and representative conformers, prioritizing quantity over quality. On the other hand, rule-based systematic methods achieve state-of-the-art in commercial software <ref type="bibr" target="#b10">[Friedrich et al., 2017]</ref> with <ref type="bibr">OMEGA [Hawkins et al., 2010, Hawkins and</ref><ref type="bibr" target="#b23">Nicholls, 2012]</ref> being a popular example. They usually process a single drug-like molecule under a second. They address the aforementioned challenges of stochastic methods by relying on carefully curated torsion templates (torsion rules), rule-based generators, and knowledge bases of rigid 3D fragments, which are assembled together and combined with subsequent stability score ranking. However, torsion angles are mostly varied independently (based on their fragments), without explicitly capturing their global interactions, which results in difficulties for larger and more flexible molecules. Furthermore, the curated fragments and rules are inadequate for more challenging inputs (e.g. transition states or open-shell molecules).</p><p>Both types of methods can be combined with Distance Geometry (DG) techniques to generate the initial 3D conformation. First, the 3D atom distance matrix is generated based on a set of distance constraints or from a specialized model. Subsequently, the corresponding 3D atom coordinates are learned to approximately match these predicted distances <ref type="bibr" target="#b21">[Havel et al., 1983b</ref><ref type="bibr" target="#b7">,a, Crippen et al., 1988</ref><ref type="bibr" target="#b19">, Havel, 1998</ref><ref type="bibr" target="#b31">, Lagorce et al., 2009</ref><ref type="bibr" target="#b40">, Riniker and Landrum, 2015]</ref>. Indeed, modern stochastic algorithms are entirely based on DG methods <ref type="bibr" target="#b40">[Riniker and Landrum, 2015]</ref>. The inductive bias of rotational and translational invariance is guaranteed for DG, thus being appealing for ML models <ref type="bibr" target="#b46">[Simm and Hernandez-Lobato, 2020</ref><ref type="bibr">, Xu et al., 2021</ref><ref type="bibr" target="#b37">, Pattanaik et al., 2020b]</ref>. However, several drawbacks weaken this important direction: i) the distance matrix is overparameterized compared to the actual number of degrees of freedom, ii) it is difficult to enforce 3D Euclidean distance constraints as well as geometric graph constraints (e.g. on torsion angles or rings <ref type="bibr" target="#b40">[Riniker and Landrum, 2015]</ref>); iii) important aspects of molecular geometry are not explicitly modeled, e.g. torsion angles of rotatable bonds or chiral centers; iv) expensive force-field energy fine-tuning of the generated conformers is vital for a reasonable quality <ref type="bibr">[Xu et al., 2021, Simm and</ref><ref type="bibr" target="#b46">Hernandez-Lobato, 2020]</ref>; iv) the resulting multi-stage pipeline is prone to error accumulation as opposed to an end-to-end model.</p><p>Previous methods often rely on a force field (FF) energy function minimization to fine-tune the conformers. These are hand-designed energy models which use parameters estimated from experi-ment and/or computed from quantum mechanics (e.g. Universal Force Field <ref type="bibr" target="#b39">[Rappé et al., 1992]</ref>, Merck Molecular Force Field <ref type="bibr" target="#b16">[Halgren, 1996]</ref>). However, FFs are crude approximations of the true molecular potential energy surface <ref type="bibr" target="#b27">[Kanal et al., 2018]</ref>, limited in the interactions they can capture in biomolecules due to their strong assumptions <ref type="bibr" target="#b4">[Barman et al., 2015]</ref>. In addition, FF energy optimization is relatively slow and increases error accumulation in a multi-pipeline method.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Relation to protein folding.</head><p>There has been impressive recent progress on modeling protein folding dynamics <ref type="bibr" target="#b25">[Ingraham et al., 2018</ref><ref type="bibr" target="#b0">, AlQuraishi, 2019</ref><ref type="bibr" target="#b35">, Noé et al., 2019</ref><ref type="bibr" target="#b44">, Senior et al., 2020]</ref>, where crystallized 3D structures are predicted solely from the amino-acid sequence using ML methods. However, molecules pose unique challenges, being highly branched graphs containing cycles, different types of bonds, and chirality information. This makes protein folding approaches not readily transferable to general molecular data.</p><p>Our key contributions &amp; model in a nutshell. In this work, we investigate the question:</p><p>Can we design fast ML generative models of high quality, representative, diverse, and generalizable low-energy 3D conformational ensembles from molecular graphs?</p><p>To tackle this question, we propose GEOMOL (shown in fig. <ref type="figure" target="#fig_1">2</ref>), exhibiting the following merits:</p><p>• It is end-to-end trainable, non-autoregressive, and does not rely on DG techniques (thus avoiding aforementioned drawbacks). More precisely, it outputs a minimal set of geometric quantities (i.e. angles and distances) sufficient for full deterministic reconstruction of the 3D conformer. • It models conformers in an SE(3)-invariant (translation/rotation) manner by design. This desirable inductive bias was previously either achieved using multi-step DG methods <ref type="bibr" target="#b46">[Simm and Hernandez-Lobato, 2020]</ref> or not captured at all <ref type="bibr" target="#b33">[Mansimov et al., 2019</ref>]. • It explicitly models and predicts essential molecular geometry elements: torsion angles and local 3D structures (bond distances and bond angles adjacent to each atom). Together with the input molecular graph, these are used for k-hop distance computation at train time and full deterministic conformation assembly at test time. Crucially, we do not over-parameterize these predictions, i.e. a single torsion angle is computed per each non-terminal bond, irrespective of the number and permutation of the neighboring atoms at each end-point of the respective bond. • The above geometric elements (torsion angles, local structures) are SE(3)-invariant (by definition or usage) and we jointly predict them using MPNNs <ref type="bibr" target="#b13">[Gilmer et al., 2017]</ref> and self-attention networks. Thus, unlike <ref type="bibr" target="#b33">[Mansimov et al., 2019]</ref>, we are not affected by MPNNs' pitfalls that obstruct direct predictions of 3D atom coordinates from node embeddings, e.g. symmetric or locally isomorphic nodes would always have identical MPNN embeddings <ref type="bibr" target="#b51">[Xu et al., 2019</ref><ref type="bibr" target="#b12">, Garg et al., 2020]</ref> and, as a consequence, would be inappropriately assigned identical 3D coordinates. • To promote diverse conformer ensembles with good coverage, we devise a tailored generative loss that does not use slow or difficult-to-optimize adversarial training techniques. Using optimal transport, GEOMOL finds the best matching between generated and ground truth conformers based on their pairwise log-likelihood loss, requiring only minimization. • It explicitly and deterministically distinguishes reflected structures (enantiomers) by solving tetrahedral chiral centers using oriented volumes and local chiral descriptors, bypassing the need for iterative optimization usually done in DG approaches. • Empirically, we conduct experiments on two benchmarks: GEOM-QM9 (smaller molecules relevant to gas-phase chemistry) and GEOM-DRUGS (drug-like molecules) <ref type="bibr" target="#b1">[Axelrod and Gomez-Bombarelli, 2020a]</ref>. Our method often outperforms previous ML and two popular open-source or commercial methods in different metrics. Moreover, we show competitive quality even without the frequently-used computationally-demanding fine-tuning FF strategies. • GEOMOL processes drug-like molecules in seconds or less, being orders of magnitude faster than popular baselines (e.g. ETKDG/RDKit <ref type="bibr" target="#b40">[Riniker and Landrum, 2015]</ref>), without sacrificing quality.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2">Method</head><p>Problem setup &amp; notations. Our input is any molecular graph G = (V, E) with node and edge features, bond types, etc. For each molecular graph G, we have a variable-size set of low-energy ground truth 3D conformers {C * l } l that we predict with a model</p><formula xml:id="formula_0">x v ∈ R f , ∀v ∈ V and e u,v ∈ R f , ∀(u, v) ∈ E representing atom types, formal charges,</formula><formula xml:id="formula_1">{C k } k def = ζ(G). A conformer is a map C : V → R 3 from graph nodes to 3D coordinates, but a simplified notation is c v ∈ R 3 for v ∈ V . We use additional notations: d(X, Y ) = c X − c Y is the 3D distance between X and Y; ∠XY Z is the counter-clockwise (CCW) angle ∠c X c Y c Z ; ∠(XY Z, XY T ) is the CCW dihedral angle of the 2D planes c X c Y c Z and c X c Y c T (formula is in appendix C). We use the corresponding c * v , d * (X, Y ), ∠ * XY Z, ∠ * (XY Z, XY T</formula><p>) when manipulating a ground truth conformer. Any conformer is defined up to a SE(3) transformation, i.e. any translation or rotation applied to the set {c v } v∈V . A classic conformer distance function that satisfies this constraint is root-mean-square deviation of atomic positions (RMSD), computed by the Kabsch alignment algorithm <ref type="bibr" target="#b26">[Kabsch, 1976]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.1">GEOMOL high-level overview</head><p>Our approach, shown in fig. <ref type="figure" target="#fig_1">2</ref>, comprises three steps. First, we predict the local 3D structure of each non-terminal atom, which we deem local structure (LS), by combining self-attention layers and MPNNs with deterministic corrections for chiral centers. Bond distances and bond angles are computed from the predicted LS. Next, we assemble all neighboring pairs of LSs by predicting the torsion angles and aligning them. Importantly, since LSs are fixed, it suffices to only predict a single value for the dihedral angle of each bond. Towards this goal, we develop a canonical representation of torsion angles via a local coordinate system defined SE(3)-equivariantly w.r.t. the full structure, which allows us to predict exactly the number of degrees of freedom. Finally, at test time, we assemble all predicted pairs of neighboring LSs to construct the full conformer, applying deterministic ring corrections. In order to generate diverse conformers, we append random Gaussian noise vectors to each initial node feature vector and use an optimal transport-based loss function for training.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.2">Message passing neural networks (MPNNs)</head><p>Given an input graph G, an MPNN <ref type="bibr" target="#b13">[Gilmer et al., 2017</ref><ref type="bibr" target="#b5">, Battaglia et al., 2018</ref><ref type="bibr" target="#b53">, Yang et al., 2019]</ref> computes node embeddings h v ∈ R d , ∀v ∈ V using T layers of iterative message passing:</p><formula xml:id="formula_2">h (t+1) u = ψ h (t) u , v∈Nu φ(h (t) v , h (t)</formula><p>u , e u,v ) , where h (0)</p><formula xml:id="formula_3">v def = concat[x v , z v ], z v ∼ N (0, sI d )</formula><p>(1) for each t ∈ [0 .. T − 1], where N u = {v ∈ V |(u, v) ∈ E}, while ψ and φ are generic functions, e.g. implemented using multilayer perceptrons (MLP) or attention <ref type="bibr" target="#b49">[Veličković et al., 2017]</ref>. Final node embeddings are obtained by the embedding of the last layer:</p><formula xml:id="formula_4">h v def = h (T )</formula><p>v , ∀v ∈ V . Finally, we also compute a molecular embedding: h mol def = M LP ( v∈V h v ). We leave comparison with other MPNN variants for future work, e.g. <ref type="bibr" target="#b28">Kipf and Welling [2017]</ref>, <ref type="bibr" target="#b49">Veličković et al. [2017</ref><ref type="bibr" target="#b18">], Hamilton et al. [2017]</ref>, <ref type="bibr" target="#b51">Xu et al. [2019]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.3">Local structure (1-hop) prediction model</head><p>Following notations in fig. <ref type="figure">3</ref>, for each non-terminal graph vertex X ∈ V having n graph neighbors N X = {T i } i∈[1..n] , we predict its local 3D structure (LS), i.e. the relative 3D positions of all T i , when X is centered in the origin. The generic model is a function f (h T1 , . . . , h Tn ; h X ) = (p 1 , . . . , p n ) ∈ R 3×n that, additionally, should satisfy permutation equivariance w.r.t. T i 's, namely, the 3D position of each neighbor T i should not change regardless of the ordering of the X's neighbors:</p><formula xml:id="formula_5">f (h T π(1) , . . . , h T π(n) ; h X ) = (p π(1) , . . . , p π(n) ), ∀π ∈ S n</formula><p>(2)</p><p>Figure <ref type="figure">3</ref>: For each non-terminal atom X, we predict the relative 3D position of each of its graph neighbors, {T i } i∈[1.</p><p>.n] , in a permutation equivariant way.</p><p>Our choice is the encoder part of a transformer <ref type="bibr" target="#b48">[Vaswani et al., 2017]</ref>, without any positional encoding, thus satisfying permutation equivariance. This model takes as input the set {concat[h Ti , h X ]; i ∈ [1.</p><p>.n]} in any order and synchronously updates the n embeddings based on several transformer layers.</p><p>The final layer projects the embeddings to 3 dimensions, resulting in a list (p 1 , . . . , p n ) ∈ R 3×n having the exact same node order as the input list.</p><p>Enforcing local consistency. We desire the LS model f () to be distance-consistent, i.e. any bond distance d(X, Y ) is the same, no matter if it is computed from the LS of node X or of node Y. To achieve this, we use the above transformer just to compute bond directions (which will be aligned using a separate approach described in section 2.4), while we obtain the bond distances with a separate symmetric model. Concretely, let the above transformer f () predict (p 1 , . . . , p n ) ∈ R 3×n , while the final local 3D coordinates are</p><formula xml:id="formula_6">p i def = pi pi d GN N (h X , h Ti ), ∀i, where each bond distance is predicted with a symmetric model d GN N (h X , h Y ) def = softplus(ψ(h X , h Y ) + ψ(h Y , h X )), ∀(X, Y ) ∈ E,</formula><p>with the same shared ψ (e.g. an MLP). For notation simplicity, we will just use p i instead of p i .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>What about SE(3) invariance?</head><p>The above model is not SE(3)-invariant per se, but it is used as such. Namely, on one hand we compute SE(3)-invariant quantities: 1-hop distances d(T i , X), 2-hop distances d(T i , T j ), and bending angles ∠T i XT j . These will be compared to their ground-truth counterparts in the final loss, see section 2.5. On the other hand, the LS of adjacent graph nodes are assembled together for computing torsion angles or for building the full conformer at test time. This process is explicitly defined to be SE(3)-invariant as described in section 2.4.</p><p>Tetrahedral chiral corrections. When embedding the local neighborhood of a node in 3D space, one has to carefully account for tetrahedral chiral centers (fig. <ref type="figure" target="#fig_2">4</ref>). Tetrahedral chirality is a common form of stereochemistry which restricts the 3D location of neighboring substituents of a central atom with four distinct neighbors; molecules which differ by a single tetrahedral chiral center, i.e. enantiomers, are mirror images of each other. Chirality heavily impacts some properties of small molecules-e.g. bioactivity. Existing MPNNs using only the molecular graph cannot distinguish chiral centers (fig. <ref type="figure" target="#fig_2">4</ref>), but solutions exist <ref type="bibr" target="#b36">[Pattanaik et al., 2020a]</ref>. Mathematically, enantiomers can be differentiated based on the oriented volume around the chiral center. That is, given the ordered set of neighbor 3D coordinates around the center, namely p 1 , p 2 , p 3 , p 4 ∈ R 3 , the sign of the volume of the tetrahedron formed by the neighbors is</p><formula xml:id="formula_7">OV (p 1 , p 2 , p 3 , p 4 ) def = sign    1 1 1 1 x 1 x 2 x 3 x 4 y 1 y 2 y 3 y 4 z 1 z 2 z 3 z 4   </formula><p>Enantiomeric structures always have opposite signs for the oriented volume <ref type="bibr" target="#b7">[Crippen et al., 1988]</ref>. Since we generate local 3D structures directly, we can also use local 3D chiral descriptors to ensure the correct generation of tetrahedral chiral centers. RDKit internally keeps track of these local chiral labels, denoted by CW/CCW labels (detailed in e.g. <ref type="bibr" target="#b36">Pattanaik et al. [2020a]</ref>). Importantly, each local chiral label corresponds to a certain oriented volume (CW = +1 and CCW = -1). Thus, when generating an LS for a tetrahedral center, we calculate the oriented volume and check against the internal RDKit label. If it results in the incorrect oriented volume (i.e. the incorrect chiral center was generated), we simply reflect the structure by flipping against the z-axis. This ensures that all chiral centers are generated exactly, and no iterative optimization is necessary as with traditional DG-based generators.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="2.4">Torsion angle representation and local structure (LS) assembly</head><p>Once the LS of each atom/vertex is predicted, we assemble them in pairs corresponding to each non-terminal bond in the molecular graph. We describe this process for a bond connecting atoms X and Y, each having additional graph neighbors</p><formula xml:id="formula_8">{T i } i∈[1..n] and, resp., {Z j } j∈[1..m] . See fig. 5.</formula><p>Torsion angle over-parameterization. We first note that, for any assembled bond XY (fig. <ref type="figure" target="#fig_3">5</ref>, right), and ∀i, k ∈ [1..n], ∀j, l ∈ [1..m], the dihedral angles ∠(XY T i , XY T k ) and ∠(XY Z l , XY Z j ) are fully determined by the LS of nodes X and Y, respectively, so they do not depend on torsion angles. Next, observe that there is exactly one torsion angle for any bond XY, given unique indexing of the neighbors. This happens because of the constraint on ∠(XY T i , XY Z j ) and ∠(XY T k , XY Z l ):</p><formula xml:id="formula_9">∠(XY T i , XY Z j ) = [∠(XY T k , XY Z l ) + ∠(XY T i , XY T k ) + ∠(XY Z l , XY Z j )](mod 2π) (3)</formula><p>Thus, in order to avoid unnecessary over-parameterization, we should predict a single torsion angle α. Torsion angle formulation. However, it is still unclear at this point how to define this unique angle in a canonical way that is both: i) permutation invariant w.r.t. the nodes in the set</p><formula xml:id="formula_10">{T i } i∈[1.</formula><p>.n] and, respectively, in the set {Z j } j∈[1..m] , and ii) SE(3)-invariant w.r.t. the full 3D conformer.</p><formula xml:id="formula_11">Let ∆ ij def = ∠(XY T i , XY Z j ) and s ij def = cos(∆ ij ) sin(∆ ij ) . Let c ij ∈ R be real coefficients such that s def = i,j c ij s ij ∈ R 2</formula><p>is not the null vector. Then, we define the torsion angle as<ref type="foot" target="#foot_0">5</ref> :</p><formula xml:id="formula_12">α def = atan2( s s ).</formula><p>It is easy to see that this formulation satisfies both invariances claimed above. We further state (and prove in appendix A) that our proposed formulation gives a torsion angle uniquely determined by all local angles ∠(Y XT i , Y XT k ), ∠(Y XZ j , Y XZ l ) and by the true underlying torsion angle: Proposition 1. Given 3D coordinates of nodes X, Y, T i , Z j and fixed weights</p><formula xml:id="formula_13">c ij ∈ R such that i,j c ij s ij ∈ R 2 is not the null vector, then α def = atan2( s s</formula><p>) is unique, i.e. if we change the torsion angle of edge XY, then α will change. Formally, if we rotate the set of bonds {XT i } i jointly around the line XY with the same angle γ, then α will be shifted with γ.</p><p>How to set c ij ? Breaking symmetries. A simple solution is to choose c ij = 1, ∀i, j. However, in some important cases, local symmetries may result in s = 0. For example, this happens if, for some j, we have</p><formula xml:id="formula_14">∆ ij = 2iπ n + ct., ∀i ∈ [1..n].</formula><p>One solution is to use different c ij to differentiate between the different subgraphs rooted at different T i (and similarly for Z j ). This is reminiscent of traditional group priorities used for distinguishing E/Z isomers. We devise a flexible solution: a differentiable real value function computed from the MPNN node embeddings as c ij = M LP (h Ti + h Zj ) ∈ R, with MLP being a network shared across all bonds and molecules. Note that we constrain c ij = c ji , thus guaranteeing that the same α is obtained if we swap X and Y (and their neighbors, respectively).</p><p>Final LS assembly for a single bond. We now describe the assembly process depicted in fig. <ref type="figure" target="#fig_3">5</ref>. We first predict the LS of node X as in section 2.3, giving some</p><formula xml:id="formula_15">p X = 0, p Y , p Ti ∈ R 3 , ∀i ∈ [1..n],</formula><p>as well as the LS of node Y, giving q Y = 0, q X , q Zj ∈ R 3 , ∀j ∈ [1..m]. By design, we have that q X = p Y . These two sets are currently not aligned. To achieve this, we first rotate the LS of X such that p Y becomes [ p Y 0 0] , while p X remains 0. Next, we rotate and translate the LS of Y such that q Y becomes p Y and q X becomes p X = 0. These two rotations have one degree of freedom each, which we set randomly. Exact formulas are in appendix B. Thus, the bond XY is now matched, but the torsional rotation is still arbitrary/random. The remaining step is to rotate the LS of X with an angle γ such that all dihedrals ∠(XY T i , XY Z j ) match their true counterparts. This is done by applying to all vectors p Ti the same rotation of type:</p><formula xml:id="formula_16">H γ := 1 0 0 0 cos(γ) − sin(γ) 0 sin(γ) cos(γ)</formula><p>.</p><p>How to compute γ? The current dihedrals ∆ cur ij def = ∠ cur (XY T i , XY Z j ) depend on the random torsional rotations from the previous assembly step. After applying the H γ rotation, we obtain the new dihedral angles: [∆ cur ij − γ] mod 2π that should match the ground truth dihedral angles</p><formula xml:id="formula_17">∆ * ij def = ∠ * (XY T i , XY Z j ). This is equivalently written as s * ij = A cur ij s γ , where s γ def = cos(γ) sin(γ)</formula><p>and</p><formula xml:id="formula_18">A cur ij def = cos(∆ cur ij ) sin(∆ cur ij ) sin(∆ cur ij ) − cos(∆ cur ij ) . Let s * def = i,j c ij s * ij and A cur def = i,j c ij A cur ij .</formula><p>The necessary condition for γ becomes s γ = (A cur ) s * , which is also sufficient due to proposition 1.</p><p>This implies it is enough to predict only the normalized cos(α) sin(α) def = s * s * , from which γ follows. We predict α using a function commutative in X and Y (i.e. swapping X and Y does not change α):</p><formula xml:id="formula_19">α = [φ(h X , h Y , h mol ) + φ(h Y , h X , h mol )]mod 2π (4)</formula><p>where φ is a neural network (e.g. MLP). Finally, [2020], we fit distances using normal distributions and angles using von Mises distributions. This is a much faster approach compared to habitual RMSD losses that compare full conformers. Dealing with node symmetries.</p><formula xml:id="formula_20">s γ = cos(γ) sin(γ) = 1 (A cur ) s * (A cur ) s * .</formula><p>Our current formulation has difficulties distinguishing pairs of symmetric graph nodes that are less than 3 hops away, e.g. hydrogen groups. We address this using a tailored matching loss detailed in appendix D and exemplified in fig. <ref type="figure" target="#fig_5">6</ref>.</p><p>Total OT loss per ensemble of conformers.</p><p>In practice, our model generates a set of conformers {C k } k∈[1..K] that needs to match a variable sized set of low-energy ground truth conformers,</p><formula xml:id="formula_21">{C * l } l∈[1..L]</formula><p>. However, we do not know a priori the number L of true conformers or the matching between generated and true conformers. We also wish to avoid expensive and problematic adversarial training. Our solution is an OT-based, minimization-only, loss function:</p><formula xml:id="formula_22">L ensemble def = W L(•,•) ({C k } k , {C * l } l ) = min T∈Q K,L k,l T kl L(C k , C * l )</formula><p>where T is the transport plan satisfying Knowing all true LSs and torsion angles is, in theory, enough for a deterministic unique SE(3)invariant reconstruction of the full conformer. However, in practice, these predictions might have small errors that accumulate, e.g. in rings. To mitigate this issue, we deterministically build the full conformer (only at test time) by first predicting a smoothed structure of (fused) rings separately, and then assembling the full conformer following any graph traversal order (any order gives the same conformer, so this procedure does not break the non-autoregressive behavior). We detail this step in appendix E.</p><formula xml:id="formula_23">Q K,L def = {T ∈ R K×L + : T1 L = 1 K 1 K , T T 1 K = 1 L 1 L }.</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="3">Experiments</head><p>We empirically evaluate GEOMOL on the task of low-energy conformer ensemble generation for small and drug-like molecules. We largely follow the evaluation protocols of recent methods <ref type="bibr" target="#b46">[Simm and</ref><ref type="bibr">Hernandez-Lobato, 2020, Xu et al., 2021]</ref>, but also introduce new useful metrics.</p><p>Datasets &amp; splits.</p><p>We use two popular datasets: GEOM-QM9 <ref type="bibr" target="#b38">[Ramakrishnan et al., 2014</ref>] and GEOM-DRUGS <ref type="bibr" target="#b1">[Axelrod and Gomez-Bombarelli, 2020a]</ref>. Statistics and other details are in fig. <ref type="figure" target="#fig_9">10</ref> and in <ref type="bibr" target="#b33">Mansimov et al. [2019]</ref>. Datasets are preprocessed as described in appendix G. We split them randomly based on molecules into train/validation/test (80%/10%/10%). At the end, for each dataset, we sample 1000 random test molecules as the final test set. Thus, the splits contain 106586/13323/1000 and 243473/30433/1000 molecules for GEOM-QM9 and GEOM-DRUGS, resp.</p><p>Baselines. We compare to established or recent baselines (discussed in section 1). ETKDG/RDKit <ref type="bibr" target="#b40">[Riniker and Landrum, 2015]</ref> is likely the most popular open-source software, a stochastic DG-based method developed in the RDKit package. OMEGA <ref type="bibr" target="#b24">[Hawkins et al., 2010</ref><ref type="bibr" target="#b23">, Hawkins and Nicholls, 2012</ref><ref type="bibr" target="#b10">, Friedrich et al., 2017]</ref>, a rule-based method, is one of the most established commercial software, with more than a decade of continuous development. OMEGA and ETKDG are some of the fastest and best scaling existing approaches. Finally, we compare with the recent ML models of highest reported quality: GraphDG <ref type="bibr" target="#b46">[Simm and Hernandez-Lobato, 2020]</ref> and CGCF <ref type="bibr">[Xu et al., 2021]</ref>.</p><p>Evaluation metrics. We follow prior work <ref type="bibr" target="#b46">[Simm and</ref><ref type="bibr">Hernandez-Lobato, 2020, Xu et al., 2021]</ref> and use root-mean-square deviation of atomic positions (RMSD) to compare any two conformers. This is defined as the normalized Frobenius norm of the two corresponding matrices of 3D coordinates after being SE(3)-aligned a priori (using the Kabsch alignment algorithm <ref type="bibr" target="#b26">[Kabsch, 1976]</ref>). Next, we introduce four types of metrics to compare two conformer ensembles, generated by a method, </p><formula xml:id="formula_24">COV -R (Recall) def = 1 L |{l ∈ [1..L] : ∃k ∈ [1..K], RM SD(C k , C * l ) &lt; δ}| AMR -R (Recall) def = 1 L l∈[1..L] min k∈[1..K] RM SD(C k , C * l )<label>(5)</label></formula><p>where AMR is "Average Minimum RMSD", COV is "Coverage", and COV -P (Precision) and AMR -P (Precision) are defined as in eq. ( <ref type="formula" target="#formula_24">5</ref>), but with the generated and ground truth conformer sets swapped.</p><p>The recall metrics measure how many of the ground truth conformers are correctly predicted, while the precision metrics indicate how many generated structures are of high quality. Specifically, in terms of recall, COV measures the percentage of correct generated conformers from the ground truth set (where a correct conformer is defined as one within an RMSD threshold of the true conformer), while AMR measures the average RMSD of each generated conformer with its closest groun truth match. Depending on the application, either of the metrics might be of greater interest. We follow <ref type="bibr">Xu et al. [2021]</ref> and set δ = 0.5Å for GEOM-QM9 and δ = 1.25Å for GEOM-DRUGS.</p><p>Training and test details. For each input molecule having K ground truth conformers, we generate exactly 2K conformers using any of the considered methods. For GEOMOL, this is done by sampling different random noise vectors that are appended to node and edge features before the MPNN (eq. ( <ref type="formula">1</ref>)).</p><p>At train time, our model uses a standard deviation (std) s (see eq. ( <ref type="formula">1</ref>)) of 5 for both GEOM-QM9 and GEOM-DRUGS. At test time, GEOMOL can use the same or different s values, depending on the downstream application, i.e. higher s results in more diverse conformers, while lower s gives more quality (better precision). For OMEGA, it is not possible to specify a desired number of conformers. So, we tune the RMSD threshold (which decides how many conformers to keep) such that the total generated conformers by OMEGA are approximately 2K. For GEOM-QM9, this corresponds to no RMSD cutoff (i.e. OMEGA generates all possible conformers), and for GEOM-DRUGS, this corresponds to a cutoff of 0.7Å (meaning no two generated conformers will have a distance smaller than this cutoff). We discuss hyper-parameters and additional training details in appendix H. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Results</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head n="4">Conclusion</head><p>We proposed GEOMOL, an end-to-end generative approach for molecular 3D conformation ensembles that explicitly models various molecular geometric aspects such as torsion angles or chirality. We expect that such differentiable structure generators will significantly impact small molecule conformer generation along with many related applications (e.g. protein-ligand binding), thus speeding up areas such as drug discovery. GEOMOL's full source code will be made publicly available.</p><p>Limitations &amp; future work. A few current limitations are highlighted and left for future extensions (see also discussion in appendix O). First, our model does not currently support disconnected molecular graphs, e.g. ionic salts, but it can be applied to each connected component, followed by a 3D alignment. Next, our approach would benefit from explicit modeling of long distance interactions, especially for macrocycles or large molecules. This remains to be addressed in an efficient manner. Third, explicitly using ground truth energy values could further improve GEOMOL. Last, we look forward to fine-tune GEOMOL on applications such as generating molecular docking poses or descriptors for 4D QSAR.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>A Proof of proposition 1</head><p>Proof. Let's assume we apply a random CCW torsion rotation of angle γ ∈ (0, 2π) around bond XY to all bonds XT i . We will prove that the resulting α will be shifted exactly by γ. Let us denote the current dihedrals after the γ rotation by ∆ cur ij = ∠ cur (XY T i , XY Z j ) mod 2π. Also, denote by ∆ ij = ∠(XY T i , XY Z j ) mod 2π the dihedral angles before rotation. We have the relation</p><formula xml:id="formula_25">∆ ij = [∆ cur ij + γ] mod 2π</formula><p>, ∀i, j, or, in matrix form:</p><formula xml:id="formula_26">s ij = A γ s cur ij (6)</formula><p>where</p><formula xml:id="formula_27">A γ := cos(γ) − sin(γ) sin(γ) cos(γ) , s ij := cos(∆ ij ) sin(∆ ij ) and s cur ij := cos(∆ cur ij ) sin(∆ cur ij )</formula><p>. We know use s A note on collinear 3D points. In the main text, we always assumed that dihedral angles</p><formula xml:id="formula_28">:= i,j c ij s ij ∈ R 2 and s cur := i,j c ij s cur ij ∈ R 2 .</formula><formula xml:id="formula_29">∆ ij def = ∠(XY T i , XY Z j ), ∀i ∈ [1..n], ∀j ∈ [1.</formula><p>.m] exist. However, any such angle will not be defined if X and Y are collinear with either T i or Z j . In such cases, we identify those neighbor nodes that are predicted to be collinear with X and Y (solely based on their respective LS), and then remove them from the computation of A cur and s γ . In the extreme case when these collinear nodes are the only neighbors, the torsion angle is not defined by our formulation. We leave this isolated case to be solved in future extensions of our work.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>B Initial assembly of the LSs of the endpoints of a bond XY</head><p>We detail here the formulae used in section section 2.4. Let the (predicted) LS of node X be p X = 0, p Y , p T1 , . . . , p Tn ∈ R 3 , as in section 2.3. Similarly, let the LS of node Y be q Y = 0, q X , q Z1 , . . . , q Zm ∈ R 3 . By design of section 2.3, we have that q X = p Y . These sets of 3D points can be aligned by applying any SE(3) transformation to each of them. To achieve alignment, we first want to match the X and Y points.</p><p>For this, we first rotate the LS of X such that p Y becomes p Y 0 0 and p X remains 0. Next, we rotate and translate the LS of Y such that q Y becomes p Y and q X becomes 0. More concretely, let η X ∈ R 3 be any random unit-norm vector orthogonal to p Y . We find a rotation matrix</p><formula xml:id="formula_30">H X,Y =   − h 1 − − h 2 − − h 3 −   ∈ R 3×3 such that H X,Y p Y = a 0 0 , with a &gt; 0, and H X,Y η X = b c 0</formula><p>, where b, c ∈ R. This is solved as:</p><formula xml:id="formula_31">h 1 = p Y p Y ; h 3 = p Y × η X p Y × η X ; h 2 = −(h 1 × h 3 )</formula><p>We now rotate the LS of X by doing:</p><formula xml:id="formula_32">p Ti def = H X,Y p Ti , ∀i ∈ [1..n], p Y def = H X,Y p Y .</formula><p>We apply a similar procedure for the LS of Y, computing q Zj def = H Y,X q Zj , ∀j ∈ [1..m] and q X := H Y,X q X . We now reflect the LS of Y w.r.t. the first and second coordinate by doing q Zj ← −1 0 0 0 −1 0 0 0 1 q Zj + p Y , which centers X in the origin, i.e. q X = 0, and aligns the two vectors of Y, i.e. q Y = p Y .</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>C Dihedral angle formula</head><p>The CCW dihedral angle between two intersecting half-planes ABC and ABD with common points A,B is computed as<ref type="foot" target="#foot_1">6</ref> </p><formula xml:id="formula_33">∠(ABC, ABD) = atan2( b 2 b 1 , b 2 × b 3 , b 1 × b 2 , b 2 × b 3 ) (7)</formula><p>where</p><formula xml:id="formula_34">b 1 := s A − s C , b 2 := s B − s A , b 3 := s D − s B .</formula></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>D Details of the loss function</head><p>Assume, for a molecular graph G = (V, E), that one predicted/generated conformer using one model is C, while the corresponding ground truth conformer is C * . We use notations in section 2. E is the set of edges in graph G. For every chain of 3 edges (u, v), (v, w), (w, y) ∈ E, we define</p><formula xml:id="formula_35">∠(uvwy) def = ∠(uvw, vwy).</formula><p>Similar to <ref type="bibr">AlphaFold [Senior et al., 2020]</ref>, we fit distances using normal distributions and angles using von Mises distributions. The resulting negative log-likelihood loss averages over same types of terms, being formally written as:  Dealing with node symmetries. A matching loss function. So far, we haven't tackled the following difficulty: symmetric graph nodes that are less than 3 hops away are indistinguishable by MPNNs in general, and by our current model in particular, even if we append initial random noise feature vectors. However, these nodes have distinct distances and angles to other nodes in 3D space. Examples are hydrogen groups as in fig. <ref type="figure" target="#fig_8">8</ref>. The difficulty in our case comes from the fact that the MPNN has lost the true matching between the graph nodes and the respective 3D points of the ground truth conformer. Our model is able to differentiate symmetric nodes because of the initial random noise vectors appended to each atom and feature vector, but a consistent matching with the ground truth conformer nodes is lost, and we seek to recover it.</p><formula xml:id="formula_36">L(C, C * ) def = ξ 1 • 1 #{(u, v) ∈ E} {(u,v)∈E} (d(u, v) − d * (u, v)) 2 + ξ 2 • 1 #{u, v : 2-hops away} {u,v:2-hops away} (d(u, v) − d * (u, v)) 2 + ξ 3 • 1 #{u, v : 3-hops away} {u,v:3-hops away} (d(u, v) − d * (u, v)) 2 − ξ 4 • 1 #(u, v) ∈ E, (v, w) ∈ E (u,v)∈E,(v,w)∈E cos (∠uvw − ∠ * uvw) − ξ 5 • 1 #(u, v), (v,</formula><p>We here address this problem only for symmetric terminal nodes attached to the same common neighbor. We leave further extensions to more general symmetries for future work. Concretely, let X 1 , . . . , X T be identical atoms of degree 1, each being connected to the same common node Y in the molecular graph. Let c 1 , . . . , c T ∈ R 3 be their predicted 3D coordinates in one generated conformer C : V → R 3 . Let also c * 1 , . . . , c * T ∈ R 3 be their corresponding 3D coordinates of some ground truth conformer C * : V → R 3 . These coordinates are then used for the computation of different loss terms in eq. ( <ref type="formula">8</ref>).</p><p>We propose a new loss function based on eq. ( <ref type="formula">8</ref>) that replaces it:</p><formula xml:id="formula_37">L perm (C, C * ) def = min π∈S T L(C, C * π )<label>(9)</label></formula><p>where</p><formula xml:id="formula_38">C * π : V → R 3 is defined as C * π (v) = C * (v), ∀v ∈ V \ {X 1 , . . . , X T } and C * π (X i ) = C * (X π(i) ), ∀i ∈ [1..T ].</formula><p>In a nutshell, this new loss function searches all possible permutations of the symmetric nodes X 1 , . . . , X T in order to find the "best matching" (based on the loss value) with the corresponding points in the ground truth conformer C * . The procedure above is applied for all groups of symmetric graph nodes that are of degree 1 and attached to a common node in the molecular graph. The loss in eq. ( <ref type="formula" target="#formula_37">9</ref>) does not significantly affect the speed of our method (as we show in the experimental section) due to the fact that most groups of symmetric atoms contain at most 3 nodes. However, it positively affects the quality of the resulting conformers as exemplified in fig. <ref type="figure" target="#fig_5">6</ref>.</p><p>OT Loss. During training, the matrix T in section 2.5 is computed for the forward pass using the Earth Mover Distance (EMD) function from the POT library <ref type="bibr" target="#b9">[Flamary and Courty, 2017]</ref> and kept fixed during backpropagation. The EMD computation cannot be parallelized in mini-batches in the current version of the library, but everything else is batch-parallelizable in our model (e.g. computation of L(C, C * )).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>E Details of the full conformer assembly procedure at test time</head><p>The training stage happens without assembling the full conformer. However, we desire to generate the full 3D conformer for test and inference time. This can be done by repeatedly applying the assembly operation described in section 2.4. We assemble the 3D coordinates of the atoms one by one, following a fixed arbitrary graph traversal, say Breadth First Search (BFS). Our procedure described here is deterministic, and any graph traversal will lead to the same final conformer (up to an SE(3) transformation).</p><p>The key step is assembling two sets of 3D points: the set containing the LS of node X (and possibly other atom coordinates added in previous steps), denoted as S X := {p 1 , . . . , p n } ⊂ R 3 , and the set containing the LS of node Y, denoted as S Y := {q 1 , . . . , q m } ⊂ R 3 . Assume that X and Y are connected by a bond/edge. Also assume that X is connected to nodes T i , while Y is connected to nodes Z j as denoted in fig. <ref type="figure" target="#fig_3">5</ref>. We make the clarification that p Ti ∈ S X , p Y ∈ S X , p X ∈ S X and q Zj ∈ S Y , q Y ∈ S Y , q X ∈ S Y and we expect that p X − p Y = q X − q Y by our design of this model.</p><p>To assemble the sets S X and S Y , we follow the steps described in section 2.4 and appendix B, but using only points in the LS of X from the set S X together with only points of the LS of Y from S Y to compute the torsion angle γ of the bond XY . That is, the torsion angle is computed only based on the graph neighbors of nodes X and Y. However, all points in S X and S Y are used for all the updates of the 3D coordinates. In the end, we obtain assembled set of points that satisfy</p><formula xml:id="formula_39">q Y = p Y = d GN N (h X , h Y ) 0 0</formula><p>, q X = p X = 0. Finally, we just merge the two sets S X and S Y into their union.</p><p>Dealing with graph cycles. The assembly operation might lead to inconsistencies when a node is reached the second time after a cycle traversal. We adopt a deterministic approach to tackle this issue. We first fix one BFS traversal of the graph and assemble the LS in the order given by this traversal. If the current node is not part of a cycle, then we can perform the assembling as described before. However, when we first encounter a node that is part of a cycle of nodes X 1 , X 2 , . . . , X n , we will jointly compute all the 3D coordinates of this cycle and attach the entire ring structure to the current partial conformer. Concretely, for every i ∈ {1, . . . , n}, we assemble the LS of nodes Figure <ref type="figure">9</ref>: Effect of two assembly techniques. Left: ground truth structure. Middle: our assembly procedure is applied on a random spanning tree of the molecular graph. Right: our described ring correction/smoothing algorithm, leading to a visibly improved structure.</p><formula xml:id="formula_40">i, i + 1, . . . n, 1, 2, . . . i − 2 resulting in the 3D points x i−1 , x i x i+1 , . . . , x n , x 1 , x 2 , . . . , x i−2 , x i−1 ,</formula><p>where node i − 1 has two 3D points x i−1 and x i−1 computed based on the LS of nodes i and i − 2 respectively. Next, we average the two 3D points of node i − 1 into a single vector denoted as x i−1 ∈ R 3 . We denote the resulting list of 3D points as S i = {x i−1 , x i x i+1 , . . . , x n , x 1 , x 2 , . . . , x i−2 }. So, we have obtained n lists of 3D points, S i , ∀i ∈ [1.</p><p>.n], that each represents the 3D conformer of the same cycle when the assembling is done using all nodes except one, in turn. We align all S i together using Kabsch algorithm <ref type="bibr" target="#b26">[Kabsch, 1976]</ref> <ref type="foot" target="#foot_2">7</ref> , followed by averaging all vectors of the same cycle node, for each node in the cycle, thus obtaining a final smoothed set of 3D coordinates for this respective cycle. We call this procedure "ring correction" or "ring smoothing". We additionally note that, when aligning two sets S i and S j , we also have to align the non-cycle points previously assembled. Finally, after all 3D vectors of a cycle are obtained, we continue to assemble in the order given by the BFS traversal. We show an example of the effect of this procedure in fig. <ref type="figure">9</ref>. We here show several dataset statistics in fig. <ref type="figure" target="#fig_9">10</ref>, but point the interested reader other resources describing these datasets, e.g. <ref type="bibr" target="#b33">Mansimov et al. [2019]</ref>, Axelrod and Gomez-Bombarelli [2020a], <ref type="bibr" target="#b38">Ramakrishnan et al. [2014]</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>F Datasets statistics</head><p>Datasets generation details. The GEOM dataset is generated with semi-empirical tight-binding DFT (GFN2-xTB) with the CREST software <ref type="bibr" target="#b14">Grimme [2019]</ref>. However, such semi-empirical calculations can be relatively slow in practice-espeically for larger molecules-which is one of the main motivations of ML models for conformer ensemble prediction.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>G Data preprocessing</head><p>We featurize each .pickle file in the datasets, which correspond to a single molecule and its respective conformers, to PyTorch Geometric data objects. First, we ensure the provided SMILES strings can be processed by RDKit, and we discard the few molecules that fail to meet this criteria. We additionally discard molecules with disconnected fragments (i.e. contains a "." in the SMILES) and without any dihedral angles (i.e. fails to match a "</p><formula xml:id="formula_41">[ * ] ∼ [ * ] ∼ [ * ] ∼ [ * ]" SMARTS pattern).</formula><p>Finally, some conformers in the original dataset may have reacted during the original data generation process. We filter these conformers by inferring the SMILES from the 3D structure, canonicalizing the SMILES with RDKit, and checking this SMILES with the SMILES reported by the dataset. Any conformers who fail this check are discarded as reacted conformers. We detail the atom and bond features used for the final GEOM-DRUGS model in Table <ref type="table" target="#tab_4">3</ref>. Note that the GEOM-QM9 model uses the same features but restricts the possible atom identities to H, C, N, O, and F. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>H Additional training details and hyperparameters</head><p>We run each model for a fixed 250 epochs with early stopping and keep the model with the best validation performance. This strategy determines the final hyperparameters chosen for the model, shown in table 4. We additionally tune the standard deviation s on a sample of the validation set to maximize recall coverage or precision coverage (depending on the user's interest), and we show the corresponding test scores in our tables. To adjust the learning rate during training, we use a plateau scheduler which automatically decays the learning rate when improvement has stalled, using a decay factor of 0.7 and a patience of 5 epochs. All models use the same seed to initialize network weights, ensuring consistency between runs. During training time, we randomly sample a fixed number of ground truth conformers from each molecule. This fixed number is a hyperparameter in our optimization, which we set to 10 for GEOM-QM9 and 20 for GEOM-DRUGS. This value is not relevant during test time, as the model simply generates the number of conformers requested by the user.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>I Confidence intervals</head><p>We report in table 5 confidence intervals for GEOMOL on both datasets during test time. The same trained model is run for 3 times for a given test molecule with K ground truth conformers, where one run means generating 2K conformers. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>J Results with force field optimization</head><p>We also show results in table 6 and table 7 for all models after additional fine-tuning with FF energy minimization. We used MMFF94s Merck Molecular Force Field <ref type="bibr" target="#b16">[Halgren, 1996</ref><ref type="bibr" target="#b17">[Halgren, , 1999]]</ref>). Note that the best GEOMOL models here use s = 1 during training rather than s = 5. </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>K Energy calculations</head><p>To gauge the plausibility of generated conformers, we compute the energies as defined by the MMFF force field within RDKit for conformers generated with ML-based methods before force field fine tuning. We note that an improved demonstration would calculate energies at the GFN2-xTB semiempirical level of theory, since the training data were generated with this method, but we decided to use a force field instead, which should retain the qualitative trends.  </p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>L Compute details</head><p>We train GEOMOL using a single Nvidia Volta V100 GPU and eight Intel Xeon Gold 6248 CPUs.</p><p>The exact number of hours depends on the cluster load and on early stopping, but training GEOMOL for the full 250 epochs takes approximately 1.8 days for the QM9 dataset and 6.1 days for the DRUGS dataset.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>M Additional coverage results</head><p>We additionally show how the Recall Coverage varies with the threshold δ in fig. <ref type="figure" target="#fig_10">11</ref>. Larger thresholds allow small errors, but penalize large errors, while smaller thresholds penalize both small and large errors.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>N Additional examples</head><p>We show additional examples of generated conformers from the GEOM-QM9 test set in fig. <ref type="figure" target="#fig_1">12</ref> and from the GEOM-DRUGS test set in fig. <ref type="figure" target="#fig_0">13</ref>.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>O Additional discussion</head></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>O.1 Purpose of conformer generation</head><p>The purpose of conformer generation in the context of this work warrants some discussion. As stated in the main text, this purpose is heavily application-dependent. The current method is very helpful for computing the properties of drug-like molecules at low temperature, where it is necessary to generate a set of conformers that represents those with high Boltzmann populations. It can also be used for small molecules, but if the molecules are very small, it may be possible to identify all the important conformers by exhaustive search. At very high temperatures, where a large number of conformers are energetically accessible, it may be more convenient to represent the potential energy surface as a sum of hindered rotor potentials. Yet another common application for 3D conformer generation is the discovery of docked poses and 4D QSAR, where speed of the conformer generator becomes a crucial factor for virtually screening millions of structures. Crystal structure prediction (CSP) similarly relies on screening stable conformations, with recent models placing a greater emphasis on quality over quantity. These last two applications require modelling conformational flexibility rather than finding wells in the potential energy surface, as docked and crystallized conformations can fall outside these wells, carrying additional strain. The methods we present in this work can address any of these latter applications as well. We emphasize that the datasets on which GEOMOL (or any ML model) is trained guide the downstream usage, but cleverly finetuning GEOMOL on various downstream applications is an exciting future research direction.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>O.2 Comment on evaluation metrics</head><p>Additionally, we note that while the evaluation metrics presented in this work are a sensible way to benchmark ML conformer generators against each other, they do not necessarily present a realistic evaluation of these algorithms in a production setting. This is why evaluating against the OMEGA software, which does not allow the user to request a specific number of conformers, is difficult. Further, for many applications, the generated conformers should be pruned and ranked (e.g., ranking conformers by energy and stable packing arrangements for CSP), and different conformer generation methods have varying methods to perform these post-processing steps. Because the scope of the presented work aims to distinguish our model against the many emerging ML-based conformer generators, we leave the exploration of such post-processing algorithms and strategies for future work. Furthermore, both the ETKDG and OMEGA algorithms are optimized to reproduce Protein Data Bank/Cambridge Structural Database conformations rather than replicate xTB low-energy conformations. In this sense, the evaluation presented here should not be viewed as a comprehensive argument for or against any of these methods.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>O.3 QM9 results</head><p>Focusing on the QM9 results, we see both the power and drawbacks of the popular conformer generators such as OMEGA and ETKDG. Both methods can successfully generate diverse sets of conformers for the small molecules in the QM9 dataset, as shown by the high recall coverage values. However, both methods run into similar issues. That is, they both fail to generate the requested number of conformers for a few structures in the QM9 dataset, most of which have fused rings and multiple chiral centers specified. Since OMEGA, which constructs initial 3D structures from its database of fragments, does not have many of these fragments readily available, both OMEGA and ETKDG likely run into the same issue: using DG-based methods to generate initial 3D conformers for molecules with multiple chiral centers is difficult because of the implicit chiral constraints that must be satisfied. Take for example the following SMILES, which represents a fairly simple fused ring structure: 'C#C[C@@]1(C)[C@H]2C[C@]1(C)C2'. ETKDG fails to embed a single conformer for this structure with repeated attempts. Removing the chiral centers specifications (i.e. inputting 'C#CC1(C)C2CC1(C)C2' as the SMILES) results in a successful structure generation, but many of the outputs have the incorrect chirality. While these can sometimes be corrected with energy-based minimization, the key issue of determining chiral centers exactly with DG-based methods remains. GEOMOL specifically tackles this problem such that all specified chiral centers are solved exactly (see section 2.3).</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>O.4 DRUGS results</head><p>The results for the DRUGS half of GEOM dataset suggest additional issues with traditional conformer generation methods. With these larger, drug-like molecules with many rotatable bonds, the search space of conformers grows exponentially. Here, it is instructive to separate the performance of ETKDG from OMEGA. ETKDG relies on randomly sampling the space of possible interatomic distances, which leads to poor coverage for conformers where this space is large. If the goal is to improve coverage, ETKDG could benefit from improved sampling strategies. OMEGA systematically varies all torsion angles in the structure to generate ensembles, but since this process can become prohibitively expensive, we must include an RMSD cutoff for many of these input molecules so as to return results in a reasonable period of time. Furthermore, not only does OMEGA uses a modified MMFF94 FF to generate its fragment library, it also uses a FF to score each potential conformer; its identified low-energy structures will be different than the xTB geometries we use as ground truths. This is a limitation with the OMEGA algorithm as currently constructed, and it could benefit from higher quality fragment structures and improved methods to score output conformers. This is not to understate the power of OMEGA as a conformer generation tool; it significantly outperforms the other baselines in our study and should be viewed as state-of-the-art in reference.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>O.5 Runtime comparison</head><p>While the baselines ML methods have not benchmarked the speed of their algorithms, we believe this is a crucial evaluation of any conformer generator, especially if the intent is to use such a model for pose prediction and high throughput virtual screening. For each baseline, we request a fixed number of conformers and record the time necessary to output a single conformer, parallelizing each model over 40 CPU cores. We repeat this analysis three times for each method and plot the results in fig. <ref type="figure" target="#fig_6">7</ref>. Importantly, we do not include the start up times for any of the methods (i.e. loading the neural network weights for the ML models). OMEGA, GraphDG, and GEOMOL show comparative performance, with ETKDG lagging slightly behind. Additionally, GEOMOL scales well for structures with an increasing number of rotatable bonds, especially compared to GraphDG and ETKDG. The CGCF model is orders of magnitude slower than the other baselines, which restricts its utility for high throughput applications of conformer generation.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>O.6 Limitations</head><p>The most significant drawback of our model is its weakness in capturing long-range interactions, which can manifest itself in several ways, detailed in fig.  require moieties in the conformer with large 2D distances in the molecular graph to be predicted close to one another in 3D space. For this reason, extending GEOMOL with an improved method for long-range interactions is an exciting future direction.</p></div>
<div xmlns="http://www.tei-c.org/ns/1.0"><head>O.7 Conclusions</head><p>In theory, GEOMOL should replicate the quality of conformers on which it was trained, which gives the model unique power and flexibility for downstream applications. For example, one could easily construct a smaller database of high-quality conformers optimized at a higher level of theory than semi-empirical (ex. coupled-cluster) and finetune GEOMOL. These higher-quality conformers could even include solvent effects in a range of solvents, which are often neglected in traditional conformer generation methods. Indeed, these downstream modifications could have significant impacts on a range of applications in cheminformatics and discovery.</p><p>Both the GraphDG and CGCF models, which represent important steps in ML-enabled conformer generation, are not quite ready to be used in a production setting without relying on a force field optimization. This is especially evident given the example structures presented in the main text and in appendix N. However, both models improve over traditional baselines at searching the space of interatomic distances and outputting diverse predictions, which is a credit to the search strategies employed by each model, especially CGCF. Further, the GraphDG model is competitive with GEOMOL for the QM9 dataset and should be viewed as a viable alternative to GEOMOL for small molecules with few heavy atoms.</p><p>As researchers continue to develop 3D ML-based conformer generators, the discussion between DGbased and non DG-based algorithms will carry on. Here, we chose to take the latter approach because we wanted to explicitly model important elements of conformer generation, and this strategy has been successful. In our experience, modeling these specific geometric elements leads to a significant improvement in the quality of the output structures. It is still unclear if such an approach can tackle</p></div><figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_0"><head>Figure 1 :</head><label>1</label><figDesc>Figure 1: We explore the task of lowenergy 3D conformer ensemble generation from the input molecular graph. This example molecule has both rigid (rings) and more flexible parts. Conformers are shown aligned and juxtaposed.</figDesc><graphic url="image-1.png" coords="1,345.60,520.44,158.39,52.87" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_1"><head>Figure 2 :</head><label>2</label><figDesc>Figure 2: Overview of the GEOMOL model, which is SE(3)-invariant by design. Given a molecular graph, we first compute MPNNs atom embeddings. Next, we predict the local 3D structures (LS) of each non-terminal atom in a permutation invariant way, explicitly solving chirality. Third, for each bond connecting non-terminal vertices, we assemble the two LS by predicting a single torsion angle, avoiding overparameterization. Finally, the full conformer is assembled (only) at test time.</figDesc><graphic url="image-2.png" coords="4,108.00,43.66,395.98,137.21" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_2"><head>Figure 4 :</head><label>4</label><figDesc>Figure 4: Chirality: even if the two shown graphs are isomorphic, they have distinct 3D structures that can be distinguished by the order of the carbon center's neighbors.</figDesc><graphic url="image-4.png" coords="5,368.11,554.15,130.67,92.39" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_3"><head>Figure 5 :</head><label>5</label><figDesc>Figure 5: Assembly of the local structures of bonded atoms X and Y based on the predicted torsion angle.</figDesc><graphic url="image-5.png" coords="6,361.44,347.71,158.40,114.66" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_4"><head>2. 5</head><label>5</label><figDesc>An optimal transport (OT) loss function for diverse conformer generation Loss per single conformer. Assume first that we predict a single conformer C. Based on all LS and torsion angle predictions, we deterministically compute all 1/2/3-hop distances and bond/torsion angles. If the corresponding ground truth conformer C * is known, we feed those quantities into a negative log-likelihood loss, denote by L(C, C * ) and detailed in appendix D. Similar to Senior et al.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_5"><head>Figure 6 :</head><label>6</label><figDesc>Figure 6: Before (left) and after (right) introducing a matching loss to distinguish symmetric graph nodes. Hydrogen predictions in both groups are visibly improved.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_6"><head>Figure 7 :</head><label>7</label><figDesc>Figure 7: Left: Examples of generated structures. For every model, we show the best generated conformer, i.e. with the smallest RMSD to the shown ground truth. More examples are in appendix N. Right/top: Number of rotatable bonds per DRUGS test molecule versus COV Recall (95% confidence intervals). Right/bottom: conformer generation times for each model.</figDesc><graphic url="image-7.png" coords="9,96.12,72.00,407.88,209.93" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_7"><head></head><label></label><figDesc>w), (w, y) ∈ E (u,v),(v,w),(w,y)∈E cos (∠(uvwy) − ∠ * (uvwy)) (8)where ξ 1 , ξ 2 , ξ 3 , ξ 4 , ξ 5 &gt; 0 are hyperparameters tuned on the validation set, with ξ 1 , ξ 2 , ξ 3 representing inverse standard deviations of the respective normal distributions, while ξ 4 , ξ 5 being the measures of concentration of the corresponding von Mises distributions.</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_8"><head>Figure 8 :</head><label>8</label><figDesc>Figure 8: Nodes A and B are symmetric in this example graph, but not when placed in the 3D space, as node A will be spatially closer to node C than node B. Such cases require a special treatment.</figDesc><graphic url="image-8.png" coords="15,375.30,522.31,99.00,103.02" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_9"><head>Figure 10 :</head><label>10</label><figDesc>Figure 10: Datasets statistics.</figDesc><graphic url="image-10.png" coords="17,90.05,447.57,415.79,93.94" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_10"><head>Figure 11 :</head><label>11</label><figDesc>Figure 11: Recall coverage plotted against varying RMSD thresholds.</figDesc><graphic url="image-11.png" coords="21,108.00,72.00,396.00,291.81" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_11"><head></head><label></label><figDesc>14. First, GEOMOL poorly models macrocycles. Because of the formulation we use to construct conformers, error accumulation sometimes leads to imperfect structures, as the ring smoothing algorithm breaks down for large cycles (top of fig.14). We also qualitatively observe that large rings with very sparse examples in the training data can be predicted poorly by our model at test time. The middle of fig.14shows one such example of an eight-membered ring; here, additional training data should help, as there only exist a few eight-membered rings in the training set. Finally, the presence of steric clashes is an important issue with the current model. The bottom of fig.14shows one such example, being the most common error mode for GEOMOL. Since global conformer information during torsion predictions is only conveyed through the graph network representations, it is challenging to account for the position of atoms far away in graph connectivity, which can lead to overlapping atoms in the final prediction. This is especially troubling for interactions such as the pi-pi stacking depicted in the figure, which</figDesc></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" xml:id="fig_12"><head>Figure 14 :</head><label>14</label><figDesc>Figure 14: Common GEOMOL errors. Top: example of a macrocyle predicted poorly by GEOMOL. Middle: example of a larger ring with few training set occurrences. Bottom: example of a steric clash due to weak modeling of long-range interactions.</figDesc><graphic url="image-161.png" coords="25,292.51,250.63,144.78,108.58" type="bitmap" /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_0"><head>Table 1 :</head><label>1</label><figDesc>The minimization w.r.t. T is computed quickly using Earth Mover Distance and the POT library<ref type="bibr" target="#b9">[Flamary and Courty, 2017]</ref>. Results on the GEOM-DRUGS dataset. All models are without FF fine-tuning. "R" and "P" denote Recall and Precision. Note: OMEGA is an established commercial (C) software.</figDesc><table><row><cell></cell><cell cols="2">COV -R (%) ↑</cell><cell cols="2">AMR -R (Å) ↓</cell><cell cols="2">COV -P (%) ↑</cell><cell cols="2">AMR -P (Å) ↓</cell></row><row><cell>Models</cell><cell cols="8">Mean Median Mean Median Mean Median Mean Median</cell></row><row><cell>GraphDG (ML)</cell><cell>10.37</cell><cell>0.00</cell><cell>1.950</cell><cell>1.933</cell><cell>3.98</cell><cell>0.00</cell><cell>2.420</cell><cell>2.420</cell></row><row><cell>CGCF (ML)</cell><cell>54.35</cell><cell>56.74</cell><cell>1.248</cell><cell>1.224</cell><cell>24.48</cell><cell>15.00</cell><cell>1.837</cell><cell>1.829</cell></row><row><cell>RDKit/ETKDG</cell><cell>68.78</cell><cell>76.04</cell><cell>1.042</cell><cell>0.982</cell><cell>71.06</cell><cell>88.24</cell><cell>1.036</cell><cell>0.943</cell></row><row><cell>OMEGA (C)</cell><cell>81.64</cell><cell>97.25</cell><cell>0.851</cell><cell>0.771</cell><cell>77.18</cell><cell>96.15</cell><cell>0.951</cell><cell>0.854</cell></row><row><cell cols="2">GEOMOL (s = 9.5) 86.07</cell><cell>98.06</cell><cell>0.846</cell><cell>0.820</cell><cell>71.78</cell><cell>83.77</cell><cell>1.039</cell><cell>0.982</cell></row><row><cell>GEOMOL (s = 5)</cell><cell>82.43</cell><cell>95.10</cell><cell>0.862</cell><cell>0.837</cell><cell>78.52</cell><cell>94.40</cell><cell>0.933</cell><cell>0.856</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_1"><head>Table 2 :</head><label>2</label><figDesc>Results on the GEOM-QM9 dataset. See caption of table 1.</figDesc><table><row><cell></cell><cell cols="2">COV -R (%) ↑</cell><cell cols="2">AMR -R (Å) ↓</cell><cell cols="2">COV -P (%) ↑</cell><cell cols="2">AMR -P (Å) ↓</cell></row><row><cell>Models</cell><cell cols="8">Mean Median Mean Median Mean Median Mean Median</cell></row><row><cell>GraphDG (ML)</cell><cell cols="2">74.66 100.00</cell><cell>0.373</cell><cell>0.337</cell><cell>63.03</cell><cell>77.60</cell><cell>0.450</cell><cell>0.404</cell></row><row><cell>CGCF (ML)</cell><cell>69.47</cell><cell>96.15</cell><cell>0.425</cell><cell>0.374</cell><cell>38.20</cell><cell>33.33</cell><cell>0.711</cell><cell>0.695</cell></row><row><cell>RDKit/ETKDG</cell><cell cols="2">85.13 100.00</cell><cell>0.235</cell><cell>0.199</cell><cell cols="2">86.80 100.00</cell><cell>0.232</cell><cell>0.205</cell></row><row><cell>OMEGA (C)</cell><cell cols="2">85.51 100.00</cell><cell>0.177</cell><cell>0.126</cell><cell cols="2">82.86 100.00</cell><cell>0.224</cell><cell>0.186</cell></row><row><cell cols="3">GEOMOL (s = 5) 91.52 100.00</cell><cell>0.225</cell><cell>0.193</cell><cell cols="2">86.71 100.00</cell><cell>0.270</cell><cell>0.241</cell></row><row><cell cols="4">2.6 Full conformer assembly at test time</cell><cell></cell><cell></cell><cell></cell><cell></cell><cell></cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_2"><head></head><label></label><figDesc>the user is interested in. Even though OMEGA is an established commercial software with more than a decade of continuous development, our model remarkably frequently outperforms it. Note that OMEGA fails to generate any conformers for 7% of the QM9 test set (many of which include fused rings). Moreover, we also outperform the popular RDKit/ETKDG open-source model (except for AMR-P on QM9) and very recent ML models such as GraphDG and CGCF, sometimes by a large margin. For a qualitative insight, we show generated examples in fig.7 and appendix N.Running time. Fig.7shows conformer generation test running times. Our model is the fastest method from the considered baselines, being much faster than CGCF or ETKDG/RDKit. Moreover, GEOMOL scales favorably for molecules with increasing number of rotatable bonds.</figDesc><table><row><cell>Additionally, we show in fig. 7 how COV Recall results are affected by the increasing number of</cell></row><row><cell>rotatable bonds in the test molecule. As expected, having more rotatable bonds makes the problem</cell></row><row><cell>harder, and this affects all baselines, but GEOMOL maintains a reasonable coverage even for more</cell></row><row><cell>difficult molecules. Moreover, in appendix K and table 8 we show energy calculations of the generated</cell></row><row><cell>conformers to support their plausibility. Additionally, results with energy-based relaxations are given</cell></row><row><cell>in appendix J.</cell></row></table><note>&amp; discussion. Results are shown in table 1 and table 2, and confidence intervals are in appendix I. As noted above, GEOMOL can be run with different noise std at test time, depending on which metric</note></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_4"><head>Table 3 :</head><label>3</label><figDesc>Atom and bond features</figDesc><table><row><cell>Atom features</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_5"><head>Table 4 :</head><label>4</label><figDesc>Hyerparameter choices</figDesc><table><row><cell>Hyperparameter</cell><cell>Final choice (QM9/DRUGS)</cell></row><row><cell>True conformers sampled</cell><cell>10/20</cell></row><row><cell>Model conformers generated</cell><cell>10/20</cell></row><row><cell>Model dimension</cell><cell>25</cell></row><row><cell>Random vector dimension</cell><cell>10</cell></row><row><cell>Random vector standard deviation s</cell><cell>5</cell></row><row><cell>MPNN 1 depth</cell><cell>3</cell></row><row><cell>MPNN 1 number of layers</cell><cell>2</cell></row><row><cell>MPNN 2 depth</cell><cell>3</cell></row><row><cell>MPNN 2 number of layers</cell><cell>2</cell></row><row><cell>LS self-attention encoder heads</cell><cell>2</cell></row><row><cell>LS coordinate MLP layers</cell><cell>2</cell></row><row><cell>LS distance MLP layers</cell><cell>1</cell></row><row><cell>h mol MLP layers</cell><cell>1</cell></row><row><cell>α MLP layers</cell><cell>2</cell></row><row><cell>c ij MLP layers</cell><cell>1</cell></row><row><cell>Batch size</cell><cell>16</cell></row><row><cell>Learning rate</cell><cell>1e-3</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_6"><head>Table 5 :</head><label>5</label><figDesc>Confidence intervals for GEOMOL with the default noise s = 5.</figDesc><table><row><cell></cell><cell cols="2">COV -R (%) ↑</cell><cell cols="2">AMR -R (Å) ↓</cell><cell cols="2">COV -P (%) ↑</cell><cell cols="2">AMR -P (Å) ↓</cell></row><row><cell>Models</cell><cell cols="2">Mean Median</cell><cell>Mean</cell><cell>Median</cell><cell cols="2">Mean Median</cell><cell>Mean</cell><cell>Median</cell></row><row><cell>GEOMOL</cell><cell>82.43</cell><cell>95.10</cell><cell>0.8626</cell><cell>0.8374</cell><cell>78.52</cell><cell>94.40</cell><cell>0.9336</cell><cell>0.8567</cell></row><row><cell>DRUGS</cell><cell>± 0.26</cell><cell>± 0.25</cell><cell>± 0.0020</cell><cell>± 0.0037</cell><cell>± 0.02</cell><cell>± 0.20</cell><cell>± 0.0015</cell><cell>± 0.0030</cell></row><row><cell>GEOMOL</cell><cell>91.52</cell><cell>100.00</cell><cell>0.2254</cell><cell>0.1938</cell><cell>86.71</cell><cell>100.00</cell><cell>0.2702</cell><cell>0.2413</cell></row><row><cell>QM9</cell><cell>± 0.36</cell><cell>± 0.00</cell><cell>± 0.0012</cell><cell>± 0.0024</cell><cell>± 0.29</cell><cell>± 0.00</cell><cell>± 0.0007</cell><cell>± 0.0030</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_7"><head>Table 6 :</head><label>6</label><figDesc>Results on the GEOM-DRUGS dataset with FF fine-tuning.</figDesc><table><row><cell></cell><cell cols="2">COV -R (%) ↑</cell><cell cols="2">AMR -R (Å) ↓</cell><cell cols="2">COV -P (%) ↑</cell><cell cols="2">AMR -P (Å) ↓</cell></row><row><cell>Models</cell><cell cols="8">Mean Median Mean Median Mean Median Mean Median</cell></row><row><cell>GraphDG (ML)</cell><cell cols="2">85.33 100.00</cell><cell>0.859</cell><cell>0.831</cell><cell>62.65</cell><cell>69.45</cell><cell>1.162</cell><cell>1.121</cell></row><row><cell>CGCF (ML)</cell><cell cols="2">91.25 100.00</cell><cell>0.723</cell><cell>0.702</cell><cell>63.86</cell><cell>70.43</cell><cell>1.096</cell><cell>1.055</cell></row><row><cell>RDKit/ETKDG</cell><cell>77.22</cell><cell>87.62</cell><cell>0.886</cell><cell>0.837</cell><cell>75.98</cell><cell>93.86</cell><cell>0.911</cell><cell>0.803</cell></row><row><cell>OMEGA (C)</cell><cell>80.82</cell><cell>94.74</cell><cell>0.840</cell><cell>0.755</cell><cell cols="2">81.79 100.00</cell><cell>0.804</cell><cell>0.684</cell></row><row><cell cols="2">GEOMOL (s = 0.25) 80.73</cell><cell>92.01</cell><cell>0.863</cell><cell>0.809</cell><cell cols="2">86.12 100.00</cell><cell>0.751</cell><cell>0.616</cell></row><row><cell cols="3">GEOMOL (s = 3.00) 91.34 100.00</cell><cell>0.683</cell><cell>0.663</cell><cell>79.64</cell><cell>92.46</cell><cell>0.841</cell><cell>0.756</cell></row></table></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_8"><head></head><label></label><figDesc>Table 8 illustrates these results, which support the results from table 1 and table 2. The energy values from GeoMol are the lowest among the ML methods, indicating greater stability of generated conformers, especially for the druglike molecules.</figDesc><table /></figure>
<figure xmlns="http://www.tei-c.org/ns/1.0" type="table" xml:id="tab_9"><head>Table 7 :</head><label>7</label><figDesc>Results on the GEOM-QM9 dataset with FF fine-tuning.</figDesc><table><row><cell></cell><cell cols="2">COV -R (%) ↑</cell><cell cols="2">AMR -R (Å) ↓</cell><cell cols="2">COV -P (%) ↑</cell><cell cols="2">AMR -P (Å) ↓</cell></row><row><cell>Models</cell><cell cols="8">Mean Median Mean Median Mean Median Mean Median</cell></row><row><cell>GraphDG (ML)</cell><cell cols="2">88.70 100.00</cell><cell>0.210</cell><cell>0.165</cell><cell cols="2">90.14 100.00</cell><cell>0.185</cell><cell>0.129</cell></row><row><cell>CGCF (ML)</cell><cell cols="2">75.45 100.00</cell><cell>0.313</cell><cell>0.246</cell><cell>50.29</cell><cell>50.00</cell><cell>0.518</cell><cell>0.520</cell></row><row><cell>RDKit/ETKDG</cell><cell cols="2">83.48 100.00</cell><cell>0.219</cell><cell>0.172</cell><cell cols="2">89.78 100.00</cell><cell>0.160</cell><cell>0.116</cell></row><row><cell>OMEGA (C)</cell><cell cols="2">85.73 100.00</cell><cell>0.177</cell><cell>0.126</cell><cell cols="2">83.08 100.00</cell><cell>0.224</cell><cell>0.186</cell></row><row><cell cols="3">GEOMOL (s = 5.00) 89.37 100.00</cell><cell>0.201</cell><cell>0.157</cell><cell cols="2">91.92 100.00</cell><cell>0.173</cell><cell>0.124</cell></row><row><cell cols="7">Table 8: MMFF energy calculations for ML conformer generators</cell><cell></cell></row><row><cell></cell><cell>Model</cell><cell></cell><cell cols="3">Mean/Median (kcal/mol)</cell><cell></cell><cell></cell></row><row><cell></cell><cell></cell><cell></cell><cell>QM9</cell><cell cols="2">DRUGS</cell><cell></cell><cell></cell></row><row><cell></cell><cell>GeoMol</cell><cell cols="2">17.45/17.56</cell><cell cols="2">83.72/77.52</cell><cell></cell><cell></cell></row><row><cell></cell><cell cols="5">GraphDG 26.32/24.44 64350.58/61732.49</cell><cell></cell><cell></cell></row><row><cell></cell><cell>CGCF</cell><cell cols="2">86.71/87.02</cell><cell cols="2">1380.82/556.78</cell><cell></cell><cell></cell></row></table></figure>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="5" xml:id="foot_0">We define atan2 slightly different than standard: atan2(r cos(α), r sin(α))def = α, ∀α ∈ [0, 2π), r ∈ R * + .</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="6" xml:id="foot_1">See https://en.wikipedia.org/wiki/Dihedral_angle.</note>
			<note xmlns="http://www.tei-c.org/ns/1.0" place="foot" n="7" xml:id="foot_2">https://en.wikipedia.org/wiki/Kabsch_algorithm</note>
		</body>
		<back>

			<div type="acknowledgement">
<div xmlns="http://www.tei-c.org/ns/1.0"><head>Acknowledgments and Disclosure of Funding</head><p>OEG thanks Bracha Laufer, Tian Xie, Xiang Fu, Peter Mikhael, and the rest of the RB and TJ group members for their helpful comments and suggestions. LP thanks Camille Bilodeau and the rest of the WHG, KFJ, and CWC research groups for their useful discussions. We also thank Pat Walters, Simon Axelrod, and Rafael Gomez-Bombarelli for their insightful feedback as well as Minkai Xu and Shitong Luo for helping with running the CGCF model. Both OEG and LP are funded by the Machine Learning for Pharmaceutical Discovery and Synthesis consortium.</p></div>
			</div>

			<div type="references">

				<listBibl>

<biblStruct xml:id="b0">
	<analytic>
		<title level="a" type="main">End-to-end differentiable learning of protein structure</title>
		<author>
			<persName><forename type="first">Mohammed</forename><surname>Alquraishi</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Cell systems</title>
		<imprint>
			<biblScope unit="volume">8</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="292" to="301" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b1">
	<monogr>
		<title level="m" type="main">Geom: Energy-annotated molecular conformations for property prediction and molecular generation</title>
		<author>
			<persName><forename type="first">Simon</forename><surname>Axelrod</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Rafael</forename><surname>Gomez-Bombarelli</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2006.05531</idno>
		<imprint>
			<date type="published" when="2020">2020a</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b2">
	<monogr>
		<author>
			<persName><forename type="first">Simon</forename><surname>Axelrod</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Rafael</forename><surname>Gomez-Bombarelli</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2012.08452</idno>
		<title level="m">Molecular machine learning with conformer ensembles</title>
				<imprint>
			<date type="published" when="2020">2020b</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b3">
	<analytic>
		<title level="a" type="main">Exploiting the potential energy landscape to sample free energy</title>
		<author>
			<persName><forename type="first">Andrew</forename><forename type="middle">J</forename><surname>Ballard</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Stefano</forename><surname>Martiniani</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Sandeep</forename><surname>Jacob D Stevenson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">David</forename><forename type="middle">J</forename><surname>Somani</surname></persName>
		</author>
		<author>
			<persName><surname>Wales</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Wiley Interdisciplinary Reviews: Computational Molecular Science</title>
		<imprint>
			<biblScope unit="volume">5</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="273" to="289" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b4">
	<analytic>
		<title level="a" type="main">Pushing the limits of a molecular mechanics force field to probe weak ch••• π interactions in proteins</title>
		<author>
			<persName><forename type="first">Arghya</forename><surname>Barman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Bruce</forename><surname>Batiste</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Donald</forename><surname>Hamelberg</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of chemical theory and computation</title>
		<imprint>
			<biblScope unit="volume">11</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="1854" to="1863" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b5">
	<monogr>
		<title level="m" type="main">Relational inductive biases, deep learning, and graph networks</title>
		<author>
			<persName><forename type="first">Jessica</forename><forename type="middle">B</forename><surname>Peter W Battaglia</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Victor</forename><surname>Hamrick</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Alvaro</forename><surname>Bapst</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Vinicius</forename><surname>Sanchez-Gonzalez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Mateusz</forename><surname>Zambaldi</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Andrea</forename><surname>Malinowski</surname></persName>
		</author>
		<author>
			<persName><forename type="first">David</forename><surname>Tacchetti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Adam</forename><surname>Raposo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ryan</forename><surname>Santoro</surname></persName>
		</author>
		<author>
			<persName><surname>Faulkner</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1806.01261</idno>
		<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b6">
	<analytic>
		<title level="a" type="main">Understanding conformational entropy in small molecules</title>
		<author>
			<persName><forename type="first">Lucian</forename><surname>Chan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Garrett</forename><forename type="middle">M</forename><surname>Morris</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Geoffrey</forename><forename type="middle">R</forename><surname>Hutchison</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Chemical Theory and Computation</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="2099" to="2106" />
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b7">
	<analytic>
		<title level="a" type="main">Distance geometry and molecular conformation</title>
		<author>
			<persName><forename type="first">Timothy</forename><forename type="middle">F</forename><surname>Gordon M Crippen</surname></persName>
		</author>
		<author>
			<persName><surname>Havel</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Research Studies Press Taunton</title>
		<imprint>
			<biblScope unit="volume">74</biblScope>
			<date type="published" when="1988">1988</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b8">
	<analytic>
		<title level="a" type="main">Role of molecular dynamics and related methods in drug discovery</title>
		<author>
			<persName><forename type="first">Marco</forename><forename type="middle">De</forename><surname>Vivo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Matteo</forename><surname>Masetti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Giovanni</forename><surname>Bottegoni</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Andrea</forename><surname>Cavalli</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of medicinal chemistry</title>
		<imprint>
			<biblScope unit="volume">59</biblScope>
			<biblScope unit="issue">9</biblScope>
			<biblScope unit="page" from="4035" to="4061" />
			<date type="published" when="2016">2016</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b9">
	<monogr>
		<title level="m" type="main">Pot python optimal transport library</title>
		<author>
			<persName><forename type="first">Rémi</forename><surname>Flamary</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Nicolas</forename><surname>Courty</surname></persName>
		</author>
		<ptr target="https://github.com/rflamary/POT" />
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b10">
	<analytic>
		<title level="a" type="main">Benchmarking commercial conformer ensemble generators</title>
		<author>
			<persName><forename type="first">Nils-Ole</forename><surname>Friedrich</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Christina</forename><surname>De Bruyn</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Florian</forename><surname>Kops</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Kai</forename><surname>Flachsenberg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Matthias</forename><surname>Sommer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Johannes</forename><surname>Rarey</surname></persName>
		</author>
		<author>
			<persName><surname>Kirchmair</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of chemical information and modeling</title>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="2719" to="2728" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b11">
	<analytic>
		<title level="a" type="main">Deciphering interaction fingerprints from protein molecular surfaces using geometric deep learning</title>
		<author>
			<persName><forename type="first">Pablo</forename><surname>Gainza</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Freyr</forename><surname>Sverrisson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Frederico</forename><surname>Monti</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Emanuele</forename><surname>Rodola</surname></persName>
		</author>
		<author>
			<persName><surname>Boscaini</surname></persName>
		</author>
		<author>
			<persName><surname>Bronstein</surname></persName>
		</author>
		<author>
			<persName><surname>Correia</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature Methods</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">2</biblScope>
			<biblScope unit="page" from="184" to="192" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b12">
	<analytic>
		<title level="a" type="main">Generalization and representational limits of graph neural networks</title>
		<author>
			<persName><forename type="first">Vikas</forename><surname>Garg</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Stefanie</forename><surname>Jegelka</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Tommi</forename><surname>Jaakkola</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Machine Learning</title>
				<imprint>
			<publisher>PMLR</publisher>
			<date type="published" when="2020">2020</date>
			<biblScope unit="page" from="3419" to="3430" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b13">
	<analytic>
		<title level="a" type="main">Neural message passing for quantum chemistry</title>
		<author>
			<persName><forename type="first">Justin</forename><surname>Gilmer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Patrick</forename><forename type="middle">F</forename><surname>Samuel S Schoenholz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Oriol</forename><surname>Riley</surname></persName>
		</author>
		<author>
			<persName><forename type="first">George</forename><forename type="middle">E</forename><surname>Vinyals</surname></persName>
		</author>
		<author>
			<persName><surname>Dahl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 34th International Conference on Machine Learning</title>
				<meeting>the 34th International Conference on Machine Learning</meeting>
		<imprint>
			<date type="published" when="2017">2017</date>
			<biblScope unit="volume">70</biblScope>
			<biblScope unit="page" from="1263" to="1272" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b14">
	<analytic>
		<title level="a" type="main">Exploration of chemical compound, conformer, and reaction space with metadynamics simulations based on tight-binding quantum chemical calculations</title>
		<author>
			<persName><forename type="first">Stefan</forename><surname>Grimme</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of chemical theory and computation</title>
		<imprint>
			<biblScope unit="volume">15</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="2847" to="2862" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b15">
	<analytic>
		<title level="a" type="main">Use of 3d properties to characterize beyond rule-of-5 property space for passive permeation</title>
		<author>
			<persName><forename type="first">Alan</forename><forename type="middle">M</forename><surname>Cristiano Rw Guimaraes</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Marina</forename><surname>Mathiowetz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Gilles</forename><surname>Shalaeva</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Spiros</forename><surname>Goetz</surname></persName>
		</author>
		<author>
			<persName><surname>Liras</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of chemical information and modeling</title>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="882" to="890" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b16">
	<analytic>
		<title level="a" type="main">Merck molecular force field. i. basis, form, scope, parameterization, and performance of mmff94</title>
		<author>
			<persName><surname>Thomas A Halgren</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of computational chemistry</title>
		<imprint>
			<biblScope unit="volume">17</biblScope>
			<biblScope unit="issue">5-6</biblScope>
			<biblScope unit="page" from="490" to="519" />
			<date type="published" when="1996">1996</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b17">
	<analytic>
		<title level="a" type="main">Mmff vi. mmff94s option for energy minimization studies</title>
		<author>
			<persName><surname>Thomas A Halgren</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Computational Chemistry</title>
		<imprint>
			<biblScope unit="volume">20</biblScope>
			<biblScope unit="issue">7</biblScope>
			<biblScope unit="page" from="720" to="729" />
			<date type="published" when="1999">1999</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b18">
	<analytic>
		<title level="a" type="main">Inductive representation learning on large graphs</title>
		<author>
			<persName><forename type="first">Rex</forename><surname>William L Hamilton</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jure</forename><surname>Ying</surname></persName>
		</author>
		<author>
			<persName><surname>Leskovec</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 31st International Conference on Neural Information Processing Systems</title>
				<meeting>the 31st International Conference on Neural Information Processing Systems</meeting>
		<imprint>
			<date type="published" when="2017">2017</date>
			<biblScope unit="page" from="1025" to="1035" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b19">
	<monogr>
		<title level="m" type="main">Distance geometry: Theory, algorithms, and chemical applications. Encyclopedia of Computational Chemistry</title>
		<author>
			<persName><forename type="first">Timothy</forename><forename type="middle">F</forename><surname>Havel</surname></persName>
		</author>
		<imprint>
			<date type="published" when="1998">1998</date>
			<biblScope unit="volume">120</biblScope>
			<biblScope unit="page" from="723" to="742" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b20">
	<analytic>
		<title level="a" type="main">The combinatorial distance geometry method for the calculation of molecular conformation ii. sample problems and computational statistics</title>
		<author>
			<persName><forename type="first">Timothy</forename><forename type="middle">F</forename><surname>Havel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Gordon</forename><forename type="middle">M</forename><surname>Crippen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Irwin</forename><forename type="middle">D</forename><surname>Kuntz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jeffrey</forename><forename type="middle">M</forename><surname>Blaney</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of theoretical biology</title>
		<imprint>
			<biblScope unit="volume">104</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="383" to="400" />
			<date type="published" when="1983">1983a</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b21">
	<analytic>
		<title level="a" type="main">The combinatorial distance geometry method for the calculation of molecular conformation. i. a new approach to an old problem</title>
		<author>
			<persName><forename type="first">Timothy</forename><forename type="middle">F</forename><surname>Havel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Irwin</forename><forename type="middle">D</forename><surname>Kuntz</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Gordon</forename><forename type="middle">M</forename><surname>Crippen</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of theoretical biology</title>
		<imprint>
			<biblScope unit="volume">104</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="359" to="381" />
			<date type="published" when="1983">1983b</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b22">
	<analytic>
		<title level="a" type="main">Conformation generation: the state of the art</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">D</forename><surname>Paul</surname></persName>
		</author>
		<author>
			<persName><surname>Hawkins</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of Chemical Information and Modeling</title>
		<imprint>
			<biblScope unit="volume">57</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="1747" to="1756" />
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b23">
	<analytic>
		<title level="a" type="main">Conformer generation with omega: learning from the data set and the analysis of failures</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">D</forename><surname>Paul</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Anthony</forename><surname>Hawkins</surname></persName>
		</author>
		<author>
			<persName><surname>Nicholls</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of chemical information and modeling</title>
		<imprint>
			<biblScope unit="volume">52</biblScope>
			<biblScope unit="issue">11</biblScope>
			<biblScope unit="page" from="2919" to="2936" />
			<date type="published" when="2012">2012</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b24">
	<analytic>
		<title level="a" type="main">Conformer generation with omega: algorithm and validation using high quality structures from the protein databank and cambridge structural database</title>
		<author>
			<persName><forename type="first">C</forename><forename type="middle">D</forename><surname>Paul</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Geoffrey</forename><surname>Hawkins</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Gregory</forename><forename type="middle">L</forename><surname>Skillman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Benjamin</forename><forename type="middle">A</forename><surname>Warren</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Matthew</forename><forename type="middle">T</forename><surname>Ellingson</surname></persName>
		</author>
		<author>
			<persName><surname>Stahl</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of chemical information and modeling</title>
		<imprint>
			<biblScope unit="volume">50</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="572" to="584" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b25">
	<analytic>
		<title level="a" type="main">Learning protein structure with a differentiable simulator</title>
		<author>
			<persName><forename type="first">John</forename><surname>Ingraham</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Adam</forename><surname>Riesselman</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Chris</forename><surname>Sander</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Debora</forename><surname>Marks</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Learning Representations</title>
				<imprint>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b26">
	<analytic>
		<title level="a" type="main">A solution for the best rotation to relate two sets of vectors</title>
		<author>
			<persName><forename type="first">Wolfgang</forename><surname>Kabsch</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Acta Crystallographica Section A: Crystal Physics, Diffraction, Theoretical and General Crystallography</title>
		<imprint>
			<biblScope unit="volume">32</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="922" to="923" />
			<date type="published" when="1976">1976</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b27">
	<analytic>
		<title level="a" type="main">A sobering assessment of small-molecule force field methods for low energy conformer predictions</title>
		<author>
			<persName><forename type="first">Ilana</forename><forename type="middle">Y</forename><surname>Kanal</surname></persName>
		</author>
		<author>
			<persName><forename type="first">John</forename><forename type="middle">A</forename><surname>Keith</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Geoffrey</forename><forename type="middle">R</forename><surname>Hutchison</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">International Journal of Quantum Chemistry</title>
		<imprint>
			<biblScope unit="volume">118</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page">e25512</biblScope>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b28">
	<analytic>
		<title level="a" type="main">Semi-supervised classification with graph convolutional networks</title>
		<author>
			<persName><forename type="first">N</forename><surname>Thomas</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Max</forename><surname>Kipf</surname></persName>
		</author>
		<author>
			<persName><surname>Welling</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b29">
	<analytic>
		<title level="a" type="main">Directional message passing for molecular graphs</title>
		<author>
			<persName><forename type="first">Johannes</forename><surname>Klicpera</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Janek</forename><surname>Groß</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Stephan</forename><surname>Günnemann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Learning Representations</title>
				<imprint>
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b30">
	<analytic>
		<title level="a" type="main">Advances in the development of shape similarity methods and their application in drug discovery</title>
		<author>
			<persName><forename type="first">Ashutosh</forename><surname>Kumar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Kam Yj</forename><surname>Zhang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Frontiers in chemistry</title>
		<imprint>
			<biblScope unit="volume">6</biblScope>
			<biblScope unit="page">315</biblScope>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b31">
	<analytic>
		<title level="a" type="main">Dg-ammos: A new tool to generate 3d conformation of small molecules using d istance g eometry and a utomated m olecular m echanics o ptimization for in silico s creening</title>
		<author>
			<persName><forename type="first">David</forename><surname>Lagorce</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Tania</forename><surname>Pencheva</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Bruno</forename><forename type="middle">O</forename><surname>Villoutreix</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Maria</forename><forename type="middle">A</forename><surname>Miteva</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2102.02806</idno>
	</analytic>
	<monogr>
		<title level="m">Dominik Lemm, Guido Falk von Rudorff, and O Anatole von Lilienfeld. Energy-free machine learning predictions of ab initio structures</title>
				<imprint>
			<date type="published" when="2009">2009. 2021</date>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="page" from="1" to="10" />
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b32">
	<monogr>
		<title level="m" type="main">Spherical message passing for 3d graph networks</title>
		<author>
			<persName><forename type="first">Yi</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Limei</forename><surname>Wang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Meng</forename><surname>Liu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Xuan</forename><surname>Zhang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Bora</forename><surname>Oztekin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Shuiwang</forename><surname>Ji</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2102.05013</idno>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b33">
	<analytic>
		<title level="a" type="main">Molecular geometry prediction using a deep generative graph neural network</title>
		<author>
			<persName><forename type="first">Elman</forename><surname>Mansimov</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Omar</forename><surname>Mahmood</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Seokho</forename><surname>Kang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Kyunghyun</forename><surname>Cho</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Scientific reports</title>
		<imprint>
			<biblScope unit="volume">9</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="13" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b34">
	<analytic>
		<title level="a" type="main">Fred pose prediction and virtual screening accuracy</title>
		<author>
			<persName><forename type="first">Mark</forename><surname>Mcgann</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of chemical information and modeling</title>
		<imprint>
			<biblScope unit="volume">51</biblScope>
			<biblScope unit="issue">3</biblScope>
			<biblScope unit="page" from="578" to="596" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b35">
	<analytic>
		<title level="a" type="main">Boltzmann generators: Sampling equilibrium states of many-body systems with deep learning</title>
		<author>
			<persName><forename type="first">Frank</forename><surname>Noé</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Simon</forename><surname>Olsson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jonas</forename><surname>Köhler</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Hao</forename><surname>Wu</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Science</title>
		<imprint>
			<biblScope unit="volume">365</biblScope>
			<biblScope unit="issue">6457</biblScope>
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b36">
	<monogr>
		<author>
			<persName><forename type="first">Lagnajit</forename><surname>Pattanaik</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Octavian</forename><forename type="middle">E</forename><surname>Ganea</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Ian</forename><surname>Coley</surname></persName>
		</author>
		<author>
			<persName><forename type="first">F</forename><surname>Klavs</surname></persName>
		</author>
		<author>
			<persName><forename type="first">William</forename><forename type="middle">H</forename><surname>Jensen</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Connor</forename><forename type="middle">W</forename><surname>Green</surname></persName>
		</author>
		<author>
			<persName><surname>Coley</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2012.00094</idno>
		<title level="m">Message passing networks for molecules with tetrahedral chirality</title>
				<imprint>
			<date type="published" when="2020">2020a</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b37">
	<analytic>
		<title level="a" type="main">Generating transition states of isomerization reactions with deep learning</title>
		<author>
			<persName><forename type="first">Lagnajit</forename><surname>Pattanaik</surname></persName>
		</author>
		<author>
			<persName><forename type="first">John</forename><forename type="middle">B</forename><surname>Ingraham</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Colin</forename><forename type="middle">A</forename><surname>Grambow</surname></persName>
		</author>
		<author>
			<persName><forename type="first">William</forename><forename type="middle">H</forename><surname>Green</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Physical Chemistry Chemical Physics</title>
		<imprint>
			<biblScope unit="volume">22</biblScope>
			<biblScope unit="issue">41</biblScope>
			<biblScope unit="page" from="23618" to="23626" />
			<date type="published" when="2020">2020b</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b38">
	<analytic>
		<title level="a" type="main">Quantum chemistry structures and properties of 134 kilo molecules</title>
		<author>
			<persName><forename type="first">Raghunathan</forename><surname>Ramakrishnan</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Matthias</forename><surname>Pavlo O Dral</surname></persName>
		</author>
		<author>
			<persName><forename type="first">O</forename><surname>Rupp</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Von</forename><surname>Anatole</surname></persName>
		</author>
		<author>
			<persName><surname>Lilienfeld</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Scientific data</title>
		<imprint>
			<biblScope unit="volume">1</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="1" to="7" />
			<date type="published" when="2014">2014</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b39">
	<analytic>
		<title level="a" type="main">Uff, a full periodic table force field for molecular mechanics and molecular dynamics simulations</title>
		<author>
			<persName><forename type="first">Carla</forename><forename type="middle">J</forename><surname>Anthony K Rappé</surname></persName>
		</author>
		<author>
			<persName><surname>Casewit</surname></persName>
		</author>
		<author>
			<persName><forename type="first">William</forename><forename type="middle">A</forename><surname>Colwell</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Iii</forename><surname>Goddard</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Mason</forename><surname>Skiff</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of the American chemical society</title>
		<imprint>
			<biblScope unit="volume">114</biblScope>
			<biblScope unit="issue">25</biblScope>
			<biblScope unit="page" from="10024" to="10035" />
			<date type="published" when="1992">1992</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b40">
	<analytic>
		<title level="a" type="main">Better informed distance geometry: using what we know to improve conformation generation</title>
		<author>
			<persName><forename type="first">Sereina</forename><surname>Riniker</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Gregory</forename><forename type="middle">A</forename><surname>Landrum</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Journal of chemical information and modeling</title>
		<imprint>
			<biblScope unit="volume">55</biblScope>
			<biblScope unit="issue">12</biblScope>
			<biblScope unit="page" from="2562" to="2574" />
			<date type="published" when="2015">2015</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b41">
	<analytic>
		<title level="a" type="main">Schnet-a deep learning architecture for molecules and materials</title>
		<author>
			<persName><surname>Kristof T Schütt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">E</forename><surname>Huziel</surname></persName>
		</author>
		<author>
			<persName><forename type="first">P-J</forename><surname>Sauceda</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Alexandre</forename><surname>Kindermans</surname></persName>
		</author>
		<author>
			<persName><forename type="first">K-R</forename><surname>Tkatchenko</surname></persName>
		</author>
		<author>
			<persName><surname>Müller</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">The Journal of Chemical Physics</title>
		<imprint>
			<biblScope unit="volume">148</biblScope>
			<biblScope unit="issue">24</biblScope>
			<biblScope unit="page">241722</biblScope>
			<date type="published" when="2018">2018</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b42">
	<monogr>
		<title level="m" type="main">Equivariant message passing for the prediction of tensorial properties and molecular spectra</title>
		<author>
			<persName><surname>Kristof T Schütt</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Michael</forename><surname>Oliver T Unke</surname></persName>
		</author>
		<author>
			<persName><surname>Gastegger</surname></persName>
		</author>
		<idno type="arXiv">arXiv:2102.03150</idno>
		<imprint>
			<date type="published" when="2021">2021</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b43">
	<analytic>
		<title level="a" type="main">Conformations and 3d pharmacophore searching</title>
		<author>
			<persName><forename type="first">Christof</forename><forename type="middle">H</forename><surname>Schwab</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Drug Discovery Today: Technologies</title>
		<imprint>
			<biblScope unit="volume">7</biblScope>
			<biblScope unit="issue">4</biblScope>
			<biblScope unit="page" from="e245" to="e253" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b44">
	<analytic>
		<title level="a" type="main">Improved protein structure prediction using potentials from deep learning</title>
		<author>
			<persName><forename type="first">Richard</forename><surname>Andrew W Senior</surname></persName>
		</author>
		<author>
			<persName><forename type="first">John</forename><surname>Evans</surname></persName>
		</author>
		<author>
			<persName><forename type="first">James</forename><surname>Jumper</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Laurent</forename><surname>Kirkpatrick</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Tim</forename><surname>Sifre</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Chongli</forename><surname>Green</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Augustin</forename><surname>Qin</surname></persName>
		</author>
		<author>
			<persName><surname>Žídek</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Alex</forename><surname>Alexander Wr Nelson</surname></persName>
		</author>
		<author>
			<persName><surname>Bridgland</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Nature</title>
		<imprint>
			<biblScope unit="volume">577</biblScope>
			<biblScope unit="issue">7792</biblScope>
			<biblScope unit="page" from="706" to="710" />
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b45">
	<analytic>
		<title level="a" type="main">Computational ligand-based rational design: role of conformational sampling and force fields in model development</title>
		<author>
			<persName><forename type="first">Jihyun</forename><surname>Shim</surname></persName>
		</author>
		<author>
			<persName><surname>Alexander D Mackerell</surname><genName>Jr</genName></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">MedChemComm</title>
		<imprint>
			<biblScope unit="volume">2</biblScope>
			<biblScope unit="issue">5</biblScope>
			<biblScope unit="page" from="356" to="370" />
			<date type="published" when="2011">2011</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b46">
	<analytic>
		<title level="a" type="main">A generative model for molecular distance geometry</title>
		<author>
			<persName><forename type="first">Gregor</forename><surname>Simm</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jose</forename><surname>Miguel Hernandez-Lobato</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Machine Learning</title>
				<imprint>
			<publisher>PMLR</publisher>
			<date type="published" when="2020">2020</date>
			<biblScope unit="page" from="8949" to="8958" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b47">
	<analytic>
		<title level="a" type="main">Fast end-to-end learning on protein surfaces</title>
		<author>
			<persName><forename type="first">Freyr</forename><surname>Sverrisson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jean</forename><surname>Feydy</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Bruno</forename><surname>Correia</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Michael</forename><surname>Bronstein</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">bioRxiv</title>
		<imprint>
			<date type="published" when="2020">2020</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b48">
	<analytic>
		<title level="a" type="main">Attention is all you need</title>
		<author>
			<persName><forename type="first">Ashish</forename><surname>Vaswani</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Noam</forename><surname>Shazeer</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Niki</forename><surname>Parmar</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jakob</forename><surname>Uszkoreit</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Llion</forename><surname>Jones</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Aidan</forename><forename type="middle">N</forename><surname>Gomez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Łukasz</forename><surname>Kaiser</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Illia</forename><surname>Polosukhin</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">Proceedings of the 31st International Conference on Neural Information Processing Systems</title>
				<meeting>the 31st International Conference on Neural Information Processing Systems</meeting>
		<imprint>
			<date type="published" when="2017">2017</date>
			<biblScope unit="page" from="6000" to="6010" />
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b49">
	<monogr>
		<title level="m" type="main">Graph attention networks</title>
		<author>
			<persName><forename type="first">Petar</forename><surname>Veličković</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Guillem</forename><surname>Cucurull</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Arantxa</forename><surname>Casanova</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Adriana</forename><surname>Romero</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Pietro</forename><surname>Lio</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
		<idno type="arXiv">arXiv:1710.10903</idno>
		<imprint>
			<date type="published" when="2017">2017</date>
		</imprint>
	</monogr>
	<note type="report_type">arXiv preprint</note>
</biblStruct>

<biblStruct xml:id="b50">
	<analytic>
		<title level="a" type="main">3d-qsar in drug design-a review</title>
		<author>
			<persName><forename type="first">Jitender</forename><surname>Verma</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Vijay</forename><forename type="middle">M</forename><surname>Khedkar</surname></persName>
		</author>
		<author>
			<persName><surname>Evans C Coutinho</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Current topics in medicinal chemistry</title>
		<imprint>
			<biblScope unit="volume">10</biblScope>
			<biblScope unit="issue">1</biblScope>
			<biblScope unit="page" from="95" to="115" />
			<date type="published" when="2010">2010</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b51">
	<monogr>
		<author>
			<persName><forename type="first">Keyulu</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Weihua</forename><surname>Hu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jure</forename><surname>Leskovec</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Stefanie</forename><surname>Jegelka</surname></persName>
		</author>
		<title level="m">How powerful are graph neural networks? International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b52">
	<analytic>
		<title level="a" type="main">Learning neural generative dynamics for molecular conformation generation</title>
		<author>
			<persName><forename type="first">Minkai</forename><surname>Xu</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Shitong</forename><surname>Luo</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Yoshua</forename><surname>Bengio</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jian</forename><surname>Peng</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Jian</forename><surname>Tang</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="m">International Conference on Learning Representations (ICLR)</title>
				<imprint>
			<biblScope unit="page">2021</biblScope>
		</imprint>
	</monogr>
</biblStruct>

<biblStruct xml:id="b53">
	<analytic>
		<title level="a" type="main">Additional examples of generated conformers for the GEOM-QM9 dataset. Reference GraphDG CGCF ETKDG OMEGA GeoMol Figure 13: Additional examples of generated conformers for the GEOM-DRUGS dataset. Reference GeoMol long-range interactions, which remains the major drawback of our model</title>
		<author>
			<persName><forename type="first">Kevin</forename><surname>Yang</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Kyle</forename><surname>Swanson</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Wengong</forename><surname>Jin</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Connor</forename><surname>Coley</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Philipp</forename><surname>Eiden</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Hua</forename><surname>Gao</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Angel</forename><surname>Guzman-Perez</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Timothy</forename><surname>Hopper</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Brian</forename><surname>Kelley</surname></persName>
		</author>
		<author>
			<persName><forename type="first">Miriam</forename><surname>Mathea</surname></persName>
		</author>
	</analytic>
	<monogr>
		<title level="j">Reference GraphDG CGCF ETKDG OMEGA GeoMol Figure</title>
		<imprint>
			<biblScope unit="volume">59</biblScope>
			<biblScope unit="issue">8</biblScope>
			<biblScope unit="page" from="3370" to="3388" />
			<date type="published" when="2019">2019</date>
		</imprint>
	</monogr>
	<note>Analyzing learned molecular representations for property prediction. We hope to answer this question in future work</note>
</biblStruct>

				</listBibl>
			</div>
		</back>
	</text>
</TEI>
